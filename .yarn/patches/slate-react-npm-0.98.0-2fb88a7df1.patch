diff --git a/dist/index.es.js b/dist/index.es.js
index 0a432725ad4a90942682bd9f26e9322cae362c7e..2a7ab24c4c7758b7ae0812743ccd340c2463731d 100644
--- a/dist/index.es.js
+++ b/dist/index.es.js
@@ -596,9 +596,7 @@ var ReactEditor = {
       return false;
     }
 
-    return targetEl.closest("[data-slate-editor]") === editorEl && (!editable || targetEl.isContentEditable ? true : typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined
-    // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable="false"(readOnly)
-    targetEl.closest('[contenteditable="false"]') === editorEl || !!targetEl.getAttribute('data-slate-zero-width'));
+    return targetEl.closest("[data-slate-editor]") === editorEl && (!editable || targetEl.isContentEditable ? true : typeof targetEl.isContentEditable === 'boolean' && targetEl.closest('[contenteditable="false"]') === editorEl || targetEl.closest("[plate-firefox-fix]") !== null || !!targetEl.getAttribute('data-slate-zero-width'));
   },
   hasEditableTarget: (editor, target) => isDOMNode(target) && ReactEditor.hasDOMNode(editor, target, {
     editable: true
diff --git a/dist/index.es.js.map b/dist/index.es.js.map
index 550896c8764442a024a48382d0fce4b9b20c911e..e5c8c75bc5f2fca2317067fd5ebdf85e8cbe483f 100644
--- a/dist/index.es.js.map
+++ b/dist/index.es.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.es.js","sources":["../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../src/hooks/use-slate-static.tsx","../src/utils/environment.ts","../src/utils/weak-maps.ts","../src/utils/dom.ts","../src/utils/key.ts","../src/plugin/react-editor.ts","../src/utils/diff-text.ts","../src/hooks/android-input-manager/android-input-manager.ts","../src/hooks/use-is-mounted.tsx","../src/hooks/use-isomorphic-layout-effect.ts","../src/hooks/use-mutation-observer.ts","../src/hooks/android-input-manager/use-android-input-manager.ts","../src/utils/range-list.ts","../src/components/string.tsx","../src/components/leaf.tsx","../src/components/text.tsx","../src/components/element.tsx","../src/hooks/use-decorate.ts","../src/hooks/use-selected.ts","../src/hooks/use-children.tsx","../src/hooks/use-read-only.ts","../src/hooks/use-slate.tsx","../src/hooks/use-track-user-input.ts","../src/utils/constants.ts","../src/utils/hotkeys.ts","../src/components/restore-dom/restore-dom-manager.ts","../src/components/restore-dom/restore-dom.tsx","../src/components/editable.tsx","../src/hooks/use-focused.ts","../src/hooks/use-slate-selector.tsx","../src/components/slate.tsx","../src/hooks/use-editor.tsx","../src/hooks/use-slate-selection.tsx","../src/utils/lines.ts","../src/plugin/with-react.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object.\n */\n\nexport const EditorContext = createContext<ReactEditor | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlateStatic = (): Editor => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useSlateStatic\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import React from 'react'\n\nexport const REACT_MAJOR_VERSION = parseInt(React.version.split('.')[0], 10)\n\nexport const IS_IOS =\n  typeof navigator !== 'undefined' &&\n  typeof window !== 'undefined' &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  !window.MSStream\n\nexport const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\n\nexport const IS_ANDROID =\n  typeof navigator !== 'undefined' && /Android/.test(navigator.userAgent)\n\nexport const IS_FIREFOX =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\n\nexport const IS_WEBKIT =\n  typeof navigator !== 'undefined' &&\n  /AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent)\n\n// \"modern\" Edge was released at 79.x\nexport const IS_EDGE_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_CHROME =\n  typeof navigator !== 'undefined' && /Chrome/i.test(navigator.userAgent)\n\n// Native `beforeInput` events don't work well with react on Chrome 75\n// and older, Chrome 76+ can use `beforeInput` though.\nexport const IS_CHROME_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_ANDROID_CHROME_LEGACY =\n  IS_ANDROID &&\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-5]?\\d)(?:\\.)/i.test(navigator.userAgent)\n\n// Firefox did not support `beforeInput` until `v87`.\nexport const IS_FIREFOX_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox\\/(?:[0-7][0-9]|[0-8][0-6])(?:\\.)).*/i.test(\n    navigator.userAgent\n  )\n\n// UC mobile browser\nexport const IS_UC_MOBILE =\n  typeof navigator !== 'undefined' && /.*UCBrowser/.test(navigator.userAgent)\n\n// Wechat browser\nexport const IS_WECHATBROWSER =\n  typeof navigator !== 'undefined' && /.*Wechat/.test(navigator.userAgent)\n\n// Check if DOM is available as React does internally.\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const CAN_USE_DOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n)\n\n// COMPAT: Firefox/Edge Legacy don't support the `beforeinput` event\n// Chrome Legacy doesn't support `beforeinput` correctly\nexport const HAS_BEFORE_INPUT_SUPPORT =\n  (!IS_CHROME_LEGACY || !IS_ANDROID_CHROME_LEGACY) &&\n  !IS_EDGE_LEGACY &&\n  // globalThis is undefined in older browsers\n  typeof globalThis !== 'undefined' &&\n  globalThis.InputEvent &&\n  // @ts-ignore The `getTargetRanges` property isn't recognized.\n  typeof globalThis.InputEvent.prototype.getTargetRanges === 'function'\n","import { Ancestor, Editor, Node, Range, RangeRef, Text } from 'slate'\nimport { Action } from '../hooks/android-input-manager/android-input-manager'\nimport { TextDiff } from './diff-text'\nimport { Key } from './key'\n\n/**\n * Two weak maps that allow us rebuild a path given a node. They are populated\n * at render time such that after a render occurs we can always backtrack.\n */\n\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\n\n/**\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\n * are used to resolve DOM event-related logic into Slate actions.\n */\nexport const EDITOR_TO_WINDOW: WeakMap<Editor, Window> = new WeakMap()\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER: WeakMap<Editor, string> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER_ELEMENT: WeakMap<\n  Editor,\n  HTMLElement\n> = new WeakMap()\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\nexport const EDITOR_TO_KEY_TO_ELEMENT: WeakMap<\n  Editor,\n  WeakMap<Key, HTMLElement>\n> = new WeakMap()\n\n/**\n * Weak maps for storing editor-related state.\n */\n\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_COMPOSING: WeakMap<Editor, boolean> = new WeakMap()\n\nexport const EDITOR_TO_USER_SELECTION: WeakMap<\n  Editor,\n  RangeRef | null\n> = new WeakMap()\n\n/**\n * Weak map for associating the context `onChange` context with the plugin.\n */\n\nexport const EDITOR_TO_ON_CHANGE = new WeakMap<Editor, () => void>()\n\n/**\n * Weak maps for saving pending state on composition stage.\n */\n\nexport const EDITOR_TO_SCHEDULE_FLUSH: WeakMap<\n  Editor,\n  () => void\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_INSERTION_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\nexport const EDITOR_TO_USER_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\n/**\n * Android input handling specific weak-maps\n */\n\nexport const EDITOR_TO_PENDING_DIFFS: WeakMap<\n  Editor,\n  TextDiff[]\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_ACTION: WeakMap<\n  Editor,\n  Action | null\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_SELECTION: WeakMap<\n  Editor,\n  Range | null\n> = new WeakMap()\n\nexport const EDITOR_TO_FORCE_RENDER: WeakMap<Editor, () => void> = new WeakMap()\n\n/**\n * Symbols.\n */\n\nexport const PLACEHOLDER_SYMBOL = (Symbol('placeholder') as unknown) as string\nexport const MARK_PLACEHOLDER_SYMBOL = (Symbol(\n  'mark-placeholder'\n) as unknown) as string\n","/**\n * Types.\n */\n\n// COMPAT: This is required to prevent TypeScript aliases from doing some very\n// weird things for Slate's types with the same name as globals. (2019/11/27)\n// https://github.com/microsoft/TypeScript/issues/35002\nimport DOMNode = globalThis.Node\nimport DOMComment = globalThis.Comment\nimport DOMElement = globalThis.Element\nimport DOMText = globalThis.Text\nimport DOMRange = globalThis.Range\nimport DOMSelection = globalThis.Selection\nimport DOMStaticRange = globalThis.StaticRange\nimport { ReactEditor } from '../plugin/react-editor'\n\nexport {\n  DOMNode,\n  DOMComment,\n  DOMElement,\n  DOMText,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n}\n\ndeclare global {\n  interface Window {\n    Selection: typeof Selection['constructor']\n    DataTransfer: typeof DataTransfer['constructor']\n    Node: typeof Node['constructor']\n  }\n}\n\nexport type DOMPoint = [Node, number]\n\n/**\n * Returns the host window of a DOM node\n */\n\nexport const getDefaultView = (value: any): Window | null => {\n  return (\n    (value && value.ownerDocument && value.ownerDocument.defaultView) || null\n  )\n}\n\n/**\n * Check if a DOM node is a comment node.\n */\n\nexport const isDOMComment = (value: any): value is DOMComment => {\n  return isDOMNode(value) && value.nodeType === 8\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMElement = (value: any): value is DOMElement => {\n  return isDOMNode(value) && value.nodeType === 1\n}\n\n/**\n * Check if a value is a DOM node.\n */\n\nexport const isDOMNode = (value: any): value is DOMNode => {\n  const window = getDefaultView(value)\n  return !!window && value instanceof window.Node\n}\n\n/**\n * Check if a value is a DOM selection.\n */\n\nexport const isDOMSelection = (value: any): value is DOMSelection => {\n  const window = value && value.anchorNode && getDefaultView(value.anchorNode)\n  return !!window && value instanceof window.Selection\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMText = (value: any): value is DOMText => {\n  return isDOMNode(value) && value.nodeType === 3\n}\n\n/**\n * Checks whether a paste event is a plaintext-only event.\n */\n\nexport const isPlainTextOnlyPaste = (event: ClipboardEvent) => {\n  return (\n    event.clipboardData &&\n    event.clipboardData.getData('text/plain') !== '' &&\n    event.clipboardData.types.length === 1\n  )\n}\n\n/**\n * Normalize a DOM point so that it always refers to a text node.\n */\n\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\n  let [node, offset] = domPoint\n\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (isDOMElement(node) && node.childNodes.length) {\n    let isLast = offset === node.childNodes.length\n    let index = isLast ? offset - 1 : offset\n    ;[node, index] = getEditableChildAndIndex(\n      node,\n      index,\n      isLast ? 'backward' : 'forward'\n    )\n    // If the editable child found is in front of input offset, we instead seek to its end\n    isLast = index < offset\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (isDOMElement(node) && node.childNodes.length) {\n      const i = isLast ? node.childNodes.length - 1 : 0\n      node = getEditableChild(node, i, isLast ? 'backward' : 'forward')\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\n  }\n\n  // Return the node and offset.\n  return [node, offset]\n}\n\n/**\n * Determines whether the active element is nested within a shadowRoot\n */\n\nexport const hasShadowRoot = (node: Node | null) => {\n  let parent = node && node.parentNode\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true\n    }\n    parent = parent.parentNode\n  }\n  return false\n}\n\n/**\n * Get the nearest editable child and index at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChildAndIndex = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): [DOMNode, number] => {\n  const { childNodes } = parent\n  let child = childNodes[index]\n  let i = index\n  let triedForward = false\n  let triedBackward = false\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (\n    isDOMComment(child) ||\n    (isDOMElement(child) && child.childNodes.length === 0) ||\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\n  ) {\n    if (triedForward && triedBackward) {\n      break\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true\n      i = index - 1\n      direction = 'backward'\n      continue\n    }\n\n    if (i < 0) {\n      triedBackward = true\n      i = index + 1\n      direction = 'forward'\n      continue\n    }\n\n    child = childNodes[i]\n    index = i\n    i += direction === 'forward' ? 1 : -1\n  }\n\n  return [child, index]\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChild = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): DOMNode => {\n  const [child] = getEditableChildAndIndex(parent, index, direction)\n  return child\n}\n\n/**\n * Get a plaintext representation of the content of a node, accounting for block\n * elements which get a newline appended.\n *\n * The domNode must be attached to the DOM.\n */\n\nexport const getPlainText = (domNode: DOMNode) => {\n  let text = ''\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue\n  }\n\n  if (isDOMElement(domNode)) {\n    for (const childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode)\n    }\n\n    const display = getComputedStyle(domNode).getPropertyValue('display')\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n'\n    }\n  }\n\n  return text\n}\n\n/**\n * Get x-slate-fragment attribute from data-slate-fragment\n */\nconst catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m\nexport const getSlateFragmentAttribute = (\n  dataTransfer: DataTransfer\n): string | void => {\n  const htmlData = dataTransfer.getData('text/html')\n  const [, fragment] = htmlData.match(catchSlateFragment) || []\n  return fragment\n}\n\n/**\n * Get the x-slate-fragment attribute that exist in text/html data\n * and append it to the DataTransfer object\n */\nexport const getClipboardData = (\n  dataTransfer: DataTransfer,\n  clipboardFormatKey = 'x-slate-fragment'\n): DataTransfer => {\n  if (!dataTransfer.getData(`application/${clipboardFormatKey}`)) {\n    const fragment = getSlateFragmentAttribute(dataTransfer)\n    if (fragment) {\n      const clipboardData = new DataTransfer()\n      dataTransfer.types.forEach(type => {\n        clipboardData.setData(type, dataTransfer.getData(type))\n      })\n      clipboardData.setData(`application/${clipboardFormatKey}`, fragment)\n      return clipboardData\n    }\n  }\n  return dataTransfer\n}\n\n/**\n * Check whether a mutation originates from a editable element inside the editor.\n */\n\nexport const isTrackedMutation = (\n  editor: ReactEditor,\n  mutation: MutationRecord,\n  batch: MutationRecord[]\n): boolean => {\n  const { target } = mutation\n  if (isDOMElement(target) && target.matches('[contentEditable=\"false\"]')) {\n    return false\n  }\n\n  const { document } = ReactEditor.getWindow(editor)\n  if (document.contains(target)) {\n    return ReactEditor.hasDOMNode(editor, target, { editable: true })\n  }\n\n  const parentMutation = batch.find(({ addedNodes, removedNodes }) => {\n    for (const node of addedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n\n    for (const node of removedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n  })\n\n  if (!parentMutation || parentMutation === mutation) {\n    return false\n  }\n\n  // Target add/remove is tracked. Track the mutation if we track the parent mutation.\n  return isTrackedMutation(editor, parentMutation, batch)\n}\n","/**\n * An auto-incrementing identifier for keys.\n */\n\nlet n = 0\n\n/**\n * A class that keeps track of a key string. We use a full class here because we\n * want to be able to use them as keys in `WeakMap` objects.\n */\n\nexport class Key {\n  id: string\n\n  constructor() {\n    this.id = `${n++}`\n  }\n}\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Path,\n  Point,\n  Range,\n  Scrubber,\n  Transforms,\n} from 'slate'\nimport { TextDiff } from '../utils/diff-text'\nimport {\n  DOMElement,\n  DOMNode,\n  DOMPoint,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n  DOMText,\n  hasShadowRoot,\n  isDOMElement,\n  isDOMNode,\n  isDOMSelection,\n  normalizeDOMPoint,\n} from '../utils/dom'\nimport { IS_ANDROID, IS_CHROME, IS_FIREFOX } from '../utils/environment'\n\nimport { Key } from '../utils/key'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  NODE_TO_INDEX,\n  NODE_TO_KEY,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\n\n/**\n * A React and DOM-specific version of the `Editor` interface.\n */\n\nexport interface ReactEditor extends BaseEditor {\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  insertData: (data: DataTransfer) => void\n  insertFragmentData: (data: DataTransfer) => boolean\n  insertTextData: (data: DataTransfer) => boolean\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  setFragmentData: (\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n}\n\nexport interface ReactEditorInterface {\n  /**\n   * Experimental and android specific: Get pending diffs\n   */\n  androidPendingDiffs: (editor: Editor) => TextDiff[] | undefined\n\n  /**\n   * Experimental and android specific: Flush all pending diffs and cancel composition at the next possible time.\n   */\n  androidScheduleFlush: (editor: Editor) => void\n\n  /**\n   * Blur the editor.\n   */\n  blur: (editor: ReactEditor) => void\n\n  /**\n   * Deselect the editor.\n   */\n  deselect: (editor: ReactEditor) => void\n\n  /**\n   * Find the DOM node that implements DocumentOrShadowRoot for the editor.\n   */\n  findDocumentOrShadowRoot: (editor: ReactEditor) => Document | ShadowRoot\n\n  /**\n   * Get the target range from a DOM `event`.\n   */\n  findEventRange: (editor: ReactEditor, event: any) => Range\n\n  /**\n   * Find a key for a Slate node.\n   */\n  findKey: (editor: ReactEditor, node: Node) => Key\n\n  /**\n   * Find the path of Slate node.\n   */\n  findPath: (editor: ReactEditor, node: Node) => Path\n\n  /**\n   * Focus the editor.\n   */\n  focus: (editor: ReactEditor) => void\n\n  /**\n   * Return the host window of the current editor.\n   */\n  getWindow: (editor: ReactEditor) => Window\n\n  /**\n   * Check if a DOM node is within the editor.\n   */\n  hasDOMNode: (\n    editor: ReactEditor,\n    target: DOMNode,\n    options?: { editable?: boolean }\n  ) => boolean\n\n  /**\n   * Check if the target is editable and in the editor.\n   */\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   *\n   */\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n\n  /**\n   * Check if the target can be selectable\n   */\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Check if the target is in the editor.\n   */\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   * Insert data from a `DataTransfer` into the editor.\n   */\n  insertData: (editor: ReactEditor, data: DataTransfer) => void\n\n  /**\n   * Insert fragment data from a `DataTransfer` into the editor.\n   */\n  insertFragmentData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Insert text data from a `DataTransfer` into the editor.\n   */\n  insertTextData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Check if the user is currently composing inside the editor.\n   */\n  isComposing: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is focused.\n   */\n  isFocused: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is in read-only mode.\n   */\n  isReadOnly: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the target is inside void and in an non-readonly editor.\n   */\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Sets data from the currently selected fragment on a `DataTransfer`.\n   */\n  setFragmentData: (\n    editor: ReactEditor,\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n\n  /**\n   * Find the native DOM element from a Slate node.\n   */\n  toDOMNode: (editor: ReactEditor, node: Node) => HTMLElement\n\n  /**\n   * Find a native DOM selection point from a Slate point.\n   */\n  toDOMPoint: (editor: ReactEditor, point: Point) => DOMPoint\n\n  /**\n   * Find a native DOM range from a Slate `range`.\n   *\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\n   *\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\n   */\n  toDOMRange: (editor: ReactEditor, range: Range) => DOMRange\n\n  /**\n   * Find a Slate node from a native DOM `element`.\n   */\n  toSlateNode: (editor: ReactEditor, domNode: DOMNode) => Node\n\n  /**\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\n   */\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Point | null : Point\n\n  /**\n   * Find a Slate range from a DOM range or selection.\n   */\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Range | null : Range\n}\n\n// eslint-disable-next-line no-redeclare\nexport const ReactEditor: ReactEditorInterface = {\n  androidPendingDiffs: editor => EDITOR_TO_PENDING_DIFFS.get(editor),\n\n  androidScheduleFlush: editor => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(editor)?.()\n  },\n\n  blur: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, false)\n\n    if (root.activeElement === el) {\n      el.blur()\n    }\n  },\n\n  deselect: editor => {\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges()\n    }\n\n    if (selection) {\n      Transforms.deselect(editor)\n    }\n  },\n\n  findDocumentOrShadowRoot: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = el.getRootNode()\n\n    if (\n      (root instanceof Document || root instanceof ShadowRoot) &&\n      root.getSelection != null\n    ) {\n      return root\n    }\n\n    return el.ownerDocument\n  },\n\n  findEventRange: (editor, event) => {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent\n    }\n\n    const { clientX: x, clientY: y, target } = event\n\n    if (x == null || y == null) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    const node = ReactEditor.toSlateNode(editor, event.target)\n    const path = ReactEditor.findPath(editor, node)\n\n    // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n    if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n      const rect = target.getBoundingClientRect()\n      const isPrev = editor.isInline(node)\n        ? x - rect.left < rect.left + rect.width - x\n        : y - rect.top < rect.top + rect.height - y\n\n      const edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end',\n      })\n      const point = isPrev\n        ? Editor.before(editor, edge)\n        : Editor.after(editor, edge)\n\n      if (point) {\n        const range = Editor.range(editor, point)\n        return range\n      }\n    }\n\n    // Else resolve a range from the caret position where the drop occured.\n    let domRange\n    const { document } = ReactEditor.getWindow(editor)\n\n    // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y)\n    } else {\n      const position = document.caretPositionFromPoint(x, y)\n\n      if (position) {\n        domRange = document.createRange()\n        domRange.setStart(position.offsetNode, position.offset)\n        domRange.setEnd(position.offsetNode, position.offset)\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    // Resolve a Slate range from the DOM range.\n    const range = ReactEditor.toSlateRange(editor, domRange, {\n      exactMatch: false,\n      suppressThrow: false,\n    })\n    return range\n  },\n\n  findKey: (editor, node) => {\n    let key = NODE_TO_KEY.get(node)\n\n    if (!key) {\n      key = new Key()\n      NODE_TO_KEY.set(node, key)\n    }\n\n    return key\n  },\n\n  findPath: (editor, node) => {\n    const path: Path = []\n    let child = node\n\n    while (true) {\n      const parent = NODE_TO_PARENT.get(child)\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path\n        } else {\n          break\n        }\n      }\n\n      const i = NODE_TO_INDEX.get(child)\n\n      if (i == null) {\n        break\n      }\n\n      path.unshift(i)\n      child = parent\n    }\n\n    throw new Error(\n      `Unable to find the path for Slate node: ${Scrubber.stringify(node)}`\n    )\n  },\n\n  focus: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, true)\n\n    if (root.activeElement !== el) {\n      el.focus({ preventScroll: true })\n    }\n  },\n\n  getWindow: editor => {\n    const window = EDITOR_TO_WINDOW.get(editor)\n    if (!window) {\n      throw new Error('Unable to find a host window element for this editor')\n    }\n    return window\n  },\n\n  hasDOMNode: (editor, target, options = {}) => {\n    const { editable = false } = options\n    const editorEl = ReactEditor.toDOMNode(editor, editor)\n    let targetEl\n\n    // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n    try {\n      targetEl = (isDOMElement(target)\n        ? target\n        : target.parentElement) as HTMLElement\n    } catch (err) {\n      if (\n        !err.message.includes('Permission denied to access property \"nodeType\"')\n      ) {\n        throw err\n      }\n    }\n\n    if (!targetEl) {\n      return false\n    }\n\n    return (\n      targetEl.closest(`[data-slate-editor]`) === editorEl &&\n      (!editable || targetEl.isContentEditable\n        ? true\n        : (typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined\n            // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable=\"false\"(readOnly)\n            targetEl.closest('[contenteditable=\"false\"]') === editorEl) ||\n          !!targetEl.getAttribute('data-slate-zero-width'))\n    )\n  },\n\n  hasEditableTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) &&\n    ReactEditor.hasDOMNode(editor, target, { editable: true }),\n\n  hasRange: (editor, range) => {\n    const { anchor, focus } = range\n    return (\n      Editor.hasPath(editor, anchor.path) && Editor.hasPath(editor, focus.path)\n    )\n  },\n\n  hasSelectableTarget: (editor, target) =>\n    ReactEditor.hasEditableTarget(editor, target) ||\n    ReactEditor.isTargetInsideNonReadonlyVoid(editor, target),\n\n  hasTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) && ReactEditor.hasDOMNode(editor, target),\n\n  insertData: (editor, data) => {\n    editor.insertData(data)\n  },\n\n  insertFragmentData: (editor, data) => editor.insertFragmentData(data),\n\n  insertTextData: (editor, data) => editor.insertTextData(data),\n\n  isComposing: editor => {\n    return !!IS_COMPOSING.get(editor)\n  },\n\n  isFocused: editor => !!IS_FOCUSED.get(editor),\n\n  isReadOnly: editor => !!IS_READ_ONLY.get(editor),\n\n  isTargetInsideNonReadonlyVoid: (editor, target) => {\n    if (IS_READ_ONLY.get(editor)) return false\n\n    const slateNode =\n      ReactEditor.hasTarget(editor, target) &&\n      ReactEditor.toSlateNode(editor, target)\n    return Element.isElement(slateNode) && Editor.isVoid(editor, slateNode)\n  },\n\n  setFragmentData: (editor, data, originEvent) =>\n    editor.setFragmentData(data, originEvent),\n\n  toDOMNode: (editor, node) => {\n    const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n    const domNode = Editor.isEditor(node)\n      ? EDITOR_TO_ELEMENT.get(editor)\n      : KEY_TO_ELEMENT?.get(ReactEditor.findKey(editor, node))\n\n    if (!domNode) {\n      throw new Error(\n        `Cannot resolve a DOM node from Slate node: ${Scrubber.stringify(node)}`\n      )\n    }\n\n    return domNode\n  },\n\n  toDOMPoint: (editor, point) => {\n    const [node] = Editor.node(editor, point.path)\n    const el = ReactEditor.toDOMNode(editor, node)\n    let domPoint: DOMPoint | undefined\n\n    // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n    if (Editor.void(editor, { at: point })) {\n      point = { path: point.path, offset: 0 }\n    }\n\n    // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n    const selector = `[data-slate-string], [data-slate-zero-width]`\n    const texts = Array.from(el.querySelectorAll(selector))\n    let start = 0\n\n    for (let i = 0; i < texts.length; i++) {\n      const text = texts[i]\n      const domNode = text.childNodes[0] as HTMLElement\n\n      if (domNode == null || domNode.textContent == null) {\n        continue\n      }\n\n      const { length } = domNode.textContent\n      const attr = text.getAttribute('data-slate-length')\n      const trueLength = attr == null ? length : parseInt(attr, 10)\n      const end = start + trueLength\n\n      // Prefer putting the selection inside the mark placeholder to ensure\n      // composed text is displayed with the correct marks.\n      const nextText = texts[i + 1]\n      if (\n        point.offset === end &&\n        nextText?.hasAttribute('data-slate-mark-placeholder')\n      ) {\n        const domText = nextText.childNodes[0]\n\n        domPoint = [\n          // COMPAT: If we don't explicity set the dom point to be on the actual\n          // dom text element, chrome will put the selection behind the actual dom\n          // text element, causing domRange.getBoundingClientRect() calls on a collapsed\n          // selection to return incorrect zero values (https://bugs.chromium.org/p/chromium/issues/detail?id=435438)\n          // which will cause issues when scrolling to it.\n          domText instanceof DOMText ? domText : nextText,\n          nextText.textContent?.startsWith('\\uFEFF') ? 1 : 0,\n        ]\n        break\n      }\n\n      if (point.offset <= end) {\n        const offset = Math.min(length, Math.max(0, point.offset - start))\n        domPoint = [domNode, offset]\n        break\n      }\n\n      start = end\n    }\n\n    if (!domPoint) {\n      throw new Error(\n        `Cannot resolve a DOM point from Slate point: ${Scrubber.stringify(\n          point\n        )}`\n      )\n    }\n\n    return domPoint\n  },\n\n  toDOMRange: (editor, range) => {\n    const { anchor, focus } = range\n    const isBackward = Range.isBackward(range)\n    const domAnchor = ReactEditor.toDOMPoint(editor, anchor)\n    const domFocus = Range.isCollapsed(range)\n      ? domAnchor\n      : ReactEditor.toDOMPoint(editor, focus)\n\n    const window = ReactEditor.getWindow(editor)\n    const domRange = window.document.createRange()\n    const [startNode, startOffset] = isBackward ? domFocus : domAnchor\n    const [endNode, endOffset] = isBackward ? domAnchor : domFocus\n\n    // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n    const startEl = (isDOMElement(startNode)\n      ? startNode\n      : startNode.parentElement) as HTMLElement\n    const isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width')\n    const endEl = (isDOMElement(endNode)\n      ? endNode\n      : endNode.parentElement) as HTMLElement\n    const isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width')\n\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset)\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset)\n    return domRange\n  },\n\n  toSlateNode: (editor, domNode) => {\n    let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(`[data-slate-node]`)\n    }\n\n    const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\n\n    if (!node) {\n      throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\n    }\n\n    return node\n  },\n\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Point | null : Point => {\n    const { exactMatch, suppressThrow } = options\n    const [nearestNode, nearestOffset] = exactMatch\n      ? domPoint\n      : normalizeDOMPoint(domPoint)\n    const parentNode = nearestNode.parentNode as DOMElement\n    let textNode: DOMElement | null = null\n    let offset = 0\n\n    if (parentNode) {\n      const editorEl = ReactEditor.toDOMNode(editor, editor)\n      const potentialVoidNode = parentNode.closest('[data-slate-void=\"true\"]')\n      // Need to ensure that the closest void node is actually a void node\n      // within this editor, and not a void node within some parent editor. This can happen\n      // if this editor is within a void node of another editor (\"nested editors\", like in\n      // the \"Editable Voids\" example on the docs site).\n      const voidNode =\n        potentialVoidNode && editorEl.contains(potentialVoidNode)\n          ? potentialVoidNode\n          : null\n      let leafNode = parentNode.closest('[data-slate-leaf]')\n      let domNode: DOMElement | null = null\n\n      // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]')\n\n        if (textNode) {\n          const window = ReactEditor.getWindow(editor)\n          const range = window.document.createRange()\n          range.setStart(textNode, 0)\n          range.setEnd(nearestNode, nearestOffset)\n\n          const contents = range.cloneContents()\n          const removals = [\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[data-slate-zero-width]')\n            ),\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[contenteditable=false]')\n            ),\n          ]\n\n          removals.forEach(el => {\n            // COMPAT: While composing at the start of a text node, some keyboards put\n            // the text content inside the zero width space.\n            if (\n              IS_ANDROID &&\n              !exactMatch &&\n              el.hasAttribute('data-slate-zero-width') &&\n              el.textContent.length > 0 &&\n              el.textContext !== '\\uFEFF'\n            ) {\n              if (el.textContent.startsWith('\\uFEFF')) {\n                el.textContent = el.textContent.slice(1)\n              }\n\n              return\n            }\n\n            el!.parentNode!.removeChild(el)\n          })\n\n          // COMPAT: Edge has a bug where Range.prototype.toString() will\n          // convert \\n into \\r\\n. The bug causes a loop when slate-react\n          // attempts to reposition its cursor to match the native position. Use\n          // textContent.length instead.\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n          offset = contents.textContent!.length\n          domNode = textNode\n        }\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent and taking the\n        // first one that isn't inside a nested editor.\n        const leafNodes = voidNode.querySelectorAll('[data-slate-leaf]')\n        for (let index = 0; index < leafNodes.length; index++) {\n          const current = leafNodes[index]\n          if (ReactEditor.hasDOMNode(editor, current)) {\n            leafNode = current\n            break\n          }\n        }\n\n        // COMPAT: In read-only editors the leaf is not rendered.\n        if (!leafNode) {\n          offset = 1\n        } else {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          offset = domNode.textContent!.length\n          domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n            offset -= el.textContent!.length\n          })\n        }\n      }\n\n      if (\n        domNode &&\n        offset === domNode.textContent!.length &&\n        // COMPAT: Android IMEs might remove the zero width space while composing,\n        // and we don't add it for line-breaks.\n        IS_ANDROID &&\n        domNode.getAttribute('data-slate-zero-width') === 'z' &&\n        domNode.textContent?.startsWith('\\uFEFF') &&\n        // COMPAT: If the parent node is a Slate zero-width space, editor is\n        // because the text node should have no characters. However, during IME\n        // composition the ASCII characters will be prepended to the zero-width\n        // space, so subtract 1 from the offset to account for the zero-width\n        // space character.\n        (parentNode.hasAttribute('data-slate-zero-width') ||\n          // COMPAT: In Firefox, `range.cloneContents()` returns an extra trailing '\\n'\n          // when the document ends with a new-line character. This results in the offset\n          // length being off by one, so we need to subtract one to account for this.\n          (IS_FIREFOX && domNode.textContent?.endsWith('\\n\\n')))\n      ) {\n        offset--\n      }\n    }\n\n    if (IS_ANDROID && !textNode && !exactMatch) {\n      const node = parentNode.hasAttribute('data-slate-node')\n        ? parentNode\n        : parentNode.closest('[data-slate-node]')\n\n      if (node && ReactEditor.hasDOMNode(editor, node, { editable: true })) {\n        const slateNode = ReactEditor.toSlateNode(editor, node)\n        let { path, offset } = Editor.start(\n          editor,\n          ReactEditor.findPath(editor, slateNode)\n        )\n\n        if (!node.querySelector('[data-slate-leaf]')) {\n          offset = nearestOffset\n        }\n\n        return { path, offset } as T extends true ? Point | null : Point\n      }\n    }\n\n    if (!textNode) {\n      if (suppressThrow) {\n        return null as T extends true ? Point | null : Point\n      }\n      throw new Error(\n        `Cannot resolve a Slate point from DOM point: ${domPoint}`\n      )\n    }\n\n    // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n    const slateNode = ReactEditor.toSlateNode(editor, textNode!)\n    const path = ReactEditor.findPath(editor, slateNode)\n    return { path, offset } as T extends true ? Point | null : Point\n  },\n\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Range | null : Range => {\n    const { exactMatch, suppressThrow } = options\n    const el = isDOMSelection(domRange)\n      ? domRange.anchorNode\n      : domRange.startContainer\n    let anchorNode\n    let anchorOffset\n    let focusNode\n    let focusOffset\n    let isCollapsed\n\n    if (el) {\n      if (isDOMSelection(domRange)) {\n        // COMPAT: In firefox the normal seletion way does not work\n        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n        if (IS_FIREFOX && domRange.rangeCount > 1) {\n          focusNode = domRange.focusNode // Focus node works fine\n          const firstRange = domRange.getRangeAt(0)\n          const lastRange = domRange.getRangeAt(domRange.rangeCount - 1)\n\n          // Right to left\n          if (firstRange.startContainer === focusNode) {\n            anchorNode = lastRange.endContainer\n            anchorOffset = lastRange.endOffset\n            focusOffset = firstRange.startOffset\n          } else {\n            // Left to right\n            anchorNode = firstRange.startContainer\n            anchorOffset = firstRange.endOffset\n            focusOffset = lastRange.startOffset\n          }\n        } else {\n          anchorNode = domRange.anchorNode\n          anchorOffset = domRange.anchorOffset\n          focusNode = domRange.focusNode\n          focusOffset = domRange.focusOffset\n        }\n\n        // COMPAT: There's a bug in chrome that always returns `true` for\n        // `isCollapsed` for a Selection that comes from a ShadowRoot.\n        // (2020/08/08)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n        // IsCollapsed might not work in firefox, but this will\n        if ((IS_CHROME && hasShadowRoot(anchorNode)) || IS_FIREFOX) {\n          isCollapsed =\n            domRange.anchorNode === domRange.focusNode &&\n            domRange.anchorOffset === domRange.focusOffset\n        } else {\n          isCollapsed = domRange.isCollapsed\n        }\n      } else {\n        anchorNode = domRange.startContainer\n        anchorOffset = domRange.startOffset\n        focusNode = domRange.endContainer\n        focusOffset = domRange.endOffset\n        isCollapsed = domRange.collapsed\n      }\n    }\n\n    if (\n      anchorNode == null ||\n      focusNode == null ||\n      anchorOffset == null ||\n      focusOffset == null\n    ) {\n      throw new Error(\n        `Cannot resolve a Slate range from DOM range: ${domRange}`\n      )\n    }\n\n    // COMPAT: Triple-clicking a word in chrome will sometimes place the focus\n    // inside a `contenteditable=\"false\"` DOM node following the word, which\n    // will cause `toSlatePoint` to throw an error. (2023/03/07)\n    if (\n      'getAttribute' in focusNode &&\n      (focusNode as HTMLElement).getAttribute('contenteditable') === 'false' &&\n      (focusNode as HTMLElement).getAttribute('data-slate-void') !== 'true'\n    ) {\n      focusNode = anchorNode\n      focusOffset = anchorNode.textContent?.length || 0\n    }\n\n    const anchor = ReactEditor.toSlatePoint(\n      editor,\n      [anchorNode, anchorOffset],\n      {\n        exactMatch,\n        suppressThrow,\n      }\n    )\n    if (!anchor) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    const focus = isCollapsed\n      ? anchor\n      : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset], {\n          exactMatch,\n          suppressThrow,\n        })\n    if (!focus) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    let range: Range = { anchor: anchor as Point, focus: focus as Point }\n    // if the selection is a hanging range that ends in a void\n    // and the DOM focus is an Element\n    // (meaning that the selection ends before the element)\n    // unhang the range to avoid mistakenly including the void\n    if (\n      Range.isExpanded(range) &&\n      Range.isForward(range) &&\n      isDOMElement(focusNode) &&\n      Editor.void(editor, { at: range.focus, mode: 'highest' })\n    ) {\n      range = Editor.unhangRange(editor, range, { voids: true })\n    }\n\n    return (range as unknown) as T extends true ? Range | null : Range\n  },\n}\n","import {\n  Editor,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Text,\n  Element,\n} from 'slate'\nimport { EDITOR_TO_PENDING_DIFFS } from './weak-maps'\n\nexport type StringDiff = {\n  start: number\n  end: number\n  text: string\n}\n\nexport type TextDiff = {\n  id: number\n  path: Path\n  diff: StringDiff\n}\n\n/**\n * Check whether a text diff was applied in a way we can perform the pending action on /\n * recover the pending selection.\n */\nexport function verifyDiffState(editor: Editor, textDiff: TextDiff): boolean {\n  const { path, diff } = textDiff\n  if (!Editor.hasPath(editor, path)) {\n    return false\n  }\n\n  const node = Node.get(editor, path)\n  if (!Text.isText(node)) {\n    return false\n  }\n\n  if (diff.start !== node.text.length || diff.text.length === 0) {\n    return (\n      node.text.slice(diff.start, diff.start + diff.text.length) === diff.text\n    )\n  }\n\n  const nextPath = Path.next(path)\n  if (!Editor.hasPath(editor, nextPath)) {\n    return false\n  }\n\n  const nextNode = Node.get(editor, nextPath)\n  return Text.isText(nextNode) && nextNode.text.startsWith(diff.text)\n}\n\nexport function applyStringDiff(text: string, ...diffs: StringDiff[]) {\n  return diffs.reduce(\n    (text, diff) =>\n      text.slice(0, diff.start) + diff.text + text.slice(diff.end),\n    text\n  )\n}\n\nfunction longestCommonPrefixLength(str: string, another: string) {\n  const length = Math.min(str.length, another.length)\n\n  for (let i = 0; i < length; i++) {\n    if (str.charAt(i) !== another.charAt(i)) {\n      return i\n    }\n  }\n\n  return length\n}\n\nfunction longestCommonSuffixLength(\n  str: string,\n  another: string,\n  max: number\n): number {\n  const length = Math.min(str.length, another.length, max)\n\n  for (let i = 0; i < length; i++) {\n    if (\n      str.charAt(str.length - i - 1) !== another.charAt(another.length - i - 1)\n    ) {\n      return i\n    }\n  }\n\n  return length\n}\n\n/**\n * Remove redundant changes from the diff so that it spans the minimal possible range\n */\nexport function normalizeStringDiff(targetText: string, diff: StringDiff) {\n  const { start, end, text } = diff\n  const removedText = targetText.slice(start, end)\n\n  const prefixLength = longestCommonPrefixLength(removedText, text)\n  const max = Math.min(\n    removedText.length - prefixLength,\n    text.length - prefixLength\n  )\n  const suffixLength = longestCommonSuffixLength(removedText, text, max)\n\n  const normalized: StringDiff = {\n    start: start + prefixLength,\n    end: end - suffixLength,\n    text: text.slice(prefixLength, text.length - suffixLength),\n  }\n\n  if (normalized.start === normalized.end && normalized.text.length === 0) {\n    return null\n  }\n\n  return normalized\n}\n\n/**\n * Return a string diff that is equivalent to applying b after a spanning the range of\n * both changes\n */\nexport function mergeStringDiffs(\n  targetText: string,\n  a: StringDiff,\n  b: StringDiff\n): StringDiff | null {\n  const start = Math.min(a.start, b.start)\n  const overlap = Math.max(\n    0,\n    Math.min(a.start + a.text.length, b.end) - b.start\n  )\n\n  const applied = applyStringDiff(targetText, a, b)\n  const sliceEnd = Math.max(\n    b.start + b.text.length,\n    a.start +\n      a.text.length +\n      (a.start + a.text.length > b.start ? b.text.length : 0) -\n      overlap\n  )\n\n  const text = applied.slice(start, sliceEnd)\n  const end = Math.max(a.end, b.end - a.text.length + (a.end - a.start))\n  return normalizeStringDiff(targetText, { start, end, text })\n}\n\n/**\n * Get the slate range the text diff spans.\n */\nexport function targetRange(textDiff: TextDiff): Range {\n  const { path, diff } = textDiff\n  return {\n    anchor: { path, offset: diff.start },\n    focus: { path, offset: diff.end },\n  }\n}\n\n/**\n * Normalize a 'pending point' a.k.a a point based on the dom state before applying\n * the pending diffs. Since the pending diffs might have been inserted with different\n * marks we have to 'walk' the offset from the starting position to ensure we still\n * have a valid point inside the document\n */\nexport function normalizePoint(editor: Editor, point: Point): Point | null {\n  let { path, offset } = point\n  if (!Editor.hasPath(editor, path)) {\n    return null\n  }\n\n  let leaf = Node.get(editor, path)\n  if (!Text.isText(leaf)) {\n    return null\n  }\n\n  const parentBlock = Editor.above(editor, {\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n    at: path,\n  })\n\n  if (!parentBlock) {\n    return null\n  }\n\n  while (offset > leaf.text.length) {\n    const entry = Editor.next(editor, { at: path, match: Text.isText })\n    if (!entry || !Path.isDescendant(entry[1], parentBlock[1])) {\n      return null\n    }\n\n    offset -= leaf.text.length\n    leaf = entry[0]\n    path = entry[1]\n  }\n\n  return { path, offset }\n}\n\n/**\n * Normalize a 'pending selection' to ensure it's valid in the current document state.\n */\nexport function normalizeRange(editor: Editor, range: Range): Range | null {\n  const anchor = normalizePoint(editor, range.anchor)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = normalizePoint(editor, range.focus)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformPendingPoint(\n  editor: Editor,\n  point: Point,\n  op: Operation\n): Point | null {\n  const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n  const textDiff = pendingDiffs?.find(({ path }) =>\n    Path.equals(path, point.path)\n  )\n\n  if (!textDiff || point.offset <= textDiff.diff.start) {\n    return Point.transform(point, op, { affinity: 'backward' })\n  }\n\n  const { diff } = textDiff\n  // Point references location inside the diff => transform the point based on the location\n  // the diff will be applied to and add the offset inside the diff.\n  if (point.offset <= diff.start + diff.text.length) {\n    const anchor = { path: point.path, offset: diff.start }\n    const transformed = Point.transform(anchor, op, {\n      affinity: 'backward',\n    })\n\n    if (!transformed) {\n      return null\n    }\n\n    return {\n      path: transformed.path,\n      offset: transformed.offset + point.offset - diff.start,\n    }\n  }\n\n  // Point references location after the diff\n  const anchor = {\n    path: point.path,\n    offset: point.offset - diff.text.length + diff.end - diff.start,\n  }\n  const transformed = Point.transform(anchor, op, {\n    affinity: 'backward',\n  })\n  if (!transformed) {\n    return null\n  }\n\n  if (\n    op.type === 'split_node' &&\n    Path.equals(op.path, point.path) &&\n    anchor.offset < op.position &&\n    diff.start < op.position\n  ) {\n    return transformed\n  }\n\n  return {\n    path: transformed.path,\n    offset: transformed.offset + diff.text.length - diff.end + diff.start,\n  }\n}\n\nexport function transformPendingRange(\n  editor: Editor,\n  range: Range,\n  op: Operation\n): Range | null {\n  const anchor = transformPendingPoint(editor, range.anchor, op)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = transformPendingPoint(editor, range.focus, op)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformTextDiff(\n  textDiff: TextDiff,\n  op: Operation\n): TextDiff | null {\n  const { path, diff, id } = textDiff\n\n  switch (op.type) {\n    case 'insert_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset <= diff.start) {\n        return {\n          diff: {\n            start: op.text.length + diff.start,\n            end: op.text.length + diff.end,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end + op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'remove_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset + op.text.length <= diff.start) {\n        return {\n          diff: {\n            start: diff.start - op.text.length,\n            end: diff.end - op.text.length,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end - op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'split_node': {\n      if (!Path.equals(op.path, path) || op.position >= diff.end) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op, { affinity: 'backward' })!,\n        }\n      }\n\n      if (op.position > diff.start) {\n        return {\n          diff: {\n            start: diff.start,\n            end: Math.min(op.position, diff.end),\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start - op.position,\n          end: diff.end - op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op, { affinity: 'forward' })!,\n      }\n    }\n    case 'merge_node': {\n      if (!Path.equals(op.path, path)) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op)!,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start + op.position,\n          end: diff.end + op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op)!,\n      }\n    }\n  }\n\n  const newPath = Path.transform(path, op)\n  if (!newPath) {\n    return null\n  }\n\n  return {\n    diff,\n    path: newPath,\n    id,\n  }\n}\n","import { DebouncedFunc } from 'lodash'\nimport { Editor, Node, Path, Point, Range, Text, Transforms } from 'slate'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport {\n  applyStringDiff,\n  mergeStringDiffs,\n  normalizePoint,\n  normalizeRange,\n  normalizeStringDiff,\n  StringDiff,\n  targetRange,\n  TextDiff,\n  verifyDiffState,\n} from '../../utils/diff-text'\nimport { isDOMSelection, isTrackedMutation } from '../../utils/dom'\nimport {\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_USER_MARKS,\n  IS_COMPOSING,\n} from '../../utils/weak-maps'\n\nexport type Action = { at?: Point | Range; run: () => void }\n\n// https://github.com/facebook/draft-js/blob/main/src/component/handlers/composition/DraftEditorCompositionHandler.js#L41\n// When using keyboard English association function, conpositionEnd triggered too fast, resulting in after `insertText` still maintain association state.\nconst RESOLVE_DELAY = 25\n\n// Time with no user interaction before the current user action is considered as done.\nconst FLUSH_DELAY = 200\n\n// Replace with `const debug = console.log` to debug\nconst debug = (..._: unknown[]) => {}\n\n// Type guard to check if a value is a DataTransfer\nconst isDataTransfer = (value: any): value is DataTransfer =>\n  value?.constructor.name === 'DataTransfer'\n\nexport type CreateAndroidInputManagerOptions = {\n  editor: ReactEditor\n\n  scheduleOnDOMSelectionChange: DebouncedFunc<() => void>\n  onDOMSelectionChange: DebouncedFunc<() => void>\n}\n\nexport type AndroidInputManager = {\n  flush: () => void\n  scheduleFlush: () => void\n\n  hasPendingDiffs: () => boolean\n  hasPendingAction: () => boolean\n  hasPendingChanges: () => boolean\n  isFlushing: () => boolean | 'action'\n\n  handleUserSelect: (range: Range | null) => void\n  handleCompositionEnd: (event: React.CompositionEvent<HTMLDivElement>) => void\n  handleCompositionStart: (\n    event: React.CompositionEvent<HTMLDivElement>\n  ) => void\n  handleDOMBeforeInput: (event: InputEvent) => void\n  handleKeyDown: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  handleDomMutations: (mutations: MutationRecord[]) => void\n  handleInput: () => void\n}\n\nexport function createAndroidInputManager({\n  editor,\n  scheduleOnDOMSelectionChange,\n  onDOMSelectionChange,\n}: CreateAndroidInputManagerOptions): AndroidInputManager {\n  let flushing: 'action' | boolean = false\n  let compositionEndTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let flushTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let actionTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  let idCounter = 0\n  let insertPositionHint: StringDiff | null | false = false\n\n  const applyPendingSelection = () => {\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(editor)\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n\n    if (pendingSelection) {\n      const { selection } = editor\n      const normalized = normalizeRange(editor, pendingSelection)\n\n      debug('apply pending selection', pendingSelection, normalized)\n\n      if (normalized && (!selection || !Range.equals(normalized, selection))) {\n        Transforms.select(editor, normalized)\n      }\n    }\n  }\n\n  const performAction = () => {\n    const action = EDITOR_TO_PENDING_ACTION.get(editor)\n    EDITOR_TO_PENDING_ACTION.delete(editor)\n    if (!action) {\n      return\n    }\n\n    if (action.at) {\n      const target = Point.isPoint(action.at)\n        ? normalizePoint(editor, action.at)\n        : normalizeRange(editor, action.at)\n\n      if (!target) {\n        return\n      }\n\n      const targetRange = Editor.range(editor, target)\n      if (!editor.selection || !Range.equals(editor.selection, targetRange)) {\n        Transforms.select(editor, target)\n      }\n    }\n\n    action.run()\n  }\n\n  const flush = () => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    if (actionTimeoutId) {\n      clearTimeout(actionTimeoutId)\n      actionTimeoutId = null\n    }\n\n    if (!hasPendingDiffs() && !hasPendingAction()) {\n      applyPendingSelection()\n      return\n    }\n\n    if (!flushing) {\n      flushing = true\n      setTimeout(() => (flushing = false))\n    }\n\n    if (hasPendingAction()) {\n      flushing = 'action'\n    }\n\n    const selectionRef =\n      editor.selection &&\n      Editor.rangeRef(editor, editor.selection, { affinity: 'forward' })\n    EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n\n    debug(\n      'flush',\n      EDITOR_TO_PENDING_ACTION.get(editor),\n      EDITOR_TO_PENDING_DIFFS.get(editor)\n    )\n\n    let scheduleSelectionChange = hasPendingDiffs()\n\n    let diff: TextDiff | undefined\n    while ((diff = EDITOR_TO_PENDING_DIFFS.get(editor)?.[0])) {\n      const pendingMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)\n\n      if (pendingMarks !== undefined) {\n        EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n        editor.marks = pendingMarks\n      }\n\n      if (pendingMarks && insertPositionHint === false) {\n        insertPositionHint = null\n        debug('insert after mark placeholder')\n      }\n\n      const range = targetRange(diff)\n      if (!editor.selection || !Range.equals(editor.selection, range)) {\n        Transforms.select(editor, range)\n      }\n\n      if (diff.diff.text) {\n        Editor.insertText(editor, diff.diff.text)\n      } else {\n        Editor.deleteFragment(editor)\n      }\n\n      // Remove diff only after we have applied it to account for it when transforming\n      // pending ranges.\n      EDITOR_TO_PENDING_DIFFS.set(\n        editor,\n        EDITOR_TO_PENDING_DIFFS.get(editor)?.filter(\n          ({ id }) => id !== diff!.id\n        )!\n      )\n\n      if (!verifyDiffState(editor, diff)) {\n        debug('invalid diff state')\n        scheduleSelectionChange = false\n        EDITOR_TO_PENDING_ACTION.delete(editor)\n        EDITOR_TO_USER_MARKS.delete(editor)\n        flushing = 'action'\n\n        // Ensure we don't restore the pending user (dom) selection\n        // since the document and dom state do not match.\n        EDITOR_TO_PENDING_SELECTION.delete(editor)\n        scheduleOnDOMSelectionChange.cancel()\n        onDOMSelectionChange.cancel()\n        selectionRef?.unref()\n      }\n    }\n\n    const selection = selectionRef?.unref()\n    if (\n      selection &&\n      !EDITOR_TO_PENDING_SELECTION.get(editor) &&\n      (!editor.selection || !Range.equals(selection, editor.selection))\n    ) {\n      Transforms.select(editor, selection)\n    }\n\n    if (hasPendingAction()) {\n      performAction()\n      return\n    }\n\n    // COMPAT: The selectionChange event is fired after the action is performed,\n    // so we have to manually schedule it to ensure we don't 'throw away' the selection\n    // while rendering if we have pending changes.\n    if (scheduleSelectionChange) {\n      debug('scheduleOnDOMSelectionChange pending changes')\n      scheduleOnDOMSelectionChange()\n    }\n\n    scheduleOnDOMSelectionChange.flush()\n    onDOMSelectionChange.flush()\n\n    applyPendingSelection()\n\n    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n    EDITOR_TO_USER_MARKS.delete(editor)\n    if (userMarks !== undefined) {\n      editor.marks = userMarks\n      editor.onChange()\n    }\n  }\n\n  const handleCompositionEnd = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n    }\n\n    compositionEndTimeoutId = setTimeout(() => {\n      IS_COMPOSING.set(editor, false)\n      flush()\n    }, RESOLVE_DELAY)\n  }\n\n  const handleCompositionStart = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    debug('composition start')\n\n    IS_COMPOSING.set(editor, true)\n\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n      compositionEndTimeoutId = null\n    }\n  }\n\n  const updatePlaceholderVisibility = (forceHide = false) => {\n    const placeholderElement = EDITOR_TO_PLACEHOLDER_ELEMENT.get(editor)\n    if (!placeholderElement) {\n      return\n    }\n\n    if (hasPendingDiffs() || forceHide) {\n      placeholderElement.style.display = 'none'\n      return\n    }\n\n    placeholderElement.style.removeProperty('display')\n  }\n\n  const storeDiff = (path: Path, diff: StringDiff) => {\n    debug('storeDiff', path, diff)\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor) ?? []\n    EDITOR_TO_PENDING_DIFFS.set(editor, pendingDiffs)\n\n    const target = Node.leaf(editor, path)\n    const idx = pendingDiffs.findIndex(change => Path.equals(change.path, path))\n    if (idx < 0) {\n      const normalized = normalizeStringDiff(target.text, diff)\n      if (normalized) {\n        pendingDiffs.push({ path, diff, id: idCounter++ })\n      }\n\n      updatePlaceholderVisibility()\n      return\n    }\n\n    const merged = mergeStringDiffs(target.text, pendingDiffs[idx].diff, diff)\n    if (!merged) {\n      pendingDiffs.splice(idx, 1)\n      updatePlaceholderVisibility()\n      return\n    }\n\n    pendingDiffs[idx] = {\n      ...pendingDiffs[idx],\n      diff: merged,\n    }\n  }\n\n  const scheduleAction = (\n    run: () => void,\n    { at }: { at?: Point | Range } = {}\n  ): void => {\n    insertPositionHint = false\n    debug('scheduleAction', { at, run })\n\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n    scheduleOnDOMSelectionChange.cancel()\n    onDOMSelectionChange.cancel()\n\n    if (hasPendingAction()) {\n      flush()\n    }\n\n    EDITOR_TO_PENDING_ACTION.set(editor, { at, run })\n\n    // COMPAT: When deleting before a non-contenteditable element chrome only fires a beforeinput,\n    // (no input) and doesn't perform any dom mutations. Without a flush timeout we would never flush\n    // in this case and thus never actually perform the action.\n    actionTimeoutId = setTimeout(flush)\n  }\n\n  const handleDOMBeforeInput = (event: InputEvent): void => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { inputType: type } = event\n    let targetRange: Range | null = null\n    const data: DataTransfer | string | undefined =\n      (event as any).dataTransfer || event.data || undefined\n\n    if (\n      insertPositionHint !== false &&\n      type !== 'insertText' &&\n      type !== 'insertCompositionText'\n    ) {\n      insertPositionHint = false\n    }\n\n    let [nativeTargetRange] = (event as any).getTargetRanges()\n    if (nativeTargetRange) {\n      targetRange = ReactEditor.toSlateRange(editor, nativeTargetRange, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    // COMPAT: SelectionChange event is fired after the action is performed, so we\n    // have to manually get the selection here to ensure it's up-to-date.\n    const window = ReactEditor.getWindow(editor)\n    const domSelection = window.getSelection()\n    if (!targetRange && domSelection) {\n      nativeTargetRange = domSelection\n      targetRange = ReactEditor.toSlateRange(editor, domSelection, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    targetRange = targetRange ?? editor.selection\n    if (!targetRange) {\n      return\n    }\n\n    // By default, the input manager tries to store text diffs so that we can\n    // defer flushing them at a later point in time. We don't want to flush\n    // for every input event as this can be expensive. However, there are some\n    // scenarios where we cannot safely store the text diff and must instead\n    // schedule an action to let Slate normalize the editor state.\n    let canStoreDiff = true\n\n    if (type.startsWith('delete')) {\n      if (Range.isExpanded(targetRange)) {\n        const [start, end] = Range.edges(targetRange)\n        const leaf = Node.leaf(editor, start.path)\n\n        if (leaf.text.length === start.offset && end.offset === 0) {\n          const next = Editor.next(editor, {\n            at: start.path,\n            match: Text.isText,\n          })\n          if (next && Path.equals(next[1], end.path)) {\n            targetRange = { anchor: end, focus: end }\n          }\n        }\n      }\n\n      const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n      const [start, end] = Range.edges(targetRange)\n      const [leaf, path] = Editor.leaf(editor, start.path)\n\n      const diff = {\n        text: '',\n        start: start.offset,\n        end: end.offset,\n      }\n      const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n      const relevantPendingDiffs = pendingDiffs?.find(change =>\n        Path.equals(change.path, path)\n      )\n      const diffs = relevantPendingDiffs\n        ? [relevantPendingDiffs.diff, diff]\n        : [diff]\n      const text = applyStringDiff(leaf.text, ...diffs)\n\n      if (text.length === 0) {\n        // Text leaf will be removed, so we need to schedule an\n        // action to remove it so that Slate can normalize instead\n        // of storing as a diff\n        canStoreDiff = false\n      }\n\n      if (Range.isExpanded(targetRange)) {\n        if (\n          canStoreDiff &&\n          Path.equals(targetRange.anchor.path, targetRange.focus.path)\n        ) {\n          const point = { path: targetRange.anchor.path, offset: start.offset }\n          const range = Editor.range(editor, point, point)\n          handleUserSelect(range)\n\n          return storeDiff(targetRange.anchor.path, {\n            text: '',\n            end: end.offset,\n            start: start.offset,\n          })\n        }\n\n        return scheduleAction(\n          () => Editor.deleteFragment(editor, { direction }),\n          { at: targetRange }\n        )\n      }\n    }\n\n    switch (type) {\n      case 'deleteByComposition':\n      case 'deleteByCut':\n      case 'deleteByDrag': {\n        return scheduleAction(() => Editor.deleteFragment(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContent':\n      case 'deleteContentForward': {\n        const { anchor } = targetRange\n        if (canStoreDiff && Range.isCollapsed(targetRange)) {\n          const targetNode = Node.leaf(editor, anchor.path)\n\n          if (anchor.offset < targetNode.text.length) {\n            return storeDiff(anchor.path, {\n              text: '',\n              start: anchor.offset,\n              end: anchor.offset + 1,\n            })\n          }\n        }\n\n        return scheduleAction(() => Editor.deleteForward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContentBackward': {\n        const { anchor } = targetRange\n\n        // If we have a mismatch between the native and slate selection being collapsed\n        // we are most likely deleting a zero-width placeholder and thus should perform it\n        // as an action to ensure correct behavior (mostly happens with mark placeholders)\n        const nativeCollapsed = isDOMSelection(nativeTargetRange)\n          ? nativeTargetRange.isCollapsed\n          : !!nativeTargetRange?.collapsed\n\n        if (\n          canStoreDiff &&\n          nativeCollapsed &&\n          Range.isCollapsed(targetRange) &&\n          anchor.offset > 0\n        ) {\n          return storeDiff(anchor.path, {\n            text: '',\n            start: anchor.offset - 1,\n            end: anchor.offset,\n          })\n        }\n\n        return scheduleAction(() => Editor.deleteBackward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteEntireSoftLine': {\n        return scheduleAction(\n          () => {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n          },\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'insertLineBreak': {\n        return scheduleAction(() => Editor.insertSoftBreak(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'insertParagraph': {\n        return scheduleAction(() => Editor.insertBreak(editor), {\n          at: targetRange,\n        })\n      }\n      case 'insertCompositionText':\n      case 'deleteCompositionText':\n      case 'insertFromComposition':\n      case 'insertFromDrop':\n      case 'insertFromPaste':\n      case 'insertFromYank':\n      case 'insertReplacementText':\n      case 'insertText': {\n        if (isDataTransfer(data)) {\n          return scheduleAction(() => ReactEditor.insertData(editor, data), {\n            at: targetRange,\n          })\n        }\n\n        let text = data ?? ''\n\n        // COMPAT: If we are writing inside a placeholder, the ime inserts the text inside\n        // the placeholder itself and thus includes the zero-width space inside edit events.\n        if (EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)) {\n          text = text.replace('\\uFEFF', '')\n        }\n\n        // Pastes from the Android clipboard will generate `insertText` events.\n        // If the copied text contains any newlines, Android will append an\n        // extra newline to the end of the copied text.\n        if (type === 'insertText' && /.*\\n.*\\n$/.test(text)) {\n          text = text.slice(0, -1)\n        }\n\n        // If the text includes a newline, split it at newlines and paste each component\n        // string, with soft breaks in between each.\n        if (text.includes('\\n')) {\n          return scheduleAction(\n            () => {\n              const parts = text.split('\\n')\n              parts.forEach((line, i) => {\n                if (line) {\n                  Editor.insertText(editor, line)\n                }\n                if (i !== parts.length - 1) {\n                  Editor.insertSoftBreak(editor)\n                }\n              })\n            },\n            {\n              at: targetRange,\n            }\n          )\n        }\n\n        if (Path.equals(targetRange.anchor.path, targetRange.focus.path)) {\n          const [start, end] = Range.edges(targetRange)\n\n          const diff = {\n            start: start.offset,\n            end: end.offset,\n            text,\n          }\n\n          // COMPAT: Swiftkey has a weird bug where the target range of the 2nd word\n          // inserted after a mark placeholder is inserted with an anchor offset off by 1.\n          // So writing 'some text' will result in 'some ttext'. Luckily all 'normal' insert\n          // text events are fired with the correct target ranges, only the final 'insertComposition'\n          // isn't, so we can adjust the target range start offset if we are confident this is the\n          // swiftkey insert causing the issue.\n          if (text && insertPositionHint && type === 'insertCompositionText') {\n            const hintPosition =\n              insertPositionHint.start + insertPositionHint.text.search(/\\S|$/)\n            const diffPosition = diff.start + diff.text.search(/\\S|$/)\n\n            if (\n              diffPosition === hintPosition + 1 &&\n              diff.end ===\n                insertPositionHint.start + insertPositionHint.text.length\n            ) {\n              debug('adjusting swiftKey insert position using hint')\n              diff.start -= 1\n              insertPositionHint = null\n              scheduleFlush()\n            } else {\n              insertPositionHint = false\n            }\n          } else if (type === 'insertText') {\n            if (insertPositionHint === null) {\n              insertPositionHint = diff\n            } else if (\n              insertPositionHint &&\n              Range.isCollapsed(targetRange) &&\n              insertPositionHint.end + insertPositionHint.text.length ===\n                start.offset\n            ) {\n              insertPositionHint = {\n                ...insertPositionHint,\n                text: insertPositionHint.text + text,\n              }\n            } else {\n              insertPositionHint = false\n            }\n          } else {\n            insertPositionHint = false\n          }\n\n          if (canStoreDiff) {\n            storeDiff(start.path, diff)\n            return\n          }\n        }\n\n        return scheduleAction(() => Editor.insertText(editor, text), {\n          at: targetRange,\n        })\n      }\n    }\n  }\n\n  const hasPendingAction = () => {\n    return !!EDITOR_TO_PENDING_ACTION.get(editor)\n  }\n\n  const hasPendingDiffs = () => {\n    return !!EDITOR_TO_PENDING_DIFFS.get(editor)?.length\n  }\n\n  const hasPendingChanges = () => {\n    return hasPendingAction() || hasPendingDiffs()\n  }\n\n  const isFlushing = () => {\n    return flushing\n  }\n\n  const handleUserSelect = (range: Range | null) => {\n    EDITOR_TO_PENDING_SELECTION.set(editor, range)\n\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { selection } = editor\n    if (!range) {\n      return\n    }\n\n    const pathChanged =\n      !selection || !Path.equals(selection.anchor.path, range.anchor.path)\n    const parentPathChanged =\n      !selection ||\n      !Path.equals(\n        selection.anchor.path.slice(0, -1),\n        range.anchor.path.slice(0, -1)\n      )\n\n    if ((pathChanged && insertPositionHint) || parentPathChanged) {\n      insertPositionHint = false\n    }\n\n    if (pathChanged || hasPendingDiffs()) {\n      flushTimeoutId = setTimeout(flush, FLUSH_DELAY)\n    }\n  }\n\n  const handleInput = () => {\n    if (hasPendingAction() || !hasPendingDiffs()) {\n      debug('flush input')\n      flush()\n    }\n  }\n\n  const handleKeyDown = (_: React.KeyboardEvent) => {\n    // COMPAT: Swiftkey closes the keyboard when typing inside a empty node\n    // directly next to a non-contenteditable element (= the placeholder).\n    // The only event fired soon enough for us to allow hiding the placeholder\n    // without swiftkey picking it up is the keydown event, so we have to hide it\n    // here. See https://github.com/ianstormtaylor/slate/pull/4988#issuecomment-1201050535\n    if (!hasPendingDiffs()) {\n      updatePlaceholderVisibility(true)\n      setTimeout(updatePlaceholderVisibility)\n    }\n  }\n\n  const scheduleFlush = () => {\n    if (!hasPendingAction()) {\n      actionTimeoutId = setTimeout(flush)\n    }\n  }\n\n  const handleDomMutations = (mutations: MutationRecord[]) => {\n    if (hasPendingDiffs() || hasPendingAction()) {\n      return\n    }\n\n    if (\n      mutations.some(mutation => isTrackedMutation(editor, mutation, mutations))\n    ) {\n      // Cause a re-render to restore the dom state if we encounter tracked mutations without\n      // a corresponding pending action.\n      EDITOR_TO_FORCE_RENDER.get(editor)?.()\n    }\n  }\n\n  return {\n    flush,\n    scheduleFlush,\n\n    hasPendingDiffs,\n    hasPendingAction,\n    hasPendingChanges,\n\n    isFlushing,\n\n    handleUserSelect,\n    handleCompositionEnd,\n    handleCompositionStart,\n    handleDOMBeforeInput,\n    handleKeyDown,\n\n    handleDomMutations,\n    handleInput,\n  }\n}\n","import { useEffect, useRef } from 'react'\n\nexport function useIsMounted() {\n  const isMountedRef = useRef(false)\n\n  useEffect(() => {\n    isMountedRef.current = true\n    return () => {\n      isMountedRef.current = false\n    }\n  }, [])\n\n  return isMountedRef.current\n}\n","import { useLayoutEffect, useEffect } from 'react'\nimport { CAN_USE_DOM } from '../utils/environment'\n\n/**\n * Prevent warning on SSR by falling back to useEffect when DOM isn't available\n */\n\nexport const useIsomorphicLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect\n","import { RefObject, useEffect, useState } from 'react'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nexport function useMutationObserver(\n  node: RefObject<HTMLElement>,\n  callback: MutationCallback,\n  options: MutationObserverInit\n) {\n  const [mutationObserver] = useState(() => new MutationObserver(callback))\n\n  useIsomorphicLayoutEffect(() => {\n    // Discard mutations caused during render phase. This works due to react calling\n    // useLayoutEffect synchronously after the render phase before the next tick.\n    mutationObserver.takeRecords()\n  })\n\n  useEffect(() => {\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    mutationObserver.observe(node.current, options)\n    return () => mutationObserver.disconnect()\n  }, [mutationObserver, node, options])\n}\n","import { RefObject, useState } from 'react'\nimport { useSlateStatic } from '../use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport { EDITOR_TO_SCHEDULE_FLUSH } from '../../utils/weak-maps'\nimport {\n  createAndroidInputManager,\n  CreateAndroidInputManagerOptions,\n} from './android-input-manager'\nimport { useIsMounted } from '../use-is-mounted'\nimport { useMutationObserver } from '../use-mutation-observer'\n\ntype UseAndroidInputManagerOptions = {\n  node: RefObject<HTMLElement>\n} & Omit<\n  CreateAndroidInputManagerOptions,\n  'editor' | 'onUserInput' | 'receivedUserInput'\n>\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n}\n\nexport const useAndroidInputManager = !IS_ANDROID\n  ? () => null\n  : ({ node, ...options }: UseAndroidInputManagerOptions) => {\n      if (!IS_ANDROID) {\n        return null\n      }\n\n      const editor = useSlateStatic()\n      const isMounted = useIsMounted()\n\n      const [inputManager] = useState(() =>\n        createAndroidInputManager({\n          editor,\n          ...options,\n        })\n      )\n\n      useMutationObserver(\n        node,\n        inputManager.handleDomMutations,\n        MUTATION_OBSERVER_CONFIG\n      )\n\n      EDITOR_TO_SCHEDULE_FLUSH.set(editor, inputManager.scheduleFlush)\n      if (isMounted) {\n        inputManager.flush()\n      }\n\n      return inputManager\n    }\n","import { Range } from 'slate'\nimport { PLACEHOLDER_SYMBOL } from './weak-maps'\n\nexport const shallowCompare = (obj1: {}, obj2: {}) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every(\n    key => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]\n  )\n\nconst isDecorationFlagsEqual = (range: Range, other: Range) => {\n  const { anchor: rangeAnchor, focus: rangeFocus, ...rangeOwnProps } = range\n  const { anchor: otherAnchor, focus: otherFocus, ...otherOwnProps } = other\n\n  return (\n    range[PLACEHOLDER_SYMBOL] === other[PLACEHOLDER_SYMBOL] &&\n    shallowCompare(rangeOwnProps, otherOwnProps)\n  )\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isElementDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    if (!Range.equals(range, other) || !isDecorationFlagsEqual(range, other)) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isTextDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    // compare only offsets because paths doesn't matter for text\n    if (\n      range.anchor.offset !== other.anchor.offset ||\n      range.focus.offset !== other.focus.offset ||\n      !isDecorationFlagsEqual(range, other)\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n","import React, { forwardRef, memo, useRef, useState } from 'react'\nimport { Editor, Text, Path, Element, Node } from 'slate'\n\nimport { ReactEditor, useSlateStatic } from '..'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { IS_ANDROID } from '../utils/environment'\nimport { MARK_PLACEHOLDER_SYMBOL } from '../utils/weak-maps'\n\n/**\n * Leaf content strings.\n */\n\nconst String = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  text: Text\n}) => {\n  const { isLast, leaf, parent, text } = props\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, text)\n  const parentPath = Path.parent(path)\n  const isMarkPlaceholder = leaf[MARK_PLACEHOLDER_SYMBOL] === true\n\n  // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n  if (editor.isVoid(parent)) {\n    return <ZeroWidthString length={Node.string(parent).length} />\n  }\n\n  // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n  if (\n    leaf.text === '' &&\n    parent.children[parent.children.length - 1] === text &&\n    !editor.isInline(parent) &&\n    Editor.string(editor, parentPath) === ''\n  ) {\n    return <ZeroWidthString isLineBreak isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n  if (leaf.text === '') {\n    return <ZeroWidthString isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return <TextString isTrailing text={leaf.text} />\n  }\n\n  return <TextString text={leaf.text} />\n}\n\n/**\n * Leaf strings with text in them.\n */\nconst TextString = (props: { text: string; isTrailing?: boolean }) => {\n  const { text, isTrailing = false } = props\n  const ref = useRef<HTMLSpanElement>(null)\n  const getTextContent = () => {\n    return `${text ?? ''}${isTrailing ? '\\n' : ''}`\n  }\n  const [initialText] = useState(getTextContent)\n\n  // This is the actual text rendering boundary where we interface with the DOM\n  // The text is not rendered as part of the virtual DOM, as since we handle basic character insertions natively,\n  // updating the DOM is not a one way dataflow anymore. What we need here is not reconciliation and diffing\n  // with previous version of the virtual DOM, but rather diffing with the actual DOM element, and replace the DOM <span> content\n  // exactly if and only if its current content does not match our current virtual DOM.\n  // Otherwise the DOM TextNode would always be replaced by React as the user types, which interferes with native text features,\n  // eg makes native spellcheck opt out from checking the text node.\n\n  // useLayoutEffect: updating our span before browser paint\n  useIsomorphicLayoutEffect(() => {\n    // null coalescing text to make sure we're not outputing \"null\" as a string in the extreme case it is nullish at runtime\n    const textWithTrailing = getTextContent()\n\n    if (ref.current && ref.current.textContent !== textWithTrailing) {\n      ref.current.textContent = textWithTrailing\n    }\n\n    // intentionally not specifying dependencies, so that this effect runs on every render\n    // as this effectively replaces \"specifying the text in the virtual DOM under the <span> below\" on each render\n  })\n\n  // We intentionally render a memoized <span> that only receives the initial text content when the component is mounted.\n  // We defer to the layout effect above to update the `textContent` of the span element when needed.\n  return <MemoizedText ref={ref}>{initialText}</MemoizedText>\n}\n\nconst MemoizedText = memo(\n  forwardRef<HTMLSpanElement, { children: string }>((props, ref) => {\n    return (\n      <span data-slate-string ref={ref}>\n        {props.children}\n      </span>\n    )\n  })\n)\n\n/**\n * Leaf strings without text, render as zero-width strings.\n */\n\nexport const ZeroWidthString = (props: {\n  length?: number\n  isLineBreak?: boolean\n  isMarkPlaceholder?: boolean\n}) => {\n  const { length = 0, isLineBreak = false, isMarkPlaceholder = false } = props\n\n  const attributes = {\n    'data-slate-zero-width': isLineBreak ? 'n' : 'z',\n    'data-slate-length': length,\n  }\n\n  if (isMarkPlaceholder) {\n    attributes['data-slate-mark-placeholder'] = true\n  }\n\n  return (\n    <span {...attributes}>\n      {!IS_ANDROID || !isLineBreak ? '\\uFEFF' : null}\n      {isLineBreak ? <br /> : null}\n    </span>\n  )\n}\n\nexport default String\n","import React, {\n  useRef,\n  useCallback,\n  MutableRefObject,\n  useState,\n  useEffect,\n} from 'react'\nimport { Element, Text } from 'slate'\nimport { ResizeObserver as ResizeObserverPolyfill } from '@juggle/resize-observer'\nimport String from './string'\nimport {\n  PLACEHOLDER_SYMBOL,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport { useSlateStatic } from '../hooks/use-slate-static'\nimport { IS_WEBKIT } from '../utils/environment'\n\nfunction disconnectPlaceholderResizeObserver(\n  placeholderResizeObserver: MutableRefObject<ResizeObserver | null>,\n  releaseObserver: boolean\n) {\n  if (placeholderResizeObserver.current) {\n    placeholderResizeObserver.current.disconnect()\n    if (releaseObserver) {\n      placeholderResizeObserver.current = null\n    }\n  }\n}\n\ntype TimerId = ReturnType<typeof setTimeout> | null\n\nfunction clearTimeoutRef(timeoutRef: MutableRefObject<TimerId>) {\n  if (timeoutRef.current) {\n    clearTimeout(timeoutRef.current)\n    timeoutRef.current = null\n  }\n}\n\n/**\n * Individual leaves in a text node with unique formatting.\n */\nconst Leaf = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: Text\n}) => {\n  const {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderPlaceholder,\n    renderLeaf = (props: RenderLeafProps) => <DefaultLeaf {...props} />,\n  } = props\n\n  const editor = useSlateStatic()\n  const placeholderResizeObserver = useRef<ResizeObserver | null>(null)\n  const placeholderRef = useRef<HTMLElement | null>(null)\n  const [showPlaceholder, setShowPlaceholder] = useState(false)\n  const showPlaceholderTimeoutRef = useRef<TimerId>(null)\n\n  const callbackPlaceholderRef = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      disconnectPlaceholderResizeObserver(\n        placeholderResizeObserver,\n        placeholderEl == null\n      )\n\n      if (placeholderEl == null) {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.delete(editor)\n        leaf.onPlaceholderResize?.(null)\n      } else {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.set(editor, placeholderEl)\n\n        if (!placeholderResizeObserver.current) {\n          // Create a new observer and observe the placeholder element.\n          const ResizeObserver = window.ResizeObserver || ResizeObserverPolyfill\n          placeholderResizeObserver.current = new ResizeObserver(() => {\n            leaf.onPlaceholderResize?.(placeholderEl)\n          })\n        }\n        placeholderResizeObserver.current.observe(placeholderEl)\n        placeholderRef.current = placeholderEl\n      }\n    },\n    [placeholderRef, leaf, editor]\n  )\n\n  let children = (\n    <String isLast={isLast} leaf={leaf} parent={parent} text={text} />\n  )\n\n  const leafIsPlaceholder = leaf[PLACEHOLDER_SYMBOL]\n  useEffect(() => {\n    if (leafIsPlaceholder) {\n      if (!showPlaceholderTimeoutRef.current) {\n        // Delay the placeholder so it will not render in a selection\n        showPlaceholderTimeoutRef.current = setTimeout(() => {\n          setShowPlaceholder(true)\n          showPlaceholderTimeoutRef.current = null\n        }, 300)\n      }\n    } else {\n      clearTimeoutRef(showPlaceholderTimeoutRef)\n      setShowPlaceholder(false)\n    }\n    return () => clearTimeoutRef(showPlaceholderTimeoutRef)\n  }, [leafIsPlaceholder, setShowPlaceholder])\n\n  if (leafIsPlaceholder && showPlaceholder) {\n    const placeholderProps: RenderPlaceholderProps = {\n      children: leaf.placeholder,\n      attributes: {\n        'data-slate-placeholder': true,\n        style: {\n          position: 'absolute',\n          top: 0,\n          pointerEvents: 'none',\n          width: '100%',\n          maxWidth: '100%',\n          display: 'block',\n          opacity: '0.333',\n          userSelect: 'none',\n          textDecoration: 'none',\n          // Fixes https://github.com/udecode/plate/issues/2315\n          WebkitUserModify: IS_WEBKIT ? 'inherit' : undefined,\n        },\n        contentEditable: false,\n        ref: callbackPlaceholderRef,\n      },\n    }\n\n    children = (\n      <React.Fragment>\n        {renderPlaceholder(placeholderProps)}\n        {children}\n      </React.Fragment>\n    )\n  }\n\n  // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n  const attributes: {\n    'data-slate-leaf': true\n  } = {\n    'data-slate-leaf': true,\n  }\n\n  return renderLeaf({ attributes, children, leaf, text })\n}\n\nconst MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    Text.equals(next.leaf, prev.leaf) &&\n    next.leaf[PLACEHOLDER_SYMBOL] === prev.leaf[PLACEHOLDER_SYMBOL]\n  )\n})\n\nexport const DefaultLeaf = (props: RenderLeafProps) => {\n  const { attributes, children } = props\n  return <span {...attributes}>{children}</span>\n}\n\nexport default MemoizedLeaf\n","import React, { useCallback, useRef } from 'react'\nimport { Element, Range, Text as SlateText } from 'slate'\nimport { ReactEditor, useSlateStatic } from '..'\nimport { isTextDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport Leaf from './leaf'\n\n/**\n * Text.\n */\n\nconst Text = (props: {\n  decorations: Range[]\n  isLast: boolean\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: SlateText\n}) => {\n  const {\n    decorations,\n    isLast,\n    parent,\n    renderPlaceholder,\n    renderLeaf,\n    text,\n  } = props\n  const editor = useSlateStatic()\n  const ref = useRef<HTMLSpanElement | null>(null)\n  const leaves = SlateText.decorations(text, decorations)\n  const key = ReactEditor.findKey(editor, text)\n  const children = []\n\n  for (let i = 0; i < leaves.length; i++) {\n    const leaf = leaves[i]\n\n    children.push(\n      <Leaf\n        isLast={isLast && i === leaves.length - 1}\n        key={`${key.id}-${i}`}\n        renderPlaceholder={renderPlaceholder}\n        leaf={leaf}\n        text={text}\n        parent={parent}\n        renderLeaf={renderLeaf}\n      />\n    )\n  }\n\n  // Update element-related weak maps with the DOM element ref.\n  const callbackRef = useCallback(\n    (span: HTMLSpanElement | null) => {\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (span) {\n        KEY_TO_ELEMENT?.set(key, span)\n        NODE_TO_ELEMENT.set(text, span)\n        ELEMENT_TO_NODE.set(span, text)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(text)\n        if (ref.current) {\n          ELEMENT_TO_NODE.delete(ref.current)\n        }\n      }\n      ref.current = span\n    },\n    [ref, editor, key, text]\n  )\n  return (\n    <span data-slate-node=\"text\" ref={callbackRef}>\n      {children}\n    </span>\n  )\n}\n\nconst MemoizedText = React.memo(Text, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    isTextDecorationsEqual(next.decorations, prev.decorations)\n  )\n})\n\nexport default MemoizedText\n","import getDirection from 'direction'\nimport React, { useCallback } from 'react'\nimport { Editor, Element as SlateElement, Node, Range } from 'slate'\nimport { ReactEditor, useReadOnly, useSlateStatic } from '..'\nimport useChildren from '../hooks/use-children'\nimport { isElementDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n  NODE_TO_INDEX,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from './editable'\n\nimport Text from './text'\n\n/**\n * Element.\n */\n\nconst Element = (props: {\n  decorations: Range[]\n  element: SlateElement\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    element,\n    renderElement = (p: RenderElementProps) => <DefaultElement {...p} />,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const editor = useSlateStatic()\n  const readOnly = useReadOnly()\n  const isInline = editor.isInline(element)\n  const key = ReactEditor.findKey(editor, element)\n  const ref = useCallback(\n    (ref: HTMLElement | null) => {\n      // Update element-related weak maps with the DOM element ref.\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (ref) {\n        KEY_TO_ELEMENT?.set(key, ref)\n        NODE_TO_ELEMENT.set(element, ref)\n        ELEMENT_TO_NODE.set(ref, element)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(element)\n      }\n    },\n    [editor, key, element]\n  )\n  let children: React.ReactNode = useChildren({\n    decorations,\n    node: element,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  })\n\n  // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n  const attributes: {\n    'data-slate-node': 'element'\n    'data-slate-void'?: true\n    'data-slate-inline'?: true\n    contentEditable?: false\n    dir?: 'rtl'\n    ref: any\n  } = {\n    'data-slate-node': 'element',\n    ref,\n  }\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true\n  }\n\n  // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    const text = Node.string(element)\n    const dir = getDirection(text)\n\n    if (dir === 'rtl') {\n      attributes.dir = dir\n    }\n  }\n\n  // If it's a void node, wrap the children in extra void-specific elements.\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false\n    }\n\n    const Tag = isInline ? 'span' : 'div'\n    const [[text]] = Node.texts(element)\n\n    children = (\n      <Tag\n        data-slate-spacer\n        style={{\n          height: '0',\n          color: 'transparent',\n          outline: 'none',\n          position: 'absolute',\n        }}\n      >\n        <Text\n          renderPlaceholder={renderPlaceholder}\n          decorations={[]}\n          isLast={false}\n          parent={element}\n          text={text}\n        />\n      </Tag>\n    )\n\n    NODE_TO_INDEX.set(text, 0)\n    NODE_TO_PARENT.set(text, element)\n  }\n\n  return renderElement({ attributes, children, element })\n}\n\nconst MemoizedElement = React.memo(Element, (prev, next) => {\n  return (\n    prev.element === next.element &&\n    prev.renderElement === next.renderElement &&\n    prev.renderLeaf === next.renderLeaf &&\n    prev.renderPlaceholder === next.renderPlaceholder &&\n    isElementDecorationsEqual(prev.decorations, next.decorations) &&\n    (prev.selection === next.selection ||\n      (!!prev.selection &&\n        !!next.selection &&\n        Range.equals(prev.selection, next.selection)))\n  )\n})\n\n/**\n * The default element renderer.\n */\n\nexport const DefaultElement = (props: RenderElementProps) => {\n  const { attributes, children, element } = props\n  const editor = useSlateStatic()\n  const Tag = editor.isInline(element) ? 'span' : 'div'\n  return (\n    <Tag {...attributes} style={{ position: 'relative' }}>\n      {children}\n    </Tag>\n  )\n}\n\nexport default MemoizedElement\n","import { createContext, useContext } from 'react'\nimport { Range, NodeEntry } from 'slate'\n\n/**\n * A React context for sharing the `decorate` prop of the editable.\n */\n\nexport const DecorateContext = createContext<(entry: NodeEntry) => Range[]>(\n  () => []\n)\n\n/**\n * Get the current `decorate` prop of the editable.\n */\n\nexport const useDecorate = (): ((entry: NodeEntry) => Range[]) => {\n  return useContext(DecorateContext)\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `selected` state of an element.\n */\n\nexport const SelectedContext = createContext(false)\n\n/**\n * Get the current `selected` state of an element.\n */\n\nexport const useSelected = (): boolean => {\n  return useContext(SelectedContext)\n}\n","import React from 'react'\nimport { Ancestor, Descendant, Editor, Element, Range } from 'slate'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from '../components/editable'\n\nimport ElementComponent from '../components/element'\nimport TextComponent from '../components/text'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { NODE_TO_INDEX, NODE_TO_PARENT } from '../utils/weak-maps'\nimport { useDecorate } from './use-decorate'\nimport { SelectedContext } from './use-selected'\nimport { useSlateStatic } from './use-slate-static'\n\n/**\n * Children.\n */\n\nconst useChildren = (props: {\n  decorations: Range[]\n  node: Ancestor\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    node,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const decorate = useDecorate()\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, node)\n  const children = []\n  const isLeafBlock =\n    Element.isElement(node) &&\n    !editor.isInline(node) &&\n    Editor.hasInlines(editor, node)\n\n  for (let i = 0; i < node.children.length; i++) {\n    const p = path.concat(i)\n    const n = node.children[i] as Descendant\n    const key = ReactEditor.findKey(editor, n)\n    const range = Editor.range(editor, p)\n    const sel = selection && Range.intersection(range, selection)\n    const ds = decorate([n, p])\n\n    for (const dec of decorations) {\n      const d = Range.intersection(dec, range)\n\n      if (d) {\n        ds.push(d)\n      }\n    }\n\n    if (Element.isElement(n)) {\n      children.push(\n        <SelectedContext.Provider key={`provider-${key.id}`} value={!!sel}>\n          <ElementComponent\n            decorations={ds}\n            element={n}\n            key={key.id}\n            renderElement={renderElement}\n            renderPlaceholder={renderPlaceholder}\n            renderLeaf={renderLeaf}\n            selection={sel}\n          />\n        </SelectedContext.Provider>\n      )\n    } else {\n      children.push(\n        <TextComponent\n          decorations={ds}\n          key={key.id}\n          isLast={isLeafBlock && i === node.children.length - 1}\n          parent={node}\n          renderPlaceholder={renderPlaceholder}\n          renderLeaf={renderLeaf}\n          text={n}\n        />\n      )\n    }\n\n    NODE_TO_INDEX.set(n, i)\n    NODE_TO_PARENT.set(n, node)\n  }\n\n  return children\n}\n\nexport default useChildren\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `readOnly` state of the editor.\n */\n\nexport const ReadOnlyContext = createContext(false)\n\n/**\n * Get the current `readOnly` state of the editor.\n */\n\nexport const useReadOnly = (): boolean => {\n  return useContext(ReadOnlyContext)\n}\n","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object, in a way that re-renders the\n * context whenever changes occur.\n */\n\nexport interface SlateContextValue {\n  v: number\n  editor: ReactEditor\n}\n\nexport const SlateContext = createContext<{\n  v: number\n  editor: ReactEditor\n} | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlate = (): Editor => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  const { editor } = context\n  return editor\n}\n\nexport const useSlateWithV = () => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return context\n}\n","import { useCallback, useEffect, useRef } from 'react'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { useSlateStatic } from './use-slate-static'\n\nexport function useTrackUserInput() {\n  const editor = useSlateStatic()\n\n  const receivedUserInput = useRef<boolean>(false)\n  const animationFrameIdRef = useRef<number>(0)\n\n  const onUserInput = useCallback(() => {\n    if (receivedUserInput.current) {\n      return\n    }\n\n    receivedUserInput.current = true\n\n    const window = ReactEditor.getWindow(editor)\n    window.cancelAnimationFrame(animationFrameIdRef.current)\n\n    animationFrameIdRef.current = window.requestAnimationFrame(() => {\n      receivedUserInput.current = false\n    })\n  }, [editor])\n\n  useEffect(() => () => cancelAnimationFrame(animationFrameIdRef.current), [])\n\n  return {\n    receivedUserInput,\n    onUserInput,\n  }\n}\n","export const TRIPLE_CLICK = 3\n","import { isHotkey } from 'is-hotkey'\nimport { IS_APPLE } from './environment'\n\n/**\n * Hotkey mappings for each platform.\n */\n\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  insertSoftBreak: 'shift+enter',\n  splitBlock: 'enter',\n  undo: 'mod+z',\n}\n\nconst APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n}\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n}\n\n/**\n * Create a platform-aware hotkey checker.\n */\n\nconst create = (key: string) => {\n  const generic = HOTKEYS[key]\n  const apple = APPLE_HOTKEYS[key]\n  const windows = WINDOWS_HOTKEYS[key]\n  const isGeneric = generic && isHotkey(generic)\n  const isApple = apple && isHotkey(apple)\n  const isWindows = windows && isHotkey(windows)\n\n  return (event: KeyboardEvent) => {\n    if (isGeneric && isGeneric(event)) return true\n    if (IS_APPLE && isApple && isApple(event)) return true\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\n    return false\n  }\n}\n\n/**\n * Hotkeys.\n */\n\nexport default {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSoftBreak: create('insertSoftBreak'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo'),\n}\n","import { RefObject } from 'react'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport { isTrackedMutation } from '../../utils/dom'\n\nexport type RestoreDOMManager = {\n  registerMutations: (mutations: MutationRecord[]) => void\n  restoreDOM: () => void\n  clear: () => void\n}\n\nexport const createRestoreDomManager = (\n  editor: ReactEditor,\n  receivedUserInput: RefObject<boolean>\n): RestoreDOMManager => {\n  let bufferedMutations: MutationRecord[] = []\n\n  const clear = () => {\n    bufferedMutations = []\n  }\n\n  const registerMutations = (mutations: MutationRecord[]) => {\n    if (!receivedUserInput.current) {\n      return\n    }\n\n    const trackedMutations = mutations.filter(mutation =>\n      isTrackedMutation(editor, mutation, mutations)\n    )\n\n    bufferedMutations.push(...trackedMutations)\n  }\n\n  function restoreDOM() {\n    if (bufferedMutations.length > 0) {\n      bufferedMutations.reverse().forEach(mutation => {\n        if (mutation.type === 'characterData') {\n          // We don't want to restore the DOM for characterData mutations\n          // because this interrupts the composition.\n          return\n        }\n\n        mutation.removedNodes.forEach(node => {\n          mutation.target.insertBefore(node, mutation.nextSibling)\n        })\n\n        mutation.addedNodes.forEach(node => {\n          mutation.target.removeChild(node)\n        })\n      })\n\n      // Clear buffered mutations to ensure we don't undo them twice\n      clear()\n    }\n  }\n\n  return {\n    registerMutations,\n    restoreDOM,\n    clear,\n  }\n}\n","import React, { Component, ComponentType, ContextType, RefObject } from 'react'\nimport { EditorContext } from '../../hooks/use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport {\n  createRestoreDomManager,\n  RestoreDOMManager,\n} from './restore-dom-manager'\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n}\n\ntype RestoreDOMProps = {\n  receivedUserInput: RefObject<boolean>\n  node: RefObject<HTMLDivElement>\n}\n\n// We have to use a class component here since we rely on `getSnapshotBeforeUpdate` which has no FC equivalent\n// to run code synchronously immediately before react commits the component update to the DOM.\nclass RestoreDOMComponent extends Component<RestoreDOMProps> {\n  static contextType = EditorContext\n  context: ContextType<typeof EditorContext> = null\n\n  private manager: RestoreDOMManager | null = null\n  private mutationObserver: MutationObserver | null = null\n\n  observe() {\n    const { node } = this.props\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    this.mutationObserver?.observe(node.current, MUTATION_OBSERVER_CONFIG)\n  }\n\n  componentDidMount() {\n    const { receivedUserInput } = this.props\n    const editor = this.context!\n\n    this.manager = createRestoreDomManager(editor, receivedUserInput)\n    this.mutationObserver = new MutationObserver(this.manager.registerMutations)\n\n    this.observe()\n  }\n\n  getSnapshotBeforeUpdate() {\n    const pendingMutations = this.mutationObserver?.takeRecords()\n    if (pendingMutations?.length) {\n      this.manager?.registerMutations(pendingMutations)\n    }\n\n    this.mutationObserver?.disconnect()\n    this.manager?.restoreDOM()\n\n    return null\n  }\n\n  componentDidUpdate() {\n    this.manager?.clear()\n    this.observe()\n  }\n\n  componentWillUnmount() {\n    this.mutationObserver?.disconnect()\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const RestoreDOM: ComponentType<RestoreDOMProps> = IS_ANDROID\n  ? RestoreDOMComponent\n  : ({ children }) => <>{children}</>\n","import getDirection from 'direction'\nimport debounce from 'lodash/debounce'\nimport throttle from 'lodash/throttle'\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {\n  Editor,\n  Element,\n  Node,\n  NodeEntry,\n  Path,\n  Range,\n  Text,\n  Transforms,\n} from 'slate'\nimport { useAndroidInputManager } from '../hooks/android-input-manager/use-android-input-manager'\nimport useChildren from '../hooks/use-children'\nimport { DecorateContext } from '../hooks/use-decorate'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { ReadOnlyContext } from '../hooks/use-read-only'\nimport { useSlate } from '../hooks/use-slate'\nimport { useTrackUserInput } from '../hooks/use-track-user-input'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { TRIPLE_CLICK } from '../utils/constants'\nimport {\n  DOMElement,\n  DOMRange,\n  DOMText,\n  getDefaultView,\n  isDOMElement,\n  isDOMNode,\n  isPlainTextOnlyPaste,\n} from '../utils/dom'\nimport {\n  CAN_USE_DOM,\n  HAS_BEFORE_INPUT_SUPPORT,\n  IS_ANDROID,\n  IS_CHROME,\n  IS_FIREFOX,\n  IS_FIREFOX_LEGACY,\n  IS_IOS,\n  IS_WEBKIT,\n  IS_UC_MOBILE,\n  IS_WECHATBROWSER,\n} from '../utils/environment'\nimport Hotkeys from '../utils/hotkeys'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  MARK_PLACEHOLDER_SYMBOL,\n  NODE_TO_ELEMENT,\n  PLACEHOLDER_SYMBOL,\n} from '../utils/weak-maps'\nimport { RestoreDOM } from './restore-dom/restore-dom'\nimport { AndroidInputManager } from '../hooks/android-input-manager/android-input-manager'\n\ntype DeferredOperation = () => void\n\nconst Children = (props: Parameters<typeof useChildren>[0]) => (\n  <React.Fragment>{useChildren(props)}</React.Fragment>\n)\n\n/**\n * `RenderElementProps` are passed to the `renderElement` handler.\n */\n\nexport interface RenderElementProps {\n  children: any\n  element: Element\n  attributes: {\n    'data-slate-node': 'element'\n    'data-slate-inline'?: true\n    'data-slate-void'?: true\n    dir?: 'rtl'\n    ref: any\n  }\n}\n\n/**\n * `RenderLeafProps` are passed to the `renderLeaf` handler.\n */\n\nexport interface RenderLeafProps {\n  children: any\n  leaf: Text\n  text: Text\n  attributes: {\n    'data-slate-leaf': true\n  }\n}\n\n/**\n * `EditableProps` are passed to the `<Editable>` component.\n */\n\nexport type EditableProps = {\n  decorate?: (entry: NodeEntry) => Range[]\n  onDOMBeforeInput?: (event: InputEvent) => void\n  placeholder?: string\n  readOnly?: boolean\n  role?: string\n  style?: React.CSSProperties\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  renderPlaceholder?: (props: RenderPlaceholderProps) => JSX.Element\n  scrollSelectionIntoView?: (editor: ReactEditor, domRange: DOMRange) => void\n  as?: React.ElementType\n  disableDefaultStyles?: boolean\n} & React.TextareaHTMLAttributes<HTMLDivElement>\n\n/**\n * Editable.\n */\n\nexport const Editable = (props: EditableProps) => {\n  const defaultRenderPlaceholder = useCallback(\n    (props: RenderPlaceholderProps) => <DefaultPlaceholder {...props} />,\n    []\n  )\n  const {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    renderPlaceholder = defaultRenderPlaceholder,\n    scrollSelectionIntoView = defaultScrollSelectionIntoView,\n    style: userStyle = {},\n    as: Component = 'div',\n    disableDefaultStyles = false,\n    ...attributes\n  } = props\n  const editor = useSlate()\n  // Rerender editor when composition status changed\n  const [isComposing, setIsComposing] = useState(false)\n  const ref = useRef<HTMLDivElement | null>(null)\n  const deferredOperations = useRef<DeferredOperation[]>([])\n  const [placeholderHeight, setPlaceholderHeight] = useState<\n    number | undefined\n  >()\n\n  const { onUserInput, receivedUserInput } = useTrackUserInput()\n\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  EDITOR_TO_FORCE_RENDER.set(editor, forceRender)\n\n  // Update internal state on each render.\n  IS_READ_ONLY.set(editor, readOnly)\n\n  // Keep track of some state for the event handler logic.\n  const state = useMemo(\n    () => ({\n      isDraggingInternally: false,\n      isUpdatingSelection: false,\n      latestElement: null as DOMElement | null,\n      hasMarkPlaceholder: false,\n    }),\n    []\n  )\n\n  // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus()\n    }\n  }, [autoFocus])\n\n  /**\n   * The AndroidInputManager object has a cyclical dependency on onDOMSelectionChange\n   *\n   * It is defined as a reference to simplify hook dependencies and clarify that\n   * it needs to be initialized.\n   */\n  const androidInputManagerRef = useRef<\n    AndroidInputManager | null | undefined\n  >()\n\n  // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n  const onDOMSelectionChange = useMemo(\n    () =>\n      throttle(() => {\n        const androidInputManager = androidInputManagerRef.current\n        if (\n          (IS_ANDROID || !ReactEditor.isComposing(editor)) &&\n          (!state.isUpdatingSelection || androidInputManager?.isFlushing()) &&\n          !state.isDraggingInternally\n        ) {\n          const root = ReactEditor.findDocumentOrShadowRoot(editor)\n          const { activeElement } = root\n          const el = ReactEditor.toDOMNode(editor, editor)\n          const domSelection = root.getSelection()\n\n          if (activeElement === el) {\n            state.latestElement = activeElement\n            IS_FOCUSED.set(editor, true)\n          } else {\n            IS_FOCUSED.delete(editor)\n          }\n\n          if (!domSelection) {\n            return Transforms.deselect(editor)\n          }\n\n          const { anchorNode, focusNode } = domSelection\n\n          const anchorNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, anchorNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, anchorNode)\n\n          const focusNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, focusNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, focusNode)\n\n          if (anchorNodeSelectable && focusNodeSelectable) {\n            const range = ReactEditor.toSlateRange(editor, domSelection, {\n              exactMatch: false,\n              suppressThrow: true,\n            })\n\n            if (range) {\n              if (\n                !ReactEditor.isComposing(editor) &&\n                !androidInputManager?.hasPendingChanges() &&\n                !androidInputManager?.isFlushing()\n              ) {\n                Transforms.select(editor, range)\n              } else {\n                androidInputManager?.handleUserSelect(range)\n              }\n            }\n          }\n\n          // Deselect the editor if the dom selection is not selectable in readonly mode\n          if (readOnly && (!anchorNodeSelectable || !focusNodeSelectable)) {\n            Transforms.deselect(editor)\n          }\n        }\n      }, 100),\n    [editor, readOnly, state]\n  )\n\n  const scheduleOnDOMSelectionChange = useMemo(\n    () => debounce(onDOMSelectionChange, 0),\n    [onDOMSelectionChange]\n  )\n\n  androidInputManagerRef.current = useAndroidInputManager({\n    node: ref,\n    onDOMSelectionChange,\n    scheduleOnDOMSelectionChange,\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    // Update element-related weak maps with the DOM element ref.\n    let window\n    if (ref.current && (window = getDefaultView(ref.current))) {\n      EDITOR_TO_WINDOW.set(editor, window)\n      EDITOR_TO_ELEMENT.set(editor, ref.current)\n      NODE_TO_ELEMENT.set(editor, ref.current)\n      ELEMENT_TO_NODE.set(ref.current, editor)\n    } else {\n      NODE_TO_ELEMENT.delete(editor)\n    }\n\n    // Make sure the DOM selection state is in sync.\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (\n      !domSelection ||\n      !ReactEditor.isFocused(editor) ||\n      androidInputManagerRef.current?.hasPendingAction()\n    ) {\n      return\n    }\n\n    const setDomSelection = (forceChange?: boolean) => {\n      const hasDomSelection = domSelection.type !== 'None'\n\n      // If the DOM selection is properly unset, we're done.\n      if (!selection && !hasDomSelection) {\n        return\n      }\n\n      // Get anchorNode and focusNode\n      const focusNode = domSelection.focusNode\n      let anchorNode\n\n      // COMPAT: In firefox the normal seletion way does not work\n      // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n      if (IS_FIREFOX && domSelection.rangeCount > 1) {\n        const firstRange = domSelection.getRangeAt(0)\n        const lastRange = domSelection.getRangeAt(domSelection.rangeCount - 1)\n\n        // Right to left\n        if (firstRange.startContainer === focusNode) {\n          anchorNode = lastRange.endContainer\n        } else {\n          // Left to right\n          anchorNode = firstRange.startContainer\n        }\n      } else {\n        anchorNode = domSelection.anchorNode\n      }\n\n      // verify that the dom selection is in the editor\n      const editorElement = EDITOR_TO_ELEMENT.get(editor)!\n      let hasDomSelectionInEditor = false\n      if (\n        editorElement.contains(anchorNode) &&\n        editorElement.contains(focusNode)\n      ) {\n        hasDomSelectionInEditor = true\n      }\n\n      // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n      if (\n        hasDomSelection &&\n        hasDomSelectionInEditor &&\n        selection &&\n        !forceChange\n      ) {\n        const slateRange = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: true,\n\n          // domSelection is not necessarily a valid Slate range\n          // (e.g. when clicking on contentEditable:false element)\n          suppressThrow: true,\n        })\n\n        if (slateRange && Range.equals(slateRange, selection)) {\n          if (!state.hasMarkPlaceholder) {\n            return\n          }\n\n          // Ensure selection is inside the mark placeholder\n          if (\n            anchorNode?.parentElement?.hasAttribute(\n              'data-slate-mark-placeholder'\n            )\n          ) {\n            return\n          }\n        }\n      }\n\n      // when <Editable/> is being controlled through external value\n      // then its children might just change - DOM responds to it on its own\n      // but Slate's value is not being updated through any operation\n      // and thus it doesn't transform selection on its own\n      if (selection && !ReactEditor.hasRange(editor, selection)) {\n        editor.selection = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: false,\n          suppressThrow: true,\n        })\n        return\n      }\n\n      // Otherwise the DOM selection is out of sync, so update it.\n      state.isUpdatingSelection = true\n\n      const newDomRange: DOMRange | null =\n        selection && ReactEditor.toDOMRange(editor, selection)\n\n      if (newDomRange) {\n        if (ReactEditor.isComposing(editor) && !IS_ANDROID) {\n          domSelection.collapseToEnd()\n        } else if (Range.isBackward(selection!)) {\n          domSelection.setBaseAndExtent(\n            newDomRange.endContainer,\n            newDomRange.endOffset,\n            newDomRange.startContainer,\n            newDomRange.startOffset\n          )\n        } else {\n          domSelection.setBaseAndExtent(\n            newDomRange.startContainer,\n            newDomRange.startOffset,\n            newDomRange.endContainer,\n            newDomRange.endOffset\n          )\n        }\n        scrollSelectionIntoView(editor, newDomRange)\n      } else {\n        domSelection.removeAllRanges()\n      }\n\n      return newDomRange\n    }\n\n    // In firefox if there is more then 1 range and we call setDomSelection we remove the ability to select more cells in a table\n    if (domSelection.rangeCount <= 1) {\n      setDomSelection()\n    }\n\n    const ensureSelection =\n      androidInputManagerRef.current?.isFlushing() === 'action'\n\n    if (!IS_ANDROID || !ensureSelection) {\n      setTimeout(() => {\n        state.isUpdatingSelection = false\n      })\n      return\n    }\n\n    let timeoutId: ReturnType<typeof setTimeout> | null = null\n    const animationFrameId = requestAnimationFrame(() => {\n      if (ensureSelection) {\n        const ensureDomSelection = (forceChange?: boolean) => {\n          try {\n            const el = ReactEditor.toDOMNode(editor, editor)\n            el.focus()\n\n            setDomSelection(forceChange)\n          } catch (e) {\n            // Ignore, dom and state might be out of sync\n          }\n        }\n\n        // Compat: Android IMEs try to force their selection by manually re-applying it even after we set it.\n        // This essentially would make setting the slate selection during an update meaningless, so we force it\n        // again here. We can't only do it in the setTimeout after the animation frame since that would cause a\n        // visible flicker.\n        ensureDomSelection()\n\n        timeoutId = setTimeout(() => {\n          // COMPAT: While setting the selection in an animation frame visually correctly sets the selection,\n          // it doesn't update GBoards spellchecker state. We have to manually trigger a selection change after\n          // the animation frame to ensure it displays the correct state.\n          ensureDomSelection(true)\n          state.isUpdatingSelection = false\n        })\n      }\n    })\n\n    return () => {\n      cancelAnimationFrame(animationFrameId)\n      if (timeoutId) {\n        clearTimeout(timeoutId)\n      }\n    }\n  })\n\n  // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n  const onDOMBeforeInput = useCallback(\n    (event: InputEvent) => {\n      onUserInput()\n\n      if (\n        !readOnly &&\n        ReactEditor.hasEditableTarget(editor, event.target) &&\n        !isDOMEventHandled(event, propsOnDOMBeforeInput)\n      ) {\n        // COMPAT: BeforeInput events aren't cancelable on android, so we have to handle them differently using the android input manager.\n        if (androidInputManagerRef.current) {\n          return androidInputManagerRef.current.handleDOMBeforeInput(event)\n        }\n\n        // Some IMEs/Chrome extensions like e.g. Grammarly set the selection immediately before\n        // triggering a `beforeinput` expecting the change to be applied to the immediately before\n        // set selection.\n        scheduleOnDOMSelectionChange.flush()\n        onDOMSelectionChange.flush()\n\n        const { selection } = editor\n        const { inputType: type } = event\n        const data = (event as any).dataTransfer || event.data || undefined\n\n        const isCompositionChange =\n          type === 'insertCompositionText' || type === 'deleteCompositionText'\n\n        // COMPAT: use composition change events as a hint to where we should insert\n        // composition text if we aren't composing to work around https://github.com/ianstormtaylor/slate/issues/5038\n        if (isCompositionChange && ReactEditor.isComposing(editor)) {\n          return\n        }\n\n        let native = false\n        if (\n          type === 'insertText' &&\n          selection &&\n          Range.isCollapsed(selection) &&\n          // Only use native character insertion for single characters a-z or space for now.\n          // Long-press events (hold a + press 4 = ä) to choose a special character otherwise\n          // causes duplicate inserts.\n          event.data &&\n          event.data.length === 1 &&\n          /[a-z ]/i.test(event.data) &&\n          // Chrome has issues correctly editing the start of nodes: https://bugs.chromium.org/p/chromium/issues/detail?id=1249405\n          // When there is an inline element, e.g. a link, and you select\n          // right after it (the start of the next node).\n          selection.anchor.offset !== 0\n        ) {\n          native = true\n\n          // Skip native if there are marks, as\n          // `insertText` will insert a node, not just text.\n          if (editor.marks) {\n            native = false\n          }\n\n          // Chrome also has issues correctly editing the end of anchor elements: https://bugs.chromium.org/p/chromium/issues/detail?id=1259100\n          // Therefore we don't allow native events to insert text at the end of anchor nodes.\n          const { anchor } = selection\n\n          const [node, offset] = ReactEditor.toDOMPoint(editor, anchor)\n          const anchorNode = node.parentElement?.closest('a')\n\n          const window = ReactEditor.getWindow(editor)\n\n          if (\n            native &&\n            anchorNode &&\n            ReactEditor.hasDOMNode(editor, anchorNode)\n          ) {\n            // Find the last text node inside the anchor.\n            const lastText = window?.document\n              .createTreeWalker(anchorNode, NodeFilter.SHOW_TEXT)\n              .lastChild() as DOMText | null\n\n            if (lastText === node && lastText.textContent?.length === offset) {\n              native = false\n            }\n          }\n\n          // Chrome has issues with the presence of tab characters inside elements with whiteSpace = 'pre'\n          // causing abnormal insert behavior: https://bugs.chromium.org/p/chromium/issues/detail?id=1219139\n          if (\n            native &&\n            node.parentElement &&\n            window?.getComputedStyle(node.parentElement)?.whiteSpace === 'pre'\n          ) {\n            const block = Editor.above(editor, {\n              at: anchor.path,\n              match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n            })\n\n            if (block && Node.string(block[0]).includes('\\t')) {\n              native = false\n            }\n          }\n        }\n\n        // COMPAT: For the deleting forward/backward input types we don't want\n        // to change the selection because it is the range that will be deleted,\n        // and those commands determine that for themselves.\n        if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n          const [targetRange] = (event as any).getTargetRanges()\n\n          if (targetRange) {\n            const range = ReactEditor.toSlateRange(editor, targetRange, {\n              exactMatch: false,\n              suppressThrow: false,\n            })\n\n            if (!selection || !Range.equals(selection, range)) {\n              native = false\n\n              const selectionRef =\n                !isCompositionChange &&\n                editor.selection &&\n                Editor.rangeRef(editor, editor.selection)\n\n              Transforms.select(editor, range)\n\n              if (selectionRef) {\n                EDITOR_TO_USER_SELECTION.set(editor, selectionRef)\n              }\n            }\n          }\n        }\n\n        // Composition change types occur while a user is composing text and can't be\n        // cancelled. Let them through and wait for the composition to end.\n        if (isCompositionChange) {\n          return\n        }\n\n        if (!native) {\n          event.preventDefault()\n        }\n\n        // COMPAT: If the selection is expanded, even if the command seems like\n        // a delete forward/backward command it should delete the selection.\n        if (\n          selection &&\n          Range.isExpanded(selection) &&\n          type.startsWith('delete')\n        ) {\n          const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n          Editor.deleteFragment(editor, { direction })\n          return\n        }\n\n        switch (type) {\n          case 'deleteByComposition':\n          case 'deleteByCut':\n          case 'deleteByDrag': {\n            Editor.deleteFragment(editor)\n            break\n          }\n\n          case 'deleteContent':\n          case 'deleteContentForward': {\n            Editor.deleteForward(editor)\n            break\n          }\n\n          case 'deleteContentBackward': {\n            Editor.deleteBackward(editor)\n            break\n          }\n\n          case 'deleteEntireSoftLine': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineForward': {\n            Editor.deleteForward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineForward': {\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteWordBackward': {\n            Editor.deleteBackward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'deleteWordForward': {\n            Editor.deleteForward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'insertLineBreak':\n            Editor.insertSoftBreak(editor)\n            break\n\n          case 'insertParagraph': {\n            Editor.insertBreak(editor)\n            break\n          }\n\n          case 'insertFromComposition':\n          case 'insertFromDrop':\n          case 'insertFromPaste':\n          case 'insertFromYank':\n          case 'insertReplacementText':\n          case 'insertText': {\n            if (type === 'insertFromComposition') {\n              // COMPAT: in Safari, `compositionend` is dispatched after the\n              // `beforeinput` for \"insertFromComposition\". But if we wait for it\n              // then we will abort because we're still composing and the selection\n              // won't be updated properly.\n              // https://www.w3.org/TR/input-events-2/\n              if (ReactEditor.isComposing(editor)) {\n                setIsComposing(false)\n                IS_COMPOSING.set(editor, false)\n              }\n            }\n\n            // use a weak comparison instead of 'instanceof' to allow\n            // programmatic access of paste events coming from external windows\n            // like cypress where cy.window does not work realibly\n            if (data?.constructor.name === 'DataTransfer') {\n              ReactEditor.insertData(editor, data)\n            } else if (typeof data === 'string') {\n              // Only insertText operations use the native functionality, for now.\n              // Potentially expand to single character deletes, as well.\n              if (native) {\n                deferredOperations.current.push(() =>\n                  Editor.insertText(editor, data)\n                )\n              } else {\n                Editor.insertText(editor, data)\n              }\n            }\n\n            break\n          }\n        }\n\n        // Restore the actual user section if nothing manually set it.\n        const toRestore = EDITOR_TO_USER_SELECTION.get(editor)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(editor)\n\n        if (\n          toRestore &&\n          (!editor.selection || !Range.equals(editor.selection, toRestore))\n        ) {\n          Transforms.select(editor, toRestore)\n        }\n      }\n    },\n    [\n      editor,\n      onDOMSelectionChange,\n      onUserInput,\n      propsOnDOMBeforeInput,\n      readOnly,\n      scheduleOnDOMSelectionChange,\n    ]\n  )\n\n  const callbackRef = useCallback(\n    node => {\n      if (node == null) {\n        onDOMSelectionChange.cancel()\n        scheduleOnDOMSelectionChange.cancel()\n\n        EDITOR_TO_ELEMENT.delete(editor)\n        NODE_TO_ELEMENT.delete(editor)\n\n        if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          ref.current.removeEventListener('beforeinput', onDOMBeforeInput)\n        }\n      } else {\n        // Attach a native DOM event handler for `beforeinput` events, because React's\n        // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n        // real `beforeinput` events sadly... (2019/11/04)\n        // https://github.com/facebook/react/issues/11211\n        if (HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          node.addEventListener('beforeinput', onDOMBeforeInput)\n        }\n      }\n\n      ref.current = node\n    },\n    [\n      onDOMSelectionChange,\n      scheduleOnDOMSelectionChange,\n      editor,\n      onDOMBeforeInput,\n    ]\n  )\n\n  // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n  useIsomorphicLayoutEffect(() => {\n    const window = ReactEditor.getWindow(editor)\n\n    window.document.addEventListener(\n      'selectionchange',\n      scheduleOnDOMSelectionChange\n    )\n\n    return () => {\n      window.document.removeEventListener(\n        'selectionchange',\n        scheduleOnDOMSelectionChange\n      )\n    }\n  }, [scheduleOnDOMSelectionChange])\n\n  const decorations = decorate([editor, []])\n\n  const showPlaceholder =\n    placeholder &&\n    editor.children.length === 1 &&\n    Array.from(Node.texts(editor)).length === 1 &&\n    Node.string(editor) === '' &&\n    !isComposing\n\n  const placeHolderResizeHandler = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      if (placeholderEl && showPlaceholder) {\n        setPlaceholderHeight(placeholderEl.getBoundingClientRect()?.height)\n      } else {\n        setPlaceholderHeight(undefined)\n      }\n    },\n    [showPlaceholder]\n  )\n\n  if (showPlaceholder) {\n    const start = Editor.start(editor, [])\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      onPlaceholderResize: placeHolderResizeHandler,\n      anchor: start,\n      focus: start,\n    })\n  }\n\n  const { marks } = editor\n  state.hasMarkPlaceholder = false\n\n  if (editor.selection && Range.isCollapsed(editor.selection) && marks) {\n    const { anchor } = editor.selection\n    const leaf = Node.leaf(editor, anchor.path)\n    const { text, ...rest } = leaf\n\n    // While marks isn't a 'complete' text, we can still use loose Text.equals\n    // here which only compares marks anyway.\n    if (!Text.equals(leaf, marks as Text, { loose: true })) {\n      state.hasMarkPlaceholder = true\n\n      const unset = Object.fromEntries(\n        Object.keys(rest).map(mark => [mark, null])\n      )\n\n      decorations.push({\n        [MARK_PLACEHOLDER_SYMBOL]: true,\n        ...unset,\n        ...marks,\n\n        anchor,\n        focus: anchor,\n      })\n    }\n  }\n\n  // Update EDITOR_TO_MARK_PLACEHOLDER_MARKS in setTimeout useEffect to ensure we don't set it\n  // before we receive the composition end event.\n  useEffect(() => {\n    setTimeout(() => {\n      const { selection } = editor\n      if (selection) {\n        const { anchor } = selection\n        const text = Node.leaf(editor, anchor.path)\n\n        // While marks isn't a 'complete' text, we can still use loose Text.equals\n        // here which only compares marks anyway.\n        if (marks && !Text.equals(text, marks as Text, { loose: true })) {\n          EDITOR_TO_PENDING_INSERTION_MARKS.set(editor, marks)\n          return\n        }\n      }\n\n      EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n    })\n  })\n\n  return (\n    <ReadOnlyContext.Provider value={readOnly}>\n      <DecorateContext.Provider value={decorate}>\n        <RestoreDOM node={ref} receivedUserInput={receivedUserInput}>\n          <Component\n            role={readOnly ? undefined : 'textbox'}\n            aria-multiline={readOnly ? undefined : true}\n            {...attributes}\n            // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n            // have to use hacks to make these replacement-based features work.\n            // For SSR situations HAS_BEFORE_INPUT_SUPPORT is false and results in prop\n            // mismatch warning app moves to browser. Pass-through consumer props when\n            // not CAN_USE_DOM (SSR) and default to falsy value\n            spellCheck={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.spellCheck\n                : false\n            }\n            autoCorrect={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCorrect\n                : 'false'\n            }\n            autoCapitalize={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCapitalize\n                : 'false'\n            }\n            data-slate-editor\n            data-slate-node=\"value\"\n            // explicitly set this\n            contentEditable={!readOnly}\n            // in some cases, a decoration needs access to the range / selection to decorate a text node,\n            // then you will select the whole text node when you select part the of text\n            // this magic zIndex=\"-1\" will fix it\n            zindex={-1}\n            suppressContentEditableWarning\n            ref={callbackRef}\n            style={{\n              ...(disableDefaultStyles\n                ? {}\n                : {\n                    // Allow positioning relative to the editable element.\n                    position: 'relative',\n                    // Preserve adjacent whitespace and new lines.\n                    whiteSpace: 'pre-wrap',\n                    // Allow words to break if they are too long.\n                    wordWrap: 'break-word',\n                    // Make the minimum height that of the placeholder.\n                    ...(placeholderHeight\n                      ? { minHeight: placeholderHeight }\n                      : {}),\n                  }),\n              // Allow for passed-in styles to override anything.\n              ...userStyle,\n            }}\n            onBeforeInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                // fall back to React's leaky polyfill instead just for it. It\n                // only works for the `insertText` input type.\n                if (\n                  !HAS_BEFORE_INPUT_SUPPORT &&\n                  !readOnly &&\n                  !isEventHandled(event, attributes.onBeforeInput) &&\n                  ReactEditor.hasSelectableTarget(editor, event.target)\n                ) {\n                  event.preventDefault()\n                  if (!ReactEditor.isComposing(editor)) {\n                    const text = (event as any).data as string\n                    Editor.insertText(editor, text)\n                  }\n                }\n              },\n              [attributes.onBeforeInput, editor, readOnly]\n            )}\n            onInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                if (isEventHandled(event, attributes.onInput)) {\n                  return\n                }\n\n                if (androidInputManagerRef.current) {\n                  androidInputManagerRef.current.handleInput()\n                  return\n                }\n\n                // Flush native operations, as native events will have propogated\n                // and we can correctly compare DOM text values in components\n                // to stop rendering, so that browser functions like autocorrect\n                // and spellcheck work as expected.\n                for (const op of deferredOperations.current) {\n                  op()\n                }\n                deferredOperations.current = []\n              },\n              [attributes.onInput]\n            )}\n            onBlur={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  readOnly ||\n                  state.isUpdatingSelection ||\n                  !ReactEditor.hasSelectableTarget(editor, event.target) ||\n                  isEventHandled(event, attributes.onBlur)\n                ) {\n                  return\n                }\n\n                // COMPAT: If the current `activeElement` is still the previous\n                // one, this is due to the window being blurred when the tab\n                // itself becomes unfocused, so we want to abort early to allow to\n                // editor to stay focused when the tab becomes focused again.\n                const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                if (state.latestElement === root.activeElement) {\n                  return\n                }\n\n                const { relatedTarget } = event\n                const el = ReactEditor.toDOMNode(editor, editor)\n\n                // COMPAT: The event should be ignored if the focus is returning\n                // to the editor from an embedded editable element (eg. an <input>\n                // element inside a void node).\n                if (relatedTarget === el) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving from\n                // the editor to inside a void node's spacer element.\n                if (\n                  isDOMElement(relatedTarget) &&\n                  relatedTarget.hasAttribute('data-slate-spacer')\n                ) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving to a\n                // non- editable section of an element that isn't a void node (eg.\n                // a list item of the check list example).\n                if (\n                  relatedTarget != null &&\n                  isDOMNode(relatedTarget) &&\n                  ReactEditor.hasDOMNode(editor, relatedTarget)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, relatedTarget)\n\n                  if (Element.isElement(node) && !editor.isVoid(node)) {\n                    return\n                  }\n                }\n\n                // COMPAT: Safari doesn't always remove the selection even if the content-\n                // editable element no longer has focus. Refer to:\n                // https://stackoverflow.com/questions/12353247/force-contenteditable-div-to-stop-accepting-input-after-it-loses-focus-under-web\n                if (IS_WEBKIT) {\n                  const domSelection = root.getSelection()\n                  domSelection?.removeAllRanges()\n                }\n\n                IS_FOCUSED.delete(editor)\n              },\n              [\n                readOnly,\n                state.isUpdatingSelection,\n                state.latestElement,\n                editor,\n                attributes.onBlur,\n              ]\n            )}\n            onClick={useCallback(\n              (event: React.MouseEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onClick) &&\n                  isDOMNode(event.target)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n\n                  // At this time, the Slate document may be arbitrarily different,\n                  // because onClick handlers can change the document before we get here.\n                  // Therefore we must check that this path actually exists,\n                  // and that it still refers to the same node.\n                  if (\n                    !Editor.hasPath(editor, path) ||\n                    Node.get(editor, path) !== node\n                  ) {\n                    return\n                  }\n\n                  if (event.detail === TRIPLE_CLICK && path.length >= 1) {\n                    let blockPath = path\n                    if (\n                      !(Element.isElement(node) && Editor.isBlock(editor, node))\n                    ) {\n                      const block = Editor.above(editor, {\n                        match: n =>\n                          Element.isElement(n) && Editor.isBlock(editor, n),\n                        at: path,\n                      })\n\n                      blockPath = block?.[1] ?? path.slice(0, 1)\n                    }\n\n                    const range = Editor.range(editor, blockPath)\n                    Transforms.select(editor, range)\n                    return\n                  }\n\n                  if (readOnly) {\n                    return\n                  }\n\n                  const start = Editor.start(editor, path)\n                  const end = Editor.end(editor, path)\n                  const startVoid = Editor.void(editor, { at: start })\n                  const endVoid = Editor.void(editor, { at: end })\n\n                  if (\n                    startVoid &&\n                    endVoid &&\n                    Path.equals(startVoid[1], endVoid[1])\n                  ) {\n                    const range = Editor.range(editor, start)\n                    Transforms.select(editor, range)\n                  }\n                }\n              },\n              [editor, attributes.onClick, readOnly]\n            )}\n            onCompositionEnd={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  if (ReactEditor.isComposing(editor)) {\n                    setIsComposing(false)\n                    IS_COMPOSING.set(editor, false)\n                  }\n\n                  androidInputManagerRef.current?.handleCompositionEnd(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionEnd) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  // COMPAT: In Chrome, `beforeinput` events for compositions\n                  // aren't correct and never fire the \"insertFromComposition\"\n                  // type that we need. So instead, insert whenever a composition\n                  // ends since it will already have been committed to the DOM.\n                  if (\n                    !IS_WEBKIT &&\n                    !IS_FIREFOX_LEGACY &&\n                    !IS_IOS &&\n                    !IS_WECHATBROWSER &&\n                    !IS_UC_MOBILE &&\n                    event.data\n                  ) {\n                    const placeholderMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(\n                      editor\n                    )\n                    EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n\n                    // Ensure we insert text with the marks the user was actually seeing\n                    if (placeholderMarks !== undefined) {\n                      EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n                      editor.marks = placeholderMarks\n                    }\n\n                    Editor.insertText(editor, event.data)\n\n                    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n                    EDITOR_TO_USER_MARKS.delete(editor)\n                    if (userMarks !== undefined) {\n                      editor.marks = userMarks\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionEnd, editor]\n            )}\n            onCompositionUpdate={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCompositionUpdate)\n                ) {\n                  if (!ReactEditor.isComposing(editor)) {\n                    setIsComposing(true)\n                    IS_COMPOSING.set(editor, true)\n                  }\n                }\n              },\n              [attributes.onCompositionUpdate, editor]\n            )}\n            onCompositionStart={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  androidInputManagerRef.current?.handleCompositionStart(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionStart) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  setIsComposing(true)\n\n                  const { selection } = editor\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                      return\n                    }\n                    const inline = Editor.above(editor, {\n                      match: n =>\n                        Element.isElement(n) && Editor.isInline(editor, n),\n                      mode: 'highest',\n                    })\n                    if (inline) {\n                      const [, inlinePath] = inline\n                      if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n                        const point = Editor.after(editor, inlinePath)!\n                        Transforms.setSelection(editor, {\n                          anchor: point,\n                          focus: point,\n                        })\n                      }\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionStart, editor]\n            )}\n            onCopy={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCopy) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'copy'\n                  )\n                }\n              },\n              [attributes.onCopy, editor]\n            )}\n            onCut={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCut) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'cut'\n                  )\n                  const { selection } = editor\n\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                    } else {\n                      const node = Node.parent(editor, selection.anchor.path)\n                      if (Editor.isVoid(editor, node)) {\n                        Transforms.delete(editor)\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onCut]\n            )}\n            onDragOver={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragOver)\n                ) {\n                  // Only when the target is void, call `preventDefault` to signal\n                  // that drops are allowed. Editable content is droppable by\n                  // default, and calling `preventDefault` hides the cursor.\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n\n                  if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n                    event.preventDefault()\n                  }\n                }\n              },\n              [attributes.onDragOver, editor]\n            )}\n            onDragStart={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragStart)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n                  const voidMatch =\n                    (Element.isElement(node) && Editor.isVoid(editor, node)) ||\n                    Editor.void(editor, { at: path, voids: true })\n\n                  // If starting a drag on a void node, make sure it is selected\n                  // so that it shows up in the selection's fragment.\n                  if (voidMatch) {\n                    const range = Editor.range(editor, path)\n                    Transforms.select(editor, range)\n                  }\n\n                  state.isDraggingInternally = true\n\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.dataTransfer,\n                    'drag'\n                  )\n                }\n              },\n              [readOnly, editor, attributes.onDragStart, state]\n            )}\n            onDrop={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDrop)\n                ) {\n                  event.preventDefault()\n\n                  // Keep a reference to the dragged range before updating selection\n                  const draggedRange = editor.selection\n\n                  // Find the range where the drop happened\n                  const range = ReactEditor.findEventRange(editor, event)\n                  const data = event.dataTransfer\n\n                  Transforms.select(editor, range)\n\n                  if (state.isDraggingInternally) {\n                    if (\n                      draggedRange &&\n                      !Range.equals(draggedRange, range) &&\n                      !Editor.void(editor, { at: range, voids: true })\n                    ) {\n                      Transforms.delete(editor, {\n                        at: draggedRange,\n                      })\n                    }\n                  }\n\n                  ReactEditor.insertData(editor, data)\n\n                  // When dragging from another source into the editor, it's possible\n                  // that the current editor does not have focus.\n                  if (!ReactEditor.isFocused(editor)) {\n                    ReactEditor.focus(editor)\n                  }\n                }\n\n                state.isDraggingInternally = false\n              },\n              [readOnly, editor, attributes.onDrop, state]\n            )}\n            onDragEnd={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  state.isDraggingInternally &&\n                  attributes.onDragEnd &&\n                  ReactEditor.hasTarget(editor, event.target)\n                ) {\n                  attributes.onDragEnd(event)\n                }\n\n                // When dropping on a different droppable element than the current editor,\n                // `onDrop` is not called. So we need to clean up in `onDragEnd` instead.\n                // Note: `onDragEnd` is only called when `onDrop` is not called\n                state.isDraggingInternally = false\n              },\n              [readOnly, state, attributes, editor]\n            )}\n            onFocus={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  !state.isUpdatingSelection &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onFocus)\n                ) {\n                  const el = ReactEditor.toDOMNode(editor, editor)\n                  const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                  state.latestElement = root.activeElement\n\n                  // COMPAT: If the editor has nested editable elements, the focus\n                  // can go to them. In Firefox, this must be prevented because it\n                  // results in issues with keyboard navigation. (2017/03/30)\n                  if (IS_FIREFOX && event.target !== el) {\n                    el.focus()\n                    return\n                  }\n\n                  IS_FOCUSED.set(editor, true)\n                }\n              },\n              [readOnly, state, editor, attributes.onFocus]\n            )}\n            onKeyDown={useCallback(\n              (event: React.KeyboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target)\n                ) {\n                  androidInputManagerRef.current?.handleKeyDown(event)\n\n                  const { nativeEvent } = event\n\n                  // COMPAT: The composition end event isn't fired reliably in all browsers,\n                  // so we sometimes might end up stuck in a composition state even though we\n                  // aren't composing any more.\n                  if (\n                    ReactEditor.isComposing(editor) &&\n                    nativeEvent.isComposing === false\n                  ) {\n                    IS_COMPOSING.set(editor, false)\n                    setIsComposing(false)\n                  }\n\n                  if (\n                    isEventHandled(event, attributes.onKeyDown) ||\n                    ReactEditor.isComposing(editor)\n                  ) {\n                    return\n                  }\n\n                  const { selection } = editor\n                  const element =\n                    editor.children[\n                      selection !== null ? selection.focus.path[0] : 0\n                    ]\n                  const isRTL = getDirection(Node.string(element)) === 'rtl'\n\n                  // COMPAT: Since we prevent the default behavior on\n                  // `beforeinput` events, the browser doesn't think there's ever\n                  // any history stack to undo or redo, so we have to manage these\n                  // hotkeys ourselves. (2019/11/06)\n                  if (Hotkeys.isRedo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.redo === 'function') {\n                      maybeHistoryEditor.redo()\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isUndo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.undo === 'function') {\n                      maybeHistoryEditor.undo()\n                    }\n\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't handle the selection updates\n                  // properly. In Chrome, the selection isn't properly extended.\n                  // And in Firefox, the selection isn't properly collapsed.\n                  // (2017/10/17)\n                  if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', reverse: true })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line' })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, {\n                      unit: 'line',\n                      edge: 'focus',\n                      reverse: true,\n                    })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', edge: 'focus' })\n                    return\n                  }\n\n                  // COMPAT: If a void node is selected, or a zero-width text node\n                  // adjacent to an inline is selected, we need to handle these\n                  // hotkeys manually because browsers won't be able to skip over\n                  // the void node with the zero-width space not being an empty\n                  // string.\n                  if (Hotkeys.isMoveBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: !isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'start' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'end' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: !isRTL })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: isRTL })\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to guessing at the input intention for hotkeys.\n                  // COMPAT: In iOS, some of these hotkeys are handled in the\n                  if (!HAS_BEFORE_INPUT_SUPPORT) {\n                    // We don't have a core behavior for these, but they change the\n                    // DOM if we don't prevent them, so we have to.\n                    if (\n                      Hotkeys.isBold(nativeEvent) ||\n                      Hotkeys.isItalic(nativeEvent) ||\n                      Hotkeys.isTransposeCharacter(nativeEvent)\n                    ) {\n                      event.preventDefault()\n                      return\n                    }\n\n                    if (Hotkeys.isSoftBreak(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertSoftBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isSplitBlock(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n                  } else {\n                    if (IS_CHROME || IS_WEBKIT) {\n                      // COMPAT: Chrome and Safari support `beforeinput` event but do not fire\n                      // an event when deleting backwards in a selected void inline node\n                      if (\n                        selection &&\n                        (Hotkeys.isDeleteBackward(nativeEvent) ||\n                          Hotkeys.isDeleteForward(nativeEvent)) &&\n                        Range.isCollapsed(selection)\n                      ) {\n                        const currentNode = Node.parent(\n                          editor,\n                          selection.anchor.path\n                        )\n\n                        if (\n                          Element.isElement(currentNode) &&\n                          Editor.isVoid(editor, currentNode) &&\n                          (Editor.isInline(editor, currentNode) ||\n                            Editor.isBlock(editor, currentNode))\n                        ) {\n                          event.preventDefault()\n                          Editor.deleteBackward(editor, { unit: 'block' })\n\n                          return\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onKeyDown]\n            )}\n            onPaste={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onPaste)\n                ) {\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to React's `onPaste` here instead.\n                  // COMPAT: Firefox, Chrome and Safari don't emit `beforeinput` events\n                  // when \"paste without formatting\" is used, so fallback. (2020/02/20)\n                  // COMPAT: Safari InputEvents generated by pasting won't include\n                  // application/x-slate-fragment items, so use the\n                  // ClipboardEvent here. (2023/03/15)\n                  if (\n                    !HAS_BEFORE_INPUT_SUPPORT ||\n                    isPlainTextOnlyPaste(event.nativeEvent) ||\n                    IS_WEBKIT\n                  ) {\n                    event.preventDefault()\n                    ReactEditor.insertData(editor, event.clipboardData)\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onPaste]\n            )}\n          >\n            <Children\n              decorations={decorations}\n              node={editor}\n              renderElement={renderElement}\n              renderPlaceholder={renderPlaceholder}\n              renderLeaf={renderLeaf}\n              selection={editor.selection}\n            />\n          </Component>\n        </RestoreDOM>\n      </DecorateContext.Provider>\n    </ReadOnlyContext.Provider>\n  )\n}\n\n/**\n * The props that get passed to renderPlaceholder\n */\nexport type RenderPlaceholderProps = {\n  children: any\n  attributes: {\n    'data-slate-placeholder': boolean\n    dir?: 'rtl'\n    contentEditable: boolean\n    ref: React.RefCallback<any>\n    style: React.CSSProperties\n  }\n}\n\n/**\n * The default placeholder element\n */\n\nexport const DefaultPlaceholder = ({\n  attributes,\n  children,\n}: RenderPlaceholderProps) => (\n  // COMPAT: Artificially add a line-break to the end on the placeholder element\n  // to prevent Android IMEs to pick up its content in autocorrect and to auto-capitalize the first letter\n  <span {...attributes}>\n    {children}\n    {IS_ANDROID && <br />}\n  </span>\n)\n\n/**\n * A default memoized decorate function.\n */\n\nexport const defaultDecorate: (entry: NodeEntry) => Range[] = () => []\n\n/**\n * A default implement to scroll dom range into view.\n */\n\nconst defaultScrollSelectionIntoView = (\n  editor: ReactEditor,\n  domRange: DOMRange\n) => {\n  // This was affecting the selection of multiple blocks and dragging behavior,\n  // so enabled only if the selection has been collapsed.\n  if (\n    domRange.getBoundingClientRect &&\n    (!editor.selection ||\n      (editor.selection && Range.isCollapsed(editor.selection)))\n  ) {\n    const leafEl = domRange.startContainer.parentElement!\n    leafEl.getBoundingClientRect = domRange.getBoundingClientRect.bind(domRange)\n    scrollIntoView(leafEl, {\n      scrollMode: 'if-needed',\n    })\n\n    // @ts-expect-error an unorthodox delete D:\n    delete leafEl.getBoundingClientRect\n  }\n}\n\n/**\n * Check if an event is overrided by a handler.\n */\n\nexport const isEventHandled = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType,\n  handler?: (event: EventType) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.isDefaultPrevented() || event.isPropagationStopped()\n}\n\n/**\n * Check if the event's target is an input element\n */\nexport const isDOMEventTargetInput = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType\n) => {\n  return (\n    isDOMNode(event.target) &&\n    (event.target instanceof HTMLInputElement ||\n      event.target instanceof HTMLTextAreaElement)\n  )\n}\n\n/**\n * Check if a DOM event is overrided by a handler.\n */\n\nexport const isDOMEventHandled = <E extends Event>(\n  event: E,\n  handler?: (event: E) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.defaultPrevented\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `focused` state of the editor.\n */\n\nexport const FocusedContext = createContext(false)\n\n/**\n * Get the current `focused` state of the editor.\n */\n\nexport const useFocused = (): boolean => {\n  return useContext(FocusedContext)\n}\n","import {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react'\nimport { Editor } from 'slate'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nfunction isError(error: any): error is Error {\n  return error instanceof Error\n}\n\ntype EditorChangeHandler = (editor: Editor) => void\n/**\n * A React context for sharing the editor selector context in a way to control rerenders\n */\n\nexport const SlateSelectorContext = createContext<{\n  getSlate: () => Editor\n  addEventListener: (callback: EditorChangeHandler) => () => void\n}>({} as any)\n\nconst refEquality = (a: any, b: any) => a === b\n\n/**\n * use redux style selectors to prevent rerendering on every keystroke.\n * Bear in mind rerendering can only prevented if the returned value is a value type or for reference types (e.g. objects and arrays) add a custom equality function.\n *\n * Example:\n * ```\n *  const isSelectionActive = useSlateSelector(editor => Boolean(editor.selection));\n * ```\n */\nexport function useSlateSelector<T>(\n  selector: (editor: Editor) => T,\n  equalityFn: (a: T, b: T) => boolean = refEquality\n) {\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  const context = useContext(SlateSelectorContext)\n  if (!context) {\n    throw new Error(\n      `The \\`useSlateSelector\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n  const { getSlate, addEventListener } = context\n\n  const latestSubscriptionCallbackError = useRef<Error | undefined>()\n  const latestSelector = useRef<(editor: Editor) => T>(() => null as any)\n  const latestSelectedState = useRef<T>((null as any) as T)\n  let selectedState: T\n\n  try {\n    if (\n      selector !== latestSelector.current ||\n      latestSubscriptionCallbackError.current\n    ) {\n      selectedState = selector(getSlate())\n    } else {\n      selectedState = latestSelectedState.current\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current && isError(err)) {\n      err.message += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\n`\n    }\n\n    throw err\n  }\n  useIsomorphicLayoutEffect(() => {\n    latestSelector.current = selector\n    latestSelectedState.current = selectedState\n    latestSubscriptionCallbackError.current = undefined\n  })\n\n  useIsomorphicLayoutEffect(\n    () => {\n      function checkForUpdates() {\n        try {\n          const newSelectedState = latestSelector.current(getSlate())\n\n          if (equalityFn(newSelectedState, latestSelectedState.current)) {\n            return\n          }\n\n          latestSelectedState.current = newSelectedState\n        } catch (err) {\n          // we ignore all errors here, since when the component\n          // is re-rendered, the selectors are called again, and\n          // will throw again, if neither props nor store state\n          // changed\n          latestSubscriptionCallbackError.current = err\n        }\n\n        forceRender()\n      }\n\n      const unsubscribe = addEventListener(checkForUpdates)\n\n      checkForUpdates()\n\n      return () => unsubscribe()\n    },\n    // don't rerender on equalityFn change since we want to be able to define it inline\n    [addEventListener, getSlate]\n  )\n\n  return selectedState\n}\n\n/**\n * Create selector context with editor updating on every editor change\n */\nexport function useSelectorContext(editor: Editor) {\n  const eventListeners = useRef<EditorChangeHandler[]>([]).current\n  const slateRef = useRef<{\n    editor: Editor\n  }>({\n    editor,\n  }).current\n  const onChange = useCallback(\n    (editor: Editor) => {\n      slateRef.editor = editor\n      eventListeners.forEach((listener: EditorChangeHandler) =>\n        listener(editor)\n      )\n    },\n    [eventListeners, slateRef]\n  )\n\n  const selectorContext = useMemo(() => {\n    return {\n      getSlate: () => slateRef.editor,\n      addEventListener: (callback: EditorChangeHandler) => {\n        eventListeners.push(callback)\n        return () => {\n          eventListeners.splice(eventListeners.indexOf(callback), 1)\n        }\n      },\n    }\n  }, [eventListeners, slateRef])\n  return { selectorContext, onChange }\n}\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { Descendant, Editor, Node, Scrubber } from 'slate'\nimport { FocusedContext } from '../hooks/use-focused'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { SlateContext, SlateContextValue } from '../hooks/use-slate'\nimport {\n  useSelectorContext,\n  SlateSelectorContext,\n} from '../hooks/use-slate-selector'\nimport { EditorContext } from '../hooks/use-slate-static'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\nimport { EDITOR_TO_ON_CHANGE } from '../utils/weak-maps'\n\n/**\n * A wrapper around the provider to handle `onChange` events, because the editor\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\n */\n\nexport const Slate = (props: {\n  editor: ReactEditor\n  initialValue: Descendant[]\n  children: React.ReactNode\n  onChange?: (value: Descendant[]) => void\n}) => {\n  const { editor, children, onChange, initialValue, ...rest } = props\n  const unmountRef = useRef(false)\n\n  const [context, setContext] = React.useState<SlateContextValue>(() => {\n    if (!Node.isNodeList(initialValue)) {\n      throw new Error(\n        `[Slate] initialValue is invalid! Expected a list of elements but got: ${Scrubber.stringify(\n          initialValue\n        )}`\n      )\n    }\n    if (!Editor.isEditor(editor)) {\n      throw new Error(\n        `[Slate] editor is invalid! You passed: ${Scrubber.stringify(editor)}`\n      )\n    }\n    editor.children = initialValue\n    Object.assign(editor, rest)\n    return { v: 0, editor }\n  })\n\n  const {\n    selectorContext,\n    onChange: handleSelectorChange,\n  } = useSelectorContext(editor)\n\n  const onContextChange = useCallback(() => {\n    if (onChange) {\n      onChange(editor.children)\n    }\n\n    setContext(prevContext => ({\n      v: prevContext.v + 1,\n      editor,\n    }))\n    handleSelectorChange(editor)\n  }, [editor, handleSelectorChange, onChange])\n\n  useEffect(() => {\n    EDITOR_TO_ON_CHANGE.set(editor, onContextChange)\n\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {})\n      unmountRef.current = true\n    }\n  }, [editor, onContextChange])\n\n  const [isFocused, setIsFocused] = useState(ReactEditor.isFocused(editor))\n\n  useEffect(() => {\n    setIsFocused(ReactEditor.isFocused(editor))\n  }, [editor])\n\n  useIsomorphicLayoutEffect(() => {\n    const fn = () => setIsFocused(ReactEditor.isFocused(editor))\n    if (REACT_MAJOR_VERSION >= 17) {\n      // In React >= 17 onFocus and onBlur listen to the focusin and focusout events during the bubbling phase.\n      // Therefore in order for <Editable />'s handlers to run first, which is necessary for ReactEditor.isFocused(editor)\n      // to return the correct value, we have to listen to the focusin and focusout events without useCapture here.\n      document.addEventListener('focusin', fn)\n      document.addEventListener('focusout', fn)\n      return () => {\n        document.removeEventListener('focusin', fn)\n        document.removeEventListener('focusout', fn)\n      }\n    } else {\n      document.addEventListener('focus', fn, true)\n      document.addEventListener('blur', fn, true)\n      return () => {\n        document.removeEventListener('focus', fn, true)\n        document.removeEventListener('blur', fn, true)\n      }\n    }\n  }, [])\n\n  return (\n    <SlateSelectorContext.Provider value={selectorContext}>\n      <SlateContext.Provider value={context}>\n        <EditorContext.Provider value={context.editor}>\n          <FocusedContext.Provider value={isFocused}>\n            {children}\n          </FocusedContext.Provider>\n        </EditorContext.Provider>\n      </SlateContext.Provider>\n    </SlateSelectorContext.Provider>\n  )\n}\n","import { useContext } from 'react'\n\nimport { EditorContext } from './use-slate-static'\n\n/**\n * Get the current editor object from the React context.\n * @deprecated Use useSlateStatic instead.\n */\n\nexport const useEditor = () => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useEditor\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import { BaseSelection, Range } from 'slate'\n\nimport { useSlateSelector } from './use-slate-selector'\n\n/**\n * Get the current slate selection.\n * Only triggers a rerender when the selection actually changes\n */\nexport const useSlateSelection = () => {\n  return useSlateSelector(editor => editor.selection, isSelectionEqual)\n}\n\nconst isSelectionEqual = (a: BaseSelection, b: BaseSelection) => {\n  if (!a && !b) return true\n  if (!a || !b) return false\n  return Range.equals(a, b)\n}\n","/**\n * Utilities for single-line deletion\n */\n\nimport { Editor, Range } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\nconst doRectsIntersect = (rect: DOMRect, compareRect: DOMRect) => {\n  const middle = (compareRect.top + compareRect.bottom) / 2\n\n  return rect.top <= middle && rect.bottom >= middle\n}\n\nconst areRangesSameLine = (\n  editor: ReactEditor,\n  range1: Range,\n  range2: Range\n) => {\n  const rect1 = ReactEditor.toDOMRange(editor, range1).getBoundingClientRect()\n  const rect2 = ReactEditor.toDOMRange(editor, range2).getBoundingClientRect()\n\n  return doRectsIntersect(rect1, rect2) && doRectsIntersect(rect2, rect1)\n}\n\n/**\n * A helper utility that returns the end portion of a `Range`\n * which is located on a single line.\n *\n * @param {Editor} editor The editor object to compare against\n * @param {Range} parentRange The parent range to compare against\n * @returns {Range} A valid portion of the parentRange which is one a single line\n */\nexport const findCurrentLineRange = (\n  editor: ReactEditor,\n  parentRange: Range\n): Range => {\n  const parentRangeBoundary = Editor.range(editor, Range.end(parentRange))\n  const positions = Array.from(Editor.positions(editor, { at: parentRange }))\n\n  let left = 0\n  let right = positions.length\n  let middle = Math.floor(right / 2)\n\n  if (\n    areRangesSameLine(\n      editor,\n      Editor.range(editor, positions[left]),\n      parentRangeBoundary\n    )\n  ) {\n    return Editor.range(editor, positions[left], parentRangeBoundary)\n  }\n\n  if (positions.length < 2) {\n    return Editor.range(\n      editor,\n      positions[positions.length - 1],\n      parentRangeBoundary\n    )\n  }\n\n  while (middle !== positions.length && middle !== left) {\n    if (\n      areRangesSameLine(\n        editor,\n        Editor.range(editor, positions[middle]),\n        parentRangeBoundary\n      )\n    ) {\n      right = middle\n    } else {\n      left = middle\n    }\n\n    middle = Math.floor((left + right) / 2)\n  }\n\n  return Editor.range(editor, positions[right], parentRangeBoundary)\n}\n","import ReactDOM from 'react-dom'\nimport {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Transforms,\n} from 'slate'\nimport {\n  TextDiff,\n  transformPendingPoint,\n  transformPendingRange,\n  transformTextDiff,\n} from '../utils/diff-text'\nimport {\n  getPlainText,\n  getSlateFragmentAttribute,\n  isDOMText,\n} from '../utils/dom'\nimport { Key } from '../utils/key'\nimport { findCurrentLineRange } from '../utils/lines'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_ON_CHANGE,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  NODE_TO_KEY,\n} from '../utils/weak-maps'\nimport { ReactEditor } from './react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\n\n/**\n * `withReact` adds React and DOM specific behaviors to the editor.\n *\n * If you are using TypeScript, you must extend Slate's CustomTypes to use\n * this plugin.\n *\n * See https://docs.slatejs.org/concepts/11-typescript to learn how.\n */\n\nexport const withReact = <T extends BaseEditor>(\n  editor: T,\n  clipboardFormatKey = 'x-slate-fragment'\n): T & ReactEditor => {\n  const e = editor as T & ReactEditor\n  const { apply, onChange, deleteBackward, addMark, removeMark } = e\n\n  // The WeakMap which maps a key to a specific HTMLElement must be scoped to the editor instance to\n  // avoid collisions between editors in the DOM that share the same value.\n  EDITOR_TO_KEY_TO_ELEMENT.set(e, new WeakMap())\n\n  e.addMark = (key, value) => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(e)?.()\n\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    addMark(key, value)\n  }\n\n  e.removeMark = key => {\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    removeMark(key)\n  }\n\n  e.deleteBackward = unit => {\n    if (unit !== 'line') {\n      return deleteBackward(unit)\n    }\n\n    if (e.selection && Range.isCollapsed(e.selection)) {\n      const parentBlockEntry = Editor.above(e, {\n        match: n => Element.isElement(n) && Editor.isBlock(e, n),\n        at: e.selection,\n      })\n\n      if (parentBlockEntry) {\n        const [, parentBlockPath] = parentBlockEntry\n        const parentElementRange = Editor.range(\n          e,\n          parentBlockPath,\n          e.selection.anchor\n        )\n\n        const currentLineRange = findCurrentLineRange(e, parentElementRange)\n\n        if (!Range.isCollapsed(currentLineRange)) {\n          Transforms.delete(e, { at: currentLineRange })\n        }\n      }\n    }\n  }\n\n  // This attempts to reset the NODE_TO_KEY entry to the correct value\n  // as apply() changes the object reference and hence invalidates the NODE_TO_KEY entry\n  e.apply = (op: Operation) => {\n    const matches: [Path, Key][] = []\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(e)\n    if (pendingDiffs?.length) {\n      const transformed = pendingDiffs\n        .map(textDiff => transformTextDiff(textDiff, op))\n        .filter(Boolean) as TextDiff[]\n\n      EDITOR_TO_PENDING_DIFFS.set(e, transformed)\n    }\n\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(e)\n    if (pendingSelection) {\n      EDITOR_TO_PENDING_SELECTION.set(\n        e,\n        transformPendingRange(e, pendingSelection, op)\n      )\n    }\n\n    const pendingAction = EDITOR_TO_PENDING_ACTION.get(e)\n    if (pendingAction?.at) {\n      const at = Point.isPoint(pendingAction?.at)\n        ? transformPendingPoint(e, pendingAction.at, op)\n        : transformPendingRange(e, pendingAction.at, op)\n\n      EDITOR_TO_PENDING_ACTION.set(e, at ? { ...pendingAction, at } : null)\n    }\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n      case 'split_node': {\n        matches.push(...getMatches(e, op.path))\n        break\n      }\n\n      case 'set_selection': {\n        // Selection was manually set, don't restore the user selection after the change.\n        EDITOR_TO_USER_SELECTION.get(e)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(e)\n        break\n      }\n\n      case 'insert_node':\n      case 'remove_node': {\n        matches.push(...getMatches(e, Path.parent(op.path)))\n        break\n      }\n\n      case 'merge_node': {\n        const prevPath = Path.previous(op.path)\n        matches.push(...getMatches(e, prevPath))\n        break\n      }\n\n      case 'move_node': {\n        const commonPath = Path.common(\n          Path.parent(op.path),\n          Path.parent(op.newPath)\n        )\n        matches.push(...getMatches(e, commonPath))\n        break\n      }\n    }\n\n    apply(op)\n\n    for (const [path, key] of matches) {\n      const [node] = Editor.node(e, path)\n      NODE_TO_KEY.set(node, key)\n    }\n  }\n\n  e.setFragmentData = (data: Pick<DataTransfer, 'getData' | 'setData'>) => {\n    const { selection } = e\n\n    if (!selection) {\n      return\n    }\n\n    const [start, end] = Range.edges(selection)\n    const startVoid = Editor.void(e, { at: start.path })\n    const endVoid = Editor.void(e, { at: end.path })\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return\n    }\n\n    // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n    const domRange = ReactEditor.toDOMRange(e, selection)\n    let contents = domRange.cloneContents()\n    let attach = contents.childNodes[0] as HTMLElement\n\n    // Make sure attach is non-empty, since empty nodes will not get copied.\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node as HTMLElement\n      }\n    })\n\n    // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n    if (endVoid) {\n      const [voidNode] = endVoid\n      const r = domRange.cloneRange()\n      const domNode = ReactEditor.toDOMNode(e, voidNode)\n      r.setEndAfter(domNode)\n      contents = r.cloneContents()\n    }\n\n    // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\n    }\n\n    // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\n      zw => {\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\n        zw.textContent = isNewline ? '\\n' : ''\n      }\n    )\n\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n    if (isDOMText(attach)) {\n      const span = attach.ownerDocument.createElement('span')\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n      span.style.whiteSpace = 'pre'\n      span.appendChild(attach)\n      contents.appendChild(span)\n      attach = span\n    }\n\n    const fragment = e.getFragment()\n    const string = JSON.stringify(fragment)\n    const encoded = window.btoa(encodeURIComponent(string))\n    attach.setAttribute('data-slate-fragment', encoded)\n    data.setData(`application/${clipboardFormatKey}`, encoded)\n\n    // Add the content to a <div> so that we can get its inner HTML.\n    const div = contents.ownerDocument.createElement('div')\n    div.appendChild(contents)\n    div.setAttribute('hidden', 'true')\n    contents.ownerDocument.body.appendChild(div)\n    data.setData('text/html', div.innerHTML)\n    data.setData('text/plain', getPlainText(div))\n    contents.ownerDocument.body.removeChild(div)\n    return data\n  }\n\n  e.insertData = (data: DataTransfer) => {\n    if (!e.insertFragmentData(data)) {\n      e.insertTextData(data)\n    }\n  }\n\n  e.insertFragmentData = (data: DataTransfer): boolean => {\n    /**\n     * Checking copied fragment from application/x-slate-fragment or data-slate-fragment\n     */\n    const fragment =\n      data.getData(`application/${clipboardFormatKey}`) ||\n      getSlateFragmentAttribute(data)\n\n    if (fragment) {\n      const decoded = decodeURIComponent(window.atob(fragment))\n      const parsed = JSON.parse(decoded) as Node[]\n      e.insertFragment(parsed)\n      return true\n    }\n    return false\n  }\n\n  e.insertTextData = (data: DataTransfer): boolean => {\n    const text = data.getData('text/plain')\n\n    if (text) {\n      const lines = text.split(/\\r\\n|\\r|\\n/)\n      let split = false\n\n      for (const line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, { always: true })\n        }\n\n        e.insertText(line)\n        split = true\n      }\n      return true\n    }\n    return false\n  }\n\n  e.onChange = options => {\n    // COMPAT: React < 18 doesn't batch `setState` hook calls, which means\n    // that the children and selection can get out of sync for one render\n    // pass. So we have to use this unstable API to ensure it batches them.\n    // (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    const maybeBatchUpdates =\n      REACT_MAJOR_VERSION < 18\n        ? ReactDOM.unstable_batchedUpdates\n        : (callback: () => void) => callback()\n\n    maybeBatchUpdates(() => {\n      const onContextChange = EDITOR_TO_ON_CHANGE.get(e)\n\n      if (onContextChange) {\n        onContextChange()\n      }\n\n      onChange(options)\n    })\n  }\n\n  return e\n}\n\nconst getMatches = (e: Editor, path: Path) => {\n  const matches: [Path, Key][] = []\n  for (const [n, p] of Editor.levels(e, { at: path })) {\n    const key = ReactEditor.findKey(e, n)\n    matches.push([p, key])\n  }\n  return matches\n}\n"],"names":["objectWithoutPropertiesLoose","EditorContext","createContext","useSlateStatic","editor","useContext","Error","REACT_MAJOR_VERSION","parseInt","React","version","split","IS_IOS","navigator","window","test","userAgent","MSStream","IS_APPLE","IS_ANDROID","IS_FIREFOX","IS_WEBKIT","IS_EDGE_LEGACY","IS_CHROME","IS_CHROME_LEGACY","IS_ANDROID_CHROME_LEGACY","IS_FIREFOX_LEGACY","IS_UC_MOBILE","IS_WECHATBROWSER","CAN_USE_DOM","document","createElement","HAS_BEFORE_INPUT_SUPPORT","globalThis","InputEvent","prototype","getTargetRanges","NODE_TO_INDEX","WeakMap","NODE_TO_PARENT","EDITOR_TO_WINDOW","EDITOR_TO_ELEMENT","EDITOR_TO_PLACEHOLDER_ELEMENT","ELEMENT_TO_NODE","NODE_TO_ELEMENT","NODE_TO_KEY","EDITOR_TO_KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","IS_COMPOSING","EDITOR_TO_USER_SELECTION","EDITOR_TO_ON_CHANGE","EDITOR_TO_SCHEDULE_FLUSH","EDITOR_TO_PENDING_INSERTION_MARKS","EDITOR_TO_USER_MARKS","EDITOR_TO_PENDING_DIFFS","EDITOR_TO_PENDING_ACTION","EDITOR_TO_PENDING_SELECTION","EDITOR_TO_FORCE_RENDER","PLACEHOLDER_SYMBOL","Symbol","MARK_PLACEHOLDER_SYMBOL","DOMText","Text","getDefaultView","value","ownerDocument","defaultView","isDOMComment","isDOMNode","nodeType","isDOMElement","Node","isDOMSelection","anchorNode","Selection","isDOMText","isPlainTextOnlyPaste","event","clipboardData","getData","types","length","normalizeDOMPoint","domPoint","node","offset","childNodes","isLast","index","getEditableChildAndIndex","i","getEditableChild","textContent","hasShadowRoot","parent","parentNode","toString","direction","child","triedForward","triedBackward","getAttribute","getPlainText","domNode","text","nodeValue","childNode","Array","from","display","getComputedStyle","getPropertyValue","tagName","catchSlateFragment","getSlateFragmentAttribute","dataTransfer","htmlData","fragment","match","isTrackedMutation","mutation","batch","target","matches","ReactEditor","getWindow","contains","hasDOMNode","editable","parentMutation","find","addedNodes","removedNodes","n","Key","constructor","id","androidPendingDiffs","get","androidScheduleFlush","blur","el","toDOMNode","root","findDocumentOrShadowRoot","set","activeElement","deselect","selection","domSelection","getSelection","rangeCount","removeAllRanges","Transforms","getRootNode","Document","ShadowRoot","findEventRange","nativeEvent","clientX","x","clientY","y","toSlateNode","path","findPath","Element","isElement","Editor","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","edge","point","before","after","range","domRange","caretRangeFromPoint","position","caretPositionFromPoint","createRange","setStart","offsetNode","setEnd","toSlateRange","exactMatch","suppressThrow","findKey","key","isEditor","unshift","Scrubber","stringify","focus","preventScroll","options","editorEl","targetEl","parentElement","err","message","includes","closest","isContentEditable","hasEditableTarget","hasRange","anchor","hasPath","hasSelectableTarget","isTargetInsideNonReadonlyVoid","hasTarget","insertData","data","insertFragmentData","insertTextData","isComposing","isFocused","isReadOnly","slateNode","setFragmentData","originEvent","KEY_TO_ELEMENT","toDOMPoint","void","at","selector","texts","querySelectorAll","start","attr","trueLength","end","nextText","hasAttribute","domText","startsWith","Math","min","max","toDOMRange","isBackward","Range","domAnchor","domFocus","isCollapsed","startNode","startOffset","endNode","endOffset","startEl","isStartAtZeroWidth","endEl","isEndAtZeroWidth","domEl","toSlatePoint","nearestNode","nearestOffset","textNode","potentialVoidNode","voidNode","leafNode","contents","cloneContents","removals","slice","call","forEach","textContext","removeChild","leafNodes","current","endsWith","querySelector","startContainer","anchorOffset","focusNode","focusOffset","firstRange","getRangeAt","lastRange","endContainer","collapsed","isExpanded","isForward","mode","unhangRange","voids","verifyDiffState","textDiff","diff","isText","nextPath","Path","next","nextNode","applyStringDiff","diffs","reduce","longestCommonPrefixLength","str","another","charAt","longestCommonSuffixLength","normalizeStringDiff","targetText","removedText","prefixLength","suffixLength","normalized","mergeStringDiffs","a","b","overlap","applied","sliceEnd","targetRange","normalizePoint","leaf","parentBlock","above","isBlock","entry","isDescendant","normalizeRange","transformPendingPoint","op","pendingDiffs","equals","Point","transform","affinity","transformed","type","transformPendingRange","transformTextDiff","newPath","RESOLVE_DELAY","FLUSH_DELAY","debug","isDataTransfer","name","createAndroidInputManager","scheduleOnDOMSelectionChange","onDOMSelectionChange","flushing","compositionEndTimeoutId","flushTimeoutId","actionTimeoutId","idCounter","insertPositionHint","applyPendingSelection","pendingSelection","delete","select","performAction","action","isPoint","run","flush","clearTimeout","hasPendingDiffs","hasPendingAction","setTimeout","selectionRef","rangeRef","marks","scheduleSelectionChange","pendingMarks","undefined","insertText","deleteFragment","filter","cancel","unref","userMarks","onChange","handleCompositionEnd","_event","handleCompositionStart","updatePlaceholderVisibility","forceHide","placeholderElement","style","removeProperty","storeDiff","idx","findIndex","change","push","merged","splice","scheduleAction","handleDOMBeforeInput","inputType","nativeTargetRange","canStoreDiff","edges","relevantPendingDiffs","handleUserSelect","targetNode","deleteForward","nativeCollapsed","deleteBackward","unit","insertSoftBreak","insertBreak","replace","parts","line","hintPosition","search","diffPosition","scheduleFlush","hasPendingChanges","isFlushing","pathChanged","parentPathChanged","handleInput","handleKeyDown","_","handleDomMutations","mutations","some","useIsMounted","isMountedRef","useRef","useEffect","useIsomorphicLayoutEffect","useLayoutEffect","useMutationObserver","callback","mutationObserver","useState","MutationObserver","takeRecords","observe","disconnect","MUTATION_OBSERVER_CONFIG","subtree","childList","characterData","useAndroidInputManager","isMounted","inputManager","shallowCompare","obj1","obj2","Object","keys","every","hasOwnProperty","isDecorationFlagsEqual","other","rangeOwnProps","otherOwnProps","isElementDecorationsEqual","list","isTextDecorationsEqual","String","props","parentPath","isMarkPlaceholder","ZeroWidthString","string","children","isLineBreak","TextString","isTrailing","ref","getTextContent","initialText","textWithTrailing","MemoizedText","memo","forwardRef","attributes","disconnectPlaceholderResizeObserver","placeholderResizeObserver","releaseObserver","clearTimeoutRef","timeoutRef","Leaf","renderPlaceholder","renderLeaf","DefaultLeaf","placeholderRef","showPlaceholder","setShowPlaceholder","showPlaceholderTimeoutRef","callbackPlaceholderRef","useCallback","placeholderEl","onPlaceholderResize","ResizeObserver","ResizeObserverPolyfill","leafIsPlaceholder","placeholderProps","placeholder","pointerEvents","maxWidth","opacity","userSelect","textDecoration","WebkitUserModify","contentEditable","Fragment","MemoizedLeaf","prev","decorations","leaves","SlateText","callbackRef","span","element","renderElement","p","DefaultElement","readOnly","useReadOnly","useChildren","hasInlines","dir","getDirection","Tag","color","outline","MemoizedElement","DecorateContext","useDecorate","SelectedContext","useSelected","decorate","isLeafBlock","concat","sel","intersection","ds","dec","d","Provider","ElementComponent","TextComponent","ReadOnlyContext","SlateContext","useSlate","context","useSlateWithV","useTrackUserInput","receivedUserInput","animationFrameIdRef","onUserInput","cancelAnimationFrame","requestAnimationFrame","TRIPLE_CLICK","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isHotkey","isApple","isWindows","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSoftBreak","isSplitBlock","isTransposeCharacter","isUndo","createRestoreDomManager","bufferedMutations","clear","registerMutations","trackedMutations","restoreDOM","reverse","insertBefore","nextSibling","characterDataOldValue","RestoreDOMComponent","Component","componentDidMount","manager","getSnapshotBeforeUpdate","pendingMutations","componentDidUpdate","componentWillUnmount","render","RestoreDOM","Children","Editable","defaultRenderPlaceholder","DefaultPlaceholder","autoFocus","defaultDecorate","onDOMBeforeInput","propsOnDOMBeforeInput","scrollSelectionIntoView","defaultScrollSelectionIntoView","userStyle","as","disableDefaultStyles","setIsComposing","deferredOperations","placeholderHeight","setPlaceholderHeight","forceRender","useReducer","s","state","useMemo","isDraggingInternally","isUpdatingSelection","latestElement","hasMarkPlaceholder","androidInputManagerRef","throttle","androidInputManager","anchorNodeSelectable","focusNodeSelectable","debounce","setDomSelection","forceChange","hasDomSelection","editorElement","hasDomSelectionInEditor","slateRange","newDomRange","collapseToEnd","setBaseAndExtent","ensureSelection","timeoutId","animationFrameId","ensureDomSelection","e","isDOMEventHandled","isCompositionChange","native","lastText","createTreeWalker","NodeFilter","SHOW_TEXT","lastChild","whiteSpace","block","preventDefault","toRestore","removeEventListener","addEventListener","placeHolderResizeHandler","rest","loose","unset","fromEntries","map","mark","role","spellCheck","autoCorrect","autoCapitalize","zindex","suppressContentEditableWarning","wordWrap","minHeight","onBeforeInput","isEventHandled","onInput","onBlur","relatedTarget","onClick","detail","blockPath","startVoid","endVoid","onCompositionEnd","placeholderMarks","onCompositionUpdate","onCompositionStart","inline","inlinePath","isEnd","setSelection","onCopy","isDOMEventTargetInput","onCut","onDragOver","onDragStart","voidMatch","onDrop","draggedRange","onDragEnd","onFocus","onKeyDown","isRTL","Hotkeys","maybeHistoryEditor","move","collapse","currentNode","onPaste","leafEl","bind","scrollIntoView","scrollMode","handler","shouldTreatEventAsHandled","isDefaultPrevented","isPropagationStopped","HTMLInputElement","HTMLTextAreaElement","defaultPrevented","FocusedContext","useFocused","isError","error","SlateSelectorContext","refEquality","useSlateSelector","equalityFn","getSlate","latestSubscriptionCallbackError","latestSelector","latestSelectedState","selectedState","stack","checkForUpdates","newSelectedState","unsubscribe","useSelectorContext","eventListeners","slateRef","listener","selectorContext","indexOf","Slate","initialValue","unmountRef","setContext","isNodeList","assign","v","handleSelectorChange","onContextChange","prevContext","setIsFocused","fn","useEditor","useSlateSelection","isSelectionEqual","doRectsIntersect","compareRect","middle","bottom","areRangesSameLine","range1","range2","rect1","rect2","findCurrentLineRange","parentRange","parentRangeBoundary","positions","right","floor","withReact","clipboardFormatKey","apply","addMark","removeMark","parentBlockEntry","parentBlockPath","parentElementRange","currentLineRange","Boolean","pendingAction","getMatches","prevPath","previous","commonPath","common","attach","trim","r","cloneRange","setEndAfter","zw","isNewline","appendChild","getFragment","JSON","encoded","btoa","encodeURIComponent","setAttribute","setData","div","body","innerHTML","decoded","decodeURIComponent","atob","parsed","parse","insertFragment","lines","splitNodes","always","maybeBatchUpdates","ReactDOM","unstable_batchedUpdates","levels"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"index.es.js","sources":["../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../src/hooks/use-slate-static.tsx","../src/utils/environment.ts","../src/utils/weak-maps.ts","../src/utils/dom.ts","../src/utils/key.ts","../src/plugin/react-editor.ts","../src/utils/diff-text.ts","../src/hooks/android-input-manager/android-input-manager.ts","../src/hooks/use-is-mounted.tsx","../src/hooks/use-isomorphic-layout-effect.ts","../src/hooks/use-mutation-observer.ts","../src/hooks/android-input-manager/use-android-input-manager.ts","../src/utils/range-list.ts","../src/components/string.tsx","../src/components/leaf.tsx","../src/components/text.tsx","../src/components/element.tsx","../src/hooks/use-decorate.ts","../src/hooks/use-selected.ts","../src/hooks/use-children.tsx","../src/hooks/use-read-only.ts","../src/hooks/use-slate.tsx","../src/hooks/use-track-user-input.ts","../src/utils/constants.ts","../src/utils/hotkeys.ts","../src/components/restore-dom/restore-dom-manager.ts","../src/components/restore-dom/restore-dom.tsx","../src/components/editable.tsx","../src/hooks/use-focused.ts","../src/hooks/use-slate-selector.tsx","../src/components/slate.tsx","../src/hooks/use-editor.tsx","../src/hooks/use-slate-selection.tsx","../src/utils/lines.ts","../src/plugin/with-react.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object.\n */\n\nexport const EditorContext = createContext<ReactEditor | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlateStatic = (): Editor => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useSlateStatic\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import React from 'react'\n\nexport const REACT_MAJOR_VERSION = parseInt(React.version.split('.')[0], 10)\n\nexport const IS_IOS =\n  typeof navigator !== 'undefined' &&\n  typeof window !== 'undefined' &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  !window.MSStream\n\nexport const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\n\nexport const IS_ANDROID =\n  typeof navigator !== 'undefined' && /Android/.test(navigator.userAgent)\n\nexport const IS_FIREFOX =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\n\nexport const IS_WEBKIT =\n  typeof navigator !== 'undefined' &&\n  /AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent)\n\n// \"modern\" Edge was released at 79.x\nexport const IS_EDGE_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_CHROME =\n  typeof navigator !== 'undefined' && /Chrome/i.test(navigator.userAgent)\n\n// Native `beforeInput` events don't work well with react on Chrome 75\n// and older, Chrome 76+ can use `beforeInput` though.\nexport const IS_CHROME_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_ANDROID_CHROME_LEGACY =\n  IS_ANDROID &&\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-5]?\\d)(?:\\.)/i.test(navigator.userAgent)\n\n// Firefox did not support `beforeInput` until `v87`.\nexport const IS_FIREFOX_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox\\/(?:[0-7][0-9]|[0-8][0-6])(?:\\.)).*/i.test(\n    navigator.userAgent\n  )\n\n// UC mobile browser\nexport const IS_UC_MOBILE =\n  typeof navigator !== 'undefined' && /.*UCBrowser/.test(navigator.userAgent)\n\n// Wechat browser\nexport const IS_WECHATBROWSER =\n  typeof navigator !== 'undefined' && /.*Wechat/.test(navigator.userAgent)\n\n// Check if DOM is available as React does internally.\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const CAN_USE_DOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n)\n\n// COMPAT: Firefox/Edge Legacy don't support the `beforeinput` event\n// Chrome Legacy doesn't support `beforeinput` correctly\nexport const HAS_BEFORE_INPUT_SUPPORT =\n  (!IS_CHROME_LEGACY || !IS_ANDROID_CHROME_LEGACY) &&\n  !IS_EDGE_LEGACY &&\n  // globalThis is undefined in older browsers\n  typeof globalThis !== 'undefined' &&\n  globalThis.InputEvent &&\n  // @ts-ignore The `getTargetRanges` property isn't recognized.\n  typeof globalThis.InputEvent.prototype.getTargetRanges === 'function'\n","import { Ancestor, Editor, Node, Range, RangeRef, Text } from 'slate'\nimport { Action } from '../hooks/android-input-manager/android-input-manager'\nimport { TextDiff } from './diff-text'\nimport { Key } from './key'\n\n/**\n * Two weak maps that allow us rebuild a path given a node. They are populated\n * at render time such that after a render occurs we can always backtrack.\n */\n\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\n\n/**\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\n * are used to resolve DOM event-related logic into Slate actions.\n */\nexport const EDITOR_TO_WINDOW: WeakMap<Editor, Window> = new WeakMap()\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER: WeakMap<Editor, string> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER_ELEMENT: WeakMap<\n  Editor,\n  HTMLElement\n> = new WeakMap()\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\nexport const EDITOR_TO_KEY_TO_ELEMENT: WeakMap<\n  Editor,\n  WeakMap<Key, HTMLElement>\n> = new WeakMap()\n\n/**\n * Weak maps for storing editor-related state.\n */\n\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_COMPOSING: WeakMap<Editor, boolean> = new WeakMap()\n\nexport const EDITOR_TO_USER_SELECTION: WeakMap<\n  Editor,\n  RangeRef | null\n> = new WeakMap()\n\n/**\n * Weak map for associating the context `onChange` context with the plugin.\n */\n\nexport const EDITOR_TO_ON_CHANGE = new WeakMap<Editor, () => void>()\n\n/**\n * Weak maps for saving pending state on composition stage.\n */\n\nexport const EDITOR_TO_SCHEDULE_FLUSH: WeakMap<\n  Editor,\n  () => void\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_INSERTION_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\nexport const EDITOR_TO_USER_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\n/**\n * Android input handling specific weak-maps\n */\n\nexport const EDITOR_TO_PENDING_DIFFS: WeakMap<\n  Editor,\n  TextDiff[]\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_ACTION: WeakMap<\n  Editor,\n  Action | null\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_SELECTION: WeakMap<\n  Editor,\n  Range | null\n> = new WeakMap()\n\nexport const EDITOR_TO_FORCE_RENDER: WeakMap<Editor, () => void> = new WeakMap()\n\n/**\n * Symbols.\n */\n\nexport const PLACEHOLDER_SYMBOL = (Symbol('placeholder') as unknown) as string\nexport const MARK_PLACEHOLDER_SYMBOL = (Symbol(\n  'mark-placeholder'\n) as unknown) as string\n","/**\n * Types.\n */\n\n// COMPAT: This is required to prevent TypeScript aliases from doing some very\n// weird things for Slate's types with the same name as globals. (2019/11/27)\n// https://github.com/microsoft/TypeScript/issues/35002\nimport DOMNode = globalThis.Node\nimport DOMComment = globalThis.Comment\nimport DOMElement = globalThis.Element\nimport DOMText = globalThis.Text\nimport DOMRange = globalThis.Range\nimport DOMSelection = globalThis.Selection\nimport DOMStaticRange = globalThis.StaticRange\nimport { ReactEditor } from '../plugin/react-editor'\n\nexport {\n  DOMNode,\n  DOMComment,\n  DOMElement,\n  DOMText,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n}\n\ndeclare global {\n  interface Window {\n    Selection: typeof Selection['constructor']\n    DataTransfer: typeof DataTransfer['constructor']\n    Node: typeof Node['constructor']\n  }\n}\n\nexport type DOMPoint = [Node, number]\n\n/**\n * Returns the host window of a DOM node\n */\n\nexport const getDefaultView = (value: any): Window | null => {\n  return (\n    (value && value.ownerDocument && value.ownerDocument.defaultView) || null\n  )\n}\n\n/**\n * Check if a DOM node is a comment node.\n */\n\nexport const isDOMComment = (value: any): value is DOMComment => {\n  return isDOMNode(value) && value.nodeType === 8\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMElement = (value: any): value is DOMElement => {\n  return isDOMNode(value) && value.nodeType === 1\n}\n\n/**\n * Check if a value is a DOM node.\n */\n\nexport const isDOMNode = (value: any): value is DOMNode => {\n  const window = getDefaultView(value)\n  return !!window && value instanceof window.Node\n}\n\n/**\n * Check if a value is a DOM selection.\n */\n\nexport const isDOMSelection = (value: any): value is DOMSelection => {\n  const window = value && value.anchorNode && getDefaultView(value.anchorNode)\n  return !!window && value instanceof window.Selection\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMText = (value: any): value is DOMText => {\n  return isDOMNode(value) && value.nodeType === 3\n}\n\n/**\n * Checks whether a paste event is a plaintext-only event.\n */\n\nexport const isPlainTextOnlyPaste = (event: ClipboardEvent) => {\n  return (\n    event.clipboardData &&\n    event.clipboardData.getData('text/plain') !== '' &&\n    event.clipboardData.types.length === 1\n  )\n}\n\n/**\n * Normalize a DOM point so that it always refers to a text node.\n */\n\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\n  let [node, offset] = domPoint\n\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (isDOMElement(node) && node.childNodes.length) {\n    let isLast = offset === node.childNodes.length\n    let index = isLast ? offset - 1 : offset\n    ;[node, index] = getEditableChildAndIndex(\n      node,\n      index,\n      isLast ? 'backward' : 'forward'\n    )\n    // If the editable child found is in front of input offset, we instead seek to its end\n    isLast = index < offset\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (isDOMElement(node) && node.childNodes.length) {\n      const i = isLast ? node.childNodes.length - 1 : 0\n      node = getEditableChild(node, i, isLast ? 'backward' : 'forward')\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\n  }\n\n  // Return the node and offset.\n  return [node, offset]\n}\n\n/**\n * Determines whether the active element is nested within a shadowRoot\n */\n\nexport const hasShadowRoot = (node: Node | null) => {\n  let parent = node && node.parentNode\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true\n    }\n    parent = parent.parentNode\n  }\n  return false\n}\n\n/**\n * Get the nearest editable child and index at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChildAndIndex = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): [DOMNode, number] => {\n  const { childNodes } = parent\n  let child = childNodes[index]\n  let i = index\n  let triedForward = false\n  let triedBackward = false\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (\n    isDOMComment(child) ||\n    (isDOMElement(child) && child.childNodes.length === 0) ||\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\n  ) {\n    if (triedForward && triedBackward) {\n      break\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true\n      i = index - 1\n      direction = 'backward'\n      continue\n    }\n\n    if (i < 0) {\n      triedBackward = true\n      i = index + 1\n      direction = 'forward'\n      continue\n    }\n\n    child = childNodes[i]\n    index = i\n    i += direction === 'forward' ? 1 : -1\n  }\n\n  return [child, index]\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChild = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): DOMNode => {\n  const [child] = getEditableChildAndIndex(parent, index, direction)\n  return child\n}\n\n/**\n * Get a plaintext representation of the content of a node, accounting for block\n * elements which get a newline appended.\n *\n * The domNode must be attached to the DOM.\n */\n\nexport const getPlainText = (domNode: DOMNode) => {\n  let text = ''\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue\n  }\n\n  if (isDOMElement(domNode)) {\n    for (const childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode)\n    }\n\n    const display = getComputedStyle(domNode).getPropertyValue('display')\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n'\n    }\n  }\n\n  return text\n}\n\n/**\n * Get x-slate-fragment attribute from data-slate-fragment\n */\nconst catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m\nexport const getSlateFragmentAttribute = (\n  dataTransfer: DataTransfer\n): string | void => {\n  const htmlData = dataTransfer.getData('text/html')\n  const [, fragment] = htmlData.match(catchSlateFragment) || []\n  return fragment\n}\n\n/**\n * Get the x-slate-fragment attribute that exist in text/html data\n * and append it to the DataTransfer object\n */\nexport const getClipboardData = (\n  dataTransfer: DataTransfer,\n  clipboardFormatKey = 'x-slate-fragment'\n): DataTransfer => {\n  if (!dataTransfer.getData(`application/${clipboardFormatKey}`)) {\n    const fragment = getSlateFragmentAttribute(dataTransfer)\n    if (fragment) {\n      const clipboardData = new DataTransfer()\n      dataTransfer.types.forEach(type => {\n        clipboardData.setData(type, dataTransfer.getData(type))\n      })\n      clipboardData.setData(`application/${clipboardFormatKey}`, fragment)\n      return clipboardData\n    }\n  }\n  return dataTransfer\n}\n\n/**\n * Check whether a mutation originates from a editable element inside the editor.\n */\n\nexport const isTrackedMutation = (\n  editor: ReactEditor,\n  mutation: MutationRecord,\n  batch: MutationRecord[]\n): boolean => {\n  const { target } = mutation\n  if (isDOMElement(target) && target.matches('[contentEditable=\"false\"]')) {\n    return false\n  }\n\n  const { document } = ReactEditor.getWindow(editor)\n  if (document.contains(target)) {\n    return ReactEditor.hasDOMNode(editor, target, { editable: true })\n  }\n\n  const parentMutation = batch.find(({ addedNodes, removedNodes }) => {\n    for (const node of addedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n\n    for (const node of removedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n  })\n\n  if (!parentMutation || parentMutation === mutation) {\n    return false\n  }\n\n  // Target add/remove is tracked. Track the mutation if we track the parent mutation.\n  return isTrackedMutation(editor, parentMutation, batch)\n}\n","/**\n * An auto-incrementing identifier for keys.\n */\n\nlet n = 0\n\n/**\n * A class that keeps track of a key string. We use a full class here because we\n * want to be able to use them as keys in `WeakMap` objects.\n */\n\nexport class Key {\n  id: string\n\n  constructor() {\n    this.id = `${n++}`\n  }\n}\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Path,\n  Point,\n  Range,\n  Scrubber,\n  Transforms,\n} from 'slate'\nimport { TextDiff } from '../utils/diff-text'\nimport {\n  DOMElement,\n  DOMNode,\n  DOMPoint,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n  DOMText,\n  hasShadowRoot,\n  isDOMElement,\n  isDOMNode,\n  isDOMSelection,\n  normalizeDOMPoint,\n} from '../utils/dom'\nimport { IS_ANDROID, IS_CHROME, IS_FIREFOX } from '../utils/environment'\n\nimport { Key } from '../utils/key'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  NODE_TO_INDEX,\n  NODE_TO_KEY,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\n\n/**\n * A React and DOM-specific version of the `Editor` interface.\n */\n\nexport interface ReactEditor extends BaseEditor {\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  insertData: (data: DataTransfer) => void\n  insertFragmentData: (data: DataTransfer) => boolean\n  insertTextData: (data: DataTransfer) => boolean\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  setFragmentData: (\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n}\n\nexport interface ReactEditorInterface {\n  /**\n   * Experimental and android specific: Get pending diffs\n   */\n  androidPendingDiffs: (editor: Editor) => TextDiff[] | undefined\n\n  /**\n   * Experimental and android specific: Flush all pending diffs and cancel composition at the next possible time.\n   */\n  androidScheduleFlush: (editor: Editor) => void\n\n  /**\n   * Blur the editor.\n   */\n  blur: (editor: ReactEditor) => void\n\n  /**\n   * Deselect the editor.\n   */\n  deselect: (editor: ReactEditor) => void\n\n  /**\n   * Find the DOM node that implements DocumentOrShadowRoot for the editor.\n   */\n  findDocumentOrShadowRoot: (editor: ReactEditor) => Document | ShadowRoot\n\n  /**\n   * Get the target range from a DOM `event`.\n   */\n  findEventRange: (editor: ReactEditor, event: any) => Range\n\n  /**\n   * Find a key for a Slate node.\n   */\n  findKey: (editor: ReactEditor, node: Node) => Key\n\n  /**\n   * Find the path of Slate node.\n   */\n  findPath: (editor: ReactEditor, node: Node) => Path\n\n  /**\n   * Focus the editor.\n   */\n  focus: (editor: ReactEditor) => void\n\n  /**\n   * Return the host window of the current editor.\n   */\n  getWindow: (editor: ReactEditor) => Window\n\n  /**\n   * Check if a DOM node is within the editor.\n   */\n  hasDOMNode: (\n    editor: ReactEditor,\n    target: DOMNode,\n    options?: { editable?: boolean }\n  ) => boolean\n\n  /**\n   * Check if the target is editable and in the editor.\n   */\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   *\n   */\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n\n  /**\n   * Check if the target can be selectable\n   */\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Check if the target is in the editor.\n   */\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   * Insert data from a `DataTransfer` into the editor.\n   */\n  insertData: (editor: ReactEditor, data: DataTransfer) => void\n\n  /**\n   * Insert fragment data from a `DataTransfer` into the editor.\n   */\n  insertFragmentData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Insert text data from a `DataTransfer` into the editor.\n   */\n  insertTextData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Check if the user is currently composing inside the editor.\n   */\n  isComposing: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is focused.\n   */\n  isFocused: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is in read-only mode.\n   */\n  isReadOnly: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the target is inside void and in an non-readonly editor.\n   */\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Sets data from the currently selected fragment on a `DataTransfer`.\n   */\n  setFragmentData: (\n    editor: ReactEditor,\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n\n  /**\n   * Find the native DOM element from a Slate node.\n   */\n  toDOMNode: (editor: ReactEditor, node: Node) => HTMLElement\n\n  /**\n   * Find a native DOM selection point from a Slate point.\n   */\n  toDOMPoint: (editor: ReactEditor, point: Point) => DOMPoint\n\n  /**\n   * Find a native DOM range from a Slate `range`.\n   *\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\n   *\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\n   */\n  toDOMRange: (editor: ReactEditor, range: Range) => DOMRange\n\n  /**\n   * Find a Slate node from a native DOM `element`.\n   */\n  toSlateNode: (editor: ReactEditor, domNode: DOMNode) => Node\n\n  /**\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\n   */\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Point | null : Point\n\n  /**\n   * Find a Slate range from a DOM range or selection.\n   */\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Range | null : Range\n}\n\n// eslint-disable-next-line no-redeclare\nexport const ReactEditor: ReactEditorInterface = {\n  androidPendingDiffs: editor => EDITOR_TO_PENDING_DIFFS.get(editor),\n\n  androidScheduleFlush: editor => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(editor)?.()\n  },\n\n  blur: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, false)\n\n    if (root.activeElement === el) {\n      el.blur()\n    }\n  },\n\n  deselect: editor => {\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges()\n    }\n\n    if (selection) {\n      Transforms.deselect(editor)\n    }\n  },\n\n  findDocumentOrShadowRoot: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = el.getRootNode()\n\n    if (\n      (root instanceof Document || root instanceof ShadowRoot) &&\n      root.getSelection != null\n    ) {\n      return root\n    }\n\n    return el.ownerDocument\n  },\n\n  findEventRange: (editor, event) => {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent\n    }\n\n    const { clientX: x, clientY: y, target } = event\n\n    if (x == null || y == null) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    const node = ReactEditor.toSlateNode(editor, event.target)\n    const path = ReactEditor.findPath(editor, node)\n\n    // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n    if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n      const rect = target.getBoundingClientRect()\n      const isPrev = editor.isInline(node)\n        ? x - rect.left < rect.left + rect.width - x\n        : y - rect.top < rect.top + rect.height - y\n\n      const edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end',\n      })\n      const point = isPrev\n        ? Editor.before(editor, edge)\n        : Editor.after(editor, edge)\n\n      if (point) {\n        const range = Editor.range(editor, point)\n        return range\n      }\n    }\n\n    // Else resolve a range from the caret position where the drop occured.\n    let domRange\n    const { document } = ReactEditor.getWindow(editor)\n\n    // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y)\n    } else {\n      const position = document.caretPositionFromPoint(x, y)\n\n      if (position) {\n        domRange = document.createRange()\n        domRange.setStart(position.offsetNode, position.offset)\n        domRange.setEnd(position.offsetNode, position.offset)\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    // Resolve a Slate range from the DOM range.\n    const range = ReactEditor.toSlateRange(editor, domRange, {\n      exactMatch: false,\n      suppressThrow: false,\n    })\n    return range\n  },\n\n  findKey: (editor, node) => {\n    let key = NODE_TO_KEY.get(node)\n\n    if (!key) {\n      key = new Key()\n      NODE_TO_KEY.set(node, key)\n    }\n\n    return key\n  },\n\n  findPath: (editor, node) => {\n    const path: Path = []\n    let child = node\n\n    while (true) {\n      const parent = NODE_TO_PARENT.get(child)\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path\n        } else {\n          break\n        }\n      }\n\n      const i = NODE_TO_INDEX.get(child)\n\n      if (i == null) {\n        break\n      }\n\n      path.unshift(i)\n      child = parent\n    }\n\n    throw new Error(\n      `Unable to find the path for Slate node: ${Scrubber.stringify(node)}`\n    )\n  },\n\n  focus: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, true)\n\n    if (root.activeElement !== el) {\n      el.focus({ preventScroll: true })\n    }\n  },\n\n  getWindow: editor => {\n    const window = EDITOR_TO_WINDOW.get(editor)\n    if (!window) {\n      throw new Error('Unable to find a host window element for this editor')\n    }\n    return window\n  },\n\n  hasDOMNode: (editor, target, options = {}) => {\n    const { editable = false } = options\n    const editorEl = ReactEditor.toDOMNode(editor, editor)\n    let targetEl\n\n    // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n    try {\n      targetEl = (isDOMElement(target)\n        ? target\n        : target.parentElement) as HTMLElement\n    } catch (err) {\n      if (\n        !err.message.includes('Permission denied to access property \"nodeType\"')\n      ) {\n        throw err\n      }\n    }\n\n    if (!targetEl) {\n      return false\n    }\n\n    return (\n      targetEl.closest(`[data-slate-editor]`) === editorEl &&\n      (!editable || targetEl.isContentEditable\n        ? true\n        : (typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined\n            // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable=\"false\"(readOnly)\n            (targetEl.closest('[contenteditable=\"false\"]') === editorEl) || targetEl.closest(\"[plate-firefox-fix]\") !== null) ||\n          !!targetEl.getAttribute('data-slate-zero-width'))\n    )\n  },\n\n  hasEditableTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) &&\n    ReactEditor.hasDOMNode(editor, target, { editable: true }),\n\n  hasRange: (editor, range) => {\n    const { anchor, focus } = range\n    return (\n      Editor.hasPath(editor, anchor.path) && Editor.hasPath(editor, focus.path)\n    )\n  },\n\n  hasSelectableTarget: (editor, target) =>\n    ReactEditor.hasEditableTarget(editor, target) ||\n    ReactEditor.isTargetInsideNonReadonlyVoid(editor, target),\n\n  hasTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) && ReactEditor.hasDOMNode(editor, target),\n\n  insertData: (editor, data) => {\n    editor.insertData(data)\n  },\n\n  insertFragmentData: (editor, data) => editor.insertFragmentData(data),\n\n  insertTextData: (editor, data) => editor.insertTextData(data),\n\n  isComposing: editor => {\n    return !!IS_COMPOSING.get(editor)\n  },\n\n  isFocused: editor => !!IS_FOCUSED.get(editor),\n\n  isReadOnly: editor => !!IS_READ_ONLY.get(editor),\n\n  isTargetInsideNonReadonlyVoid: (editor, target) => {\n    if (IS_READ_ONLY.get(editor)) return false\n\n    const slateNode =\n      ReactEditor.hasTarget(editor, target) &&\n      ReactEditor.toSlateNode(editor, target)\n    return Element.isElement(slateNode) && Editor.isVoid(editor, slateNode)\n  },\n\n  setFragmentData: (editor, data, originEvent) =>\n    editor.setFragmentData(data, originEvent),\n\n  toDOMNode: (editor, node) => {\n    const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n    const domNode = Editor.isEditor(node)\n      ? EDITOR_TO_ELEMENT.get(editor)\n      : KEY_TO_ELEMENT?.get(ReactEditor.findKey(editor, node))\n\n    if (!domNode) {\n      throw new Error(\n        `Cannot resolve a DOM node from Slate node: ${Scrubber.stringify(node)}`\n      )\n    }\n\n    return domNode\n  },\n\n  toDOMPoint: (editor, point) => {\n    const [node] = Editor.node(editor, point.path)\n    const el = ReactEditor.toDOMNode(editor, node)\n    let domPoint: DOMPoint | undefined\n\n    // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n    if (Editor.void(editor, { at: point })) {\n      point = { path: point.path, offset: 0 }\n    }\n\n    // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n    const selector = `[data-slate-string], [data-slate-zero-width]`\n    const texts = Array.from(el.querySelectorAll(selector))\n    let start = 0\n\n    for (let i = 0; i < texts.length; i++) {\n      const text = texts[i]\n      const domNode = text.childNodes[0] as HTMLElement\n\n      if (domNode == null || domNode.textContent == null) {\n        continue\n      }\n\n      const { length } = domNode.textContent\n      const attr = text.getAttribute('data-slate-length')\n      const trueLength = attr == null ? length : parseInt(attr, 10)\n      const end = start + trueLength\n\n      // Prefer putting the selection inside the mark placeholder to ensure\n      // composed text is displayed with the correct marks.\n      const nextText = texts[i + 1]\n      if (\n        point.offset === end &&\n        nextText?.hasAttribute('data-slate-mark-placeholder')\n      ) {\n        const domText = nextText.childNodes[0]\n\n        domPoint = [\n          // COMPAT: If we don't explicity set the dom point to be on the actual\n          // dom text element, chrome will put the selection behind the actual dom\n          // text element, causing domRange.getBoundingClientRect() calls on a collapsed\n          // selection to return incorrect zero values (https://bugs.chromium.org/p/chromium/issues/detail?id=435438)\n          // which will cause issues when scrolling to it.\n          domText instanceof DOMText ? domText : nextText,\n          nextText.textContent?.startsWith('\\uFEFF') ? 1 : 0,\n        ]\n        break\n      }\n\n      if (point.offset <= end) {\n        const offset = Math.min(length, Math.max(0, point.offset - start))\n        domPoint = [domNode, offset]\n        break\n      }\n\n      start = end\n    }\n\n    if (!domPoint) {\n      throw new Error(\n        `Cannot resolve a DOM point from Slate point: ${Scrubber.stringify(\n          point\n        )}`\n      )\n    }\n\n    return domPoint\n  },\n\n  toDOMRange: (editor, range) => {\n    const { anchor, focus } = range\n    const isBackward = Range.isBackward(range)\n    const domAnchor = ReactEditor.toDOMPoint(editor, anchor)\n    const domFocus = Range.isCollapsed(range)\n      ? domAnchor\n      : ReactEditor.toDOMPoint(editor, focus)\n\n    const window = ReactEditor.getWindow(editor)\n    const domRange = window.document.createRange()\n    const [startNode, startOffset] = isBackward ? domFocus : domAnchor\n    const [endNode, endOffset] = isBackward ? domAnchor : domFocus\n\n    // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n    const startEl = (isDOMElement(startNode)\n      ? startNode\n      : startNode.parentElement) as HTMLElement\n    const isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width')\n    const endEl = (isDOMElement(endNode)\n      ? endNode\n      : endNode.parentElement) as HTMLElement\n    const isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width')\n\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset)\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset)\n    return domRange\n  },\n\n  toSlateNode: (editor, domNode) => {\n    let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(`[data-slate-node]`)\n    }\n\n    const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\n\n    if (!node) {\n      throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\n    }\n\n    return node\n  },\n\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Point | null : Point => {\n    const { exactMatch, suppressThrow } = options\n    const [nearestNode, nearestOffset] = exactMatch\n      ? domPoint\n      : normalizeDOMPoint(domPoint)\n    const parentNode = nearestNode.parentNode as DOMElement\n    let textNode: DOMElement | null = null\n    let offset = 0\n\n    if (parentNode) {\n      const editorEl = ReactEditor.toDOMNode(editor, editor)\n      const potentialVoidNode = parentNode.closest('[data-slate-void=\"true\"]')\n      // Need to ensure that the closest void node is actually a void node\n      // within this editor, and not a void node within some parent editor. This can happen\n      // if this editor is within a void node of another editor (\"nested editors\", like in\n      // the \"Editable Voids\" example on the docs site).\n      const voidNode =\n        potentialVoidNode && editorEl.contains(potentialVoidNode)\n          ? potentialVoidNode\n          : null\n      let leafNode = parentNode.closest('[data-slate-leaf]')\n      let domNode: DOMElement | null = null\n\n      // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]')\n\n        if (textNode) {\n          const window = ReactEditor.getWindow(editor)\n          const range = window.document.createRange()\n          range.setStart(textNode, 0)\n          range.setEnd(nearestNode, nearestOffset)\n\n          const contents = range.cloneContents()\n          const removals = [\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[data-slate-zero-width]')\n            ),\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[contenteditable=false]')\n            ),\n          ]\n\n          removals.forEach(el => {\n            // COMPAT: While composing at the start of a text node, some keyboards put\n            // the text content inside the zero width space.\n            if (\n              IS_ANDROID &&\n              !exactMatch &&\n              el.hasAttribute('data-slate-zero-width') &&\n              el.textContent.length > 0 &&\n              el.textContext !== '\\uFEFF'\n            ) {\n              if (el.textContent.startsWith('\\uFEFF')) {\n                el.textContent = el.textContent.slice(1)\n              }\n\n              return\n            }\n\n            el!.parentNode!.removeChild(el)\n          })\n\n          // COMPAT: Edge has a bug where Range.prototype.toString() will\n          // convert \\n into \\r\\n. The bug causes a loop when slate-react\n          // attempts to reposition its cursor to match the native position. Use\n          // textContent.length instead.\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n          offset = contents.textContent!.length\n          domNode = textNode\n        }\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent and taking the\n        // first one that isn't inside a nested editor.\n        const leafNodes = voidNode.querySelectorAll('[data-slate-leaf]')\n        for (let index = 0; index < leafNodes.length; index++) {\n          const current = leafNodes[index]\n          if (ReactEditor.hasDOMNode(editor, current)) {\n            leafNode = current\n            break\n          }\n        }\n\n        // COMPAT: In read-only editors the leaf is not rendered.\n        if (!leafNode) {\n          offset = 1\n        } else {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          offset = domNode.textContent!.length\n          domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n            offset -= el.textContent!.length\n          })\n        }\n      }\n\n      if (\n        domNode &&\n        offset === domNode.textContent!.length &&\n        // COMPAT: Android IMEs might remove the zero width space while composing,\n        // and we don't add it for line-breaks.\n        IS_ANDROID &&\n        domNode.getAttribute('data-slate-zero-width') === 'z' &&\n        domNode.textContent?.startsWith('\\uFEFF') &&\n        // COMPAT: If the parent node is a Slate zero-width space, editor is\n        // because the text node should have no characters. However, during IME\n        // composition the ASCII characters will be prepended to the zero-width\n        // space, so subtract 1 from the offset to account for the zero-width\n        // space character.\n        (parentNode.hasAttribute('data-slate-zero-width') ||\n          // COMPAT: In Firefox, `range.cloneContents()` returns an extra trailing '\\n'\n          // when the document ends with a new-line character. This results in the offset\n          // length being off by one, so we need to subtract one to account for this.\n          (IS_FIREFOX && domNode.textContent?.endsWith('\\n\\n')))\n      ) {\n        offset--\n      }\n    }\n\n    if (IS_ANDROID && !textNode && !exactMatch) {\n      const node = parentNode.hasAttribute('data-slate-node')\n        ? parentNode\n        : parentNode.closest('[data-slate-node]')\n\n      if (node && ReactEditor.hasDOMNode(editor, node, { editable: true })) {\n        const slateNode = ReactEditor.toSlateNode(editor, node)\n        let { path, offset } = Editor.start(\n          editor,\n          ReactEditor.findPath(editor, slateNode)\n        )\n\n        if (!node.querySelector('[data-slate-leaf]')) {\n          offset = nearestOffset\n        }\n\n        return { path, offset } as T extends true ? Point | null : Point\n      }\n    }\n\n    if (!textNode) {\n      if (suppressThrow) {\n        return null as T extends true ? Point | null : Point\n      }\n      throw new Error(\n        `Cannot resolve a Slate point from DOM point: ${domPoint}`\n      )\n    }\n\n    // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n    const slateNode = ReactEditor.toSlateNode(editor, textNode!)\n    const path = ReactEditor.findPath(editor, slateNode)\n    return { path, offset } as T extends true ? Point | null : Point\n  },\n\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Range | null : Range => {\n    const { exactMatch, suppressThrow } = options\n    const el = isDOMSelection(domRange)\n      ? domRange.anchorNode\n      : domRange.startContainer\n    let anchorNode\n    let anchorOffset\n    let focusNode\n    let focusOffset\n    let isCollapsed\n\n    if (el) {\n      if (isDOMSelection(domRange)) {\n        // COMPAT: In firefox the normal seletion way does not work\n        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n        if (IS_FIREFOX && domRange.rangeCount > 1) {\n          focusNode = domRange.focusNode // Focus node works fine\n          const firstRange = domRange.getRangeAt(0)\n          const lastRange = domRange.getRangeAt(domRange.rangeCount - 1)\n\n          // Right to left\n          if (firstRange.startContainer === focusNode) {\n            anchorNode = lastRange.endContainer\n            anchorOffset = lastRange.endOffset\n            focusOffset = firstRange.startOffset\n          } else {\n            // Left to right\n            anchorNode = firstRange.startContainer\n            anchorOffset = firstRange.endOffset\n            focusOffset = lastRange.startOffset\n          }\n        } else {\n          anchorNode = domRange.anchorNode\n          anchorOffset = domRange.anchorOffset\n          focusNode = domRange.focusNode\n          focusOffset = domRange.focusOffset\n        }\n\n        // COMPAT: There's a bug in chrome that always returns `true` for\n        // `isCollapsed` for a Selection that comes from a ShadowRoot.\n        // (2020/08/08)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n        // IsCollapsed might not work in firefox, but this will\n        if ((IS_CHROME && hasShadowRoot(anchorNode)) || IS_FIREFOX) {\n          isCollapsed =\n            domRange.anchorNode === domRange.focusNode &&\n            domRange.anchorOffset === domRange.focusOffset\n        } else {\n          isCollapsed = domRange.isCollapsed\n        }\n      } else {\n        anchorNode = domRange.startContainer\n        anchorOffset = domRange.startOffset\n        focusNode = domRange.endContainer\n        focusOffset = domRange.endOffset\n        isCollapsed = domRange.collapsed\n      }\n    }\n\n    if (\n      anchorNode == null ||\n      focusNode == null ||\n      anchorOffset == null ||\n      focusOffset == null\n    ) {\n      throw new Error(\n        `Cannot resolve a Slate range from DOM range: ${domRange}`\n      )\n    }\n\n    // COMPAT: Triple-clicking a word in chrome will sometimes place the focus\n    // inside a `contenteditable=\"false\"` DOM node following the word, which\n    // will cause `toSlatePoint` to throw an error. (2023/03/07)\n    if (\n      'getAttribute' in focusNode &&\n      (focusNode as HTMLElement).getAttribute('contenteditable') === 'false' &&\n      (focusNode as HTMLElement).getAttribute('data-slate-void') !== 'true'\n    ) {\n      focusNode = anchorNode\n      focusOffset = anchorNode.textContent?.length || 0\n    }\n\n    const anchor = ReactEditor.toSlatePoint(\n      editor,\n      [anchorNode, anchorOffset],\n      {\n        exactMatch,\n        suppressThrow,\n      }\n    )\n    if (!anchor) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    const focus = isCollapsed\n      ? anchor\n      : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset], {\n          exactMatch,\n          suppressThrow,\n        })\n    if (!focus) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    let range: Range = { anchor: anchor as Point, focus: focus as Point }\n    // if the selection is a hanging range that ends in a void\n    // and the DOM focus is an Element\n    // (meaning that the selection ends before the element)\n    // unhang the range to avoid mistakenly including the void\n    if (\n      Range.isExpanded(range) &&\n      Range.isForward(range) &&\n      isDOMElement(focusNode) &&\n      Editor.void(editor, { at: range.focus, mode: 'highest' })\n    ) {\n      range = Editor.unhangRange(editor, range, { voids: true })\n    }\n\n    return (range as unknown) as T extends true ? Range | null : Range\n  },\n}\n","import {\n  Editor,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Text,\n  Element,\n} from 'slate'\nimport { EDITOR_TO_PENDING_DIFFS } from './weak-maps'\n\nexport type StringDiff = {\n  start: number\n  end: number\n  text: string\n}\n\nexport type TextDiff = {\n  id: number\n  path: Path\n  diff: StringDiff\n}\n\n/**\n * Check whether a text diff was applied in a way we can perform the pending action on /\n * recover the pending selection.\n */\nexport function verifyDiffState(editor: Editor, textDiff: TextDiff): boolean {\n  const { path, diff } = textDiff\n  if (!Editor.hasPath(editor, path)) {\n    return false\n  }\n\n  const node = Node.get(editor, path)\n  if (!Text.isText(node)) {\n    return false\n  }\n\n  if (diff.start !== node.text.length || diff.text.length === 0) {\n    return (\n      node.text.slice(diff.start, diff.start + diff.text.length) === diff.text\n    )\n  }\n\n  const nextPath = Path.next(path)\n  if (!Editor.hasPath(editor, nextPath)) {\n    return false\n  }\n\n  const nextNode = Node.get(editor, nextPath)\n  return Text.isText(nextNode) && nextNode.text.startsWith(diff.text)\n}\n\nexport function applyStringDiff(text: string, ...diffs: StringDiff[]) {\n  return diffs.reduce(\n    (text, diff) =>\n      text.slice(0, diff.start) + diff.text + text.slice(diff.end),\n    text\n  )\n}\n\nfunction longestCommonPrefixLength(str: string, another: string) {\n  const length = Math.min(str.length, another.length)\n\n  for (let i = 0; i < length; i++) {\n    if (str.charAt(i) !== another.charAt(i)) {\n      return i\n    }\n  }\n\n  return length\n}\n\nfunction longestCommonSuffixLength(\n  str: string,\n  another: string,\n  max: number\n): number {\n  const length = Math.min(str.length, another.length, max)\n\n  for (let i = 0; i < length; i++) {\n    if (\n      str.charAt(str.length - i - 1) !== another.charAt(another.length - i - 1)\n    ) {\n      return i\n    }\n  }\n\n  return length\n}\n\n/**\n * Remove redundant changes from the diff so that it spans the minimal possible range\n */\nexport function normalizeStringDiff(targetText: string, diff: StringDiff) {\n  const { start, end, text } = diff\n  const removedText = targetText.slice(start, end)\n\n  const prefixLength = longestCommonPrefixLength(removedText, text)\n  const max = Math.min(\n    removedText.length - prefixLength,\n    text.length - prefixLength\n  )\n  const suffixLength = longestCommonSuffixLength(removedText, text, max)\n\n  const normalized: StringDiff = {\n    start: start + prefixLength,\n    end: end - suffixLength,\n    text: text.slice(prefixLength, text.length - suffixLength),\n  }\n\n  if (normalized.start === normalized.end && normalized.text.length === 0) {\n    return null\n  }\n\n  return normalized\n}\n\n/**\n * Return a string diff that is equivalent to applying b after a spanning the range of\n * both changes\n */\nexport function mergeStringDiffs(\n  targetText: string,\n  a: StringDiff,\n  b: StringDiff\n): StringDiff | null {\n  const start = Math.min(a.start, b.start)\n  const overlap = Math.max(\n    0,\n    Math.min(a.start + a.text.length, b.end) - b.start\n  )\n\n  const applied = applyStringDiff(targetText, a, b)\n  const sliceEnd = Math.max(\n    b.start + b.text.length,\n    a.start +\n      a.text.length +\n      (a.start + a.text.length > b.start ? b.text.length : 0) -\n      overlap\n  )\n\n  const text = applied.slice(start, sliceEnd)\n  const end = Math.max(a.end, b.end - a.text.length + (a.end - a.start))\n  return normalizeStringDiff(targetText, { start, end, text })\n}\n\n/**\n * Get the slate range the text diff spans.\n */\nexport function targetRange(textDiff: TextDiff): Range {\n  const { path, diff } = textDiff\n  return {\n    anchor: { path, offset: diff.start },\n    focus: { path, offset: diff.end },\n  }\n}\n\n/**\n * Normalize a 'pending point' a.k.a a point based on the dom state before applying\n * the pending diffs. Since the pending diffs might have been inserted with different\n * marks we have to 'walk' the offset from the starting position to ensure we still\n * have a valid point inside the document\n */\nexport function normalizePoint(editor: Editor, point: Point): Point | null {\n  let { path, offset } = point\n  if (!Editor.hasPath(editor, path)) {\n    return null\n  }\n\n  let leaf = Node.get(editor, path)\n  if (!Text.isText(leaf)) {\n    return null\n  }\n\n  const parentBlock = Editor.above(editor, {\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n    at: path,\n  })\n\n  if (!parentBlock) {\n    return null\n  }\n\n  while (offset > leaf.text.length) {\n    const entry = Editor.next(editor, { at: path, match: Text.isText })\n    if (!entry || !Path.isDescendant(entry[1], parentBlock[1])) {\n      return null\n    }\n\n    offset -= leaf.text.length\n    leaf = entry[0]\n    path = entry[1]\n  }\n\n  return { path, offset }\n}\n\n/**\n * Normalize a 'pending selection' to ensure it's valid in the current document state.\n */\nexport function normalizeRange(editor: Editor, range: Range): Range | null {\n  const anchor = normalizePoint(editor, range.anchor)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = normalizePoint(editor, range.focus)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformPendingPoint(\n  editor: Editor,\n  point: Point,\n  op: Operation\n): Point | null {\n  const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n  const textDiff = pendingDiffs?.find(({ path }) =>\n    Path.equals(path, point.path)\n  )\n\n  if (!textDiff || point.offset <= textDiff.diff.start) {\n    return Point.transform(point, op, { affinity: 'backward' })\n  }\n\n  const { diff } = textDiff\n  // Point references location inside the diff => transform the point based on the location\n  // the diff will be applied to and add the offset inside the diff.\n  if (point.offset <= diff.start + diff.text.length) {\n    const anchor = { path: point.path, offset: diff.start }\n    const transformed = Point.transform(anchor, op, {\n      affinity: 'backward',\n    })\n\n    if (!transformed) {\n      return null\n    }\n\n    return {\n      path: transformed.path,\n      offset: transformed.offset + point.offset - diff.start,\n    }\n  }\n\n  // Point references location after the diff\n  const anchor = {\n    path: point.path,\n    offset: point.offset - diff.text.length + diff.end - diff.start,\n  }\n  const transformed = Point.transform(anchor, op, {\n    affinity: 'backward',\n  })\n  if (!transformed) {\n    return null\n  }\n\n  if (\n    op.type === 'split_node' &&\n    Path.equals(op.path, point.path) &&\n    anchor.offset < op.position &&\n    diff.start < op.position\n  ) {\n    return transformed\n  }\n\n  return {\n    path: transformed.path,\n    offset: transformed.offset + diff.text.length - diff.end + diff.start,\n  }\n}\n\nexport function transformPendingRange(\n  editor: Editor,\n  range: Range,\n  op: Operation\n): Range | null {\n  const anchor = transformPendingPoint(editor, range.anchor, op)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = transformPendingPoint(editor, range.focus, op)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformTextDiff(\n  textDiff: TextDiff,\n  op: Operation\n): TextDiff | null {\n  const { path, diff, id } = textDiff\n\n  switch (op.type) {\n    case 'insert_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset <= diff.start) {\n        return {\n          diff: {\n            start: op.text.length + diff.start,\n            end: op.text.length + diff.end,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end + op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'remove_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset + op.text.length <= diff.start) {\n        return {\n          diff: {\n            start: diff.start - op.text.length,\n            end: diff.end - op.text.length,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end - op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'split_node': {\n      if (!Path.equals(op.path, path) || op.position >= diff.end) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op, { affinity: 'backward' })!,\n        }\n      }\n\n      if (op.position > diff.start) {\n        return {\n          diff: {\n            start: diff.start,\n            end: Math.min(op.position, diff.end),\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start - op.position,\n          end: diff.end - op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op, { affinity: 'forward' })!,\n      }\n    }\n    case 'merge_node': {\n      if (!Path.equals(op.path, path)) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op)!,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start + op.position,\n          end: diff.end + op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op)!,\n      }\n    }\n  }\n\n  const newPath = Path.transform(path, op)\n  if (!newPath) {\n    return null\n  }\n\n  return {\n    diff,\n    path: newPath,\n    id,\n  }\n}\n","import { DebouncedFunc } from 'lodash'\nimport { Editor, Node, Path, Point, Range, Text, Transforms } from 'slate'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport {\n  applyStringDiff,\n  mergeStringDiffs,\n  normalizePoint,\n  normalizeRange,\n  normalizeStringDiff,\n  StringDiff,\n  targetRange,\n  TextDiff,\n  verifyDiffState,\n} from '../../utils/diff-text'\nimport { isDOMSelection, isTrackedMutation } from '../../utils/dom'\nimport {\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_USER_MARKS,\n  IS_COMPOSING,\n} from '../../utils/weak-maps'\n\nexport type Action = { at?: Point | Range; run: () => void }\n\n// https://github.com/facebook/draft-js/blob/main/src/component/handlers/composition/DraftEditorCompositionHandler.js#L41\n// When using keyboard English association function, conpositionEnd triggered too fast, resulting in after `insertText` still maintain association state.\nconst RESOLVE_DELAY = 25\n\n// Time with no user interaction before the current user action is considered as done.\nconst FLUSH_DELAY = 200\n\n// Replace with `const debug = console.log` to debug\nconst debug = (..._: unknown[]) => {}\n\n// Type guard to check if a value is a DataTransfer\nconst isDataTransfer = (value: any): value is DataTransfer =>\n  value?.constructor.name === 'DataTransfer'\n\nexport type CreateAndroidInputManagerOptions = {\n  editor: ReactEditor\n\n  scheduleOnDOMSelectionChange: DebouncedFunc<() => void>\n  onDOMSelectionChange: DebouncedFunc<() => void>\n}\n\nexport type AndroidInputManager = {\n  flush: () => void\n  scheduleFlush: () => void\n\n  hasPendingDiffs: () => boolean\n  hasPendingAction: () => boolean\n  hasPendingChanges: () => boolean\n  isFlushing: () => boolean | 'action'\n\n  handleUserSelect: (range: Range | null) => void\n  handleCompositionEnd: (event: React.CompositionEvent<HTMLDivElement>) => void\n  handleCompositionStart: (\n    event: React.CompositionEvent<HTMLDivElement>\n  ) => void\n  handleDOMBeforeInput: (event: InputEvent) => void\n  handleKeyDown: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  handleDomMutations: (mutations: MutationRecord[]) => void\n  handleInput: () => void\n}\n\nexport function createAndroidInputManager({\n  editor,\n  scheduleOnDOMSelectionChange,\n  onDOMSelectionChange,\n}: CreateAndroidInputManagerOptions): AndroidInputManager {\n  let flushing: 'action' | boolean = false\n  let compositionEndTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let flushTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let actionTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  let idCounter = 0\n  let insertPositionHint: StringDiff | null | false = false\n\n  const applyPendingSelection = () => {\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(editor)\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n\n    if (pendingSelection) {\n      const { selection } = editor\n      const normalized = normalizeRange(editor, pendingSelection)\n\n      debug('apply pending selection', pendingSelection, normalized)\n\n      if (normalized && (!selection || !Range.equals(normalized, selection))) {\n        Transforms.select(editor, normalized)\n      }\n    }\n  }\n\n  const performAction = () => {\n    const action = EDITOR_TO_PENDING_ACTION.get(editor)\n    EDITOR_TO_PENDING_ACTION.delete(editor)\n    if (!action) {\n      return\n    }\n\n    if (action.at) {\n      const target = Point.isPoint(action.at)\n        ? normalizePoint(editor, action.at)\n        : normalizeRange(editor, action.at)\n\n      if (!target) {\n        return\n      }\n\n      const targetRange = Editor.range(editor, target)\n      if (!editor.selection || !Range.equals(editor.selection, targetRange)) {\n        Transforms.select(editor, target)\n      }\n    }\n\n    action.run()\n  }\n\n  const flush = () => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    if (actionTimeoutId) {\n      clearTimeout(actionTimeoutId)\n      actionTimeoutId = null\n    }\n\n    if (!hasPendingDiffs() && !hasPendingAction()) {\n      applyPendingSelection()\n      return\n    }\n\n    if (!flushing) {\n      flushing = true\n      setTimeout(() => (flushing = false))\n    }\n\n    if (hasPendingAction()) {\n      flushing = 'action'\n    }\n\n    const selectionRef =\n      editor.selection &&\n      Editor.rangeRef(editor, editor.selection, { affinity: 'forward' })\n    EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n\n    debug(\n      'flush',\n      EDITOR_TO_PENDING_ACTION.get(editor),\n      EDITOR_TO_PENDING_DIFFS.get(editor)\n    )\n\n    let scheduleSelectionChange = hasPendingDiffs()\n\n    let diff: TextDiff | undefined\n    while ((diff = EDITOR_TO_PENDING_DIFFS.get(editor)?.[0])) {\n      const pendingMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)\n\n      if (pendingMarks !== undefined) {\n        EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n        editor.marks = pendingMarks\n      }\n\n      if (pendingMarks && insertPositionHint === false) {\n        insertPositionHint = null\n        debug('insert after mark placeholder')\n      }\n\n      const range = targetRange(diff)\n      if (!editor.selection || !Range.equals(editor.selection, range)) {\n        Transforms.select(editor, range)\n      }\n\n      if (diff.diff.text) {\n        Editor.insertText(editor, diff.diff.text)\n      } else {\n        Editor.deleteFragment(editor)\n      }\n\n      // Remove diff only after we have applied it to account for it when transforming\n      // pending ranges.\n      EDITOR_TO_PENDING_DIFFS.set(\n        editor,\n        EDITOR_TO_PENDING_DIFFS.get(editor)?.filter(\n          ({ id }) => id !== diff!.id\n        )!\n      )\n\n      if (!verifyDiffState(editor, diff)) {\n        debug('invalid diff state')\n        scheduleSelectionChange = false\n        EDITOR_TO_PENDING_ACTION.delete(editor)\n        EDITOR_TO_USER_MARKS.delete(editor)\n        flushing = 'action'\n\n        // Ensure we don't restore the pending user (dom) selection\n        // since the document and dom state do not match.\n        EDITOR_TO_PENDING_SELECTION.delete(editor)\n        scheduleOnDOMSelectionChange.cancel()\n        onDOMSelectionChange.cancel()\n        selectionRef?.unref()\n      }\n    }\n\n    const selection = selectionRef?.unref()\n    if (\n      selection &&\n      !EDITOR_TO_PENDING_SELECTION.get(editor) &&\n      (!editor.selection || !Range.equals(selection, editor.selection))\n    ) {\n      Transforms.select(editor, selection)\n    }\n\n    if (hasPendingAction()) {\n      performAction()\n      return\n    }\n\n    // COMPAT: The selectionChange event is fired after the action is performed,\n    // so we have to manually schedule it to ensure we don't 'throw away' the selection\n    // while rendering if we have pending changes.\n    if (scheduleSelectionChange) {\n      debug('scheduleOnDOMSelectionChange pending changes')\n      scheduleOnDOMSelectionChange()\n    }\n\n    scheduleOnDOMSelectionChange.flush()\n    onDOMSelectionChange.flush()\n\n    applyPendingSelection()\n\n    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n    EDITOR_TO_USER_MARKS.delete(editor)\n    if (userMarks !== undefined) {\n      editor.marks = userMarks\n      editor.onChange()\n    }\n  }\n\n  const handleCompositionEnd = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n    }\n\n    compositionEndTimeoutId = setTimeout(() => {\n      IS_COMPOSING.set(editor, false)\n      flush()\n    }, RESOLVE_DELAY)\n  }\n\n  const handleCompositionStart = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    debug('composition start')\n\n    IS_COMPOSING.set(editor, true)\n\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n      compositionEndTimeoutId = null\n    }\n  }\n\n  const updatePlaceholderVisibility = (forceHide = false) => {\n    const placeholderElement = EDITOR_TO_PLACEHOLDER_ELEMENT.get(editor)\n    if (!placeholderElement) {\n      return\n    }\n\n    if (hasPendingDiffs() || forceHide) {\n      placeholderElement.style.display = 'none'\n      return\n    }\n\n    placeholderElement.style.removeProperty('display')\n  }\n\n  const storeDiff = (path: Path, diff: StringDiff) => {\n    debug('storeDiff', path, diff)\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor) ?? []\n    EDITOR_TO_PENDING_DIFFS.set(editor, pendingDiffs)\n\n    const target = Node.leaf(editor, path)\n    const idx = pendingDiffs.findIndex(change => Path.equals(change.path, path))\n    if (idx < 0) {\n      const normalized = normalizeStringDiff(target.text, diff)\n      if (normalized) {\n        pendingDiffs.push({ path, diff, id: idCounter++ })\n      }\n\n      updatePlaceholderVisibility()\n      return\n    }\n\n    const merged = mergeStringDiffs(target.text, pendingDiffs[idx].diff, diff)\n    if (!merged) {\n      pendingDiffs.splice(idx, 1)\n      updatePlaceholderVisibility()\n      return\n    }\n\n    pendingDiffs[idx] = {\n      ...pendingDiffs[idx],\n      diff: merged,\n    }\n  }\n\n  const scheduleAction = (\n    run: () => void,\n    { at }: { at?: Point | Range } = {}\n  ): void => {\n    insertPositionHint = false\n    debug('scheduleAction', { at, run })\n\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n    scheduleOnDOMSelectionChange.cancel()\n    onDOMSelectionChange.cancel()\n\n    if (hasPendingAction()) {\n      flush()\n    }\n\n    EDITOR_TO_PENDING_ACTION.set(editor, { at, run })\n\n    // COMPAT: When deleting before a non-contenteditable element chrome only fires a beforeinput,\n    // (no input) and doesn't perform any dom mutations. Without a flush timeout we would never flush\n    // in this case and thus never actually perform the action.\n    actionTimeoutId = setTimeout(flush)\n  }\n\n  const handleDOMBeforeInput = (event: InputEvent): void => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { inputType: type } = event\n    let targetRange: Range | null = null\n    const data: DataTransfer | string | undefined =\n      (event as any).dataTransfer || event.data || undefined\n\n    if (\n      insertPositionHint !== false &&\n      type !== 'insertText' &&\n      type !== 'insertCompositionText'\n    ) {\n      insertPositionHint = false\n    }\n\n    let [nativeTargetRange] = (event as any).getTargetRanges()\n    if (nativeTargetRange) {\n      targetRange = ReactEditor.toSlateRange(editor, nativeTargetRange, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    // COMPAT: SelectionChange event is fired after the action is performed, so we\n    // have to manually get the selection here to ensure it's up-to-date.\n    const window = ReactEditor.getWindow(editor)\n    const domSelection = window.getSelection()\n    if (!targetRange && domSelection) {\n      nativeTargetRange = domSelection\n      targetRange = ReactEditor.toSlateRange(editor, domSelection, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    targetRange = targetRange ?? editor.selection\n    if (!targetRange) {\n      return\n    }\n\n    // By default, the input manager tries to store text diffs so that we can\n    // defer flushing them at a later point in time. We don't want to flush\n    // for every input event as this can be expensive. However, there are some\n    // scenarios where we cannot safely store the text diff and must instead\n    // schedule an action to let Slate normalize the editor state.\n    let canStoreDiff = true\n\n    if (type.startsWith('delete')) {\n      if (Range.isExpanded(targetRange)) {\n        const [start, end] = Range.edges(targetRange)\n        const leaf = Node.leaf(editor, start.path)\n\n        if (leaf.text.length === start.offset && end.offset === 0) {\n          const next = Editor.next(editor, {\n            at: start.path,\n            match: Text.isText,\n          })\n          if (next && Path.equals(next[1], end.path)) {\n            targetRange = { anchor: end, focus: end }\n          }\n        }\n      }\n\n      const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n      const [start, end] = Range.edges(targetRange)\n      const [leaf, path] = Editor.leaf(editor, start.path)\n\n      const diff = {\n        text: '',\n        start: start.offset,\n        end: end.offset,\n      }\n      const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n      const relevantPendingDiffs = pendingDiffs?.find(change =>\n        Path.equals(change.path, path)\n      )\n      const diffs = relevantPendingDiffs\n        ? [relevantPendingDiffs.diff, diff]\n        : [diff]\n      const text = applyStringDiff(leaf.text, ...diffs)\n\n      if (text.length === 0) {\n        // Text leaf will be removed, so we need to schedule an\n        // action to remove it so that Slate can normalize instead\n        // of storing as a diff\n        canStoreDiff = false\n      }\n\n      if (Range.isExpanded(targetRange)) {\n        if (\n          canStoreDiff &&\n          Path.equals(targetRange.anchor.path, targetRange.focus.path)\n        ) {\n          const point = { path: targetRange.anchor.path, offset: start.offset }\n          const range = Editor.range(editor, point, point)\n          handleUserSelect(range)\n\n          return storeDiff(targetRange.anchor.path, {\n            text: '',\n            end: end.offset,\n            start: start.offset,\n          })\n        }\n\n        return scheduleAction(\n          () => Editor.deleteFragment(editor, { direction }),\n          { at: targetRange }\n        )\n      }\n    }\n\n    switch (type) {\n      case 'deleteByComposition':\n      case 'deleteByCut':\n      case 'deleteByDrag': {\n        return scheduleAction(() => Editor.deleteFragment(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContent':\n      case 'deleteContentForward': {\n        const { anchor } = targetRange\n        if (canStoreDiff && Range.isCollapsed(targetRange)) {\n          const targetNode = Node.leaf(editor, anchor.path)\n\n          if (anchor.offset < targetNode.text.length) {\n            return storeDiff(anchor.path, {\n              text: '',\n              start: anchor.offset,\n              end: anchor.offset + 1,\n            })\n          }\n        }\n\n        return scheduleAction(() => Editor.deleteForward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContentBackward': {\n        const { anchor } = targetRange\n\n        // If we have a mismatch between the native and slate selection being collapsed\n        // we are most likely deleting a zero-width placeholder and thus should perform it\n        // as an action to ensure correct behavior (mostly happens with mark placeholders)\n        const nativeCollapsed = isDOMSelection(nativeTargetRange)\n          ? nativeTargetRange.isCollapsed\n          : !!nativeTargetRange?.collapsed\n\n        if (\n          canStoreDiff &&\n          nativeCollapsed &&\n          Range.isCollapsed(targetRange) &&\n          anchor.offset > 0\n        ) {\n          return storeDiff(anchor.path, {\n            text: '',\n            start: anchor.offset - 1,\n            end: anchor.offset,\n          })\n        }\n\n        return scheduleAction(() => Editor.deleteBackward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteEntireSoftLine': {\n        return scheduleAction(\n          () => {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n          },\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'insertLineBreak': {\n        return scheduleAction(() => Editor.insertSoftBreak(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'insertParagraph': {\n        return scheduleAction(() => Editor.insertBreak(editor), {\n          at: targetRange,\n        })\n      }\n      case 'insertCompositionText':\n      case 'deleteCompositionText':\n      case 'insertFromComposition':\n      case 'insertFromDrop':\n      case 'insertFromPaste':\n      case 'insertFromYank':\n      case 'insertReplacementText':\n      case 'insertText': {\n        if (isDataTransfer(data)) {\n          return scheduleAction(() => ReactEditor.insertData(editor, data), {\n            at: targetRange,\n          })\n        }\n\n        let text = data ?? ''\n\n        // COMPAT: If we are writing inside a placeholder, the ime inserts the text inside\n        // the placeholder itself and thus includes the zero-width space inside edit events.\n        if (EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)) {\n          text = text.replace('\\uFEFF', '')\n        }\n\n        // Pastes from the Android clipboard will generate `insertText` events.\n        // If the copied text contains any newlines, Android will append an\n        // extra newline to the end of the copied text.\n        if (type === 'insertText' && /.*\\n.*\\n$/.test(text)) {\n          text = text.slice(0, -1)\n        }\n\n        // If the text includes a newline, split it at newlines and paste each component\n        // string, with soft breaks in between each.\n        if (text.includes('\\n')) {\n          return scheduleAction(\n            () => {\n              const parts = text.split('\\n')\n              parts.forEach((line, i) => {\n                if (line) {\n                  Editor.insertText(editor, line)\n                }\n                if (i !== parts.length - 1) {\n                  Editor.insertSoftBreak(editor)\n                }\n              })\n            },\n            {\n              at: targetRange,\n            }\n          )\n        }\n\n        if (Path.equals(targetRange.anchor.path, targetRange.focus.path)) {\n          const [start, end] = Range.edges(targetRange)\n\n          const diff = {\n            start: start.offset,\n            end: end.offset,\n            text,\n          }\n\n          // COMPAT: Swiftkey has a weird bug where the target range of the 2nd word\n          // inserted after a mark placeholder is inserted with an anchor offset off by 1.\n          // So writing 'some text' will result in 'some ttext'. Luckily all 'normal' insert\n          // text events are fired with the correct target ranges, only the final 'insertComposition'\n          // isn't, so we can adjust the target range start offset if we are confident this is the\n          // swiftkey insert causing the issue.\n          if (text && insertPositionHint && type === 'insertCompositionText') {\n            const hintPosition =\n              insertPositionHint.start + insertPositionHint.text.search(/\\S|$/)\n            const diffPosition = diff.start + diff.text.search(/\\S|$/)\n\n            if (\n              diffPosition === hintPosition + 1 &&\n              diff.end ===\n                insertPositionHint.start + insertPositionHint.text.length\n            ) {\n              debug('adjusting swiftKey insert position using hint')\n              diff.start -= 1\n              insertPositionHint = null\n              scheduleFlush()\n            } else {\n              insertPositionHint = false\n            }\n          } else if (type === 'insertText') {\n            if (insertPositionHint === null) {\n              insertPositionHint = diff\n            } else if (\n              insertPositionHint &&\n              Range.isCollapsed(targetRange) &&\n              insertPositionHint.end + insertPositionHint.text.length ===\n                start.offset\n            ) {\n              insertPositionHint = {\n                ...insertPositionHint,\n                text: insertPositionHint.text + text,\n              }\n            } else {\n              insertPositionHint = false\n            }\n          } else {\n            insertPositionHint = false\n          }\n\n          if (canStoreDiff) {\n            storeDiff(start.path, diff)\n            return\n          }\n        }\n\n        return scheduleAction(() => Editor.insertText(editor, text), {\n          at: targetRange,\n        })\n      }\n    }\n  }\n\n  const hasPendingAction = () => {\n    return !!EDITOR_TO_PENDING_ACTION.get(editor)\n  }\n\n  const hasPendingDiffs = () => {\n    return !!EDITOR_TO_PENDING_DIFFS.get(editor)?.length\n  }\n\n  const hasPendingChanges = () => {\n    return hasPendingAction() || hasPendingDiffs()\n  }\n\n  const isFlushing = () => {\n    return flushing\n  }\n\n  const handleUserSelect = (range: Range | null) => {\n    EDITOR_TO_PENDING_SELECTION.set(editor, range)\n\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { selection } = editor\n    if (!range) {\n      return\n    }\n\n    const pathChanged =\n      !selection || !Path.equals(selection.anchor.path, range.anchor.path)\n    const parentPathChanged =\n      !selection ||\n      !Path.equals(\n        selection.anchor.path.slice(0, -1),\n        range.anchor.path.slice(0, -1)\n      )\n\n    if ((pathChanged && insertPositionHint) || parentPathChanged) {\n      insertPositionHint = false\n    }\n\n    if (pathChanged || hasPendingDiffs()) {\n      flushTimeoutId = setTimeout(flush, FLUSH_DELAY)\n    }\n  }\n\n  const handleInput = () => {\n    if (hasPendingAction() || !hasPendingDiffs()) {\n      debug('flush input')\n      flush()\n    }\n  }\n\n  const handleKeyDown = (_: React.KeyboardEvent) => {\n    // COMPAT: Swiftkey closes the keyboard when typing inside a empty node\n    // directly next to a non-contenteditable element (= the placeholder).\n    // The only event fired soon enough for us to allow hiding the placeholder\n    // without swiftkey picking it up is the keydown event, so we have to hide it\n    // here. See https://github.com/ianstormtaylor/slate/pull/4988#issuecomment-1201050535\n    if (!hasPendingDiffs()) {\n      updatePlaceholderVisibility(true)\n      setTimeout(updatePlaceholderVisibility)\n    }\n  }\n\n  const scheduleFlush = () => {\n    if (!hasPendingAction()) {\n      actionTimeoutId = setTimeout(flush)\n    }\n  }\n\n  const handleDomMutations = (mutations: MutationRecord[]) => {\n    if (hasPendingDiffs() || hasPendingAction()) {\n      return\n    }\n\n    if (\n      mutations.some(mutation => isTrackedMutation(editor, mutation, mutations))\n    ) {\n      // Cause a re-render to restore the dom state if we encounter tracked mutations without\n      // a corresponding pending action.\n      EDITOR_TO_FORCE_RENDER.get(editor)?.()\n    }\n  }\n\n  return {\n    flush,\n    scheduleFlush,\n\n    hasPendingDiffs,\n    hasPendingAction,\n    hasPendingChanges,\n\n    isFlushing,\n\n    handleUserSelect,\n    handleCompositionEnd,\n    handleCompositionStart,\n    handleDOMBeforeInput,\n    handleKeyDown,\n\n    handleDomMutations,\n    handleInput,\n  }\n}\n","import { useEffect, useRef } from 'react'\n\nexport function useIsMounted() {\n  const isMountedRef = useRef(false)\n\n  useEffect(() => {\n    isMountedRef.current = true\n    return () => {\n      isMountedRef.current = false\n    }\n  }, [])\n\n  return isMountedRef.current\n}\n","import { useLayoutEffect, useEffect } from 'react'\nimport { CAN_USE_DOM } from '../utils/environment'\n\n/**\n * Prevent warning on SSR by falling back to useEffect when DOM isn't available\n */\n\nexport const useIsomorphicLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect\n","import { RefObject, useEffect, useState } from 'react'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nexport function useMutationObserver(\n  node: RefObject<HTMLElement>,\n  callback: MutationCallback,\n  options: MutationObserverInit\n) {\n  const [mutationObserver] = useState(() => new MutationObserver(callback))\n\n  useIsomorphicLayoutEffect(() => {\n    // Discard mutations caused during render phase. This works due to react calling\n    // useLayoutEffect synchronously after the render phase before the next tick.\n    mutationObserver.takeRecords()\n  })\n\n  useEffect(() => {\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    mutationObserver.observe(node.current, options)\n    return () => mutationObserver.disconnect()\n  }, [mutationObserver, node, options])\n}\n","import { RefObject, useState } from 'react'\nimport { useSlateStatic } from '../use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport { EDITOR_TO_SCHEDULE_FLUSH } from '../../utils/weak-maps'\nimport {\n  createAndroidInputManager,\n  CreateAndroidInputManagerOptions,\n} from './android-input-manager'\nimport { useIsMounted } from '../use-is-mounted'\nimport { useMutationObserver } from '../use-mutation-observer'\n\ntype UseAndroidInputManagerOptions = {\n  node: RefObject<HTMLElement>\n} & Omit<\n  CreateAndroidInputManagerOptions,\n  'editor' | 'onUserInput' | 'receivedUserInput'\n>\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n}\n\nexport const useAndroidInputManager = !IS_ANDROID\n  ? () => null\n  : ({ node, ...options }: UseAndroidInputManagerOptions) => {\n      if (!IS_ANDROID) {\n        return null\n      }\n\n      const editor = useSlateStatic()\n      const isMounted = useIsMounted()\n\n      const [inputManager] = useState(() =>\n        createAndroidInputManager({\n          editor,\n          ...options,\n        })\n      )\n\n      useMutationObserver(\n        node,\n        inputManager.handleDomMutations,\n        MUTATION_OBSERVER_CONFIG\n      )\n\n      EDITOR_TO_SCHEDULE_FLUSH.set(editor, inputManager.scheduleFlush)\n      if (isMounted) {\n        inputManager.flush()\n      }\n\n      return inputManager\n    }\n","import { Range } from 'slate'\nimport { PLACEHOLDER_SYMBOL } from './weak-maps'\n\nexport const shallowCompare = (obj1: {}, obj2: {}) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every(\n    key => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]\n  )\n\nconst isDecorationFlagsEqual = (range: Range, other: Range) => {\n  const { anchor: rangeAnchor, focus: rangeFocus, ...rangeOwnProps } = range\n  const { anchor: otherAnchor, focus: otherFocus, ...otherOwnProps } = other\n\n  return (\n    range[PLACEHOLDER_SYMBOL] === other[PLACEHOLDER_SYMBOL] &&\n    shallowCompare(rangeOwnProps, otherOwnProps)\n  )\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isElementDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    if (!Range.equals(range, other) || !isDecorationFlagsEqual(range, other)) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isTextDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    // compare only offsets because paths doesn't matter for text\n    if (\n      range.anchor.offset !== other.anchor.offset ||\n      range.focus.offset !== other.focus.offset ||\n      !isDecorationFlagsEqual(range, other)\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n","import React, { forwardRef, memo, useRef, useState } from 'react'\nimport { Editor, Text, Path, Element, Node } from 'slate'\n\nimport { ReactEditor, useSlateStatic } from '..'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { IS_ANDROID } from '../utils/environment'\nimport { MARK_PLACEHOLDER_SYMBOL } from '../utils/weak-maps'\n\n/**\n * Leaf content strings.\n */\n\nconst String = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  text: Text\n}) => {\n  const { isLast, leaf, parent, text } = props\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, text)\n  const parentPath = Path.parent(path)\n  const isMarkPlaceholder = leaf[MARK_PLACEHOLDER_SYMBOL] === true\n\n  // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n  if (editor.isVoid(parent)) {\n    return <ZeroWidthString length={Node.string(parent).length} />\n  }\n\n  // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n  if (\n    leaf.text === '' &&\n    parent.children[parent.children.length - 1] === text &&\n    !editor.isInline(parent) &&\n    Editor.string(editor, parentPath) === ''\n  ) {\n    return <ZeroWidthString isLineBreak isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n  if (leaf.text === '') {\n    return <ZeroWidthString isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return <TextString isTrailing text={leaf.text} />\n  }\n\n  return <TextString text={leaf.text} />\n}\n\n/**\n * Leaf strings with text in them.\n */\nconst TextString = (props: { text: string; isTrailing?: boolean }) => {\n  const { text, isTrailing = false } = props\n  const ref = useRef<HTMLSpanElement>(null)\n  const getTextContent = () => {\n    return `${text ?? ''}${isTrailing ? '\\n' : ''}`\n  }\n  const [initialText] = useState(getTextContent)\n\n  // This is the actual text rendering boundary where we interface with the DOM\n  // The text is not rendered as part of the virtual DOM, as since we handle basic character insertions natively,\n  // updating the DOM is not a one way dataflow anymore. What we need here is not reconciliation and diffing\n  // with previous version of the virtual DOM, but rather diffing with the actual DOM element, and replace the DOM <span> content\n  // exactly if and only if its current content does not match our current virtual DOM.\n  // Otherwise the DOM TextNode would always be replaced by React as the user types, which interferes with native text features,\n  // eg makes native spellcheck opt out from checking the text node.\n\n  // useLayoutEffect: updating our span before browser paint\n  useIsomorphicLayoutEffect(() => {\n    // null coalescing text to make sure we're not outputing \"null\" as a string in the extreme case it is nullish at runtime\n    const textWithTrailing = getTextContent()\n\n    if (ref.current && ref.current.textContent !== textWithTrailing) {\n      ref.current.textContent = textWithTrailing\n    }\n\n    // intentionally not specifying dependencies, so that this effect runs on every render\n    // as this effectively replaces \"specifying the text in the virtual DOM under the <span> below\" on each render\n  })\n\n  // We intentionally render a memoized <span> that only receives the initial text content when the component is mounted.\n  // We defer to the layout effect above to update the `textContent` of the span element when needed.\n  return <MemoizedText ref={ref}>{initialText}</MemoizedText>\n}\n\nconst MemoizedText = memo(\n  forwardRef<HTMLSpanElement, { children: string }>((props, ref) => {\n    return (\n      <span data-slate-string ref={ref}>\n        {props.children}\n      </span>\n    )\n  })\n)\n\n/**\n * Leaf strings without text, render as zero-width strings.\n */\n\nexport const ZeroWidthString = (props: {\n  length?: number\n  isLineBreak?: boolean\n  isMarkPlaceholder?: boolean\n}) => {\n  const { length = 0, isLineBreak = false, isMarkPlaceholder = false } = props\n\n  const attributes = {\n    'data-slate-zero-width': isLineBreak ? 'n' : 'z',\n    'data-slate-length': length,\n  }\n\n  if (isMarkPlaceholder) {\n    attributes['data-slate-mark-placeholder'] = true\n  }\n\n  return (\n    <span {...attributes}>\n      {!IS_ANDROID || !isLineBreak ? '\\uFEFF' : null}\n      {isLineBreak ? <br /> : null}\n    </span>\n  )\n}\n\nexport default String\n","import React, {\n  useRef,\n  useCallback,\n  MutableRefObject,\n  useState,\n  useEffect,\n} from 'react'\nimport { Element, Text } from 'slate'\nimport { ResizeObserver as ResizeObserverPolyfill } from '@juggle/resize-observer'\nimport String from './string'\nimport {\n  PLACEHOLDER_SYMBOL,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport { useSlateStatic } from '../hooks/use-slate-static'\nimport { IS_WEBKIT } from '../utils/environment'\n\nfunction disconnectPlaceholderResizeObserver(\n  placeholderResizeObserver: MutableRefObject<ResizeObserver | null>,\n  releaseObserver: boolean\n) {\n  if (placeholderResizeObserver.current) {\n    placeholderResizeObserver.current.disconnect()\n    if (releaseObserver) {\n      placeholderResizeObserver.current = null\n    }\n  }\n}\n\ntype TimerId = ReturnType<typeof setTimeout> | null\n\nfunction clearTimeoutRef(timeoutRef: MutableRefObject<TimerId>) {\n  if (timeoutRef.current) {\n    clearTimeout(timeoutRef.current)\n    timeoutRef.current = null\n  }\n}\n\n/**\n * Individual leaves in a text node with unique formatting.\n */\nconst Leaf = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: Text\n}) => {\n  const {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderPlaceholder,\n    renderLeaf = (props: RenderLeafProps) => <DefaultLeaf {...props} />,\n  } = props\n\n  const editor = useSlateStatic()\n  const placeholderResizeObserver = useRef<ResizeObserver | null>(null)\n  const placeholderRef = useRef<HTMLElement | null>(null)\n  const [showPlaceholder, setShowPlaceholder] = useState(false)\n  const showPlaceholderTimeoutRef = useRef<TimerId>(null)\n\n  const callbackPlaceholderRef = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      disconnectPlaceholderResizeObserver(\n        placeholderResizeObserver,\n        placeholderEl == null\n      )\n\n      if (placeholderEl == null) {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.delete(editor)\n        leaf.onPlaceholderResize?.(null)\n      } else {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.set(editor, placeholderEl)\n\n        if (!placeholderResizeObserver.current) {\n          // Create a new observer and observe the placeholder element.\n          const ResizeObserver = window.ResizeObserver || ResizeObserverPolyfill\n          placeholderResizeObserver.current = new ResizeObserver(() => {\n            leaf.onPlaceholderResize?.(placeholderEl)\n          })\n        }\n        placeholderResizeObserver.current.observe(placeholderEl)\n        placeholderRef.current = placeholderEl\n      }\n    },\n    [placeholderRef, leaf, editor]\n  )\n\n  let children = (\n    <String isLast={isLast} leaf={leaf} parent={parent} text={text} />\n  )\n\n  const leafIsPlaceholder = leaf[PLACEHOLDER_SYMBOL]\n  useEffect(() => {\n    if (leafIsPlaceholder) {\n      if (!showPlaceholderTimeoutRef.current) {\n        // Delay the placeholder so it will not render in a selection\n        showPlaceholderTimeoutRef.current = setTimeout(() => {\n          setShowPlaceholder(true)\n          showPlaceholderTimeoutRef.current = null\n        }, 300)\n      }\n    } else {\n      clearTimeoutRef(showPlaceholderTimeoutRef)\n      setShowPlaceholder(false)\n    }\n    return () => clearTimeoutRef(showPlaceholderTimeoutRef)\n  }, [leafIsPlaceholder, setShowPlaceholder])\n\n  if (leafIsPlaceholder && showPlaceholder) {\n    const placeholderProps: RenderPlaceholderProps = {\n      children: leaf.placeholder,\n      attributes: {\n        'data-slate-placeholder': true,\n        style: {\n          position: 'absolute',\n          top: 0,\n          pointerEvents: 'none',\n          width: '100%',\n          maxWidth: '100%',\n          display: 'block',\n          opacity: '0.333',\n          userSelect: 'none',\n          textDecoration: 'none',\n          // Fixes https://github.com/udecode/plate/issues/2315\n          WebkitUserModify: IS_WEBKIT ? 'inherit' : undefined,\n        },\n        contentEditable: false,\n        ref: callbackPlaceholderRef,\n      },\n    }\n\n    children = (\n      <React.Fragment>\n        {renderPlaceholder(placeholderProps)}\n        {children}\n      </React.Fragment>\n    )\n  }\n\n  // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n  const attributes: {\n    'data-slate-leaf': true\n  } = {\n    'data-slate-leaf': true,\n  }\n\n  return renderLeaf({ attributes, children, leaf, text })\n}\n\nconst MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    Text.equals(next.leaf, prev.leaf) &&\n    next.leaf[PLACEHOLDER_SYMBOL] === prev.leaf[PLACEHOLDER_SYMBOL]\n  )\n})\n\nexport const DefaultLeaf = (props: RenderLeafProps) => {\n  const { attributes, children } = props\n  return <span {...attributes}>{children}</span>\n}\n\nexport default MemoizedLeaf\n","import React, { useCallback, useRef } from 'react'\nimport { Element, Range, Text as SlateText } from 'slate'\nimport { ReactEditor, useSlateStatic } from '..'\nimport { isTextDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport Leaf from './leaf'\n\n/**\n * Text.\n */\n\nconst Text = (props: {\n  decorations: Range[]\n  isLast: boolean\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: SlateText\n}) => {\n  const {\n    decorations,\n    isLast,\n    parent,\n    renderPlaceholder,\n    renderLeaf,\n    text,\n  } = props\n  const editor = useSlateStatic()\n  const ref = useRef<HTMLSpanElement | null>(null)\n  const leaves = SlateText.decorations(text, decorations)\n  const key = ReactEditor.findKey(editor, text)\n  const children = []\n\n  for (let i = 0; i < leaves.length; i++) {\n    const leaf = leaves[i]\n\n    children.push(\n      <Leaf\n        isLast={isLast && i === leaves.length - 1}\n        key={`${key.id}-${i}`}\n        renderPlaceholder={renderPlaceholder}\n        leaf={leaf}\n        text={text}\n        parent={parent}\n        renderLeaf={renderLeaf}\n      />\n    )\n  }\n\n  // Update element-related weak maps with the DOM element ref.\n  const callbackRef = useCallback(\n    (span: HTMLSpanElement | null) => {\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (span) {\n        KEY_TO_ELEMENT?.set(key, span)\n        NODE_TO_ELEMENT.set(text, span)\n        ELEMENT_TO_NODE.set(span, text)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(text)\n        if (ref.current) {\n          ELEMENT_TO_NODE.delete(ref.current)\n        }\n      }\n      ref.current = span\n    },\n    [ref, editor, key, text]\n  )\n  return (\n    <span data-slate-node=\"text\" ref={callbackRef}>\n      {children}\n    </span>\n  )\n}\n\nconst MemoizedText = React.memo(Text, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    isTextDecorationsEqual(next.decorations, prev.decorations)\n  )\n})\n\nexport default MemoizedText\n","import getDirection from 'direction'\nimport React, { useCallback } from 'react'\nimport { Editor, Element as SlateElement, Node, Range } from 'slate'\nimport { ReactEditor, useReadOnly, useSlateStatic } from '..'\nimport useChildren from '../hooks/use-children'\nimport { isElementDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n  NODE_TO_INDEX,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from './editable'\n\nimport Text from './text'\n\n/**\n * Element.\n */\n\nconst Element = (props: {\n  decorations: Range[]\n  element: SlateElement\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    element,\n    renderElement = (p: RenderElementProps) => <DefaultElement {...p} />,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const editor = useSlateStatic()\n  const readOnly = useReadOnly()\n  const isInline = editor.isInline(element)\n  const key = ReactEditor.findKey(editor, element)\n  const ref = useCallback(\n    (ref: HTMLElement | null) => {\n      // Update element-related weak maps with the DOM element ref.\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (ref) {\n        KEY_TO_ELEMENT?.set(key, ref)\n        NODE_TO_ELEMENT.set(element, ref)\n        ELEMENT_TO_NODE.set(ref, element)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(element)\n      }\n    },\n    [editor, key, element]\n  )\n  let children: React.ReactNode = useChildren({\n    decorations,\n    node: element,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  })\n\n  // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n  const attributes: {\n    'data-slate-node': 'element'\n    'data-slate-void'?: true\n    'data-slate-inline'?: true\n    contentEditable?: false\n    dir?: 'rtl'\n    ref: any\n  } = {\n    'data-slate-node': 'element',\n    ref,\n  }\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true\n  }\n\n  // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    const text = Node.string(element)\n    const dir = getDirection(text)\n\n    if (dir === 'rtl') {\n      attributes.dir = dir\n    }\n  }\n\n  // If it's a void node, wrap the children in extra void-specific elements.\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false\n    }\n\n    const Tag = isInline ? 'span' : 'div'\n    const [[text]] = Node.texts(element)\n\n    children = (\n      <Tag\n        data-slate-spacer\n        style={{\n          height: '0',\n          color: 'transparent',\n          outline: 'none',\n          position: 'absolute',\n        }}\n      >\n        <Text\n          renderPlaceholder={renderPlaceholder}\n          decorations={[]}\n          isLast={false}\n          parent={element}\n          text={text}\n        />\n      </Tag>\n    )\n\n    NODE_TO_INDEX.set(text, 0)\n    NODE_TO_PARENT.set(text, element)\n  }\n\n  return renderElement({ attributes, children, element })\n}\n\nconst MemoizedElement = React.memo(Element, (prev, next) => {\n  return (\n    prev.element === next.element &&\n    prev.renderElement === next.renderElement &&\n    prev.renderLeaf === next.renderLeaf &&\n    prev.renderPlaceholder === next.renderPlaceholder &&\n    isElementDecorationsEqual(prev.decorations, next.decorations) &&\n    (prev.selection === next.selection ||\n      (!!prev.selection &&\n        !!next.selection &&\n        Range.equals(prev.selection, next.selection)))\n  )\n})\n\n/**\n * The default element renderer.\n */\n\nexport const DefaultElement = (props: RenderElementProps) => {\n  const { attributes, children, element } = props\n  const editor = useSlateStatic()\n  const Tag = editor.isInline(element) ? 'span' : 'div'\n  return (\n    <Tag {...attributes} style={{ position: 'relative' }}>\n      {children}\n    </Tag>\n  )\n}\n\nexport default MemoizedElement\n","import { createContext, useContext } from 'react'\nimport { Range, NodeEntry } from 'slate'\n\n/**\n * A React context for sharing the `decorate` prop of the editable.\n */\n\nexport const DecorateContext = createContext<(entry: NodeEntry) => Range[]>(\n  () => []\n)\n\n/**\n * Get the current `decorate` prop of the editable.\n */\n\nexport const useDecorate = (): ((entry: NodeEntry) => Range[]) => {\n  return useContext(DecorateContext)\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `selected` state of an element.\n */\n\nexport const SelectedContext = createContext(false)\n\n/**\n * Get the current `selected` state of an element.\n */\n\nexport const useSelected = (): boolean => {\n  return useContext(SelectedContext)\n}\n","import React from 'react'\nimport { Ancestor, Descendant, Editor, Element, Range } from 'slate'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from '../components/editable'\n\nimport ElementComponent from '../components/element'\nimport TextComponent from '../components/text'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { NODE_TO_INDEX, NODE_TO_PARENT } from '../utils/weak-maps'\nimport { useDecorate } from './use-decorate'\nimport { SelectedContext } from './use-selected'\nimport { useSlateStatic } from './use-slate-static'\n\n/**\n * Children.\n */\n\nconst useChildren = (props: {\n  decorations: Range[]\n  node: Ancestor\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    node,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const decorate = useDecorate()\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, node)\n  const children = []\n  const isLeafBlock =\n    Element.isElement(node) &&\n    !editor.isInline(node) &&\n    Editor.hasInlines(editor, node)\n\n  for (let i = 0; i < node.children.length; i++) {\n    const p = path.concat(i)\n    const n = node.children[i] as Descendant\n    const key = ReactEditor.findKey(editor, n)\n    const range = Editor.range(editor, p)\n    const sel = selection && Range.intersection(range, selection)\n    const ds = decorate([n, p])\n\n    for (const dec of decorations) {\n      const d = Range.intersection(dec, range)\n\n      if (d) {\n        ds.push(d)\n      }\n    }\n\n    if (Element.isElement(n)) {\n      children.push(\n        <SelectedContext.Provider key={`provider-${key.id}`} value={!!sel}>\n          <ElementComponent\n            decorations={ds}\n            element={n}\n            key={key.id}\n            renderElement={renderElement}\n            renderPlaceholder={renderPlaceholder}\n            renderLeaf={renderLeaf}\n            selection={sel}\n          />\n        </SelectedContext.Provider>\n      )\n    } else {\n      children.push(\n        <TextComponent\n          decorations={ds}\n          key={key.id}\n          isLast={isLeafBlock && i === node.children.length - 1}\n          parent={node}\n          renderPlaceholder={renderPlaceholder}\n          renderLeaf={renderLeaf}\n          text={n}\n        />\n      )\n    }\n\n    NODE_TO_INDEX.set(n, i)\n    NODE_TO_PARENT.set(n, node)\n  }\n\n  return children\n}\n\nexport default useChildren\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `readOnly` state of the editor.\n */\n\nexport const ReadOnlyContext = createContext(false)\n\n/**\n * Get the current `readOnly` state of the editor.\n */\n\nexport const useReadOnly = (): boolean => {\n  return useContext(ReadOnlyContext)\n}\n","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object, in a way that re-renders the\n * context whenever changes occur.\n */\n\nexport interface SlateContextValue {\n  v: number\n  editor: ReactEditor\n}\n\nexport const SlateContext = createContext<{\n  v: number\n  editor: ReactEditor\n} | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlate = (): Editor => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  const { editor } = context\n  return editor\n}\n\nexport const useSlateWithV = () => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return context\n}\n","import { useCallback, useEffect, useRef } from 'react'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { useSlateStatic } from './use-slate-static'\n\nexport function useTrackUserInput() {\n  const editor = useSlateStatic()\n\n  const receivedUserInput = useRef<boolean>(false)\n  const animationFrameIdRef = useRef<number>(0)\n\n  const onUserInput = useCallback(() => {\n    if (receivedUserInput.current) {\n      return\n    }\n\n    receivedUserInput.current = true\n\n    const window = ReactEditor.getWindow(editor)\n    window.cancelAnimationFrame(animationFrameIdRef.current)\n\n    animationFrameIdRef.current = window.requestAnimationFrame(() => {\n      receivedUserInput.current = false\n    })\n  }, [editor])\n\n  useEffect(() => () => cancelAnimationFrame(animationFrameIdRef.current), [])\n\n  return {\n    receivedUserInput,\n    onUserInput,\n  }\n}\n","export const TRIPLE_CLICK = 3\n","import { isHotkey } from 'is-hotkey'\nimport { IS_APPLE } from './environment'\n\n/**\n * Hotkey mappings for each platform.\n */\n\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  insertSoftBreak: 'shift+enter',\n  splitBlock: 'enter',\n  undo: 'mod+z',\n}\n\nconst APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n}\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n}\n\n/**\n * Create a platform-aware hotkey checker.\n */\n\nconst create = (key: string) => {\n  const generic = HOTKEYS[key]\n  const apple = APPLE_HOTKEYS[key]\n  const windows = WINDOWS_HOTKEYS[key]\n  const isGeneric = generic && isHotkey(generic)\n  const isApple = apple && isHotkey(apple)\n  const isWindows = windows && isHotkey(windows)\n\n  return (event: KeyboardEvent) => {\n    if (isGeneric && isGeneric(event)) return true\n    if (IS_APPLE && isApple && isApple(event)) return true\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\n    return false\n  }\n}\n\n/**\n * Hotkeys.\n */\n\nexport default {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSoftBreak: create('insertSoftBreak'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo'),\n}\n","import { RefObject } from 'react'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport { isTrackedMutation } from '../../utils/dom'\n\nexport type RestoreDOMManager = {\n  registerMutations: (mutations: MutationRecord[]) => void\n  restoreDOM: () => void\n  clear: () => void\n}\n\nexport const createRestoreDomManager = (\n  editor: ReactEditor,\n  receivedUserInput: RefObject<boolean>\n): RestoreDOMManager => {\n  let bufferedMutations: MutationRecord[] = []\n\n  const clear = () => {\n    bufferedMutations = []\n  }\n\n  const registerMutations = (mutations: MutationRecord[]) => {\n    if (!receivedUserInput.current) {\n      return\n    }\n\n    const trackedMutations = mutations.filter(mutation =>\n      isTrackedMutation(editor, mutation, mutations)\n    )\n\n    bufferedMutations.push(...trackedMutations)\n  }\n\n  function restoreDOM() {\n    if (bufferedMutations.length > 0) {\n      bufferedMutations.reverse().forEach(mutation => {\n        if (mutation.type === 'characterData') {\n          // We don't want to restore the DOM for characterData mutations\n          // because this interrupts the composition.\n          return\n        }\n\n        mutation.removedNodes.forEach(node => {\n          mutation.target.insertBefore(node, mutation.nextSibling)\n        })\n\n        mutation.addedNodes.forEach(node => {\n          mutation.target.removeChild(node)\n        })\n      })\n\n      // Clear buffered mutations to ensure we don't undo them twice\n      clear()\n    }\n  }\n\n  return {\n    registerMutations,\n    restoreDOM,\n    clear,\n  }\n}\n","import React, { Component, ComponentType, ContextType, RefObject } from 'react'\nimport { EditorContext } from '../../hooks/use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport {\n  createRestoreDomManager,\n  RestoreDOMManager,\n} from './restore-dom-manager'\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n}\n\ntype RestoreDOMProps = {\n  receivedUserInput: RefObject<boolean>\n  node: RefObject<HTMLDivElement>\n}\n\n// We have to use a class component here since we rely on `getSnapshotBeforeUpdate` which has no FC equivalent\n// to run code synchronously immediately before react commits the component update to the DOM.\nclass RestoreDOMComponent extends Component<RestoreDOMProps> {\n  static contextType = EditorContext\n  context: ContextType<typeof EditorContext> = null\n\n  private manager: RestoreDOMManager | null = null\n  private mutationObserver: MutationObserver | null = null\n\n  observe() {\n    const { node } = this.props\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    this.mutationObserver?.observe(node.current, MUTATION_OBSERVER_CONFIG)\n  }\n\n  componentDidMount() {\n    const { receivedUserInput } = this.props\n    const editor = this.context!\n\n    this.manager = createRestoreDomManager(editor, receivedUserInput)\n    this.mutationObserver = new MutationObserver(this.manager.registerMutations)\n\n    this.observe()\n  }\n\n  getSnapshotBeforeUpdate() {\n    const pendingMutations = this.mutationObserver?.takeRecords()\n    if (pendingMutations?.length) {\n      this.manager?.registerMutations(pendingMutations)\n    }\n\n    this.mutationObserver?.disconnect()\n    this.manager?.restoreDOM()\n\n    return null\n  }\n\n  componentDidUpdate() {\n    this.manager?.clear()\n    this.observe()\n  }\n\n  componentWillUnmount() {\n    this.mutationObserver?.disconnect()\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const RestoreDOM: ComponentType<RestoreDOMProps> = IS_ANDROID\n  ? RestoreDOMComponent\n  : ({ children }) => <>{children}</>\n","import getDirection from 'direction'\nimport debounce from 'lodash/debounce'\nimport throttle from 'lodash/throttle'\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {\n  Editor,\n  Element,\n  Node,\n  NodeEntry,\n  Path,\n  Range,\n  Text,\n  Transforms,\n} from 'slate'\nimport { useAndroidInputManager } from '../hooks/android-input-manager/use-android-input-manager'\nimport useChildren from '../hooks/use-children'\nimport { DecorateContext } from '../hooks/use-decorate'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { ReadOnlyContext } from '../hooks/use-read-only'\nimport { useSlate } from '../hooks/use-slate'\nimport { useTrackUserInput } from '../hooks/use-track-user-input'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { TRIPLE_CLICK } from '../utils/constants'\nimport {\n  DOMElement,\n  DOMRange,\n  DOMText,\n  getDefaultView,\n  isDOMElement,\n  isDOMNode,\n  isPlainTextOnlyPaste,\n} from '../utils/dom'\nimport {\n  CAN_USE_DOM,\n  HAS_BEFORE_INPUT_SUPPORT,\n  IS_ANDROID,\n  IS_CHROME,\n  IS_FIREFOX,\n  IS_FIREFOX_LEGACY,\n  IS_IOS,\n  IS_WEBKIT,\n  IS_UC_MOBILE,\n  IS_WECHATBROWSER,\n} from '../utils/environment'\nimport Hotkeys from '../utils/hotkeys'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  MARK_PLACEHOLDER_SYMBOL,\n  NODE_TO_ELEMENT,\n  PLACEHOLDER_SYMBOL,\n} from '../utils/weak-maps'\nimport { RestoreDOM } from './restore-dom/restore-dom'\nimport { AndroidInputManager } from '../hooks/android-input-manager/android-input-manager'\n\ntype DeferredOperation = () => void\n\nconst Children = (props: Parameters<typeof useChildren>[0]) => (\n  <React.Fragment>{useChildren(props)}</React.Fragment>\n)\n\n/**\n * `RenderElementProps` are passed to the `renderElement` handler.\n */\n\nexport interface RenderElementProps {\n  children: any\n  element: Element\n  attributes: {\n    'data-slate-node': 'element'\n    'data-slate-inline'?: true\n    'data-slate-void'?: true\n    dir?: 'rtl'\n    ref: any\n  }\n}\n\n/**\n * `RenderLeafProps` are passed to the `renderLeaf` handler.\n */\n\nexport interface RenderLeafProps {\n  children: any\n  leaf: Text\n  text: Text\n  attributes: {\n    'data-slate-leaf': true\n  }\n}\n\n/**\n * `EditableProps` are passed to the `<Editable>` component.\n */\n\nexport type EditableProps = {\n  decorate?: (entry: NodeEntry) => Range[]\n  onDOMBeforeInput?: (event: InputEvent) => void\n  placeholder?: string\n  readOnly?: boolean\n  role?: string\n  style?: React.CSSProperties\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  renderPlaceholder?: (props: RenderPlaceholderProps) => JSX.Element\n  scrollSelectionIntoView?: (editor: ReactEditor, domRange: DOMRange) => void\n  as?: React.ElementType\n  disableDefaultStyles?: boolean\n} & React.TextareaHTMLAttributes<HTMLDivElement>\n\n/**\n * Editable.\n */\n\nexport const Editable = (props: EditableProps) => {\n  const defaultRenderPlaceholder = useCallback(\n    (props: RenderPlaceholderProps) => <DefaultPlaceholder {...props} />,\n    []\n  )\n  const {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    renderPlaceholder = defaultRenderPlaceholder,\n    scrollSelectionIntoView = defaultScrollSelectionIntoView,\n    style: userStyle = {},\n    as: Component = 'div',\n    disableDefaultStyles = false,\n    ...attributes\n  } = props\n  const editor = useSlate()\n  // Rerender editor when composition status changed\n  const [isComposing, setIsComposing] = useState(false)\n  const ref = useRef<HTMLDivElement | null>(null)\n  const deferredOperations = useRef<DeferredOperation[]>([])\n  const [placeholderHeight, setPlaceholderHeight] = useState<\n    number | undefined\n  >()\n\n  const { onUserInput, receivedUserInput } = useTrackUserInput()\n\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  EDITOR_TO_FORCE_RENDER.set(editor, forceRender)\n\n  // Update internal state on each render.\n  IS_READ_ONLY.set(editor, readOnly)\n\n  // Keep track of some state for the event handler logic.\n  const state = useMemo(\n    () => ({\n      isDraggingInternally: false,\n      isUpdatingSelection: false,\n      latestElement: null as DOMElement | null,\n      hasMarkPlaceholder: false,\n    }),\n    []\n  )\n\n  // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus()\n    }\n  }, [autoFocus])\n\n  /**\n   * The AndroidInputManager object has a cyclical dependency on onDOMSelectionChange\n   *\n   * It is defined as a reference to simplify hook dependencies and clarify that\n   * it needs to be initialized.\n   */\n  const androidInputManagerRef = useRef<\n    AndroidInputManager | null | undefined\n  >()\n\n  // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n  const onDOMSelectionChange = useMemo(\n    () =>\n      throttle(() => {\n        const androidInputManager = androidInputManagerRef.current\n        if (\n          (IS_ANDROID || !ReactEditor.isComposing(editor)) &&\n          (!state.isUpdatingSelection || androidInputManager?.isFlushing()) &&\n          !state.isDraggingInternally\n        ) {\n          const root = ReactEditor.findDocumentOrShadowRoot(editor)\n          const { activeElement } = root\n          const el = ReactEditor.toDOMNode(editor, editor)\n          const domSelection = root.getSelection()\n\n          if (activeElement === el) {\n            state.latestElement = activeElement\n            IS_FOCUSED.set(editor, true)\n          } else {\n            IS_FOCUSED.delete(editor)\n          }\n\n          if (!domSelection) {\n            return Transforms.deselect(editor)\n          }\n\n          const { anchorNode, focusNode } = domSelection\n\n          const anchorNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, anchorNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, anchorNode)\n\n          const focusNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, focusNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, focusNode)\n\n          if (anchorNodeSelectable && focusNodeSelectable) {\n            const range = ReactEditor.toSlateRange(editor, domSelection, {\n              exactMatch: false,\n              suppressThrow: true,\n            })\n\n            if (range) {\n              if (\n                !ReactEditor.isComposing(editor) &&\n                !androidInputManager?.hasPendingChanges() &&\n                !androidInputManager?.isFlushing()\n              ) {\n                Transforms.select(editor, range)\n              } else {\n                androidInputManager?.handleUserSelect(range)\n              }\n            }\n          }\n\n          // Deselect the editor if the dom selection is not selectable in readonly mode\n          if (readOnly && (!anchorNodeSelectable || !focusNodeSelectable)) {\n            Transforms.deselect(editor)\n          }\n        }\n      }, 100),\n    [editor, readOnly, state]\n  )\n\n  const scheduleOnDOMSelectionChange = useMemo(\n    () => debounce(onDOMSelectionChange, 0),\n    [onDOMSelectionChange]\n  )\n\n  androidInputManagerRef.current = useAndroidInputManager({\n    node: ref,\n    onDOMSelectionChange,\n    scheduleOnDOMSelectionChange,\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    // Update element-related weak maps with the DOM element ref.\n    let window\n    if (ref.current && (window = getDefaultView(ref.current))) {\n      EDITOR_TO_WINDOW.set(editor, window)\n      EDITOR_TO_ELEMENT.set(editor, ref.current)\n      NODE_TO_ELEMENT.set(editor, ref.current)\n      ELEMENT_TO_NODE.set(ref.current, editor)\n    } else {\n      NODE_TO_ELEMENT.delete(editor)\n    }\n\n    // Make sure the DOM selection state is in sync.\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (\n      !domSelection ||\n      !ReactEditor.isFocused(editor) ||\n      androidInputManagerRef.current?.hasPendingAction()\n    ) {\n      return\n    }\n\n    const setDomSelection = (forceChange?: boolean) => {\n      const hasDomSelection = domSelection.type !== 'None'\n\n      // If the DOM selection is properly unset, we're done.\n      if (!selection && !hasDomSelection) {\n        return\n      }\n\n      // Get anchorNode and focusNode\n      const focusNode = domSelection.focusNode\n      let anchorNode\n\n      // COMPAT: In firefox the normal seletion way does not work\n      // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n      if (IS_FIREFOX && domSelection.rangeCount > 1) {\n        const firstRange = domSelection.getRangeAt(0)\n        const lastRange = domSelection.getRangeAt(domSelection.rangeCount - 1)\n\n        // Right to left\n        if (firstRange.startContainer === focusNode) {\n          anchorNode = lastRange.endContainer\n        } else {\n          // Left to right\n          anchorNode = firstRange.startContainer\n        }\n      } else {\n        anchorNode = domSelection.anchorNode\n      }\n\n      // verify that the dom selection is in the editor\n      const editorElement = EDITOR_TO_ELEMENT.get(editor)!\n      let hasDomSelectionInEditor = false\n      if (\n        editorElement.contains(anchorNode) &&\n        editorElement.contains(focusNode)\n      ) {\n        hasDomSelectionInEditor = true\n      }\n\n      // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n      if (\n        hasDomSelection &&\n        hasDomSelectionInEditor &&\n        selection &&\n        !forceChange\n      ) {\n        const slateRange = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: true,\n\n          // domSelection is not necessarily a valid Slate range\n          // (e.g. when clicking on contentEditable:false element)\n          suppressThrow: true,\n        })\n\n        if (slateRange && Range.equals(slateRange, selection)) {\n          if (!state.hasMarkPlaceholder) {\n            return\n          }\n\n          // Ensure selection is inside the mark placeholder\n          if (\n            anchorNode?.parentElement?.hasAttribute(\n              'data-slate-mark-placeholder'\n            )\n          ) {\n            return\n          }\n        }\n      }\n\n      // when <Editable/> is being controlled through external value\n      // then its children might just change - DOM responds to it on its own\n      // but Slate's value is not being updated through any operation\n      // and thus it doesn't transform selection on its own\n      if (selection && !ReactEditor.hasRange(editor, selection)) {\n        editor.selection = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: false,\n          suppressThrow: true,\n        })\n        return\n      }\n\n      // Otherwise the DOM selection is out of sync, so update it.\n      state.isUpdatingSelection = true\n\n      const newDomRange: DOMRange | null =\n        selection && ReactEditor.toDOMRange(editor, selection)\n\n      if (newDomRange) {\n        if (ReactEditor.isComposing(editor) && !IS_ANDROID) {\n          domSelection.collapseToEnd()\n        } else if (Range.isBackward(selection!)) {\n          domSelection.setBaseAndExtent(\n            newDomRange.endContainer,\n            newDomRange.endOffset,\n            newDomRange.startContainer,\n            newDomRange.startOffset\n          )\n        } else {\n          domSelection.setBaseAndExtent(\n            newDomRange.startContainer,\n            newDomRange.startOffset,\n            newDomRange.endContainer,\n            newDomRange.endOffset\n          )\n        }\n        scrollSelectionIntoView(editor, newDomRange)\n      } else {\n        domSelection.removeAllRanges()\n      }\n\n      return newDomRange\n    }\n\n    // In firefox if there is more then 1 range and we call setDomSelection we remove the ability to select more cells in a table\n    if (domSelection.rangeCount <= 1) {\n      setDomSelection()\n    }\n\n    const ensureSelection =\n      androidInputManagerRef.current?.isFlushing() === 'action'\n\n    if (!IS_ANDROID || !ensureSelection) {\n      setTimeout(() => {\n        state.isUpdatingSelection = false\n      })\n      return\n    }\n\n    let timeoutId: ReturnType<typeof setTimeout> | null = null\n    const animationFrameId = requestAnimationFrame(() => {\n      if (ensureSelection) {\n        const ensureDomSelection = (forceChange?: boolean) => {\n          try {\n            const el = ReactEditor.toDOMNode(editor, editor)\n            el.focus()\n\n            setDomSelection(forceChange)\n          } catch (e) {\n            // Ignore, dom and state might be out of sync\n          }\n        }\n\n        // Compat: Android IMEs try to force their selection by manually re-applying it even after we set it.\n        // This essentially would make setting the slate selection during an update meaningless, so we force it\n        // again here. We can't only do it in the setTimeout after the animation frame since that would cause a\n        // visible flicker.\n        ensureDomSelection()\n\n        timeoutId = setTimeout(() => {\n          // COMPAT: While setting the selection in an animation frame visually correctly sets the selection,\n          // it doesn't update GBoards spellchecker state. We have to manually trigger a selection change after\n          // the animation frame to ensure it displays the correct state.\n          ensureDomSelection(true)\n          state.isUpdatingSelection = false\n        })\n      }\n    })\n\n    return () => {\n      cancelAnimationFrame(animationFrameId)\n      if (timeoutId) {\n        clearTimeout(timeoutId)\n      }\n    }\n  })\n\n  // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n  const onDOMBeforeInput = useCallback(\n    (event: InputEvent) => {\n      onUserInput()\n\n      if (\n        !readOnly &&\n        ReactEditor.hasEditableTarget(editor, event.target) &&\n        !isDOMEventHandled(event, propsOnDOMBeforeInput)\n      ) {\n        // COMPAT: BeforeInput events aren't cancelable on android, so we have to handle them differently using the android input manager.\n        if (androidInputManagerRef.current) {\n          return androidInputManagerRef.current.handleDOMBeforeInput(event)\n        }\n\n        // Some IMEs/Chrome extensions like e.g. Grammarly set the selection immediately before\n        // triggering a `beforeinput` expecting the change to be applied to the immediately before\n        // set selection.\n        scheduleOnDOMSelectionChange.flush()\n        onDOMSelectionChange.flush()\n\n        const { selection } = editor\n        const { inputType: type } = event\n        const data = (event as any).dataTransfer || event.data || undefined\n\n        const isCompositionChange =\n          type === 'insertCompositionText' || type === 'deleteCompositionText'\n\n        // COMPAT: use composition change events as a hint to where we should insert\n        // composition text if we aren't composing to work around https://github.com/ianstormtaylor/slate/issues/5038\n        if (isCompositionChange && ReactEditor.isComposing(editor)) {\n          return\n        }\n\n        let native = false\n        if (\n          type === 'insertText' &&\n          selection &&\n          Range.isCollapsed(selection) &&\n          // Only use native character insertion for single characters a-z or space for now.\n          // Long-press events (hold a + press 4 = ä) to choose a special character otherwise\n          // causes duplicate inserts.\n          event.data &&\n          event.data.length === 1 &&\n          /[a-z ]/i.test(event.data) &&\n          // Chrome has issues correctly editing the start of nodes: https://bugs.chromium.org/p/chromium/issues/detail?id=1249405\n          // When there is an inline element, e.g. a link, and you select\n          // right after it (the start of the next node).\n          selection.anchor.offset !== 0\n        ) {\n          native = true\n\n          // Skip native if there are marks, as\n          // `insertText` will insert a node, not just text.\n          if (editor.marks) {\n            native = false\n          }\n\n          // Chrome also has issues correctly editing the end of anchor elements: https://bugs.chromium.org/p/chromium/issues/detail?id=1259100\n          // Therefore we don't allow native events to insert text at the end of anchor nodes.\n          const { anchor } = selection\n\n          const [node, offset] = ReactEditor.toDOMPoint(editor, anchor)\n          const anchorNode = node.parentElement?.closest('a')\n\n          const window = ReactEditor.getWindow(editor)\n\n          if (\n            native &&\n            anchorNode &&\n            ReactEditor.hasDOMNode(editor, anchorNode)\n          ) {\n            // Find the last text node inside the anchor.\n            const lastText = window?.document\n              .createTreeWalker(anchorNode, NodeFilter.SHOW_TEXT)\n              .lastChild() as DOMText | null\n\n            if (lastText === node && lastText.textContent?.length === offset) {\n              native = false\n            }\n          }\n\n          // Chrome has issues with the presence of tab characters inside elements with whiteSpace = 'pre'\n          // causing abnormal insert behavior: https://bugs.chromium.org/p/chromium/issues/detail?id=1219139\n          if (\n            native &&\n            node.parentElement &&\n            window?.getComputedStyle(node.parentElement)?.whiteSpace === 'pre'\n          ) {\n            const block = Editor.above(editor, {\n              at: anchor.path,\n              match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n            })\n\n            if (block && Node.string(block[0]).includes('\\t')) {\n              native = false\n            }\n          }\n        }\n\n        // COMPAT: For the deleting forward/backward input types we don't want\n        // to change the selection because it is the range that will be deleted,\n        // and those commands determine that for themselves.\n        if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n          const [targetRange] = (event as any).getTargetRanges()\n\n          if (targetRange) {\n            const range = ReactEditor.toSlateRange(editor, targetRange, {\n              exactMatch: false,\n              suppressThrow: false,\n            })\n\n            if (!selection || !Range.equals(selection, range)) {\n              native = false\n\n              const selectionRef =\n                !isCompositionChange &&\n                editor.selection &&\n                Editor.rangeRef(editor, editor.selection)\n\n              Transforms.select(editor, range)\n\n              if (selectionRef) {\n                EDITOR_TO_USER_SELECTION.set(editor, selectionRef)\n              }\n            }\n          }\n        }\n\n        // Composition change types occur while a user is composing text and can't be\n        // cancelled. Let them through and wait for the composition to end.\n        if (isCompositionChange) {\n          return\n        }\n\n        if (!native) {\n          event.preventDefault()\n        }\n\n        // COMPAT: If the selection is expanded, even if the command seems like\n        // a delete forward/backward command it should delete the selection.\n        if (\n          selection &&\n          Range.isExpanded(selection) &&\n          type.startsWith('delete')\n        ) {\n          const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n          Editor.deleteFragment(editor, { direction })\n          return\n        }\n\n        switch (type) {\n          case 'deleteByComposition':\n          case 'deleteByCut':\n          case 'deleteByDrag': {\n            Editor.deleteFragment(editor)\n            break\n          }\n\n          case 'deleteContent':\n          case 'deleteContentForward': {\n            Editor.deleteForward(editor)\n            break\n          }\n\n          case 'deleteContentBackward': {\n            Editor.deleteBackward(editor)\n            break\n          }\n\n          case 'deleteEntireSoftLine': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineForward': {\n            Editor.deleteForward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineForward': {\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteWordBackward': {\n            Editor.deleteBackward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'deleteWordForward': {\n            Editor.deleteForward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'insertLineBreak':\n            Editor.insertSoftBreak(editor)\n            break\n\n          case 'insertParagraph': {\n            Editor.insertBreak(editor)\n            break\n          }\n\n          case 'insertFromComposition':\n          case 'insertFromDrop':\n          case 'insertFromPaste':\n          case 'insertFromYank':\n          case 'insertReplacementText':\n          case 'insertText': {\n            if (type === 'insertFromComposition') {\n              // COMPAT: in Safari, `compositionend` is dispatched after the\n              // `beforeinput` for \"insertFromComposition\". But if we wait for it\n              // then we will abort because we're still composing and the selection\n              // won't be updated properly.\n              // https://www.w3.org/TR/input-events-2/\n              if (ReactEditor.isComposing(editor)) {\n                setIsComposing(false)\n                IS_COMPOSING.set(editor, false)\n              }\n            }\n\n            // use a weak comparison instead of 'instanceof' to allow\n            // programmatic access of paste events coming from external windows\n            // like cypress where cy.window does not work realibly\n            if (data?.constructor.name === 'DataTransfer') {\n              ReactEditor.insertData(editor, data)\n            } else if (typeof data === 'string') {\n              // Only insertText operations use the native functionality, for now.\n              // Potentially expand to single character deletes, as well.\n              if (native) {\n                deferredOperations.current.push(() =>\n                  Editor.insertText(editor, data)\n                )\n              } else {\n                Editor.insertText(editor, data)\n              }\n            }\n\n            break\n          }\n        }\n\n        // Restore the actual user section if nothing manually set it.\n        const toRestore = EDITOR_TO_USER_SELECTION.get(editor)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(editor)\n\n        if (\n          toRestore &&\n          (!editor.selection || !Range.equals(editor.selection, toRestore))\n        ) {\n          Transforms.select(editor, toRestore)\n        }\n      }\n    },\n    [\n      editor,\n      onDOMSelectionChange,\n      onUserInput,\n      propsOnDOMBeforeInput,\n      readOnly,\n      scheduleOnDOMSelectionChange,\n    ]\n  )\n\n  const callbackRef = useCallback(\n    node => {\n      if (node == null) {\n        onDOMSelectionChange.cancel()\n        scheduleOnDOMSelectionChange.cancel()\n\n        EDITOR_TO_ELEMENT.delete(editor)\n        NODE_TO_ELEMENT.delete(editor)\n\n        if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          ref.current.removeEventListener('beforeinput', onDOMBeforeInput)\n        }\n      } else {\n        // Attach a native DOM event handler for `beforeinput` events, because React's\n        // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n        // real `beforeinput` events sadly... (2019/11/04)\n        // https://github.com/facebook/react/issues/11211\n        if (HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          node.addEventListener('beforeinput', onDOMBeforeInput)\n        }\n      }\n\n      ref.current = node\n    },\n    [\n      onDOMSelectionChange,\n      scheduleOnDOMSelectionChange,\n      editor,\n      onDOMBeforeInput,\n    ]\n  )\n\n  // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n  useIsomorphicLayoutEffect(() => {\n    const window = ReactEditor.getWindow(editor)\n\n    window.document.addEventListener(\n      'selectionchange',\n      scheduleOnDOMSelectionChange\n    )\n\n    return () => {\n      window.document.removeEventListener(\n        'selectionchange',\n        scheduleOnDOMSelectionChange\n      )\n    }\n  }, [scheduleOnDOMSelectionChange])\n\n  const decorations = decorate([editor, []])\n\n  const showPlaceholder =\n    placeholder &&\n    editor.children.length === 1 &&\n    Array.from(Node.texts(editor)).length === 1 &&\n    Node.string(editor) === '' &&\n    !isComposing\n\n  const placeHolderResizeHandler = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      if (placeholderEl && showPlaceholder) {\n        setPlaceholderHeight(placeholderEl.getBoundingClientRect()?.height)\n      } else {\n        setPlaceholderHeight(undefined)\n      }\n    },\n    [showPlaceholder]\n  )\n\n  if (showPlaceholder) {\n    const start = Editor.start(editor, [])\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      onPlaceholderResize: placeHolderResizeHandler,\n      anchor: start,\n      focus: start,\n    })\n  }\n\n  const { marks } = editor\n  state.hasMarkPlaceholder = false\n\n  if (editor.selection && Range.isCollapsed(editor.selection) && marks) {\n    const { anchor } = editor.selection\n    const leaf = Node.leaf(editor, anchor.path)\n    const { text, ...rest } = leaf\n\n    // While marks isn't a 'complete' text, we can still use loose Text.equals\n    // here which only compares marks anyway.\n    if (!Text.equals(leaf, marks as Text, { loose: true })) {\n      state.hasMarkPlaceholder = true\n\n      const unset = Object.fromEntries(\n        Object.keys(rest).map(mark => [mark, null])\n      )\n\n      decorations.push({\n        [MARK_PLACEHOLDER_SYMBOL]: true,\n        ...unset,\n        ...marks,\n\n        anchor,\n        focus: anchor,\n      })\n    }\n  }\n\n  // Update EDITOR_TO_MARK_PLACEHOLDER_MARKS in setTimeout useEffect to ensure we don't set it\n  // before we receive the composition end event.\n  useEffect(() => {\n    setTimeout(() => {\n      const { selection } = editor\n      if (selection) {\n        const { anchor } = selection\n        const text = Node.leaf(editor, anchor.path)\n\n        // While marks isn't a 'complete' text, we can still use loose Text.equals\n        // here which only compares marks anyway.\n        if (marks && !Text.equals(text, marks as Text, { loose: true })) {\n          EDITOR_TO_PENDING_INSERTION_MARKS.set(editor, marks)\n          return\n        }\n      }\n\n      EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n    })\n  })\n\n  return (\n    <ReadOnlyContext.Provider value={readOnly}>\n      <DecorateContext.Provider value={decorate}>\n        <RestoreDOM node={ref} receivedUserInput={receivedUserInput}>\n          <Component\n            role={readOnly ? undefined : 'textbox'}\n            aria-multiline={readOnly ? undefined : true}\n            {...attributes}\n            // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n            // have to use hacks to make these replacement-based features work.\n            // For SSR situations HAS_BEFORE_INPUT_SUPPORT is false and results in prop\n            // mismatch warning app moves to browser. Pass-through consumer props when\n            // not CAN_USE_DOM (SSR) and default to falsy value\n            spellCheck={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.spellCheck\n                : false\n            }\n            autoCorrect={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCorrect\n                : 'false'\n            }\n            autoCapitalize={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCapitalize\n                : 'false'\n            }\n            data-slate-editor\n            data-slate-node=\"value\"\n            // explicitly set this\n            contentEditable={!readOnly}\n            // in some cases, a decoration needs access to the range / selection to decorate a text node,\n            // then you will select the whole text node when you select part the of text\n            // this magic zIndex=\"-1\" will fix it\n            zindex={-1}\n            suppressContentEditableWarning\n            ref={callbackRef}\n            style={{\n              ...(disableDefaultStyles\n                ? {}\n                : {\n                    // Allow positioning relative to the editable element.\n                    position: 'relative',\n                    // Preserve adjacent whitespace and new lines.\n                    whiteSpace: 'pre-wrap',\n                    // Allow words to break if they are too long.\n                    wordWrap: 'break-word',\n                    // Make the minimum height that of the placeholder.\n                    ...(placeholderHeight\n                      ? { minHeight: placeholderHeight }\n                      : {}),\n                  }),\n              // Allow for passed-in styles to override anything.\n              ...userStyle,\n            }}\n            onBeforeInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                // fall back to React's leaky polyfill instead just for it. It\n                // only works for the `insertText` input type.\n                if (\n                  !HAS_BEFORE_INPUT_SUPPORT &&\n                  !readOnly &&\n                  !isEventHandled(event, attributes.onBeforeInput) &&\n                  ReactEditor.hasSelectableTarget(editor, event.target)\n                ) {\n                  event.preventDefault()\n                  if (!ReactEditor.isComposing(editor)) {\n                    const text = (event as any).data as string\n                    Editor.insertText(editor, text)\n                  }\n                }\n              },\n              [attributes.onBeforeInput, editor, readOnly]\n            )}\n            onInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                if (isEventHandled(event, attributes.onInput)) {\n                  return\n                }\n\n                if (androidInputManagerRef.current) {\n                  androidInputManagerRef.current.handleInput()\n                  return\n                }\n\n                // Flush native operations, as native events will have propogated\n                // and we can correctly compare DOM text values in components\n                // to stop rendering, so that browser functions like autocorrect\n                // and spellcheck work as expected.\n                for (const op of deferredOperations.current) {\n                  op()\n                }\n                deferredOperations.current = []\n              },\n              [attributes.onInput]\n            )}\n            onBlur={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  readOnly ||\n                  state.isUpdatingSelection ||\n                  !ReactEditor.hasSelectableTarget(editor, event.target) ||\n                  isEventHandled(event, attributes.onBlur)\n                ) {\n                  return\n                }\n\n                // COMPAT: If the current `activeElement` is still the previous\n                // one, this is due to the window being blurred when the tab\n                // itself becomes unfocused, so we want to abort early to allow to\n                // editor to stay focused when the tab becomes focused again.\n                const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                if (state.latestElement === root.activeElement) {\n                  return\n                }\n\n                const { relatedTarget } = event\n                const el = ReactEditor.toDOMNode(editor, editor)\n\n                // COMPAT: The event should be ignored if the focus is returning\n                // to the editor from an embedded editable element (eg. an <input>\n                // element inside a void node).\n                if (relatedTarget === el) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving from\n                // the editor to inside a void node's spacer element.\n                if (\n                  isDOMElement(relatedTarget) &&\n                  relatedTarget.hasAttribute('data-slate-spacer')\n                ) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving to a\n                // non- editable section of an element that isn't a void node (eg.\n                // a list item of the check list example).\n                if (\n                  relatedTarget != null &&\n                  isDOMNode(relatedTarget) &&\n                  ReactEditor.hasDOMNode(editor, relatedTarget)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, relatedTarget)\n\n                  if (Element.isElement(node) && !editor.isVoid(node)) {\n                    return\n                  }\n                }\n\n                // COMPAT: Safari doesn't always remove the selection even if the content-\n                // editable element no longer has focus. Refer to:\n                // https://stackoverflow.com/questions/12353247/force-contenteditable-div-to-stop-accepting-input-after-it-loses-focus-under-web\n                if (IS_WEBKIT) {\n                  const domSelection = root.getSelection()\n                  domSelection?.removeAllRanges()\n                }\n\n                IS_FOCUSED.delete(editor)\n              },\n              [\n                readOnly,\n                state.isUpdatingSelection,\n                state.latestElement,\n                editor,\n                attributes.onBlur,\n              ]\n            )}\n            onClick={useCallback(\n              (event: React.MouseEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onClick) &&\n                  isDOMNode(event.target)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n\n                  // At this time, the Slate document may be arbitrarily different,\n                  // because onClick handlers can change the document before we get here.\n                  // Therefore we must check that this path actually exists,\n                  // and that it still refers to the same node.\n                  if (\n                    !Editor.hasPath(editor, path) ||\n                    Node.get(editor, path) !== node\n                  ) {\n                    return\n                  }\n\n                  if (event.detail === TRIPLE_CLICK && path.length >= 1) {\n                    let blockPath = path\n                    if (\n                      !(Element.isElement(node) && Editor.isBlock(editor, node))\n                    ) {\n                      const block = Editor.above(editor, {\n                        match: n =>\n                          Element.isElement(n) && Editor.isBlock(editor, n),\n                        at: path,\n                      })\n\n                      blockPath = block?.[1] ?? path.slice(0, 1)\n                    }\n\n                    const range = Editor.range(editor, blockPath)\n                    Transforms.select(editor, range)\n                    return\n                  }\n\n                  if (readOnly) {\n                    return\n                  }\n\n                  const start = Editor.start(editor, path)\n                  const end = Editor.end(editor, path)\n                  const startVoid = Editor.void(editor, { at: start })\n                  const endVoid = Editor.void(editor, { at: end })\n\n                  if (\n                    startVoid &&\n                    endVoid &&\n                    Path.equals(startVoid[1], endVoid[1])\n                  ) {\n                    const range = Editor.range(editor, start)\n                    Transforms.select(editor, range)\n                  }\n                }\n              },\n              [editor, attributes.onClick, readOnly]\n            )}\n            onCompositionEnd={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  if (ReactEditor.isComposing(editor)) {\n                    setIsComposing(false)\n                    IS_COMPOSING.set(editor, false)\n                  }\n\n                  androidInputManagerRef.current?.handleCompositionEnd(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionEnd) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  // COMPAT: In Chrome, `beforeinput` events for compositions\n                  // aren't correct and never fire the \"insertFromComposition\"\n                  // type that we need. So instead, insert whenever a composition\n                  // ends since it will already have been committed to the DOM.\n                  if (\n                    !IS_WEBKIT &&\n                    !IS_FIREFOX_LEGACY &&\n                    !IS_IOS &&\n                    !IS_WECHATBROWSER &&\n                    !IS_UC_MOBILE &&\n                    event.data\n                  ) {\n                    const placeholderMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(\n                      editor\n                    )\n                    EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n\n                    // Ensure we insert text with the marks the user was actually seeing\n                    if (placeholderMarks !== undefined) {\n                      EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n                      editor.marks = placeholderMarks\n                    }\n\n                    Editor.insertText(editor, event.data)\n\n                    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n                    EDITOR_TO_USER_MARKS.delete(editor)\n                    if (userMarks !== undefined) {\n                      editor.marks = userMarks\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionEnd, editor]\n            )}\n            onCompositionUpdate={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCompositionUpdate)\n                ) {\n                  if (!ReactEditor.isComposing(editor)) {\n                    setIsComposing(true)\n                    IS_COMPOSING.set(editor, true)\n                  }\n                }\n              },\n              [attributes.onCompositionUpdate, editor]\n            )}\n            onCompositionStart={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  androidInputManagerRef.current?.handleCompositionStart(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionStart) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  setIsComposing(true)\n\n                  const { selection } = editor\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                      return\n                    }\n                    const inline = Editor.above(editor, {\n                      match: n =>\n                        Element.isElement(n) && Editor.isInline(editor, n),\n                      mode: 'highest',\n                    })\n                    if (inline) {\n                      const [, inlinePath] = inline\n                      if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n                        const point = Editor.after(editor, inlinePath)!\n                        Transforms.setSelection(editor, {\n                          anchor: point,\n                          focus: point,\n                        })\n                      }\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionStart, editor]\n            )}\n            onCopy={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCopy) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'copy'\n                  )\n                }\n              },\n              [attributes.onCopy, editor]\n            )}\n            onCut={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCut) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'cut'\n                  )\n                  const { selection } = editor\n\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                    } else {\n                      const node = Node.parent(editor, selection.anchor.path)\n                      if (Editor.isVoid(editor, node)) {\n                        Transforms.delete(editor)\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onCut]\n            )}\n            onDragOver={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragOver)\n                ) {\n                  // Only when the target is void, call `preventDefault` to signal\n                  // that drops are allowed. Editable content is droppable by\n                  // default, and calling `preventDefault` hides the cursor.\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n\n                  if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n                    event.preventDefault()\n                  }\n                }\n              },\n              [attributes.onDragOver, editor]\n            )}\n            onDragStart={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragStart)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n                  const voidMatch =\n                    (Element.isElement(node) && Editor.isVoid(editor, node)) ||\n                    Editor.void(editor, { at: path, voids: true })\n\n                  // If starting a drag on a void node, make sure it is selected\n                  // so that it shows up in the selection's fragment.\n                  if (voidMatch) {\n                    const range = Editor.range(editor, path)\n                    Transforms.select(editor, range)\n                  }\n\n                  state.isDraggingInternally = true\n\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.dataTransfer,\n                    'drag'\n                  )\n                }\n              },\n              [readOnly, editor, attributes.onDragStart, state]\n            )}\n            onDrop={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDrop)\n                ) {\n                  event.preventDefault()\n\n                  // Keep a reference to the dragged range before updating selection\n                  const draggedRange = editor.selection\n\n                  // Find the range where the drop happened\n                  const range = ReactEditor.findEventRange(editor, event)\n                  const data = event.dataTransfer\n\n                  Transforms.select(editor, range)\n\n                  if (state.isDraggingInternally) {\n                    if (\n                      draggedRange &&\n                      !Range.equals(draggedRange, range) &&\n                      !Editor.void(editor, { at: range, voids: true })\n                    ) {\n                      Transforms.delete(editor, {\n                        at: draggedRange,\n                      })\n                    }\n                  }\n\n                  ReactEditor.insertData(editor, data)\n\n                  // When dragging from another source into the editor, it's possible\n                  // that the current editor does not have focus.\n                  if (!ReactEditor.isFocused(editor)) {\n                    ReactEditor.focus(editor)\n                  }\n                }\n\n                state.isDraggingInternally = false\n              },\n              [readOnly, editor, attributes.onDrop, state]\n            )}\n            onDragEnd={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  state.isDraggingInternally &&\n                  attributes.onDragEnd &&\n                  ReactEditor.hasTarget(editor, event.target)\n                ) {\n                  attributes.onDragEnd(event)\n                }\n\n                // When dropping on a different droppable element than the current editor,\n                // `onDrop` is not called. So we need to clean up in `onDragEnd` instead.\n                // Note: `onDragEnd` is only called when `onDrop` is not called\n                state.isDraggingInternally = false\n              },\n              [readOnly, state, attributes, editor]\n            )}\n            onFocus={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  !state.isUpdatingSelection &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onFocus)\n                ) {\n                  const el = ReactEditor.toDOMNode(editor, editor)\n                  const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                  state.latestElement = root.activeElement\n\n                  // COMPAT: If the editor has nested editable elements, the focus\n                  // can go to them. In Firefox, this must be prevented because it\n                  // results in issues with keyboard navigation. (2017/03/30)\n                  if (IS_FIREFOX && event.target !== el) {\n                    el.focus()\n                    return\n                  }\n\n                  IS_FOCUSED.set(editor, true)\n                }\n              },\n              [readOnly, state, editor, attributes.onFocus]\n            )}\n            onKeyDown={useCallback(\n              (event: React.KeyboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target)\n                ) {\n                  androidInputManagerRef.current?.handleKeyDown(event)\n\n                  const { nativeEvent } = event\n\n                  // COMPAT: The composition end event isn't fired reliably in all browsers,\n                  // so we sometimes might end up stuck in a composition state even though we\n                  // aren't composing any more.\n                  if (\n                    ReactEditor.isComposing(editor) &&\n                    nativeEvent.isComposing === false\n                  ) {\n                    IS_COMPOSING.set(editor, false)\n                    setIsComposing(false)\n                  }\n\n                  if (\n                    isEventHandled(event, attributes.onKeyDown) ||\n                    ReactEditor.isComposing(editor)\n                  ) {\n                    return\n                  }\n\n                  const { selection } = editor\n                  const element =\n                    editor.children[\n                      selection !== null ? selection.focus.path[0] : 0\n                    ]\n                  const isRTL = getDirection(Node.string(element)) === 'rtl'\n\n                  // COMPAT: Since we prevent the default behavior on\n                  // `beforeinput` events, the browser doesn't think there's ever\n                  // any history stack to undo or redo, so we have to manage these\n                  // hotkeys ourselves. (2019/11/06)\n                  if (Hotkeys.isRedo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.redo === 'function') {\n                      maybeHistoryEditor.redo()\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isUndo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.undo === 'function') {\n                      maybeHistoryEditor.undo()\n                    }\n\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't handle the selection updates\n                  // properly. In Chrome, the selection isn't properly extended.\n                  // And in Firefox, the selection isn't properly collapsed.\n                  // (2017/10/17)\n                  if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', reverse: true })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line' })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, {\n                      unit: 'line',\n                      edge: 'focus',\n                      reverse: true,\n                    })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', edge: 'focus' })\n                    return\n                  }\n\n                  // COMPAT: If a void node is selected, or a zero-width text node\n                  // adjacent to an inline is selected, we need to handle these\n                  // hotkeys manually because browsers won't be able to skip over\n                  // the void node with the zero-width space not being an empty\n                  // string.\n                  if (Hotkeys.isMoveBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: !isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'start' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'end' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: !isRTL })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: isRTL })\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to guessing at the input intention for hotkeys.\n                  // COMPAT: In iOS, some of these hotkeys are handled in the\n                  if (!HAS_BEFORE_INPUT_SUPPORT) {\n                    // We don't have a core behavior for these, but they change the\n                    // DOM if we don't prevent them, so we have to.\n                    if (\n                      Hotkeys.isBold(nativeEvent) ||\n                      Hotkeys.isItalic(nativeEvent) ||\n                      Hotkeys.isTransposeCharacter(nativeEvent)\n                    ) {\n                      event.preventDefault()\n                      return\n                    }\n\n                    if (Hotkeys.isSoftBreak(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertSoftBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isSplitBlock(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n                  } else {\n                    if (IS_CHROME || IS_WEBKIT) {\n                      // COMPAT: Chrome and Safari support `beforeinput` event but do not fire\n                      // an event when deleting backwards in a selected void inline node\n                      if (\n                        selection &&\n                        (Hotkeys.isDeleteBackward(nativeEvent) ||\n                          Hotkeys.isDeleteForward(nativeEvent)) &&\n                        Range.isCollapsed(selection)\n                      ) {\n                        const currentNode = Node.parent(\n                          editor,\n                          selection.anchor.path\n                        )\n\n                        if (\n                          Element.isElement(currentNode) &&\n                          Editor.isVoid(editor, currentNode) &&\n                          (Editor.isInline(editor, currentNode) ||\n                            Editor.isBlock(editor, currentNode))\n                        ) {\n                          event.preventDefault()\n                          Editor.deleteBackward(editor, { unit: 'block' })\n\n                          return\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onKeyDown]\n            )}\n            onPaste={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onPaste)\n                ) {\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to React's `onPaste` here instead.\n                  // COMPAT: Firefox, Chrome and Safari don't emit `beforeinput` events\n                  // when \"paste without formatting\" is used, so fallback. (2020/02/20)\n                  // COMPAT: Safari InputEvents generated by pasting won't include\n                  // application/x-slate-fragment items, so use the\n                  // ClipboardEvent here. (2023/03/15)\n                  if (\n                    !HAS_BEFORE_INPUT_SUPPORT ||\n                    isPlainTextOnlyPaste(event.nativeEvent) ||\n                    IS_WEBKIT\n                  ) {\n                    event.preventDefault()\n                    ReactEditor.insertData(editor, event.clipboardData)\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onPaste]\n            )}\n          >\n            <Children\n              decorations={decorations}\n              node={editor}\n              renderElement={renderElement}\n              renderPlaceholder={renderPlaceholder}\n              renderLeaf={renderLeaf}\n              selection={editor.selection}\n            />\n          </Component>\n        </RestoreDOM>\n      </DecorateContext.Provider>\n    </ReadOnlyContext.Provider>\n  )\n}\n\n/**\n * The props that get passed to renderPlaceholder\n */\nexport type RenderPlaceholderProps = {\n  children: any\n  attributes: {\n    'data-slate-placeholder': boolean\n    dir?: 'rtl'\n    contentEditable: boolean\n    ref: React.RefCallback<any>\n    style: React.CSSProperties\n  }\n}\n\n/**\n * The default placeholder element\n */\n\nexport const DefaultPlaceholder = ({\n  attributes,\n  children,\n}: RenderPlaceholderProps) => (\n  // COMPAT: Artificially add a line-break to the end on the placeholder element\n  // to prevent Android IMEs to pick up its content in autocorrect and to auto-capitalize the first letter\n  <span {...attributes}>\n    {children}\n    {IS_ANDROID && <br />}\n  </span>\n)\n\n/**\n * A default memoized decorate function.\n */\n\nexport const defaultDecorate: (entry: NodeEntry) => Range[] = () => []\n\n/**\n * A default implement to scroll dom range into view.\n */\n\nconst defaultScrollSelectionIntoView = (\n  editor: ReactEditor,\n  domRange: DOMRange\n) => {\n  // This was affecting the selection of multiple blocks and dragging behavior,\n  // so enabled only if the selection has been collapsed.\n  if (\n    domRange.getBoundingClientRect &&\n    (!editor.selection ||\n      (editor.selection && Range.isCollapsed(editor.selection)))\n  ) {\n    const leafEl = domRange.startContainer.parentElement!\n    leafEl.getBoundingClientRect = domRange.getBoundingClientRect.bind(domRange)\n    scrollIntoView(leafEl, {\n      scrollMode: 'if-needed',\n    })\n\n    // @ts-expect-error an unorthodox delete D:\n    delete leafEl.getBoundingClientRect\n  }\n}\n\n/**\n * Check if an event is overrided by a handler.\n */\n\nexport const isEventHandled = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType,\n  handler?: (event: EventType) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.isDefaultPrevented() || event.isPropagationStopped()\n}\n\n/**\n * Check if the event's target is an input element\n */\nexport const isDOMEventTargetInput = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType\n) => {\n  return (\n    isDOMNode(event.target) &&\n    (event.target instanceof HTMLInputElement ||\n      event.target instanceof HTMLTextAreaElement)\n  )\n}\n\n/**\n * Check if a DOM event is overrided by a handler.\n */\n\nexport const isDOMEventHandled = <E extends Event>(\n  event: E,\n  handler?: (event: E) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.defaultPrevented\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `focused` state of the editor.\n */\n\nexport const FocusedContext = createContext(false)\n\n/**\n * Get the current `focused` state of the editor.\n */\n\nexport const useFocused = (): boolean => {\n  return useContext(FocusedContext)\n}\n","import {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react'\nimport { Editor } from 'slate'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nfunction isError(error: any): error is Error {\n  return error instanceof Error\n}\n\ntype EditorChangeHandler = (editor: Editor) => void\n/**\n * A React context for sharing the editor selector context in a way to control rerenders\n */\n\nexport const SlateSelectorContext = createContext<{\n  getSlate: () => Editor\n  addEventListener: (callback: EditorChangeHandler) => () => void\n}>({} as any)\n\nconst refEquality = (a: any, b: any) => a === b\n\n/**\n * use redux style selectors to prevent rerendering on every keystroke.\n * Bear in mind rerendering can only prevented if the returned value is a value type or for reference types (e.g. objects and arrays) add a custom equality function.\n *\n * Example:\n * ```\n *  const isSelectionActive = useSlateSelector(editor => Boolean(editor.selection));\n * ```\n */\nexport function useSlateSelector<T>(\n  selector: (editor: Editor) => T,\n  equalityFn: (a: T, b: T) => boolean = refEquality\n) {\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  const context = useContext(SlateSelectorContext)\n  if (!context) {\n    throw new Error(\n      `The \\`useSlateSelector\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n  const { getSlate, addEventListener } = context\n\n  const latestSubscriptionCallbackError = useRef<Error | undefined>()\n  const latestSelector = useRef<(editor: Editor) => T>(() => null as any)\n  const latestSelectedState = useRef<T>((null as any) as T)\n  let selectedState: T\n\n  try {\n    if (\n      selector !== latestSelector.current ||\n      latestSubscriptionCallbackError.current\n    ) {\n      selectedState = selector(getSlate())\n    } else {\n      selectedState = latestSelectedState.current\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current && isError(err)) {\n      err.message += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\n`\n    }\n\n    throw err\n  }\n  useIsomorphicLayoutEffect(() => {\n    latestSelector.current = selector\n    latestSelectedState.current = selectedState\n    latestSubscriptionCallbackError.current = undefined\n  })\n\n  useIsomorphicLayoutEffect(\n    () => {\n      function checkForUpdates() {\n        try {\n          const newSelectedState = latestSelector.current(getSlate())\n\n          if (equalityFn(newSelectedState, latestSelectedState.current)) {\n            return\n          }\n\n          latestSelectedState.current = newSelectedState\n        } catch (err) {\n          // we ignore all errors here, since when the component\n          // is re-rendered, the selectors are called again, and\n          // will throw again, if neither props nor store state\n          // changed\n          latestSubscriptionCallbackError.current = err\n        }\n\n        forceRender()\n      }\n\n      const unsubscribe = addEventListener(checkForUpdates)\n\n      checkForUpdates()\n\n      return () => unsubscribe()\n    },\n    // don't rerender on equalityFn change since we want to be able to define it inline\n    [addEventListener, getSlate]\n  )\n\n  return selectedState\n}\n\n/**\n * Create selector context with editor updating on every editor change\n */\nexport function useSelectorContext(editor: Editor) {\n  const eventListeners = useRef<EditorChangeHandler[]>([]).current\n  const slateRef = useRef<{\n    editor: Editor\n  }>({\n    editor,\n  }).current\n  const onChange = useCallback(\n    (editor: Editor) => {\n      slateRef.editor = editor\n      eventListeners.forEach((listener: EditorChangeHandler) =>\n        listener(editor)\n      )\n    },\n    [eventListeners, slateRef]\n  )\n\n  const selectorContext = useMemo(() => {\n    return {\n      getSlate: () => slateRef.editor,\n      addEventListener: (callback: EditorChangeHandler) => {\n        eventListeners.push(callback)\n        return () => {\n          eventListeners.splice(eventListeners.indexOf(callback), 1)\n        }\n      },\n    }\n  }, [eventListeners, slateRef])\n  return { selectorContext, onChange }\n}\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { Descendant, Editor, Node, Scrubber } from 'slate'\nimport { FocusedContext } from '../hooks/use-focused'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { SlateContext, SlateContextValue } from '../hooks/use-slate'\nimport {\n  useSelectorContext,\n  SlateSelectorContext,\n} from '../hooks/use-slate-selector'\nimport { EditorContext } from '../hooks/use-slate-static'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\nimport { EDITOR_TO_ON_CHANGE } from '../utils/weak-maps'\n\n/**\n * A wrapper around the provider to handle `onChange` events, because the editor\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\n */\n\nexport const Slate = (props: {\n  editor: ReactEditor\n  initialValue: Descendant[]\n  children: React.ReactNode\n  onChange?: (value: Descendant[]) => void\n}) => {\n  const { editor, children, onChange, initialValue, ...rest } = props\n  const unmountRef = useRef(false)\n\n  const [context, setContext] = React.useState<SlateContextValue>(() => {\n    if (!Node.isNodeList(initialValue)) {\n      throw new Error(\n        `[Slate] initialValue is invalid! Expected a list of elements but got: ${Scrubber.stringify(\n          initialValue\n        )}`\n      )\n    }\n    if (!Editor.isEditor(editor)) {\n      throw new Error(\n        `[Slate] editor is invalid! You passed: ${Scrubber.stringify(editor)}`\n      )\n    }\n    editor.children = initialValue\n    Object.assign(editor, rest)\n    return { v: 0, editor }\n  })\n\n  const {\n    selectorContext,\n    onChange: handleSelectorChange,\n  } = useSelectorContext(editor)\n\n  const onContextChange = useCallback(() => {\n    if (onChange) {\n      onChange(editor.children)\n    }\n\n    setContext(prevContext => ({\n      v: prevContext.v + 1,\n      editor,\n    }))\n    handleSelectorChange(editor)\n  }, [editor, handleSelectorChange, onChange])\n\n  useEffect(() => {\n    EDITOR_TO_ON_CHANGE.set(editor, onContextChange)\n\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {})\n      unmountRef.current = true\n    }\n  }, [editor, onContextChange])\n\n  const [isFocused, setIsFocused] = useState(ReactEditor.isFocused(editor))\n\n  useEffect(() => {\n    setIsFocused(ReactEditor.isFocused(editor))\n  }, [editor])\n\n  useIsomorphicLayoutEffect(() => {\n    const fn = () => setIsFocused(ReactEditor.isFocused(editor))\n    if (REACT_MAJOR_VERSION >= 17) {\n      // In React >= 17 onFocus and onBlur listen to the focusin and focusout events during the bubbling phase.\n      // Therefore in order for <Editable />'s handlers to run first, which is necessary for ReactEditor.isFocused(editor)\n      // to return the correct value, we have to listen to the focusin and focusout events without useCapture here.\n      document.addEventListener('focusin', fn)\n      document.addEventListener('focusout', fn)\n      return () => {\n        document.removeEventListener('focusin', fn)\n        document.removeEventListener('focusout', fn)\n      }\n    } else {\n      document.addEventListener('focus', fn, true)\n      document.addEventListener('blur', fn, true)\n      return () => {\n        document.removeEventListener('focus', fn, true)\n        document.removeEventListener('blur', fn, true)\n      }\n    }\n  }, [])\n\n  return (\n    <SlateSelectorContext.Provider value={selectorContext}>\n      <SlateContext.Provider value={context}>\n        <EditorContext.Provider value={context.editor}>\n          <FocusedContext.Provider value={isFocused}>\n            {children}\n          </FocusedContext.Provider>\n        </EditorContext.Provider>\n      </SlateContext.Provider>\n    </SlateSelectorContext.Provider>\n  )\n}\n","import { useContext } from 'react'\n\nimport { EditorContext } from './use-slate-static'\n\n/**\n * Get the current editor object from the React context.\n * @deprecated Use useSlateStatic instead.\n */\n\nexport const useEditor = () => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useEditor\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import { BaseSelection, Range } from 'slate'\n\nimport { useSlateSelector } from './use-slate-selector'\n\n/**\n * Get the current slate selection.\n * Only triggers a rerender when the selection actually changes\n */\nexport const useSlateSelection = () => {\n  return useSlateSelector(editor => editor.selection, isSelectionEqual)\n}\n\nconst isSelectionEqual = (a: BaseSelection, b: BaseSelection) => {\n  if (!a && !b) return true\n  if (!a || !b) return false\n  return Range.equals(a, b)\n}\n","/**\n * Utilities for single-line deletion\n */\n\nimport { Editor, Range } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\nconst doRectsIntersect = (rect: DOMRect, compareRect: DOMRect) => {\n  const middle = (compareRect.top + compareRect.bottom) / 2\n\n  return rect.top <= middle && rect.bottom >= middle\n}\n\nconst areRangesSameLine = (\n  editor: ReactEditor,\n  range1: Range,\n  range2: Range\n) => {\n  const rect1 = ReactEditor.toDOMRange(editor, range1).getBoundingClientRect()\n  const rect2 = ReactEditor.toDOMRange(editor, range2).getBoundingClientRect()\n\n  return doRectsIntersect(rect1, rect2) && doRectsIntersect(rect2, rect1)\n}\n\n/**\n * A helper utility that returns the end portion of a `Range`\n * which is located on a single line.\n *\n * @param {Editor} editor The editor object to compare against\n * @param {Range} parentRange The parent range to compare against\n * @returns {Range} A valid portion of the parentRange which is one a single line\n */\nexport const findCurrentLineRange = (\n  editor: ReactEditor,\n  parentRange: Range\n): Range => {\n  const parentRangeBoundary = Editor.range(editor, Range.end(parentRange))\n  const positions = Array.from(Editor.positions(editor, { at: parentRange }))\n\n  let left = 0\n  let right = positions.length\n  let middle = Math.floor(right / 2)\n\n  if (\n    areRangesSameLine(\n      editor,\n      Editor.range(editor, positions[left]),\n      parentRangeBoundary\n    )\n  ) {\n    return Editor.range(editor, positions[left], parentRangeBoundary)\n  }\n\n  if (positions.length < 2) {\n    return Editor.range(\n      editor,\n      positions[positions.length - 1],\n      parentRangeBoundary\n    )\n  }\n\n  while (middle !== positions.length && middle !== left) {\n    if (\n      areRangesSameLine(\n        editor,\n        Editor.range(editor, positions[middle]),\n        parentRangeBoundary\n      )\n    ) {\n      right = middle\n    } else {\n      left = middle\n    }\n\n    middle = Math.floor((left + right) / 2)\n  }\n\n  return Editor.range(editor, positions[right], parentRangeBoundary)\n}\n","import ReactDOM from 'react-dom'\nimport {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Transforms,\n} from 'slate'\nimport {\n  TextDiff,\n  transformPendingPoint,\n  transformPendingRange,\n  transformTextDiff,\n} from '../utils/diff-text'\nimport {\n  getPlainText,\n  getSlateFragmentAttribute,\n  isDOMText,\n} from '../utils/dom'\nimport { Key } from '../utils/key'\nimport { findCurrentLineRange } from '../utils/lines'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_ON_CHANGE,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  NODE_TO_KEY,\n} from '../utils/weak-maps'\nimport { ReactEditor } from './react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\n\n/**\n * `withReact` adds React and DOM specific behaviors to the editor.\n *\n * If you are using TypeScript, you must extend Slate's CustomTypes to use\n * this plugin.\n *\n * See https://docs.slatejs.org/concepts/11-typescript to learn how.\n */\n\nexport const withReact = <T extends BaseEditor>(\n  editor: T,\n  clipboardFormatKey = 'x-slate-fragment'\n): T & ReactEditor => {\n  const e = editor as T & ReactEditor\n  const { apply, onChange, deleteBackward, addMark, removeMark } = e\n\n  // The WeakMap which maps a key to a specific HTMLElement must be scoped to the editor instance to\n  // avoid collisions between editors in the DOM that share the same value.\n  EDITOR_TO_KEY_TO_ELEMENT.set(e, new WeakMap())\n\n  e.addMark = (key, value) => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(e)?.()\n\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    addMark(key, value)\n  }\n\n  e.removeMark = key => {\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    removeMark(key)\n  }\n\n  e.deleteBackward = unit => {\n    if (unit !== 'line') {\n      return deleteBackward(unit)\n    }\n\n    if (e.selection && Range.isCollapsed(e.selection)) {\n      const parentBlockEntry = Editor.above(e, {\n        match: n => Element.isElement(n) && Editor.isBlock(e, n),\n        at: e.selection,\n      })\n\n      if (parentBlockEntry) {\n        const [, parentBlockPath] = parentBlockEntry\n        const parentElementRange = Editor.range(\n          e,\n          parentBlockPath,\n          e.selection.anchor\n        )\n\n        const currentLineRange = findCurrentLineRange(e, parentElementRange)\n\n        if (!Range.isCollapsed(currentLineRange)) {\n          Transforms.delete(e, { at: currentLineRange })\n        }\n      }\n    }\n  }\n\n  // This attempts to reset the NODE_TO_KEY entry to the correct value\n  // as apply() changes the object reference and hence invalidates the NODE_TO_KEY entry\n  e.apply = (op: Operation) => {\n    const matches: [Path, Key][] = []\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(e)\n    if (pendingDiffs?.length) {\n      const transformed = pendingDiffs\n        .map(textDiff => transformTextDiff(textDiff, op))\n        .filter(Boolean) as TextDiff[]\n\n      EDITOR_TO_PENDING_DIFFS.set(e, transformed)\n    }\n\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(e)\n    if (pendingSelection) {\n      EDITOR_TO_PENDING_SELECTION.set(\n        e,\n        transformPendingRange(e, pendingSelection, op)\n      )\n    }\n\n    const pendingAction = EDITOR_TO_PENDING_ACTION.get(e)\n    if (pendingAction?.at) {\n      const at = Point.isPoint(pendingAction?.at)\n        ? transformPendingPoint(e, pendingAction.at, op)\n        : transformPendingRange(e, pendingAction.at, op)\n\n      EDITOR_TO_PENDING_ACTION.set(e, at ? { ...pendingAction, at } : null)\n    }\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n      case 'split_node': {\n        matches.push(...getMatches(e, op.path))\n        break\n      }\n\n      case 'set_selection': {\n        // Selection was manually set, don't restore the user selection after the change.\n        EDITOR_TO_USER_SELECTION.get(e)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(e)\n        break\n      }\n\n      case 'insert_node':\n      case 'remove_node': {\n        matches.push(...getMatches(e, Path.parent(op.path)))\n        break\n      }\n\n      case 'merge_node': {\n        const prevPath = Path.previous(op.path)\n        matches.push(...getMatches(e, prevPath))\n        break\n      }\n\n      case 'move_node': {\n        const commonPath = Path.common(\n          Path.parent(op.path),\n          Path.parent(op.newPath)\n        )\n        matches.push(...getMatches(e, commonPath))\n        break\n      }\n    }\n\n    apply(op)\n\n    for (const [path, key] of matches) {\n      const [node] = Editor.node(e, path)\n      NODE_TO_KEY.set(node, key)\n    }\n  }\n\n  e.setFragmentData = (data: Pick<DataTransfer, 'getData' | 'setData'>) => {\n    const { selection } = e\n\n    if (!selection) {\n      return\n    }\n\n    const [start, end] = Range.edges(selection)\n    const startVoid = Editor.void(e, { at: start.path })\n    const endVoid = Editor.void(e, { at: end.path })\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return\n    }\n\n    // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n    const domRange = ReactEditor.toDOMRange(e, selection)\n    let contents = domRange.cloneContents()\n    let attach = contents.childNodes[0] as HTMLElement\n\n    // Make sure attach is non-empty, since empty nodes will not get copied.\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node as HTMLElement\n      }\n    })\n\n    // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n    if (endVoid) {\n      const [voidNode] = endVoid\n      const r = domRange.cloneRange()\n      const domNode = ReactEditor.toDOMNode(e, voidNode)\n      r.setEndAfter(domNode)\n      contents = r.cloneContents()\n    }\n\n    // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\n    }\n\n    // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\n      zw => {\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\n        zw.textContent = isNewline ? '\\n' : ''\n      }\n    )\n\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n    if (isDOMText(attach)) {\n      const span = attach.ownerDocument.createElement('span')\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n      span.style.whiteSpace = 'pre'\n      span.appendChild(attach)\n      contents.appendChild(span)\n      attach = span\n    }\n\n    const fragment = e.getFragment()\n    const string = JSON.stringify(fragment)\n    const encoded = window.btoa(encodeURIComponent(string))\n    attach.setAttribute('data-slate-fragment', encoded)\n    data.setData(`application/${clipboardFormatKey}`, encoded)\n\n    // Add the content to a <div> so that we can get its inner HTML.\n    const div = contents.ownerDocument.createElement('div')\n    div.appendChild(contents)\n    div.setAttribute('hidden', 'true')\n    contents.ownerDocument.body.appendChild(div)\n    data.setData('text/html', div.innerHTML)\n    data.setData('text/plain', getPlainText(div))\n    contents.ownerDocument.body.removeChild(div)\n    return data\n  }\n\n  e.insertData = (data: DataTransfer) => {\n    if (!e.insertFragmentData(data)) {\n      e.insertTextData(data)\n    }\n  }\n\n  e.insertFragmentData = (data: DataTransfer): boolean => {\n    /**\n     * Checking copied fragment from application/x-slate-fragment or data-slate-fragment\n     */\n    const fragment =\n      data.getData(`application/${clipboardFormatKey}`) ||\n      getSlateFragmentAttribute(data)\n\n    if (fragment) {\n      const decoded = decodeURIComponent(window.atob(fragment))\n      const parsed = JSON.parse(decoded) as Node[]\n      e.insertFragment(parsed)\n      return true\n    }\n    return false\n  }\n\n  e.insertTextData = (data: DataTransfer): boolean => {\n    const text = data.getData('text/plain')\n\n    if (text) {\n      const lines = text.split(/\\r\\n|\\r|\\n/)\n      let split = false\n\n      for (const line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, { always: true })\n        }\n\n        e.insertText(line)\n        split = true\n      }\n      return true\n    }\n    return false\n  }\n\n  e.onChange = options => {\n    // COMPAT: React < 18 doesn't batch `setState` hook calls, which means\n    // that the children and selection can get out of sync for one render\n    // pass. So we have to use this unstable API to ensure it batches them.\n    // (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    const maybeBatchUpdates =\n      REACT_MAJOR_VERSION < 18\n        ? ReactDOM.unstable_batchedUpdates\n        : (callback: () => void) => callback()\n\n    maybeBatchUpdates(() => {\n      const onContextChange = EDITOR_TO_ON_CHANGE.get(e)\n\n      if (onContextChange) {\n        onContextChange()\n      }\n\n      onChange(options)\n    })\n  }\n\n  return e\n}\n\nconst getMatches = (e: Editor, path: Path) => {\n  const matches: [Path, Key][] = []\n  for (const [n, p] of Editor.levels(e, { at: path })) {\n    const key = ReactEditor.findKey(e, n)\n    matches.push([p, key])\n  }\n  return matches\n}\n"],"names":["objectWithoutPropertiesLoose","EditorContext","createContext","useSlateStatic","editor","useContext","Error","REACT_MAJOR_VERSION","parseInt","React","version","split","IS_IOS","navigator","window","test","userAgent","MSStream","IS_APPLE","IS_ANDROID","IS_FIREFOX","IS_WEBKIT","IS_EDGE_LEGACY","IS_CHROME","IS_CHROME_LEGACY","IS_ANDROID_CHROME_LEGACY","IS_FIREFOX_LEGACY","IS_UC_MOBILE","IS_WECHATBROWSER","CAN_USE_DOM","document","createElement","HAS_BEFORE_INPUT_SUPPORT","globalThis","InputEvent","prototype","getTargetRanges","NODE_TO_INDEX","WeakMap","NODE_TO_PARENT","EDITOR_TO_WINDOW","EDITOR_TO_ELEMENT","EDITOR_TO_PLACEHOLDER_ELEMENT","ELEMENT_TO_NODE","NODE_TO_ELEMENT","NODE_TO_KEY","EDITOR_TO_KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","IS_COMPOSING","EDITOR_TO_USER_SELECTION","EDITOR_TO_ON_CHANGE","EDITOR_TO_SCHEDULE_FLUSH","EDITOR_TO_PENDING_INSERTION_MARKS","EDITOR_TO_USER_MARKS","EDITOR_TO_PENDING_DIFFS","EDITOR_TO_PENDING_ACTION","EDITOR_TO_PENDING_SELECTION","EDITOR_TO_FORCE_RENDER","PLACEHOLDER_SYMBOL","Symbol","MARK_PLACEHOLDER_SYMBOL","DOMText","Text","getDefaultView","value","ownerDocument","defaultView","isDOMComment","isDOMNode","nodeType","isDOMElement","Node","isDOMSelection","anchorNode","Selection","isDOMText","isPlainTextOnlyPaste","event","clipboardData","getData","types","length","normalizeDOMPoint","domPoint","node","offset","childNodes","isLast","index","getEditableChildAndIndex","i","getEditableChild","textContent","hasShadowRoot","parent","parentNode","toString","direction","child","triedForward","triedBackward","getAttribute","getPlainText","domNode","text","nodeValue","childNode","Array","from","display","getComputedStyle","getPropertyValue","tagName","catchSlateFragment","getSlateFragmentAttribute","dataTransfer","htmlData","fragment","match","isTrackedMutation","mutation","batch","target","matches","ReactEditor","getWindow","contains","hasDOMNode","editable","parentMutation","find","addedNodes","removedNodes","n","Key","constructor","id","androidPendingDiffs","get","androidScheduleFlush","blur","el","toDOMNode","root","findDocumentOrShadowRoot","set","activeElement","deselect","selection","domSelection","getSelection","rangeCount","removeAllRanges","Transforms","getRootNode","Document","ShadowRoot","findEventRange","nativeEvent","clientX","x","clientY","y","toSlateNode","path","findPath","Element","isElement","Editor","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","edge","point","before","after","range","domRange","caretRangeFromPoint","position","caretPositionFromPoint","createRange","setStart","offsetNode","setEnd","toSlateRange","exactMatch","suppressThrow","findKey","key","isEditor","unshift","Scrubber","stringify","focus","preventScroll","options","editorEl","targetEl","parentElement","err","message","includes","closest","isContentEditable","hasEditableTarget","hasRange","anchor","hasPath","hasSelectableTarget","isTargetInsideNonReadonlyVoid","hasTarget","insertData","data","insertFragmentData","insertTextData","isComposing","isFocused","isReadOnly","slateNode","setFragmentData","originEvent","KEY_TO_ELEMENT","toDOMPoint","void","at","selector","texts","querySelectorAll","start","attr","trueLength","end","nextText","hasAttribute","domText","startsWith","Math","min","max","toDOMRange","isBackward","Range","domAnchor","domFocus","isCollapsed","startNode","startOffset","endNode","endOffset","startEl","isStartAtZeroWidth","endEl","isEndAtZeroWidth","domEl","toSlatePoint","nearestNode","nearestOffset","textNode","potentialVoidNode","voidNode","leafNode","contents","cloneContents","removals","slice","call","forEach","textContext","removeChild","leafNodes","current","endsWith","querySelector","startContainer","anchorOffset","focusNode","focusOffset","firstRange","getRangeAt","lastRange","endContainer","collapsed","isExpanded","isForward","mode","unhangRange","voids","verifyDiffState","textDiff","diff","isText","nextPath","Path","next","nextNode","applyStringDiff","diffs","reduce","longestCommonPrefixLength","str","another","charAt","longestCommonSuffixLength","normalizeStringDiff","targetText","removedText","prefixLength","suffixLength","normalized","mergeStringDiffs","a","b","overlap","applied","sliceEnd","targetRange","normalizePoint","leaf","parentBlock","above","isBlock","entry","isDescendant","normalizeRange","transformPendingPoint","op","pendingDiffs","equals","Point","transform","affinity","transformed","type","transformPendingRange","transformTextDiff","newPath","RESOLVE_DELAY","FLUSH_DELAY","debug","isDataTransfer","name","createAndroidInputManager","scheduleOnDOMSelectionChange","onDOMSelectionChange","flushing","compositionEndTimeoutId","flushTimeoutId","actionTimeoutId","idCounter","insertPositionHint","applyPendingSelection","pendingSelection","delete","select","performAction","action","isPoint","run","flush","clearTimeout","hasPendingDiffs","hasPendingAction","setTimeout","selectionRef","rangeRef","marks","scheduleSelectionChange","pendingMarks","undefined","insertText","deleteFragment","filter","cancel","unref","userMarks","onChange","handleCompositionEnd","_event","handleCompositionStart","updatePlaceholderVisibility","forceHide","placeholderElement","style","removeProperty","storeDiff","idx","findIndex","change","push","merged","splice","scheduleAction","handleDOMBeforeInput","inputType","nativeTargetRange","canStoreDiff","edges","relevantPendingDiffs","handleUserSelect","targetNode","deleteForward","nativeCollapsed","deleteBackward","unit","insertSoftBreak","insertBreak","replace","parts","line","hintPosition","search","diffPosition","scheduleFlush","hasPendingChanges","isFlushing","pathChanged","parentPathChanged","handleInput","handleKeyDown","_","handleDomMutations","mutations","some","useIsMounted","isMountedRef","useRef","useEffect","useIsomorphicLayoutEffect","useLayoutEffect","useMutationObserver","callback","mutationObserver","useState","MutationObserver","takeRecords","observe","disconnect","MUTATION_OBSERVER_CONFIG","subtree","childList","characterData","useAndroidInputManager","isMounted","inputManager","shallowCompare","obj1","obj2","Object","keys","every","hasOwnProperty","isDecorationFlagsEqual","other","rangeOwnProps","otherOwnProps","isElementDecorationsEqual","list","isTextDecorationsEqual","String","props","parentPath","isMarkPlaceholder","ZeroWidthString","string","children","isLineBreak","TextString","isTrailing","ref","getTextContent","initialText","textWithTrailing","MemoizedText","memo","forwardRef","attributes","disconnectPlaceholderResizeObserver","placeholderResizeObserver","releaseObserver","clearTimeoutRef","timeoutRef","Leaf","renderPlaceholder","renderLeaf","DefaultLeaf","placeholderRef","showPlaceholder","setShowPlaceholder","showPlaceholderTimeoutRef","callbackPlaceholderRef","useCallback","placeholderEl","onPlaceholderResize","ResizeObserver","ResizeObserverPolyfill","leafIsPlaceholder","placeholderProps","placeholder","pointerEvents","maxWidth","opacity","userSelect","textDecoration","WebkitUserModify","contentEditable","Fragment","MemoizedLeaf","prev","decorations","leaves","SlateText","callbackRef","span","element","renderElement","p","DefaultElement","readOnly","useReadOnly","useChildren","hasInlines","dir","getDirection","Tag","color","outline","MemoizedElement","DecorateContext","useDecorate","SelectedContext","useSelected","decorate","isLeafBlock","concat","sel","intersection","ds","dec","d","Provider","ElementComponent","TextComponent","ReadOnlyContext","SlateContext","useSlate","context","useSlateWithV","useTrackUserInput","receivedUserInput","animationFrameIdRef","onUserInput","cancelAnimationFrame","requestAnimationFrame","TRIPLE_CLICK","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isHotkey","isApple","isWindows","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSoftBreak","isSplitBlock","isTransposeCharacter","isUndo","createRestoreDomManager","bufferedMutations","clear","registerMutations","trackedMutations","restoreDOM","reverse","insertBefore","nextSibling","characterDataOldValue","RestoreDOMComponent","Component","componentDidMount","manager","getSnapshotBeforeUpdate","pendingMutations","componentDidUpdate","componentWillUnmount","render","RestoreDOM","Children","Editable","defaultRenderPlaceholder","DefaultPlaceholder","autoFocus","defaultDecorate","onDOMBeforeInput","propsOnDOMBeforeInput","scrollSelectionIntoView","defaultScrollSelectionIntoView","userStyle","as","disableDefaultStyles","setIsComposing","deferredOperations","placeholderHeight","setPlaceholderHeight","forceRender","useReducer","s","state","useMemo","isDraggingInternally","isUpdatingSelection","latestElement","hasMarkPlaceholder","androidInputManagerRef","throttle","androidInputManager","anchorNodeSelectable","focusNodeSelectable","debounce","setDomSelection","forceChange","hasDomSelection","editorElement","hasDomSelectionInEditor","slateRange","newDomRange","collapseToEnd","setBaseAndExtent","ensureSelection","timeoutId","animationFrameId","ensureDomSelection","e","isDOMEventHandled","isCompositionChange","native","lastText","createTreeWalker","NodeFilter","SHOW_TEXT","lastChild","whiteSpace","block","preventDefault","toRestore","removeEventListener","addEventListener","placeHolderResizeHandler","rest","loose","unset","fromEntries","map","mark","role","spellCheck","autoCorrect","autoCapitalize","zindex","suppressContentEditableWarning","wordWrap","minHeight","onBeforeInput","isEventHandled","onInput","onBlur","relatedTarget","onClick","detail","blockPath","startVoid","endVoid","onCompositionEnd","placeholderMarks","onCompositionUpdate","onCompositionStart","inline","inlinePath","isEnd","setSelection","onCopy","isDOMEventTargetInput","onCut","onDragOver","onDragStart","voidMatch","onDrop","draggedRange","onDragEnd","onFocus","onKeyDown","isRTL","Hotkeys","maybeHistoryEditor","move","collapse","currentNode","onPaste","leafEl","bind","scrollIntoView","scrollMode","handler","shouldTreatEventAsHandled","isDefaultPrevented","isPropagationStopped","HTMLInputElement","HTMLTextAreaElement","defaultPrevented","FocusedContext","useFocused","isError","error","SlateSelectorContext","refEquality","useSlateSelector","equalityFn","getSlate","latestSubscriptionCallbackError","latestSelector","latestSelectedState","selectedState","stack","checkForUpdates","newSelectedState","unsubscribe","useSelectorContext","eventListeners","slateRef","listener","selectorContext","indexOf","Slate","initialValue","unmountRef","setContext","isNodeList","assign","v","handleSelectorChange","onContextChange","prevContext","setIsFocused","fn","useEditor","useSlateSelection","isSelectionEqual","doRectsIntersect","compareRect","middle","bottom","areRangesSameLine","range1","range2","rect1","rect2","findCurrentLineRange","parentRange","parentRangeBoundary","positions","right","floor","withReact","clipboardFormatKey","apply","addMark","removeMark","parentBlockEntry","parentBlockPath","parentElementRange","currentLineRange","Boolean","pendingAction","getMatches","prevPath","previous","commonPath","common","attach","trim","r","cloneRange","setEndAfter","zw","isNewline","appendChild","getFragment","JSON","encoded","btoa","encodeURIComponent","setAttribute","setData","div","body","innerHTML","decoded","decodeURIComponent","atob","parsed","parse","insertFragment","lines","splitNodes","always","maybeBatchUpdates","ReactDOM","unstable_batchedUpdates","levels"],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/index.js b/dist/index.js
index 6591a6385326a69363c95a28251fbfe9fa8b65c3..2bbc79771ab9429667fc0c2ab2a2a116932aa264 100644
--- a/dist/index.js
+++ b/dist/index.js
@@ -830,9 +830,7 @@ var ReactEditor = {
       return false;
     }
 
-    return targetEl.closest("[data-slate-editor]") === editorEl && (!editable || targetEl.isContentEditable ? true : typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined
-    // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable="false"(readOnly)
-    targetEl.closest('[contenteditable="false"]') === editorEl || !!targetEl.getAttribute('data-slate-zero-width'));
+    return targetEl.closest("[data-slate-editor]") === editorEl && (!editable || targetEl.isContentEditable ? true : typeof targetEl.isContentEditable === 'boolean' && targetEl.closest('[contenteditable="false"]') === editorEl || targetEl.closest("[plate-firefox-fix]") !== null || !!targetEl.getAttribute('data-slate-zero-width'));
   },
   hasEditableTarget: function hasEditableTarget(editor, target) {
     return isDOMNode(target) && ReactEditor.hasDOMNode(editor, target, {
diff --git a/dist/index.js.map b/dist/index.js.map
index 9842a3965eae7da1722e3d7be9e377212d203919..a88d62a157fd7f75fa3299b6ba38a59316475e2b 100644
--- a/dist/index.js.map
+++ b/dist/index.js.map
@@ -1 +1 @@
-{"version":3,"file":"index.js","sources":["../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/defineProperty.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayWithHoles.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/nonIterableRest.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/slicedToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/objectWithoutProperties.js","../src/hooks/use-slate-static.tsx","../src/utils/environment.ts","../src/utils/weak-maps.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/iterableToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/nonIterableSpread.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/toConsumableArray.js","../src/utils/dom.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/classCallCheck.js","../src/utils/key.ts","../src/plugin/react-editor.ts","../src/utils/diff-text.ts","../src/hooks/android-input-manager/android-input-manager.ts","../src/hooks/use-is-mounted.tsx","../src/hooks/use-isomorphic-layout-effect.ts","../src/hooks/use-mutation-observer.ts","../src/hooks/android-input-manager/use-android-input-manager.ts","../src/utils/range-list.ts","../src/components/string.tsx","../src/components/leaf.tsx","../src/components/text.tsx","../src/components/element.tsx","../src/hooks/use-decorate.ts","../src/hooks/use-selected.ts","../src/hooks/use-children.tsx","../src/hooks/use-read-only.ts","../src/hooks/use-slate.tsx","../src/hooks/use-track-user-input.ts","../src/utils/constants.ts","../src/utils/hotkeys.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/createClass.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/setPrototypeOf.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/inherits.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/typeof.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/assertThisInitialized.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/getPrototypeOf.js","../src/components/restore-dom/restore-dom-manager.ts","../src/components/restore-dom/restore-dom.tsx","../src/components/editable.tsx","../src/hooks/use-focused.ts","../src/hooks/use-slate-selector.tsx","../src/components/slate.tsx","../src/hooks/use-editor.tsx","../src/hooks/use-slate-selection.tsx","../src/utils/lines.ts","../src/plugin/with-react.ts"],"sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose.js\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object.\n */\n\nexport const EditorContext = createContext<ReactEditor | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlateStatic = (): Editor => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useSlateStatic\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import React from 'react'\n\nexport const REACT_MAJOR_VERSION = parseInt(React.version.split('.')[0], 10)\n\nexport const IS_IOS =\n  typeof navigator !== 'undefined' &&\n  typeof window !== 'undefined' &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  !window.MSStream\n\nexport const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\n\nexport const IS_ANDROID =\n  typeof navigator !== 'undefined' && /Android/.test(navigator.userAgent)\n\nexport const IS_FIREFOX =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\n\nexport const IS_WEBKIT =\n  typeof navigator !== 'undefined' &&\n  /AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent)\n\n// \"modern\" Edge was released at 79.x\nexport const IS_EDGE_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_CHROME =\n  typeof navigator !== 'undefined' && /Chrome/i.test(navigator.userAgent)\n\n// Native `beforeInput` events don't work well with react on Chrome 75\n// and older, Chrome 76+ can use `beforeInput` though.\nexport const IS_CHROME_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_ANDROID_CHROME_LEGACY =\n  IS_ANDROID &&\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-5]?\\d)(?:\\.)/i.test(navigator.userAgent)\n\n// Firefox did not support `beforeInput` until `v87`.\nexport const IS_FIREFOX_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox\\/(?:[0-7][0-9]|[0-8][0-6])(?:\\.)).*/i.test(\n    navigator.userAgent\n  )\n\n// UC mobile browser\nexport const IS_UC_MOBILE =\n  typeof navigator !== 'undefined' && /.*UCBrowser/.test(navigator.userAgent)\n\n// Wechat browser\nexport const IS_WECHATBROWSER =\n  typeof navigator !== 'undefined' && /.*Wechat/.test(navigator.userAgent)\n\n// Check if DOM is available as React does internally.\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const CAN_USE_DOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n)\n\n// COMPAT: Firefox/Edge Legacy don't support the `beforeinput` event\n// Chrome Legacy doesn't support `beforeinput` correctly\nexport const HAS_BEFORE_INPUT_SUPPORT =\n  (!IS_CHROME_LEGACY || !IS_ANDROID_CHROME_LEGACY) &&\n  !IS_EDGE_LEGACY &&\n  // globalThis is undefined in older browsers\n  typeof globalThis !== 'undefined' &&\n  globalThis.InputEvent &&\n  // @ts-ignore The `getTargetRanges` property isn't recognized.\n  typeof globalThis.InputEvent.prototype.getTargetRanges === 'function'\n","import { Ancestor, Editor, Node, Range, RangeRef, Text } from 'slate'\nimport { Action } from '../hooks/android-input-manager/android-input-manager'\nimport { TextDiff } from './diff-text'\nimport { Key } from './key'\n\n/**\n * Two weak maps that allow us rebuild a path given a node. They are populated\n * at render time such that after a render occurs we can always backtrack.\n */\n\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\n\n/**\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\n * are used to resolve DOM event-related logic into Slate actions.\n */\nexport const EDITOR_TO_WINDOW: WeakMap<Editor, Window> = new WeakMap()\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER: WeakMap<Editor, string> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER_ELEMENT: WeakMap<\n  Editor,\n  HTMLElement\n> = new WeakMap()\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\nexport const EDITOR_TO_KEY_TO_ELEMENT: WeakMap<\n  Editor,\n  WeakMap<Key, HTMLElement>\n> = new WeakMap()\n\n/**\n * Weak maps for storing editor-related state.\n */\n\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_COMPOSING: WeakMap<Editor, boolean> = new WeakMap()\n\nexport const EDITOR_TO_USER_SELECTION: WeakMap<\n  Editor,\n  RangeRef | null\n> = new WeakMap()\n\n/**\n * Weak map for associating the context `onChange` context with the plugin.\n */\n\nexport const EDITOR_TO_ON_CHANGE = new WeakMap<Editor, () => void>()\n\n/**\n * Weak maps for saving pending state on composition stage.\n */\n\nexport const EDITOR_TO_SCHEDULE_FLUSH: WeakMap<\n  Editor,\n  () => void\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_INSERTION_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\nexport const EDITOR_TO_USER_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\n/**\n * Android input handling specific weak-maps\n */\n\nexport const EDITOR_TO_PENDING_DIFFS: WeakMap<\n  Editor,\n  TextDiff[]\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_ACTION: WeakMap<\n  Editor,\n  Action | null\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_SELECTION: WeakMap<\n  Editor,\n  Range | null\n> = new WeakMap()\n\nexport const EDITOR_TO_FORCE_RENDER: WeakMap<Editor, () => void> = new WeakMap()\n\n/**\n * Symbols.\n */\n\nexport const PLACEHOLDER_SYMBOL = (Symbol('placeholder') as unknown) as string\nexport const MARK_PLACEHOLDER_SYMBOL = (Symbol(\n  'mark-placeholder'\n) as unknown) as string\n","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\n\nvar iterableToArray = require(\"./iterableToArray.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * Types.\n */\n\n// COMPAT: This is required to prevent TypeScript aliases from doing some very\n// weird things for Slate's types with the same name as globals. (2019/11/27)\n// https://github.com/microsoft/TypeScript/issues/35002\nimport DOMNode = globalThis.Node\nimport DOMComment = globalThis.Comment\nimport DOMElement = globalThis.Element\nimport DOMText = globalThis.Text\nimport DOMRange = globalThis.Range\nimport DOMSelection = globalThis.Selection\nimport DOMStaticRange = globalThis.StaticRange\nimport { ReactEditor } from '../plugin/react-editor'\n\nexport {\n  DOMNode,\n  DOMComment,\n  DOMElement,\n  DOMText,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n}\n\ndeclare global {\n  interface Window {\n    Selection: typeof Selection['constructor']\n    DataTransfer: typeof DataTransfer['constructor']\n    Node: typeof Node['constructor']\n  }\n}\n\nexport type DOMPoint = [Node, number]\n\n/**\n * Returns the host window of a DOM node\n */\n\nexport const getDefaultView = (value: any): Window | null => {\n  return (\n    (value && value.ownerDocument && value.ownerDocument.defaultView) || null\n  )\n}\n\n/**\n * Check if a DOM node is a comment node.\n */\n\nexport const isDOMComment = (value: any): value is DOMComment => {\n  return isDOMNode(value) && value.nodeType === 8\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMElement = (value: any): value is DOMElement => {\n  return isDOMNode(value) && value.nodeType === 1\n}\n\n/**\n * Check if a value is a DOM node.\n */\n\nexport const isDOMNode = (value: any): value is DOMNode => {\n  const window = getDefaultView(value)\n  return !!window && value instanceof window.Node\n}\n\n/**\n * Check if a value is a DOM selection.\n */\n\nexport const isDOMSelection = (value: any): value is DOMSelection => {\n  const window = value && value.anchorNode && getDefaultView(value.anchorNode)\n  return !!window && value instanceof window.Selection\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMText = (value: any): value is DOMText => {\n  return isDOMNode(value) && value.nodeType === 3\n}\n\n/**\n * Checks whether a paste event is a plaintext-only event.\n */\n\nexport const isPlainTextOnlyPaste = (event: ClipboardEvent) => {\n  return (\n    event.clipboardData &&\n    event.clipboardData.getData('text/plain') !== '' &&\n    event.clipboardData.types.length === 1\n  )\n}\n\n/**\n * Normalize a DOM point so that it always refers to a text node.\n */\n\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\n  let [node, offset] = domPoint\n\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (isDOMElement(node) && node.childNodes.length) {\n    let isLast = offset === node.childNodes.length\n    let index = isLast ? offset - 1 : offset\n    ;[node, index] = getEditableChildAndIndex(\n      node,\n      index,\n      isLast ? 'backward' : 'forward'\n    )\n    // If the editable child found is in front of input offset, we instead seek to its end\n    isLast = index < offset\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (isDOMElement(node) && node.childNodes.length) {\n      const i = isLast ? node.childNodes.length - 1 : 0\n      node = getEditableChild(node, i, isLast ? 'backward' : 'forward')\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\n  }\n\n  // Return the node and offset.\n  return [node, offset]\n}\n\n/**\n * Determines whether the active element is nested within a shadowRoot\n */\n\nexport const hasShadowRoot = (node: Node | null) => {\n  let parent = node && node.parentNode\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true\n    }\n    parent = parent.parentNode\n  }\n  return false\n}\n\n/**\n * Get the nearest editable child and index at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChildAndIndex = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): [DOMNode, number] => {\n  const { childNodes } = parent\n  let child = childNodes[index]\n  let i = index\n  let triedForward = false\n  let triedBackward = false\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (\n    isDOMComment(child) ||\n    (isDOMElement(child) && child.childNodes.length === 0) ||\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\n  ) {\n    if (triedForward && triedBackward) {\n      break\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true\n      i = index - 1\n      direction = 'backward'\n      continue\n    }\n\n    if (i < 0) {\n      triedBackward = true\n      i = index + 1\n      direction = 'forward'\n      continue\n    }\n\n    child = childNodes[i]\n    index = i\n    i += direction === 'forward' ? 1 : -1\n  }\n\n  return [child, index]\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChild = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): DOMNode => {\n  const [child] = getEditableChildAndIndex(parent, index, direction)\n  return child\n}\n\n/**\n * Get a plaintext representation of the content of a node, accounting for block\n * elements which get a newline appended.\n *\n * The domNode must be attached to the DOM.\n */\n\nexport const getPlainText = (domNode: DOMNode) => {\n  let text = ''\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue\n  }\n\n  if (isDOMElement(domNode)) {\n    for (const childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode)\n    }\n\n    const display = getComputedStyle(domNode).getPropertyValue('display')\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n'\n    }\n  }\n\n  return text\n}\n\n/**\n * Get x-slate-fragment attribute from data-slate-fragment\n */\nconst catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m\nexport const getSlateFragmentAttribute = (\n  dataTransfer: DataTransfer\n): string | void => {\n  const htmlData = dataTransfer.getData('text/html')\n  const [, fragment] = htmlData.match(catchSlateFragment) || []\n  return fragment\n}\n\n/**\n * Get the x-slate-fragment attribute that exist in text/html data\n * and append it to the DataTransfer object\n */\nexport const getClipboardData = (\n  dataTransfer: DataTransfer,\n  clipboardFormatKey = 'x-slate-fragment'\n): DataTransfer => {\n  if (!dataTransfer.getData(`application/${clipboardFormatKey}`)) {\n    const fragment = getSlateFragmentAttribute(dataTransfer)\n    if (fragment) {\n      const clipboardData = new DataTransfer()\n      dataTransfer.types.forEach(type => {\n        clipboardData.setData(type, dataTransfer.getData(type))\n      })\n      clipboardData.setData(`application/${clipboardFormatKey}`, fragment)\n      return clipboardData\n    }\n  }\n  return dataTransfer\n}\n\n/**\n * Check whether a mutation originates from a editable element inside the editor.\n */\n\nexport const isTrackedMutation = (\n  editor: ReactEditor,\n  mutation: MutationRecord,\n  batch: MutationRecord[]\n): boolean => {\n  const { target } = mutation\n  if (isDOMElement(target) && target.matches('[contentEditable=\"false\"]')) {\n    return false\n  }\n\n  const { document } = ReactEditor.getWindow(editor)\n  if (document.contains(target)) {\n    return ReactEditor.hasDOMNode(editor, target, { editable: true })\n  }\n\n  const parentMutation = batch.find(({ addedNodes, removedNodes }) => {\n    for (const node of addedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n\n    for (const node of removedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n  })\n\n  if (!parentMutation || parentMutation === mutation) {\n    return false\n  }\n\n  // Target add/remove is tracked. Track the mutation if we track the parent mutation.\n  return isTrackedMutation(editor, parentMutation, batch)\n}\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * An auto-incrementing identifier for keys.\n */\n\nlet n = 0\n\n/**\n * A class that keeps track of a key string. We use a full class here because we\n * want to be able to use them as keys in `WeakMap` objects.\n */\n\nexport class Key {\n  id: string\n\n  constructor() {\n    this.id = `${n++}`\n  }\n}\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Path,\n  Point,\n  Range,\n  Scrubber,\n  Transforms,\n} from 'slate'\nimport { TextDiff } from '../utils/diff-text'\nimport {\n  DOMElement,\n  DOMNode,\n  DOMPoint,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n  DOMText,\n  hasShadowRoot,\n  isDOMElement,\n  isDOMNode,\n  isDOMSelection,\n  normalizeDOMPoint,\n} from '../utils/dom'\nimport { IS_ANDROID, IS_CHROME, IS_FIREFOX } from '../utils/environment'\n\nimport { Key } from '../utils/key'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  NODE_TO_INDEX,\n  NODE_TO_KEY,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\n\n/**\n * A React and DOM-specific version of the `Editor` interface.\n */\n\nexport interface ReactEditor extends BaseEditor {\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  insertData: (data: DataTransfer) => void\n  insertFragmentData: (data: DataTransfer) => boolean\n  insertTextData: (data: DataTransfer) => boolean\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  setFragmentData: (\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n}\n\nexport interface ReactEditorInterface {\n  /**\n   * Experimental and android specific: Get pending diffs\n   */\n  androidPendingDiffs: (editor: Editor) => TextDiff[] | undefined\n\n  /**\n   * Experimental and android specific: Flush all pending diffs and cancel composition at the next possible time.\n   */\n  androidScheduleFlush: (editor: Editor) => void\n\n  /**\n   * Blur the editor.\n   */\n  blur: (editor: ReactEditor) => void\n\n  /**\n   * Deselect the editor.\n   */\n  deselect: (editor: ReactEditor) => void\n\n  /**\n   * Find the DOM node that implements DocumentOrShadowRoot for the editor.\n   */\n  findDocumentOrShadowRoot: (editor: ReactEditor) => Document | ShadowRoot\n\n  /**\n   * Get the target range from a DOM `event`.\n   */\n  findEventRange: (editor: ReactEditor, event: any) => Range\n\n  /**\n   * Find a key for a Slate node.\n   */\n  findKey: (editor: ReactEditor, node: Node) => Key\n\n  /**\n   * Find the path of Slate node.\n   */\n  findPath: (editor: ReactEditor, node: Node) => Path\n\n  /**\n   * Focus the editor.\n   */\n  focus: (editor: ReactEditor) => void\n\n  /**\n   * Return the host window of the current editor.\n   */\n  getWindow: (editor: ReactEditor) => Window\n\n  /**\n   * Check if a DOM node is within the editor.\n   */\n  hasDOMNode: (\n    editor: ReactEditor,\n    target: DOMNode,\n    options?: { editable?: boolean }\n  ) => boolean\n\n  /**\n   * Check if the target is editable and in the editor.\n   */\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   *\n   */\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n\n  /**\n   * Check if the target can be selectable\n   */\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Check if the target is in the editor.\n   */\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   * Insert data from a `DataTransfer` into the editor.\n   */\n  insertData: (editor: ReactEditor, data: DataTransfer) => void\n\n  /**\n   * Insert fragment data from a `DataTransfer` into the editor.\n   */\n  insertFragmentData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Insert text data from a `DataTransfer` into the editor.\n   */\n  insertTextData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Check if the user is currently composing inside the editor.\n   */\n  isComposing: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is focused.\n   */\n  isFocused: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is in read-only mode.\n   */\n  isReadOnly: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the target is inside void and in an non-readonly editor.\n   */\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Sets data from the currently selected fragment on a `DataTransfer`.\n   */\n  setFragmentData: (\n    editor: ReactEditor,\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n\n  /**\n   * Find the native DOM element from a Slate node.\n   */\n  toDOMNode: (editor: ReactEditor, node: Node) => HTMLElement\n\n  /**\n   * Find a native DOM selection point from a Slate point.\n   */\n  toDOMPoint: (editor: ReactEditor, point: Point) => DOMPoint\n\n  /**\n   * Find a native DOM range from a Slate `range`.\n   *\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\n   *\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\n   */\n  toDOMRange: (editor: ReactEditor, range: Range) => DOMRange\n\n  /**\n   * Find a Slate node from a native DOM `element`.\n   */\n  toSlateNode: (editor: ReactEditor, domNode: DOMNode) => Node\n\n  /**\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\n   */\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Point | null : Point\n\n  /**\n   * Find a Slate range from a DOM range or selection.\n   */\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Range | null : Range\n}\n\n// eslint-disable-next-line no-redeclare\nexport const ReactEditor: ReactEditorInterface = {\n  androidPendingDiffs: editor => EDITOR_TO_PENDING_DIFFS.get(editor),\n\n  androidScheduleFlush: editor => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(editor)?.()\n  },\n\n  blur: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, false)\n\n    if (root.activeElement === el) {\n      el.blur()\n    }\n  },\n\n  deselect: editor => {\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges()\n    }\n\n    if (selection) {\n      Transforms.deselect(editor)\n    }\n  },\n\n  findDocumentOrShadowRoot: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = el.getRootNode()\n\n    if (\n      (root instanceof Document || root instanceof ShadowRoot) &&\n      root.getSelection != null\n    ) {\n      return root\n    }\n\n    return el.ownerDocument\n  },\n\n  findEventRange: (editor, event) => {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent\n    }\n\n    const { clientX: x, clientY: y, target } = event\n\n    if (x == null || y == null) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    const node = ReactEditor.toSlateNode(editor, event.target)\n    const path = ReactEditor.findPath(editor, node)\n\n    // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n    if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n      const rect = target.getBoundingClientRect()\n      const isPrev = editor.isInline(node)\n        ? x - rect.left < rect.left + rect.width - x\n        : y - rect.top < rect.top + rect.height - y\n\n      const edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end',\n      })\n      const point = isPrev\n        ? Editor.before(editor, edge)\n        : Editor.after(editor, edge)\n\n      if (point) {\n        const range = Editor.range(editor, point)\n        return range\n      }\n    }\n\n    // Else resolve a range from the caret position where the drop occured.\n    let domRange\n    const { document } = ReactEditor.getWindow(editor)\n\n    // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y)\n    } else {\n      const position = document.caretPositionFromPoint(x, y)\n\n      if (position) {\n        domRange = document.createRange()\n        domRange.setStart(position.offsetNode, position.offset)\n        domRange.setEnd(position.offsetNode, position.offset)\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    // Resolve a Slate range from the DOM range.\n    const range = ReactEditor.toSlateRange(editor, domRange, {\n      exactMatch: false,\n      suppressThrow: false,\n    })\n    return range\n  },\n\n  findKey: (editor, node) => {\n    let key = NODE_TO_KEY.get(node)\n\n    if (!key) {\n      key = new Key()\n      NODE_TO_KEY.set(node, key)\n    }\n\n    return key\n  },\n\n  findPath: (editor, node) => {\n    const path: Path = []\n    let child = node\n\n    while (true) {\n      const parent = NODE_TO_PARENT.get(child)\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path\n        } else {\n          break\n        }\n      }\n\n      const i = NODE_TO_INDEX.get(child)\n\n      if (i == null) {\n        break\n      }\n\n      path.unshift(i)\n      child = parent\n    }\n\n    throw new Error(\n      `Unable to find the path for Slate node: ${Scrubber.stringify(node)}`\n    )\n  },\n\n  focus: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, true)\n\n    if (root.activeElement !== el) {\n      el.focus({ preventScroll: true })\n    }\n  },\n\n  getWindow: editor => {\n    const window = EDITOR_TO_WINDOW.get(editor)\n    if (!window) {\n      throw new Error('Unable to find a host window element for this editor')\n    }\n    return window\n  },\n\n  hasDOMNode: (editor, target, options = {}) => {\n    const { editable = false } = options\n    const editorEl = ReactEditor.toDOMNode(editor, editor)\n    let targetEl\n\n    // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n    try {\n      targetEl = (isDOMElement(target)\n        ? target\n        : target.parentElement) as HTMLElement\n    } catch (err) {\n      if (\n        !err.message.includes('Permission denied to access property \"nodeType\"')\n      ) {\n        throw err\n      }\n    }\n\n    if (!targetEl) {\n      return false\n    }\n\n    return (\n      targetEl.closest(`[data-slate-editor]`) === editorEl &&\n      (!editable || targetEl.isContentEditable\n        ? true\n        : (typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined\n            // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable=\"false\"(readOnly)\n            targetEl.closest('[contenteditable=\"false\"]') === editorEl) ||\n          !!targetEl.getAttribute('data-slate-zero-width'))\n    )\n  },\n\n  hasEditableTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) &&\n    ReactEditor.hasDOMNode(editor, target, { editable: true }),\n\n  hasRange: (editor, range) => {\n    const { anchor, focus } = range\n    return (\n      Editor.hasPath(editor, anchor.path) && Editor.hasPath(editor, focus.path)\n    )\n  },\n\n  hasSelectableTarget: (editor, target) =>\n    ReactEditor.hasEditableTarget(editor, target) ||\n    ReactEditor.isTargetInsideNonReadonlyVoid(editor, target),\n\n  hasTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) && ReactEditor.hasDOMNode(editor, target),\n\n  insertData: (editor, data) => {\n    editor.insertData(data)\n  },\n\n  insertFragmentData: (editor, data) => editor.insertFragmentData(data),\n\n  insertTextData: (editor, data) => editor.insertTextData(data),\n\n  isComposing: editor => {\n    return !!IS_COMPOSING.get(editor)\n  },\n\n  isFocused: editor => !!IS_FOCUSED.get(editor),\n\n  isReadOnly: editor => !!IS_READ_ONLY.get(editor),\n\n  isTargetInsideNonReadonlyVoid: (editor, target) => {\n    if (IS_READ_ONLY.get(editor)) return false\n\n    const slateNode =\n      ReactEditor.hasTarget(editor, target) &&\n      ReactEditor.toSlateNode(editor, target)\n    return Element.isElement(slateNode) && Editor.isVoid(editor, slateNode)\n  },\n\n  setFragmentData: (editor, data, originEvent) =>\n    editor.setFragmentData(data, originEvent),\n\n  toDOMNode: (editor, node) => {\n    const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n    const domNode = Editor.isEditor(node)\n      ? EDITOR_TO_ELEMENT.get(editor)\n      : KEY_TO_ELEMENT?.get(ReactEditor.findKey(editor, node))\n\n    if (!domNode) {\n      throw new Error(\n        `Cannot resolve a DOM node from Slate node: ${Scrubber.stringify(node)}`\n      )\n    }\n\n    return domNode\n  },\n\n  toDOMPoint: (editor, point) => {\n    const [node] = Editor.node(editor, point.path)\n    const el = ReactEditor.toDOMNode(editor, node)\n    let domPoint: DOMPoint | undefined\n\n    // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n    if (Editor.void(editor, { at: point })) {\n      point = { path: point.path, offset: 0 }\n    }\n\n    // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n    const selector = `[data-slate-string], [data-slate-zero-width]`\n    const texts = Array.from(el.querySelectorAll(selector))\n    let start = 0\n\n    for (let i = 0; i < texts.length; i++) {\n      const text = texts[i]\n      const domNode = text.childNodes[0] as HTMLElement\n\n      if (domNode == null || domNode.textContent == null) {\n        continue\n      }\n\n      const { length } = domNode.textContent\n      const attr = text.getAttribute('data-slate-length')\n      const trueLength = attr == null ? length : parseInt(attr, 10)\n      const end = start + trueLength\n\n      // Prefer putting the selection inside the mark placeholder to ensure\n      // composed text is displayed with the correct marks.\n      const nextText = texts[i + 1]\n      if (\n        point.offset === end &&\n        nextText?.hasAttribute('data-slate-mark-placeholder')\n      ) {\n        const domText = nextText.childNodes[0]\n\n        domPoint = [\n          // COMPAT: If we don't explicity set the dom point to be on the actual\n          // dom text element, chrome will put the selection behind the actual dom\n          // text element, causing domRange.getBoundingClientRect() calls on a collapsed\n          // selection to return incorrect zero values (https://bugs.chromium.org/p/chromium/issues/detail?id=435438)\n          // which will cause issues when scrolling to it.\n          domText instanceof DOMText ? domText : nextText,\n          nextText.textContent?.startsWith('\\uFEFF') ? 1 : 0,\n        ]\n        break\n      }\n\n      if (point.offset <= end) {\n        const offset = Math.min(length, Math.max(0, point.offset - start))\n        domPoint = [domNode, offset]\n        break\n      }\n\n      start = end\n    }\n\n    if (!domPoint) {\n      throw new Error(\n        `Cannot resolve a DOM point from Slate point: ${Scrubber.stringify(\n          point\n        )}`\n      )\n    }\n\n    return domPoint\n  },\n\n  toDOMRange: (editor, range) => {\n    const { anchor, focus } = range\n    const isBackward = Range.isBackward(range)\n    const domAnchor = ReactEditor.toDOMPoint(editor, anchor)\n    const domFocus = Range.isCollapsed(range)\n      ? domAnchor\n      : ReactEditor.toDOMPoint(editor, focus)\n\n    const window = ReactEditor.getWindow(editor)\n    const domRange = window.document.createRange()\n    const [startNode, startOffset] = isBackward ? domFocus : domAnchor\n    const [endNode, endOffset] = isBackward ? domAnchor : domFocus\n\n    // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n    const startEl = (isDOMElement(startNode)\n      ? startNode\n      : startNode.parentElement) as HTMLElement\n    const isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width')\n    const endEl = (isDOMElement(endNode)\n      ? endNode\n      : endNode.parentElement) as HTMLElement\n    const isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width')\n\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset)\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset)\n    return domRange\n  },\n\n  toSlateNode: (editor, domNode) => {\n    let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(`[data-slate-node]`)\n    }\n\n    const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\n\n    if (!node) {\n      throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\n    }\n\n    return node\n  },\n\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Point | null : Point => {\n    const { exactMatch, suppressThrow } = options\n    const [nearestNode, nearestOffset] = exactMatch\n      ? domPoint\n      : normalizeDOMPoint(domPoint)\n    const parentNode = nearestNode.parentNode as DOMElement\n    let textNode: DOMElement | null = null\n    let offset = 0\n\n    if (parentNode) {\n      const editorEl = ReactEditor.toDOMNode(editor, editor)\n      const potentialVoidNode = parentNode.closest('[data-slate-void=\"true\"]')\n      // Need to ensure that the closest void node is actually a void node\n      // within this editor, and not a void node within some parent editor. This can happen\n      // if this editor is within a void node of another editor (\"nested editors\", like in\n      // the \"Editable Voids\" example on the docs site).\n      const voidNode =\n        potentialVoidNode && editorEl.contains(potentialVoidNode)\n          ? potentialVoidNode\n          : null\n      let leafNode = parentNode.closest('[data-slate-leaf]')\n      let domNode: DOMElement | null = null\n\n      // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]')\n\n        if (textNode) {\n          const window = ReactEditor.getWindow(editor)\n          const range = window.document.createRange()\n          range.setStart(textNode, 0)\n          range.setEnd(nearestNode, nearestOffset)\n\n          const contents = range.cloneContents()\n          const removals = [\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[data-slate-zero-width]')\n            ),\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[contenteditable=false]')\n            ),\n          ]\n\n          removals.forEach(el => {\n            // COMPAT: While composing at the start of a text node, some keyboards put\n            // the text content inside the zero width space.\n            if (\n              IS_ANDROID &&\n              !exactMatch &&\n              el.hasAttribute('data-slate-zero-width') &&\n              el.textContent.length > 0 &&\n              el.textContext !== '\\uFEFF'\n            ) {\n              if (el.textContent.startsWith('\\uFEFF')) {\n                el.textContent = el.textContent.slice(1)\n              }\n\n              return\n            }\n\n            el!.parentNode!.removeChild(el)\n          })\n\n          // COMPAT: Edge has a bug where Range.prototype.toString() will\n          // convert \\n into \\r\\n. The bug causes a loop when slate-react\n          // attempts to reposition its cursor to match the native position. Use\n          // textContent.length instead.\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n          offset = contents.textContent!.length\n          domNode = textNode\n        }\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent and taking the\n        // first one that isn't inside a nested editor.\n        const leafNodes = voidNode.querySelectorAll('[data-slate-leaf]')\n        for (let index = 0; index < leafNodes.length; index++) {\n          const current = leafNodes[index]\n          if (ReactEditor.hasDOMNode(editor, current)) {\n            leafNode = current\n            break\n          }\n        }\n\n        // COMPAT: In read-only editors the leaf is not rendered.\n        if (!leafNode) {\n          offset = 1\n        } else {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          offset = domNode.textContent!.length\n          domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n            offset -= el.textContent!.length\n          })\n        }\n      }\n\n      if (\n        domNode &&\n        offset === domNode.textContent!.length &&\n        // COMPAT: Android IMEs might remove the zero width space while composing,\n        // and we don't add it for line-breaks.\n        IS_ANDROID &&\n        domNode.getAttribute('data-slate-zero-width') === 'z' &&\n        domNode.textContent?.startsWith('\\uFEFF') &&\n        // COMPAT: If the parent node is a Slate zero-width space, editor is\n        // because the text node should have no characters. However, during IME\n        // composition the ASCII characters will be prepended to the zero-width\n        // space, so subtract 1 from the offset to account for the zero-width\n        // space character.\n        (parentNode.hasAttribute('data-slate-zero-width') ||\n          // COMPAT: In Firefox, `range.cloneContents()` returns an extra trailing '\\n'\n          // when the document ends with a new-line character. This results in the offset\n          // length being off by one, so we need to subtract one to account for this.\n          (IS_FIREFOX && domNode.textContent?.endsWith('\\n\\n')))\n      ) {\n        offset--\n      }\n    }\n\n    if (IS_ANDROID && !textNode && !exactMatch) {\n      const node = parentNode.hasAttribute('data-slate-node')\n        ? parentNode\n        : parentNode.closest('[data-slate-node]')\n\n      if (node && ReactEditor.hasDOMNode(editor, node, { editable: true })) {\n        const slateNode = ReactEditor.toSlateNode(editor, node)\n        let { path, offset } = Editor.start(\n          editor,\n          ReactEditor.findPath(editor, slateNode)\n        )\n\n        if (!node.querySelector('[data-slate-leaf]')) {\n          offset = nearestOffset\n        }\n\n        return { path, offset } as T extends true ? Point | null : Point\n      }\n    }\n\n    if (!textNode) {\n      if (suppressThrow) {\n        return null as T extends true ? Point | null : Point\n      }\n      throw new Error(\n        `Cannot resolve a Slate point from DOM point: ${domPoint}`\n      )\n    }\n\n    // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n    const slateNode = ReactEditor.toSlateNode(editor, textNode!)\n    const path = ReactEditor.findPath(editor, slateNode)\n    return { path, offset } as T extends true ? Point | null : Point\n  },\n\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Range | null : Range => {\n    const { exactMatch, suppressThrow } = options\n    const el = isDOMSelection(domRange)\n      ? domRange.anchorNode\n      : domRange.startContainer\n    let anchorNode\n    let anchorOffset\n    let focusNode\n    let focusOffset\n    let isCollapsed\n\n    if (el) {\n      if (isDOMSelection(domRange)) {\n        // COMPAT: In firefox the normal seletion way does not work\n        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n        if (IS_FIREFOX && domRange.rangeCount > 1) {\n          focusNode = domRange.focusNode // Focus node works fine\n          const firstRange = domRange.getRangeAt(0)\n          const lastRange = domRange.getRangeAt(domRange.rangeCount - 1)\n\n          // Right to left\n          if (firstRange.startContainer === focusNode) {\n            anchorNode = lastRange.endContainer\n            anchorOffset = lastRange.endOffset\n            focusOffset = firstRange.startOffset\n          } else {\n            // Left to right\n            anchorNode = firstRange.startContainer\n            anchorOffset = firstRange.endOffset\n            focusOffset = lastRange.startOffset\n          }\n        } else {\n          anchorNode = domRange.anchorNode\n          anchorOffset = domRange.anchorOffset\n          focusNode = domRange.focusNode\n          focusOffset = domRange.focusOffset\n        }\n\n        // COMPAT: There's a bug in chrome that always returns `true` for\n        // `isCollapsed` for a Selection that comes from a ShadowRoot.\n        // (2020/08/08)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n        // IsCollapsed might not work in firefox, but this will\n        if ((IS_CHROME && hasShadowRoot(anchorNode)) || IS_FIREFOX) {\n          isCollapsed =\n            domRange.anchorNode === domRange.focusNode &&\n            domRange.anchorOffset === domRange.focusOffset\n        } else {\n          isCollapsed = domRange.isCollapsed\n        }\n      } else {\n        anchorNode = domRange.startContainer\n        anchorOffset = domRange.startOffset\n        focusNode = domRange.endContainer\n        focusOffset = domRange.endOffset\n        isCollapsed = domRange.collapsed\n      }\n    }\n\n    if (\n      anchorNode == null ||\n      focusNode == null ||\n      anchorOffset == null ||\n      focusOffset == null\n    ) {\n      throw new Error(\n        `Cannot resolve a Slate range from DOM range: ${domRange}`\n      )\n    }\n\n    // COMPAT: Triple-clicking a word in chrome will sometimes place the focus\n    // inside a `contenteditable=\"false\"` DOM node following the word, which\n    // will cause `toSlatePoint` to throw an error. (2023/03/07)\n    if (\n      'getAttribute' in focusNode &&\n      (focusNode as HTMLElement).getAttribute('contenteditable') === 'false' &&\n      (focusNode as HTMLElement).getAttribute('data-slate-void') !== 'true'\n    ) {\n      focusNode = anchorNode\n      focusOffset = anchorNode.textContent?.length || 0\n    }\n\n    const anchor = ReactEditor.toSlatePoint(\n      editor,\n      [anchorNode, anchorOffset],\n      {\n        exactMatch,\n        suppressThrow,\n      }\n    )\n    if (!anchor) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    const focus = isCollapsed\n      ? anchor\n      : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset], {\n          exactMatch,\n          suppressThrow,\n        })\n    if (!focus) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    let range: Range = { anchor: anchor as Point, focus: focus as Point }\n    // if the selection is a hanging range that ends in a void\n    // and the DOM focus is an Element\n    // (meaning that the selection ends before the element)\n    // unhang the range to avoid mistakenly including the void\n    if (\n      Range.isExpanded(range) &&\n      Range.isForward(range) &&\n      isDOMElement(focusNode) &&\n      Editor.void(editor, { at: range.focus, mode: 'highest' })\n    ) {\n      range = Editor.unhangRange(editor, range, { voids: true })\n    }\n\n    return (range as unknown) as T extends true ? Range | null : Range\n  },\n}\n","import {\n  Editor,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Text,\n  Element,\n} from 'slate'\nimport { EDITOR_TO_PENDING_DIFFS } from './weak-maps'\n\nexport type StringDiff = {\n  start: number\n  end: number\n  text: string\n}\n\nexport type TextDiff = {\n  id: number\n  path: Path\n  diff: StringDiff\n}\n\n/**\n * Check whether a text diff was applied in a way we can perform the pending action on /\n * recover the pending selection.\n */\nexport function verifyDiffState(editor: Editor, textDiff: TextDiff): boolean {\n  const { path, diff } = textDiff\n  if (!Editor.hasPath(editor, path)) {\n    return false\n  }\n\n  const node = Node.get(editor, path)\n  if (!Text.isText(node)) {\n    return false\n  }\n\n  if (diff.start !== node.text.length || diff.text.length === 0) {\n    return (\n      node.text.slice(diff.start, diff.start + diff.text.length) === diff.text\n    )\n  }\n\n  const nextPath = Path.next(path)\n  if (!Editor.hasPath(editor, nextPath)) {\n    return false\n  }\n\n  const nextNode = Node.get(editor, nextPath)\n  return Text.isText(nextNode) && nextNode.text.startsWith(diff.text)\n}\n\nexport function applyStringDiff(text: string, ...diffs: StringDiff[]) {\n  return diffs.reduce(\n    (text, diff) =>\n      text.slice(0, diff.start) + diff.text + text.slice(diff.end),\n    text\n  )\n}\n\nfunction longestCommonPrefixLength(str: string, another: string) {\n  const length = Math.min(str.length, another.length)\n\n  for (let i = 0; i < length; i++) {\n    if (str.charAt(i) !== another.charAt(i)) {\n      return i\n    }\n  }\n\n  return length\n}\n\nfunction longestCommonSuffixLength(\n  str: string,\n  another: string,\n  max: number\n): number {\n  const length = Math.min(str.length, another.length, max)\n\n  for (let i = 0; i < length; i++) {\n    if (\n      str.charAt(str.length - i - 1) !== another.charAt(another.length - i - 1)\n    ) {\n      return i\n    }\n  }\n\n  return length\n}\n\n/**\n * Remove redundant changes from the diff so that it spans the minimal possible range\n */\nexport function normalizeStringDiff(targetText: string, diff: StringDiff) {\n  const { start, end, text } = diff\n  const removedText = targetText.slice(start, end)\n\n  const prefixLength = longestCommonPrefixLength(removedText, text)\n  const max = Math.min(\n    removedText.length - prefixLength,\n    text.length - prefixLength\n  )\n  const suffixLength = longestCommonSuffixLength(removedText, text, max)\n\n  const normalized: StringDiff = {\n    start: start + prefixLength,\n    end: end - suffixLength,\n    text: text.slice(prefixLength, text.length - suffixLength),\n  }\n\n  if (normalized.start === normalized.end && normalized.text.length === 0) {\n    return null\n  }\n\n  return normalized\n}\n\n/**\n * Return a string diff that is equivalent to applying b after a spanning the range of\n * both changes\n */\nexport function mergeStringDiffs(\n  targetText: string,\n  a: StringDiff,\n  b: StringDiff\n): StringDiff | null {\n  const start = Math.min(a.start, b.start)\n  const overlap = Math.max(\n    0,\n    Math.min(a.start + a.text.length, b.end) - b.start\n  )\n\n  const applied = applyStringDiff(targetText, a, b)\n  const sliceEnd = Math.max(\n    b.start + b.text.length,\n    a.start +\n      a.text.length +\n      (a.start + a.text.length > b.start ? b.text.length : 0) -\n      overlap\n  )\n\n  const text = applied.slice(start, sliceEnd)\n  const end = Math.max(a.end, b.end - a.text.length + (a.end - a.start))\n  return normalizeStringDiff(targetText, { start, end, text })\n}\n\n/**\n * Get the slate range the text diff spans.\n */\nexport function targetRange(textDiff: TextDiff): Range {\n  const { path, diff } = textDiff\n  return {\n    anchor: { path, offset: diff.start },\n    focus: { path, offset: diff.end },\n  }\n}\n\n/**\n * Normalize a 'pending point' a.k.a a point based on the dom state before applying\n * the pending diffs. Since the pending diffs might have been inserted with different\n * marks we have to 'walk' the offset from the starting position to ensure we still\n * have a valid point inside the document\n */\nexport function normalizePoint(editor: Editor, point: Point): Point | null {\n  let { path, offset } = point\n  if (!Editor.hasPath(editor, path)) {\n    return null\n  }\n\n  let leaf = Node.get(editor, path)\n  if (!Text.isText(leaf)) {\n    return null\n  }\n\n  const parentBlock = Editor.above(editor, {\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n    at: path,\n  })\n\n  if (!parentBlock) {\n    return null\n  }\n\n  while (offset > leaf.text.length) {\n    const entry = Editor.next(editor, { at: path, match: Text.isText })\n    if (!entry || !Path.isDescendant(entry[1], parentBlock[1])) {\n      return null\n    }\n\n    offset -= leaf.text.length\n    leaf = entry[0]\n    path = entry[1]\n  }\n\n  return { path, offset }\n}\n\n/**\n * Normalize a 'pending selection' to ensure it's valid in the current document state.\n */\nexport function normalizeRange(editor: Editor, range: Range): Range | null {\n  const anchor = normalizePoint(editor, range.anchor)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = normalizePoint(editor, range.focus)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformPendingPoint(\n  editor: Editor,\n  point: Point,\n  op: Operation\n): Point | null {\n  const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n  const textDiff = pendingDiffs?.find(({ path }) =>\n    Path.equals(path, point.path)\n  )\n\n  if (!textDiff || point.offset <= textDiff.diff.start) {\n    return Point.transform(point, op, { affinity: 'backward' })\n  }\n\n  const { diff } = textDiff\n  // Point references location inside the diff => transform the point based on the location\n  // the diff will be applied to and add the offset inside the diff.\n  if (point.offset <= diff.start + diff.text.length) {\n    const anchor = { path: point.path, offset: diff.start }\n    const transformed = Point.transform(anchor, op, {\n      affinity: 'backward',\n    })\n\n    if (!transformed) {\n      return null\n    }\n\n    return {\n      path: transformed.path,\n      offset: transformed.offset + point.offset - diff.start,\n    }\n  }\n\n  // Point references location after the diff\n  const anchor = {\n    path: point.path,\n    offset: point.offset - diff.text.length + diff.end - diff.start,\n  }\n  const transformed = Point.transform(anchor, op, {\n    affinity: 'backward',\n  })\n  if (!transformed) {\n    return null\n  }\n\n  if (\n    op.type === 'split_node' &&\n    Path.equals(op.path, point.path) &&\n    anchor.offset < op.position &&\n    diff.start < op.position\n  ) {\n    return transformed\n  }\n\n  return {\n    path: transformed.path,\n    offset: transformed.offset + diff.text.length - diff.end + diff.start,\n  }\n}\n\nexport function transformPendingRange(\n  editor: Editor,\n  range: Range,\n  op: Operation\n): Range | null {\n  const anchor = transformPendingPoint(editor, range.anchor, op)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = transformPendingPoint(editor, range.focus, op)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformTextDiff(\n  textDiff: TextDiff,\n  op: Operation\n): TextDiff | null {\n  const { path, diff, id } = textDiff\n\n  switch (op.type) {\n    case 'insert_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset <= diff.start) {\n        return {\n          diff: {\n            start: op.text.length + diff.start,\n            end: op.text.length + diff.end,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end + op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'remove_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset + op.text.length <= diff.start) {\n        return {\n          diff: {\n            start: diff.start - op.text.length,\n            end: diff.end - op.text.length,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end - op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'split_node': {\n      if (!Path.equals(op.path, path) || op.position >= diff.end) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op, { affinity: 'backward' })!,\n        }\n      }\n\n      if (op.position > diff.start) {\n        return {\n          diff: {\n            start: diff.start,\n            end: Math.min(op.position, diff.end),\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start - op.position,\n          end: diff.end - op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op, { affinity: 'forward' })!,\n      }\n    }\n    case 'merge_node': {\n      if (!Path.equals(op.path, path)) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op)!,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start + op.position,\n          end: diff.end + op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op)!,\n      }\n    }\n  }\n\n  const newPath = Path.transform(path, op)\n  if (!newPath) {\n    return null\n  }\n\n  return {\n    diff,\n    path: newPath,\n    id,\n  }\n}\n","import { DebouncedFunc } from 'lodash'\nimport { Editor, Node, Path, Point, Range, Text, Transforms } from 'slate'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport {\n  applyStringDiff,\n  mergeStringDiffs,\n  normalizePoint,\n  normalizeRange,\n  normalizeStringDiff,\n  StringDiff,\n  targetRange,\n  TextDiff,\n  verifyDiffState,\n} from '../../utils/diff-text'\nimport { isDOMSelection, isTrackedMutation } from '../../utils/dom'\nimport {\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_USER_MARKS,\n  IS_COMPOSING,\n} from '../../utils/weak-maps'\n\nexport type Action = { at?: Point | Range; run: () => void }\n\n// https://github.com/facebook/draft-js/blob/main/src/component/handlers/composition/DraftEditorCompositionHandler.js#L41\n// When using keyboard English association function, conpositionEnd triggered too fast, resulting in after `insertText` still maintain association state.\nconst RESOLVE_DELAY = 25\n\n// Time with no user interaction before the current user action is considered as done.\nconst FLUSH_DELAY = 200\n\n// Replace with `const debug = console.log` to debug\nconst debug = (..._: unknown[]) => {}\n\n// Type guard to check if a value is a DataTransfer\nconst isDataTransfer = (value: any): value is DataTransfer =>\n  value?.constructor.name === 'DataTransfer'\n\nexport type CreateAndroidInputManagerOptions = {\n  editor: ReactEditor\n\n  scheduleOnDOMSelectionChange: DebouncedFunc<() => void>\n  onDOMSelectionChange: DebouncedFunc<() => void>\n}\n\nexport type AndroidInputManager = {\n  flush: () => void\n  scheduleFlush: () => void\n\n  hasPendingDiffs: () => boolean\n  hasPendingAction: () => boolean\n  hasPendingChanges: () => boolean\n  isFlushing: () => boolean | 'action'\n\n  handleUserSelect: (range: Range | null) => void\n  handleCompositionEnd: (event: React.CompositionEvent<HTMLDivElement>) => void\n  handleCompositionStart: (\n    event: React.CompositionEvent<HTMLDivElement>\n  ) => void\n  handleDOMBeforeInput: (event: InputEvent) => void\n  handleKeyDown: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  handleDomMutations: (mutations: MutationRecord[]) => void\n  handleInput: () => void\n}\n\nexport function createAndroidInputManager({\n  editor,\n  scheduleOnDOMSelectionChange,\n  onDOMSelectionChange,\n}: CreateAndroidInputManagerOptions): AndroidInputManager {\n  let flushing: 'action' | boolean = false\n  let compositionEndTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let flushTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let actionTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  let idCounter = 0\n  let insertPositionHint: StringDiff | null | false = false\n\n  const applyPendingSelection = () => {\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(editor)\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n\n    if (pendingSelection) {\n      const { selection } = editor\n      const normalized = normalizeRange(editor, pendingSelection)\n\n      debug('apply pending selection', pendingSelection, normalized)\n\n      if (normalized && (!selection || !Range.equals(normalized, selection))) {\n        Transforms.select(editor, normalized)\n      }\n    }\n  }\n\n  const performAction = () => {\n    const action = EDITOR_TO_PENDING_ACTION.get(editor)\n    EDITOR_TO_PENDING_ACTION.delete(editor)\n    if (!action) {\n      return\n    }\n\n    if (action.at) {\n      const target = Point.isPoint(action.at)\n        ? normalizePoint(editor, action.at)\n        : normalizeRange(editor, action.at)\n\n      if (!target) {\n        return\n      }\n\n      const targetRange = Editor.range(editor, target)\n      if (!editor.selection || !Range.equals(editor.selection, targetRange)) {\n        Transforms.select(editor, target)\n      }\n    }\n\n    action.run()\n  }\n\n  const flush = () => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    if (actionTimeoutId) {\n      clearTimeout(actionTimeoutId)\n      actionTimeoutId = null\n    }\n\n    if (!hasPendingDiffs() && !hasPendingAction()) {\n      applyPendingSelection()\n      return\n    }\n\n    if (!flushing) {\n      flushing = true\n      setTimeout(() => (flushing = false))\n    }\n\n    if (hasPendingAction()) {\n      flushing = 'action'\n    }\n\n    const selectionRef =\n      editor.selection &&\n      Editor.rangeRef(editor, editor.selection, { affinity: 'forward' })\n    EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n\n    debug(\n      'flush',\n      EDITOR_TO_PENDING_ACTION.get(editor),\n      EDITOR_TO_PENDING_DIFFS.get(editor)\n    )\n\n    let scheduleSelectionChange = hasPendingDiffs()\n\n    let diff: TextDiff | undefined\n    while ((diff = EDITOR_TO_PENDING_DIFFS.get(editor)?.[0])) {\n      const pendingMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)\n\n      if (pendingMarks !== undefined) {\n        EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n        editor.marks = pendingMarks\n      }\n\n      if (pendingMarks && insertPositionHint === false) {\n        insertPositionHint = null\n        debug('insert after mark placeholder')\n      }\n\n      const range = targetRange(diff)\n      if (!editor.selection || !Range.equals(editor.selection, range)) {\n        Transforms.select(editor, range)\n      }\n\n      if (diff.diff.text) {\n        Editor.insertText(editor, diff.diff.text)\n      } else {\n        Editor.deleteFragment(editor)\n      }\n\n      // Remove diff only after we have applied it to account for it when transforming\n      // pending ranges.\n      EDITOR_TO_PENDING_DIFFS.set(\n        editor,\n        EDITOR_TO_PENDING_DIFFS.get(editor)?.filter(\n          ({ id }) => id !== diff!.id\n        )!\n      )\n\n      if (!verifyDiffState(editor, diff)) {\n        debug('invalid diff state')\n        scheduleSelectionChange = false\n        EDITOR_TO_PENDING_ACTION.delete(editor)\n        EDITOR_TO_USER_MARKS.delete(editor)\n        flushing = 'action'\n\n        // Ensure we don't restore the pending user (dom) selection\n        // since the document and dom state do not match.\n        EDITOR_TO_PENDING_SELECTION.delete(editor)\n        scheduleOnDOMSelectionChange.cancel()\n        onDOMSelectionChange.cancel()\n        selectionRef?.unref()\n      }\n    }\n\n    const selection = selectionRef?.unref()\n    if (\n      selection &&\n      !EDITOR_TO_PENDING_SELECTION.get(editor) &&\n      (!editor.selection || !Range.equals(selection, editor.selection))\n    ) {\n      Transforms.select(editor, selection)\n    }\n\n    if (hasPendingAction()) {\n      performAction()\n      return\n    }\n\n    // COMPAT: The selectionChange event is fired after the action is performed,\n    // so we have to manually schedule it to ensure we don't 'throw away' the selection\n    // while rendering if we have pending changes.\n    if (scheduleSelectionChange) {\n      debug('scheduleOnDOMSelectionChange pending changes')\n      scheduleOnDOMSelectionChange()\n    }\n\n    scheduleOnDOMSelectionChange.flush()\n    onDOMSelectionChange.flush()\n\n    applyPendingSelection()\n\n    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n    EDITOR_TO_USER_MARKS.delete(editor)\n    if (userMarks !== undefined) {\n      editor.marks = userMarks\n      editor.onChange()\n    }\n  }\n\n  const handleCompositionEnd = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n    }\n\n    compositionEndTimeoutId = setTimeout(() => {\n      IS_COMPOSING.set(editor, false)\n      flush()\n    }, RESOLVE_DELAY)\n  }\n\n  const handleCompositionStart = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    debug('composition start')\n\n    IS_COMPOSING.set(editor, true)\n\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n      compositionEndTimeoutId = null\n    }\n  }\n\n  const updatePlaceholderVisibility = (forceHide = false) => {\n    const placeholderElement = EDITOR_TO_PLACEHOLDER_ELEMENT.get(editor)\n    if (!placeholderElement) {\n      return\n    }\n\n    if (hasPendingDiffs() || forceHide) {\n      placeholderElement.style.display = 'none'\n      return\n    }\n\n    placeholderElement.style.removeProperty('display')\n  }\n\n  const storeDiff = (path: Path, diff: StringDiff) => {\n    debug('storeDiff', path, diff)\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor) ?? []\n    EDITOR_TO_PENDING_DIFFS.set(editor, pendingDiffs)\n\n    const target = Node.leaf(editor, path)\n    const idx = pendingDiffs.findIndex(change => Path.equals(change.path, path))\n    if (idx < 0) {\n      const normalized = normalizeStringDiff(target.text, diff)\n      if (normalized) {\n        pendingDiffs.push({ path, diff, id: idCounter++ })\n      }\n\n      updatePlaceholderVisibility()\n      return\n    }\n\n    const merged = mergeStringDiffs(target.text, pendingDiffs[idx].diff, diff)\n    if (!merged) {\n      pendingDiffs.splice(idx, 1)\n      updatePlaceholderVisibility()\n      return\n    }\n\n    pendingDiffs[idx] = {\n      ...pendingDiffs[idx],\n      diff: merged,\n    }\n  }\n\n  const scheduleAction = (\n    run: () => void,\n    { at }: { at?: Point | Range } = {}\n  ): void => {\n    insertPositionHint = false\n    debug('scheduleAction', { at, run })\n\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n    scheduleOnDOMSelectionChange.cancel()\n    onDOMSelectionChange.cancel()\n\n    if (hasPendingAction()) {\n      flush()\n    }\n\n    EDITOR_TO_PENDING_ACTION.set(editor, { at, run })\n\n    // COMPAT: When deleting before a non-contenteditable element chrome only fires a beforeinput,\n    // (no input) and doesn't perform any dom mutations. Without a flush timeout we would never flush\n    // in this case and thus never actually perform the action.\n    actionTimeoutId = setTimeout(flush)\n  }\n\n  const handleDOMBeforeInput = (event: InputEvent): void => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { inputType: type } = event\n    let targetRange: Range | null = null\n    const data: DataTransfer | string | undefined =\n      (event as any).dataTransfer || event.data || undefined\n\n    if (\n      insertPositionHint !== false &&\n      type !== 'insertText' &&\n      type !== 'insertCompositionText'\n    ) {\n      insertPositionHint = false\n    }\n\n    let [nativeTargetRange] = (event as any).getTargetRanges()\n    if (nativeTargetRange) {\n      targetRange = ReactEditor.toSlateRange(editor, nativeTargetRange, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    // COMPAT: SelectionChange event is fired after the action is performed, so we\n    // have to manually get the selection here to ensure it's up-to-date.\n    const window = ReactEditor.getWindow(editor)\n    const domSelection = window.getSelection()\n    if (!targetRange && domSelection) {\n      nativeTargetRange = domSelection\n      targetRange = ReactEditor.toSlateRange(editor, domSelection, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    targetRange = targetRange ?? editor.selection\n    if (!targetRange) {\n      return\n    }\n\n    // By default, the input manager tries to store text diffs so that we can\n    // defer flushing them at a later point in time. We don't want to flush\n    // for every input event as this can be expensive. However, there are some\n    // scenarios where we cannot safely store the text diff and must instead\n    // schedule an action to let Slate normalize the editor state.\n    let canStoreDiff = true\n\n    if (type.startsWith('delete')) {\n      if (Range.isExpanded(targetRange)) {\n        const [start, end] = Range.edges(targetRange)\n        const leaf = Node.leaf(editor, start.path)\n\n        if (leaf.text.length === start.offset && end.offset === 0) {\n          const next = Editor.next(editor, {\n            at: start.path,\n            match: Text.isText,\n          })\n          if (next && Path.equals(next[1], end.path)) {\n            targetRange = { anchor: end, focus: end }\n          }\n        }\n      }\n\n      const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n      const [start, end] = Range.edges(targetRange)\n      const [leaf, path] = Editor.leaf(editor, start.path)\n\n      const diff = {\n        text: '',\n        start: start.offset,\n        end: end.offset,\n      }\n      const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n      const relevantPendingDiffs = pendingDiffs?.find(change =>\n        Path.equals(change.path, path)\n      )\n      const diffs = relevantPendingDiffs\n        ? [relevantPendingDiffs.diff, diff]\n        : [diff]\n      const text = applyStringDiff(leaf.text, ...diffs)\n\n      if (text.length === 0) {\n        // Text leaf will be removed, so we need to schedule an\n        // action to remove it so that Slate can normalize instead\n        // of storing as a diff\n        canStoreDiff = false\n      }\n\n      if (Range.isExpanded(targetRange)) {\n        if (\n          canStoreDiff &&\n          Path.equals(targetRange.anchor.path, targetRange.focus.path)\n        ) {\n          const point = { path: targetRange.anchor.path, offset: start.offset }\n          const range = Editor.range(editor, point, point)\n          handleUserSelect(range)\n\n          return storeDiff(targetRange.anchor.path, {\n            text: '',\n            end: end.offset,\n            start: start.offset,\n          })\n        }\n\n        return scheduleAction(\n          () => Editor.deleteFragment(editor, { direction }),\n          { at: targetRange }\n        )\n      }\n    }\n\n    switch (type) {\n      case 'deleteByComposition':\n      case 'deleteByCut':\n      case 'deleteByDrag': {\n        return scheduleAction(() => Editor.deleteFragment(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContent':\n      case 'deleteContentForward': {\n        const { anchor } = targetRange\n        if (canStoreDiff && Range.isCollapsed(targetRange)) {\n          const targetNode = Node.leaf(editor, anchor.path)\n\n          if (anchor.offset < targetNode.text.length) {\n            return storeDiff(anchor.path, {\n              text: '',\n              start: anchor.offset,\n              end: anchor.offset + 1,\n            })\n          }\n        }\n\n        return scheduleAction(() => Editor.deleteForward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContentBackward': {\n        const { anchor } = targetRange\n\n        // If we have a mismatch between the native and slate selection being collapsed\n        // we are most likely deleting a zero-width placeholder and thus should perform it\n        // as an action to ensure correct behavior (mostly happens with mark placeholders)\n        const nativeCollapsed = isDOMSelection(nativeTargetRange)\n          ? nativeTargetRange.isCollapsed\n          : !!nativeTargetRange?.collapsed\n\n        if (\n          canStoreDiff &&\n          nativeCollapsed &&\n          Range.isCollapsed(targetRange) &&\n          anchor.offset > 0\n        ) {\n          return storeDiff(anchor.path, {\n            text: '',\n            start: anchor.offset - 1,\n            end: anchor.offset,\n          })\n        }\n\n        return scheduleAction(() => Editor.deleteBackward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteEntireSoftLine': {\n        return scheduleAction(\n          () => {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n          },\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'insertLineBreak': {\n        return scheduleAction(() => Editor.insertSoftBreak(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'insertParagraph': {\n        return scheduleAction(() => Editor.insertBreak(editor), {\n          at: targetRange,\n        })\n      }\n      case 'insertCompositionText':\n      case 'deleteCompositionText':\n      case 'insertFromComposition':\n      case 'insertFromDrop':\n      case 'insertFromPaste':\n      case 'insertFromYank':\n      case 'insertReplacementText':\n      case 'insertText': {\n        if (isDataTransfer(data)) {\n          return scheduleAction(() => ReactEditor.insertData(editor, data), {\n            at: targetRange,\n          })\n        }\n\n        let text = data ?? ''\n\n        // COMPAT: If we are writing inside a placeholder, the ime inserts the text inside\n        // the placeholder itself and thus includes the zero-width space inside edit events.\n        if (EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)) {\n          text = text.replace('\\uFEFF', '')\n        }\n\n        // Pastes from the Android clipboard will generate `insertText` events.\n        // If the copied text contains any newlines, Android will append an\n        // extra newline to the end of the copied text.\n        if (type === 'insertText' && /.*\\n.*\\n$/.test(text)) {\n          text = text.slice(0, -1)\n        }\n\n        // If the text includes a newline, split it at newlines and paste each component\n        // string, with soft breaks in between each.\n        if (text.includes('\\n')) {\n          return scheduleAction(\n            () => {\n              const parts = text.split('\\n')\n              parts.forEach((line, i) => {\n                if (line) {\n                  Editor.insertText(editor, line)\n                }\n                if (i !== parts.length - 1) {\n                  Editor.insertSoftBreak(editor)\n                }\n              })\n            },\n            {\n              at: targetRange,\n            }\n          )\n        }\n\n        if (Path.equals(targetRange.anchor.path, targetRange.focus.path)) {\n          const [start, end] = Range.edges(targetRange)\n\n          const diff = {\n            start: start.offset,\n            end: end.offset,\n            text,\n          }\n\n          // COMPAT: Swiftkey has a weird bug where the target range of the 2nd word\n          // inserted after a mark placeholder is inserted with an anchor offset off by 1.\n          // So writing 'some text' will result in 'some ttext'. Luckily all 'normal' insert\n          // text events are fired with the correct target ranges, only the final 'insertComposition'\n          // isn't, so we can adjust the target range start offset if we are confident this is the\n          // swiftkey insert causing the issue.\n          if (text && insertPositionHint && type === 'insertCompositionText') {\n            const hintPosition =\n              insertPositionHint.start + insertPositionHint.text.search(/\\S|$/)\n            const diffPosition = diff.start + diff.text.search(/\\S|$/)\n\n            if (\n              diffPosition === hintPosition + 1 &&\n              diff.end ===\n                insertPositionHint.start + insertPositionHint.text.length\n            ) {\n              debug('adjusting swiftKey insert position using hint')\n              diff.start -= 1\n              insertPositionHint = null\n              scheduleFlush()\n            } else {\n              insertPositionHint = false\n            }\n          } else if (type === 'insertText') {\n            if (insertPositionHint === null) {\n              insertPositionHint = diff\n            } else if (\n              insertPositionHint &&\n              Range.isCollapsed(targetRange) &&\n              insertPositionHint.end + insertPositionHint.text.length ===\n                start.offset\n            ) {\n              insertPositionHint = {\n                ...insertPositionHint,\n                text: insertPositionHint.text + text,\n              }\n            } else {\n              insertPositionHint = false\n            }\n          } else {\n            insertPositionHint = false\n          }\n\n          if (canStoreDiff) {\n            storeDiff(start.path, diff)\n            return\n          }\n        }\n\n        return scheduleAction(() => Editor.insertText(editor, text), {\n          at: targetRange,\n        })\n      }\n    }\n  }\n\n  const hasPendingAction = () => {\n    return !!EDITOR_TO_PENDING_ACTION.get(editor)\n  }\n\n  const hasPendingDiffs = () => {\n    return !!EDITOR_TO_PENDING_DIFFS.get(editor)?.length\n  }\n\n  const hasPendingChanges = () => {\n    return hasPendingAction() || hasPendingDiffs()\n  }\n\n  const isFlushing = () => {\n    return flushing\n  }\n\n  const handleUserSelect = (range: Range | null) => {\n    EDITOR_TO_PENDING_SELECTION.set(editor, range)\n\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { selection } = editor\n    if (!range) {\n      return\n    }\n\n    const pathChanged =\n      !selection || !Path.equals(selection.anchor.path, range.anchor.path)\n    const parentPathChanged =\n      !selection ||\n      !Path.equals(\n        selection.anchor.path.slice(0, -1),\n        range.anchor.path.slice(0, -1)\n      )\n\n    if ((pathChanged && insertPositionHint) || parentPathChanged) {\n      insertPositionHint = false\n    }\n\n    if (pathChanged || hasPendingDiffs()) {\n      flushTimeoutId = setTimeout(flush, FLUSH_DELAY)\n    }\n  }\n\n  const handleInput = () => {\n    if (hasPendingAction() || !hasPendingDiffs()) {\n      debug('flush input')\n      flush()\n    }\n  }\n\n  const handleKeyDown = (_: React.KeyboardEvent) => {\n    // COMPAT: Swiftkey closes the keyboard when typing inside a empty node\n    // directly next to a non-contenteditable element (= the placeholder).\n    // The only event fired soon enough for us to allow hiding the placeholder\n    // without swiftkey picking it up is the keydown event, so we have to hide it\n    // here. See https://github.com/ianstormtaylor/slate/pull/4988#issuecomment-1201050535\n    if (!hasPendingDiffs()) {\n      updatePlaceholderVisibility(true)\n      setTimeout(updatePlaceholderVisibility)\n    }\n  }\n\n  const scheduleFlush = () => {\n    if (!hasPendingAction()) {\n      actionTimeoutId = setTimeout(flush)\n    }\n  }\n\n  const handleDomMutations = (mutations: MutationRecord[]) => {\n    if (hasPendingDiffs() || hasPendingAction()) {\n      return\n    }\n\n    if (\n      mutations.some(mutation => isTrackedMutation(editor, mutation, mutations))\n    ) {\n      // Cause a re-render to restore the dom state if we encounter tracked mutations without\n      // a corresponding pending action.\n      EDITOR_TO_FORCE_RENDER.get(editor)?.()\n    }\n  }\n\n  return {\n    flush,\n    scheduleFlush,\n\n    hasPendingDiffs,\n    hasPendingAction,\n    hasPendingChanges,\n\n    isFlushing,\n\n    handleUserSelect,\n    handleCompositionEnd,\n    handleCompositionStart,\n    handleDOMBeforeInput,\n    handleKeyDown,\n\n    handleDomMutations,\n    handleInput,\n  }\n}\n","import { useEffect, useRef } from 'react'\n\nexport function useIsMounted() {\n  const isMountedRef = useRef(false)\n\n  useEffect(() => {\n    isMountedRef.current = true\n    return () => {\n      isMountedRef.current = false\n    }\n  }, [])\n\n  return isMountedRef.current\n}\n","import { useLayoutEffect, useEffect } from 'react'\nimport { CAN_USE_DOM } from '../utils/environment'\n\n/**\n * Prevent warning on SSR by falling back to useEffect when DOM isn't available\n */\n\nexport const useIsomorphicLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect\n","import { RefObject, useEffect, useState } from 'react'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nexport function useMutationObserver(\n  node: RefObject<HTMLElement>,\n  callback: MutationCallback,\n  options: MutationObserverInit\n) {\n  const [mutationObserver] = useState(() => new MutationObserver(callback))\n\n  useIsomorphicLayoutEffect(() => {\n    // Discard mutations caused during render phase. This works due to react calling\n    // useLayoutEffect synchronously after the render phase before the next tick.\n    mutationObserver.takeRecords()\n  })\n\n  useEffect(() => {\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    mutationObserver.observe(node.current, options)\n    return () => mutationObserver.disconnect()\n  }, [mutationObserver, node, options])\n}\n","import { RefObject, useState } from 'react'\nimport { useSlateStatic } from '../use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport { EDITOR_TO_SCHEDULE_FLUSH } from '../../utils/weak-maps'\nimport {\n  createAndroidInputManager,\n  CreateAndroidInputManagerOptions,\n} from './android-input-manager'\nimport { useIsMounted } from '../use-is-mounted'\nimport { useMutationObserver } from '../use-mutation-observer'\n\ntype UseAndroidInputManagerOptions = {\n  node: RefObject<HTMLElement>\n} & Omit<\n  CreateAndroidInputManagerOptions,\n  'editor' | 'onUserInput' | 'receivedUserInput'\n>\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n}\n\nexport const useAndroidInputManager = !IS_ANDROID\n  ? () => null\n  : ({ node, ...options }: UseAndroidInputManagerOptions) => {\n      if (!IS_ANDROID) {\n        return null\n      }\n\n      const editor = useSlateStatic()\n      const isMounted = useIsMounted()\n\n      const [inputManager] = useState(() =>\n        createAndroidInputManager({\n          editor,\n          ...options,\n        })\n      )\n\n      useMutationObserver(\n        node,\n        inputManager.handleDomMutations,\n        MUTATION_OBSERVER_CONFIG\n      )\n\n      EDITOR_TO_SCHEDULE_FLUSH.set(editor, inputManager.scheduleFlush)\n      if (isMounted) {\n        inputManager.flush()\n      }\n\n      return inputManager\n    }\n","import { Range } from 'slate'\nimport { PLACEHOLDER_SYMBOL } from './weak-maps'\n\nexport const shallowCompare = (obj1: {}, obj2: {}) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every(\n    key => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]\n  )\n\nconst isDecorationFlagsEqual = (range: Range, other: Range) => {\n  const { anchor: rangeAnchor, focus: rangeFocus, ...rangeOwnProps } = range\n  const { anchor: otherAnchor, focus: otherFocus, ...otherOwnProps } = other\n\n  return (\n    range[PLACEHOLDER_SYMBOL] === other[PLACEHOLDER_SYMBOL] &&\n    shallowCompare(rangeOwnProps, otherOwnProps)\n  )\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isElementDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    if (!Range.equals(range, other) || !isDecorationFlagsEqual(range, other)) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isTextDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    // compare only offsets because paths doesn't matter for text\n    if (\n      range.anchor.offset !== other.anchor.offset ||\n      range.focus.offset !== other.focus.offset ||\n      !isDecorationFlagsEqual(range, other)\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n","import React, { forwardRef, memo, useRef, useState } from 'react'\nimport { Editor, Text, Path, Element, Node } from 'slate'\n\nimport { ReactEditor, useSlateStatic } from '..'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { IS_ANDROID } from '../utils/environment'\nimport { MARK_PLACEHOLDER_SYMBOL } from '../utils/weak-maps'\n\n/**\n * Leaf content strings.\n */\n\nconst String = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  text: Text\n}) => {\n  const { isLast, leaf, parent, text } = props\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, text)\n  const parentPath = Path.parent(path)\n  const isMarkPlaceholder = leaf[MARK_PLACEHOLDER_SYMBOL] === true\n\n  // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n  if (editor.isVoid(parent)) {\n    return <ZeroWidthString length={Node.string(parent).length} />\n  }\n\n  // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n  if (\n    leaf.text === '' &&\n    parent.children[parent.children.length - 1] === text &&\n    !editor.isInline(parent) &&\n    Editor.string(editor, parentPath) === ''\n  ) {\n    return <ZeroWidthString isLineBreak isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n  if (leaf.text === '') {\n    return <ZeroWidthString isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return <TextString isTrailing text={leaf.text} />\n  }\n\n  return <TextString text={leaf.text} />\n}\n\n/**\n * Leaf strings with text in them.\n */\nconst TextString = (props: { text: string; isTrailing?: boolean }) => {\n  const { text, isTrailing = false } = props\n  const ref = useRef<HTMLSpanElement>(null)\n  const getTextContent = () => {\n    return `${text ?? ''}${isTrailing ? '\\n' : ''}`\n  }\n  const [initialText] = useState(getTextContent)\n\n  // This is the actual text rendering boundary where we interface with the DOM\n  // The text is not rendered as part of the virtual DOM, as since we handle basic character insertions natively,\n  // updating the DOM is not a one way dataflow anymore. What we need here is not reconciliation and diffing\n  // with previous version of the virtual DOM, but rather diffing with the actual DOM element, and replace the DOM <span> content\n  // exactly if and only if its current content does not match our current virtual DOM.\n  // Otherwise the DOM TextNode would always be replaced by React as the user types, which interferes with native text features,\n  // eg makes native spellcheck opt out from checking the text node.\n\n  // useLayoutEffect: updating our span before browser paint\n  useIsomorphicLayoutEffect(() => {\n    // null coalescing text to make sure we're not outputing \"null\" as a string in the extreme case it is nullish at runtime\n    const textWithTrailing = getTextContent()\n\n    if (ref.current && ref.current.textContent !== textWithTrailing) {\n      ref.current.textContent = textWithTrailing\n    }\n\n    // intentionally not specifying dependencies, so that this effect runs on every render\n    // as this effectively replaces \"specifying the text in the virtual DOM under the <span> below\" on each render\n  })\n\n  // We intentionally render a memoized <span> that only receives the initial text content when the component is mounted.\n  // We defer to the layout effect above to update the `textContent` of the span element when needed.\n  return <MemoizedText ref={ref}>{initialText}</MemoizedText>\n}\n\nconst MemoizedText = memo(\n  forwardRef<HTMLSpanElement, { children: string }>((props, ref) => {\n    return (\n      <span data-slate-string ref={ref}>\n        {props.children}\n      </span>\n    )\n  })\n)\n\n/**\n * Leaf strings without text, render as zero-width strings.\n */\n\nexport const ZeroWidthString = (props: {\n  length?: number\n  isLineBreak?: boolean\n  isMarkPlaceholder?: boolean\n}) => {\n  const { length = 0, isLineBreak = false, isMarkPlaceholder = false } = props\n\n  const attributes = {\n    'data-slate-zero-width': isLineBreak ? 'n' : 'z',\n    'data-slate-length': length,\n  }\n\n  if (isMarkPlaceholder) {\n    attributes['data-slate-mark-placeholder'] = true\n  }\n\n  return (\n    <span {...attributes}>\n      {!IS_ANDROID || !isLineBreak ? '\\uFEFF' : null}\n      {isLineBreak ? <br /> : null}\n    </span>\n  )\n}\n\nexport default String\n","import React, {\n  useRef,\n  useCallback,\n  MutableRefObject,\n  useState,\n  useEffect,\n} from 'react'\nimport { Element, Text } from 'slate'\nimport { ResizeObserver as ResizeObserverPolyfill } from '@juggle/resize-observer'\nimport String from './string'\nimport {\n  PLACEHOLDER_SYMBOL,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport { useSlateStatic } from '../hooks/use-slate-static'\nimport { IS_WEBKIT } from '../utils/environment'\n\nfunction disconnectPlaceholderResizeObserver(\n  placeholderResizeObserver: MutableRefObject<ResizeObserver | null>,\n  releaseObserver: boolean\n) {\n  if (placeholderResizeObserver.current) {\n    placeholderResizeObserver.current.disconnect()\n    if (releaseObserver) {\n      placeholderResizeObserver.current = null\n    }\n  }\n}\n\ntype TimerId = ReturnType<typeof setTimeout> | null\n\nfunction clearTimeoutRef(timeoutRef: MutableRefObject<TimerId>) {\n  if (timeoutRef.current) {\n    clearTimeout(timeoutRef.current)\n    timeoutRef.current = null\n  }\n}\n\n/**\n * Individual leaves in a text node with unique formatting.\n */\nconst Leaf = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: Text\n}) => {\n  const {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderPlaceholder,\n    renderLeaf = (props: RenderLeafProps) => <DefaultLeaf {...props} />,\n  } = props\n\n  const editor = useSlateStatic()\n  const placeholderResizeObserver = useRef<ResizeObserver | null>(null)\n  const placeholderRef = useRef<HTMLElement | null>(null)\n  const [showPlaceholder, setShowPlaceholder] = useState(false)\n  const showPlaceholderTimeoutRef = useRef<TimerId>(null)\n\n  const callbackPlaceholderRef = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      disconnectPlaceholderResizeObserver(\n        placeholderResizeObserver,\n        placeholderEl == null\n      )\n\n      if (placeholderEl == null) {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.delete(editor)\n        leaf.onPlaceholderResize?.(null)\n      } else {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.set(editor, placeholderEl)\n\n        if (!placeholderResizeObserver.current) {\n          // Create a new observer and observe the placeholder element.\n          const ResizeObserver = window.ResizeObserver || ResizeObserverPolyfill\n          placeholderResizeObserver.current = new ResizeObserver(() => {\n            leaf.onPlaceholderResize?.(placeholderEl)\n          })\n        }\n        placeholderResizeObserver.current.observe(placeholderEl)\n        placeholderRef.current = placeholderEl\n      }\n    },\n    [placeholderRef, leaf, editor]\n  )\n\n  let children = (\n    <String isLast={isLast} leaf={leaf} parent={parent} text={text} />\n  )\n\n  const leafIsPlaceholder = leaf[PLACEHOLDER_SYMBOL]\n  useEffect(() => {\n    if (leafIsPlaceholder) {\n      if (!showPlaceholderTimeoutRef.current) {\n        // Delay the placeholder so it will not render in a selection\n        showPlaceholderTimeoutRef.current = setTimeout(() => {\n          setShowPlaceholder(true)\n          showPlaceholderTimeoutRef.current = null\n        }, 300)\n      }\n    } else {\n      clearTimeoutRef(showPlaceholderTimeoutRef)\n      setShowPlaceholder(false)\n    }\n    return () => clearTimeoutRef(showPlaceholderTimeoutRef)\n  }, [leafIsPlaceholder, setShowPlaceholder])\n\n  if (leafIsPlaceholder && showPlaceholder) {\n    const placeholderProps: RenderPlaceholderProps = {\n      children: leaf.placeholder,\n      attributes: {\n        'data-slate-placeholder': true,\n        style: {\n          position: 'absolute',\n          top: 0,\n          pointerEvents: 'none',\n          width: '100%',\n          maxWidth: '100%',\n          display: 'block',\n          opacity: '0.333',\n          userSelect: 'none',\n          textDecoration: 'none',\n          // Fixes https://github.com/udecode/plate/issues/2315\n          WebkitUserModify: IS_WEBKIT ? 'inherit' : undefined,\n        },\n        contentEditable: false,\n        ref: callbackPlaceholderRef,\n      },\n    }\n\n    children = (\n      <React.Fragment>\n        {renderPlaceholder(placeholderProps)}\n        {children}\n      </React.Fragment>\n    )\n  }\n\n  // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n  const attributes: {\n    'data-slate-leaf': true\n  } = {\n    'data-slate-leaf': true,\n  }\n\n  return renderLeaf({ attributes, children, leaf, text })\n}\n\nconst MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    Text.equals(next.leaf, prev.leaf) &&\n    next.leaf[PLACEHOLDER_SYMBOL] === prev.leaf[PLACEHOLDER_SYMBOL]\n  )\n})\n\nexport const DefaultLeaf = (props: RenderLeafProps) => {\n  const { attributes, children } = props\n  return <span {...attributes}>{children}</span>\n}\n\nexport default MemoizedLeaf\n","import React, { useCallback, useRef } from 'react'\nimport { Element, Range, Text as SlateText } from 'slate'\nimport { ReactEditor, useSlateStatic } from '..'\nimport { isTextDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport Leaf from './leaf'\n\n/**\n * Text.\n */\n\nconst Text = (props: {\n  decorations: Range[]\n  isLast: boolean\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: SlateText\n}) => {\n  const {\n    decorations,\n    isLast,\n    parent,\n    renderPlaceholder,\n    renderLeaf,\n    text,\n  } = props\n  const editor = useSlateStatic()\n  const ref = useRef<HTMLSpanElement | null>(null)\n  const leaves = SlateText.decorations(text, decorations)\n  const key = ReactEditor.findKey(editor, text)\n  const children = []\n\n  for (let i = 0; i < leaves.length; i++) {\n    const leaf = leaves[i]\n\n    children.push(\n      <Leaf\n        isLast={isLast && i === leaves.length - 1}\n        key={`${key.id}-${i}`}\n        renderPlaceholder={renderPlaceholder}\n        leaf={leaf}\n        text={text}\n        parent={parent}\n        renderLeaf={renderLeaf}\n      />\n    )\n  }\n\n  // Update element-related weak maps with the DOM element ref.\n  const callbackRef = useCallback(\n    (span: HTMLSpanElement | null) => {\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (span) {\n        KEY_TO_ELEMENT?.set(key, span)\n        NODE_TO_ELEMENT.set(text, span)\n        ELEMENT_TO_NODE.set(span, text)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(text)\n        if (ref.current) {\n          ELEMENT_TO_NODE.delete(ref.current)\n        }\n      }\n      ref.current = span\n    },\n    [ref, editor, key, text]\n  )\n  return (\n    <span data-slate-node=\"text\" ref={callbackRef}>\n      {children}\n    </span>\n  )\n}\n\nconst MemoizedText = React.memo(Text, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    isTextDecorationsEqual(next.decorations, prev.decorations)\n  )\n})\n\nexport default MemoizedText\n","import getDirection from 'direction'\nimport React, { useCallback } from 'react'\nimport { Editor, Element as SlateElement, Node, Range } from 'slate'\nimport { ReactEditor, useReadOnly, useSlateStatic } from '..'\nimport useChildren from '../hooks/use-children'\nimport { isElementDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n  NODE_TO_INDEX,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from './editable'\n\nimport Text from './text'\n\n/**\n * Element.\n */\n\nconst Element = (props: {\n  decorations: Range[]\n  element: SlateElement\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    element,\n    renderElement = (p: RenderElementProps) => <DefaultElement {...p} />,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const editor = useSlateStatic()\n  const readOnly = useReadOnly()\n  const isInline = editor.isInline(element)\n  const key = ReactEditor.findKey(editor, element)\n  const ref = useCallback(\n    (ref: HTMLElement | null) => {\n      // Update element-related weak maps with the DOM element ref.\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (ref) {\n        KEY_TO_ELEMENT?.set(key, ref)\n        NODE_TO_ELEMENT.set(element, ref)\n        ELEMENT_TO_NODE.set(ref, element)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(element)\n      }\n    },\n    [editor, key, element]\n  )\n  let children: React.ReactNode = useChildren({\n    decorations,\n    node: element,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  })\n\n  // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n  const attributes: {\n    'data-slate-node': 'element'\n    'data-slate-void'?: true\n    'data-slate-inline'?: true\n    contentEditable?: false\n    dir?: 'rtl'\n    ref: any\n  } = {\n    'data-slate-node': 'element',\n    ref,\n  }\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true\n  }\n\n  // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    const text = Node.string(element)\n    const dir = getDirection(text)\n\n    if (dir === 'rtl') {\n      attributes.dir = dir\n    }\n  }\n\n  // If it's a void node, wrap the children in extra void-specific elements.\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false\n    }\n\n    const Tag = isInline ? 'span' : 'div'\n    const [[text]] = Node.texts(element)\n\n    children = (\n      <Tag\n        data-slate-spacer\n        style={{\n          height: '0',\n          color: 'transparent',\n          outline: 'none',\n          position: 'absolute',\n        }}\n      >\n        <Text\n          renderPlaceholder={renderPlaceholder}\n          decorations={[]}\n          isLast={false}\n          parent={element}\n          text={text}\n        />\n      </Tag>\n    )\n\n    NODE_TO_INDEX.set(text, 0)\n    NODE_TO_PARENT.set(text, element)\n  }\n\n  return renderElement({ attributes, children, element })\n}\n\nconst MemoizedElement = React.memo(Element, (prev, next) => {\n  return (\n    prev.element === next.element &&\n    prev.renderElement === next.renderElement &&\n    prev.renderLeaf === next.renderLeaf &&\n    prev.renderPlaceholder === next.renderPlaceholder &&\n    isElementDecorationsEqual(prev.decorations, next.decorations) &&\n    (prev.selection === next.selection ||\n      (!!prev.selection &&\n        !!next.selection &&\n        Range.equals(prev.selection, next.selection)))\n  )\n})\n\n/**\n * The default element renderer.\n */\n\nexport const DefaultElement = (props: RenderElementProps) => {\n  const { attributes, children, element } = props\n  const editor = useSlateStatic()\n  const Tag = editor.isInline(element) ? 'span' : 'div'\n  return (\n    <Tag {...attributes} style={{ position: 'relative' }}>\n      {children}\n    </Tag>\n  )\n}\n\nexport default MemoizedElement\n","import { createContext, useContext } from 'react'\nimport { Range, NodeEntry } from 'slate'\n\n/**\n * A React context for sharing the `decorate` prop of the editable.\n */\n\nexport const DecorateContext = createContext<(entry: NodeEntry) => Range[]>(\n  () => []\n)\n\n/**\n * Get the current `decorate` prop of the editable.\n */\n\nexport const useDecorate = (): ((entry: NodeEntry) => Range[]) => {\n  return useContext(DecorateContext)\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `selected` state of an element.\n */\n\nexport const SelectedContext = createContext(false)\n\n/**\n * Get the current `selected` state of an element.\n */\n\nexport const useSelected = (): boolean => {\n  return useContext(SelectedContext)\n}\n","import React from 'react'\nimport { Ancestor, Descendant, Editor, Element, Range } from 'slate'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from '../components/editable'\n\nimport ElementComponent from '../components/element'\nimport TextComponent from '../components/text'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { NODE_TO_INDEX, NODE_TO_PARENT } from '../utils/weak-maps'\nimport { useDecorate } from './use-decorate'\nimport { SelectedContext } from './use-selected'\nimport { useSlateStatic } from './use-slate-static'\n\n/**\n * Children.\n */\n\nconst useChildren = (props: {\n  decorations: Range[]\n  node: Ancestor\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    node,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const decorate = useDecorate()\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, node)\n  const children = []\n  const isLeafBlock =\n    Element.isElement(node) &&\n    !editor.isInline(node) &&\n    Editor.hasInlines(editor, node)\n\n  for (let i = 0; i < node.children.length; i++) {\n    const p = path.concat(i)\n    const n = node.children[i] as Descendant\n    const key = ReactEditor.findKey(editor, n)\n    const range = Editor.range(editor, p)\n    const sel = selection && Range.intersection(range, selection)\n    const ds = decorate([n, p])\n\n    for (const dec of decorations) {\n      const d = Range.intersection(dec, range)\n\n      if (d) {\n        ds.push(d)\n      }\n    }\n\n    if (Element.isElement(n)) {\n      children.push(\n        <SelectedContext.Provider key={`provider-${key.id}`} value={!!sel}>\n          <ElementComponent\n            decorations={ds}\n            element={n}\n            key={key.id}\n            renderElement={renderElement}\n            renderPlaceholder={renderPlaceholder}\n            renderLeaf={renderLeaf}\n            selection={sel}\n          />\n        </SelectedContext.Provider>\n      )\n    } else {\n      children.push(\n        <TextComponent\n          decorations={ds}\n          key={key.id}\n          isLast={isLeafBlock && i === node.children.length - 1}\n          parent={node}\n          renderPlaceholder={renderPlaceholder}\n          renderLeaf={renderLeaf}\n          text={n}\n        />\n      )\n    }\n\n    NODE_TO_INDEX.set(n, i)\n    NODE_TO_PARENT.set(n, node)\n  }\n\n  return children\n}\n\nexport default useChildren\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `readOnly` state of the editor.\n */\n\nexport const ReadOnlyContext = createContext(false)\n\n/**\n * Get the current `readOnly` state of the editor.\n */\n\nexport const useReadOnly = (): boolean => {\n  return useContext(ReadOnlyContext)\n}\n","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object, in a way that re-renders the\n * context whenever changes occur.\n */\n\nexport interface SlateContextValue {\n  v: number\n  editor: ReactEditor\n}\n\nexport const SlateContext = createContext<{\n  v: number\n  editor: ReactEditor\n} | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlate = (): Editor => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  const { editor } = context\n  return editor\n}\n\nexport const useSlateWithV = () => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return context\n}\n","import { useCallback, useEffect, useRef } from 'react'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { useSlateStatic } from './use-slate-static'\n\nexport function useTrackUserInput() {\n  const editor = useSlateStatic()\n\n  const receivedUserInput = useRef<boolean>(false)\n  const animationFrameIdRef = useRef<number>(0)\n\n  const onUserInput = useCallback(() => {\n    if (receivedUserInput.current) {\n      return\n    }\n\n    receivedUserInput.current = true\n\n    const window = ReactEditor.getWindow(editor)\n    window.cancelAnimationFrame(animationFrameIdRef.current)\n\n    animationFrameIdRef.current = window.requestAnimationFrame(() => {\n      receivedUserInput.current = false\n    })\n  }, [editor])\n\n  useEffect(() => () => cancelAnimationFrame(animationFrameIdRef.current), [])\n\n  return {\n    receivedUserInput,\n    onUserInput,\n  }\n}\n","export const TRIPLE_CLICK = 3\n","import { isHotkey } from 'is-hotkey'\nimport { IS_APPLE } from './environment'\n\n/**\n * Hotkey mappings for each platform.\n */\n\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  insertSoftBreak: 'shift+enter',\n  splitBlock: 'enter',\n  undo: 'mod+z',\n}\n\nconst APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n}\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n}\n\n/**\n * Create a platform-aware hotkey checker.\n */\n\nconst create = (key: string) => {\n  const generic = HOTKEYS[key]\n  const apple = APPLE_HOTKEYS[key]\n  const windows = WINDOWS_HOTKEYS[key]\n  const isGeneric = generic && isHotkey(generic)\n  const isApple = apple && isHotkey(apple)\n  const isWindows = windows && isHotkey(windows)\n\n  return (event: KeyboardEvent) => {\n    if (isGeneric && isGeneric(event)) return true\n    if (IS_APPLE && isApple && isApple(event)) return true\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\n    return false\n  }\n}\n\n/**\n * Hotkeys.\n */\n\nexport default {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSoftBreak: create('insertSoftBreak'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo'),\n}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var _typeof = require(\"@babel/runtime/helpers/typeof\")[\"default\"];\n\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { RefObject } from 'react'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport { isTrackedMutation } from '../../utils/dom'\n\nexport type RestoreDOMManager = {\n  registerMutations: (mutations: MutationRecord[]) => void\n  restoreDOM: () => void\n  clear: () => void\n}\n\nexport const createRestoreDomManager = (\n  editor: ReactEditor,\n  receivedUserInput: RefObject<boolean>\n): RestoreDOMManager => {\n  let bufferedMutations: MutationRecord[] = []\n\n  const clear = () => {\n    bufferedMutations = []\n  }\n\n  const registerMutations = (mutations: MutationRecord[]) => {\n    if (!receivedUserInput.current) {\n      return\n    }\n\n    const trackedMutations = mutations.filter(mutation =>\n      isTrackedMutation(editor, mutation, mutations)\n    )\n\n    bufferedMutations.push(...trackedMutations)\n  }\n\n  function restoreDOM() {\n    if (bufferedMutations.length > 0) {\n      bufferedMutations.reverse().forEach(mutation => {\n        if (mutation.type === 'characterData') {\n          // We don't want to restore the DOM for characterData mutations\n          // because this interrupts the composition.\n          return\n        }\n\n        mutation.removedNodes.forEach(node => {\n          mutation.target.insertBefore(node, mutation.nextSibling)\n        })\n\n        mutation.addedNodes.forEach(node => {\n          mutation.target.removeChild(node)\n        })\n      })\n\n      // Clear buffered mutations to ensure we don't undo them twice\n      clear()\n    }\n  }\n\n  return {\n    registerMutations,\n    restoreDOM,\n    clear,\n  }\n}\n","import React, { Component, ComponentType, ContextType, RefObject } from 'react'\nimport { EditorContext } from '../../hooks/use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport {\n  createRestoreDomManager,\n  RestoreDOMManager,\n} from './restore-dom-manager'\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n}\n\ntype RestoreDOMProps = {\n  receivedUserInput: RefObject<boolean>\n  node: RefObject<HTMLDivElement>\n}\n\n// We have to use a class component here since we rely on `getSnapshotBeforeUpdate` which has no FC equivalent\n// to run code synchronously immediately before react commits the component update to the DOM.\nclass RestoreDOMComponent extends Component<RestoreDOMProps> {\n  static contextType = EditorContext\n  context: ContextType<typeof EditorContext> = null\n\n  private manager: RestoreDOMManager | null = null\n  private mutationObserver: MutationObserver | null = null\n\n  observe() {\n    const { node } = this.props\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    this.mutationObserver?.observe(node.current, MUTATION_OBSERVER_CONFIG)\n  }\n\n  componentDidMount() {\n    const { receivedUserInput } = this.props\n    const editor = this.context!\n\n    this.manager = createRestoreDomManager(editor, receivedUserInput)\n    this.mutationObserver = new MutationObserver(this.manager.registerMutations)\n\n    this.observe()\n  }\n\n  getSnapshotBeforeUpdate() {\n    const pendingMutations = this.mutationObserver?.takeRecords()\n    if (pendingMutations?.length) {\n      this.manager?.registerMutations(pendingMutations)\n    }\n\n    this.mutationObserver?.disconnect()\n    this.manager?.restoreDOM()\n\n    return null\n  }\n\n  componentDidUpdate() {\n    this.manager?.clear()\n    this.observe()\n  }\n\n  componentWillUnmount() {\n    this.mutationObserver?.disconnect()\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const RestoreDOM: ComponentType<RestoreDOMProps> = IS_ANDROID\n  ? RestoreDOMComponent\n  : ({ children }) => <>{children}</>\n","import getDirection from 'direction'\nimport debounce from 'lodash/debounce'\nimport throttle from 'lodash/throttle'\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {\n  Editor,\n  Element,\n  Node,\n  NodeEntry,\n  Path,\n  Range,\n  Text,\n  Transforms,\n} from 'slate'\nimport { useAndroidInputManager } from '../hooks/android-input-manager/use-android-input-manager'\nimport useChildren from '../hooks/use-children'\nimport { DecorateContext } from '../hooks/use-decorate'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { ReadOnlyContext } from '../hooks/use-read-only'\nimport { useSlate } from '../hooks/use-slate'\nimport { useTrackUserInput } from '../hooks/use-track-user-input'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { TRIPLE_CLICK } from '../utils/constants'\nimport {\n  DOMElement,\n  DOMRange,\n  DOMText,\n  getDefaultView,\n  isDOMElement,\n  isDOMNode,\n  isPlainTextOnlyPaste,\n} from '../utils/dom'\nimport {\n  CAN_USE_DOM,\n  HAS_BEFORE_INPUT_SUPPORT,\n  IS_ANDROID,\n  IS_CHROME,\n  IS_FIREFOX,\n  IS_FIREFOX_LEGACY,\n  IS_IOS,\n  IS_WEBKIT,\n  IS_UC_MOBILE,\n  IS_WECHATBROWSER,\n} from '../utils/environment'\nimport Hotkeys from '../utils/hotkeys'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  MARK_PLACEHOLDER_SYMBOL,\n  NODE_TO_ELEMENT,\n  PLACEHOLDER_SYMBOL,\n} from '../utils/weak-maps'\nimport { RestoreDOM } from './restore-dom/restore-dom'\nimport { AndroidInputManager } from '../hooks/android-input-manager/android-input-manager'\n\ntype DeferredOperation = () => void\n\nconst Children = (props: Parameters<typeof useChildren>[0]) => (\n  <React.Fragment>{useChildren(props)}</React.Fragment>\n)\n\n/**\n * `RenderElementProps` are passed to the `renderElement` handler.\n */\n\nexport interface RenderElementProps {\n  children: any\n  element: Element\n  attributes: {\n    'data-slate-node': 'element'\n    'data-slate-inline'?: true\n    'data-slate-void'?: true\n    dir?: 'rtl'\n    ref: any\n  }\n}\n\n/**\n * `RenderLeafProps` are passed to the `renderLeaf` handler.\n */\n\nexport interface RenderLeafProps {\n  children: any\n  leaf: Text\n  text: Text\n  attributes: {\n    'data-slate-leaf': true\n  }\n}\n\n/**\n * `EditableProps` are passed to the `<Editable>` component.\n */\n\nexport type EditableProps = {\n  decorate?: (entry: NodeEntry) => Range[]\n  onDOMBeforeInput?: (event: InputEvent) => void\n  placeholder?: string\n  readOnly?: boolean\n  role?: string\n  style?: React.CSSProperties\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  renderPlaceholder?: (props: RenderPlaceholderProps) => JSX.Element\n  scrollSelectionIntoView?: (editor: ReactEditor, domRange: DOMRange) => void\n  as?: React.ElementType\n  disableDefaultStyles?: boolean\n} & React.TextareaHTMLAttributes<HTMLDivElement>\n\n/**\n * Editable.\n */\n\nexport const Editable = (props: EditableProps) => {\n  const defaultRenderPlaceholder = useCallback(\n    (props: RenderPlaceholderProps) => <DefaultPlaceholder {...props} />,\n    []\n  )\n  const {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    renderPlaceholder = defaultRenderPlaceholder,\n    scrollSelectionIntoView = defaultScrollSelectionIntoView,\n    style: userStyle = {},\n    as: Component = 'div',\n    disableDefaultStyles = false,\n    ...attributes\n  } = props\n  const editor = useSlate()\n  // Rerender editor when composition status changed\n  const [isComposing, setIsComposing] = useState(false)\n  const ref = useRef<HTMLDivElement | null>(null)\n  const deferredOperations = useRef<DeferredOperation[]>([])\n  const [placeholderHeight, setPlaceholderHeight] = useState<\n    number | undefined\n  >()\n\n  const { onUserInput, receivedUserInput } = useTrackUserInput()\n\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  EDITOR_TO_FORCE_RENDER.set(editor, forceRender)\n\n  // Update internal state on each render.\n  IS_READ_ONLY.set(editor, readOnly)\n\n  // Keep track of some state for the event handler logic.\n  const state = useMemo(\n    () => ({\n      isDraggingInternally: false,\n      isUpdatingSelection: false,\n      latestElement: null as DOMElement | null,\n      hasMarkPlaceholder: false,\n    }),\n    []\n  )\n\n  // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus()\n    }\n  }, [autoFocus])\n\n  /**\n   * The AndroidInputManager object has a cyclical dependency on onDOMSelectionChange\n   *\n   * It is defined as a reference to simplify hook dependencies and clarify that\n   * it needs to be initialized.\n   */\n  const androidInputManagerRef = useRef<\n    AndroidInputManager | null | undefined\n  >()\n\n  // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n  const onDOMSelectionChange = useMemo(\n    () =>\n      throttle(() => {\n        const androidInputManager = androidInputManagerRef.current\n        if (\n          (IS_ANDROID || !ReactEditor.isComposing(editor)) &&\n          (!state.isUpdatingSelection || androidInputManager?.isFlushing()) &&\n          !state.isDraggingInternally\n        ) {\n          const root = ReactEditor.findDocumentOrShadowRoot(editor)\n          const { activeElement } = root\n          const el = ReactEditor.toDOMNode(editor, editor)\n          const domSelection = root.getSelection()\n\n          if (activeElement === el) {\n            state.latestElement = activeElement\n            IS_FOCUSED.set(editor, true)\n          } else {\n            IS_FOCUSED.delete(editor)\n          }\n\n          if (!domSelection) {\n            return Transforms.deselect(editor)\n          }\n\n          const { anchorNode, focusNode } = domSelection\n\n          const anchorNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, anchorNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, anchorNode)\n\n          const focusNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, focusNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, focusNode)\n\n          if (anchorNodeSelectable && focusNodeSelectable) {\n            const range = ReactEditor.toSlateRange(editor, domSelection, {\n              exactMatch: false,\n              suppressThrow: true,\n            })\n\n            if (range) {\n              if (\n                !ReactEditor.isComposing(editor) &&\n                !androidInputManager?.hasPendingChanges() &&\n                !androidInputManager?.isFlushing()\n              ) {\n                Transforms.select(editor, range)\n              } else {\n                androidInputManager?.handleUserSelect(range)\n              }\n            }\n          }\n\n          // Deselect the editor if the dom selection is not selectable in readonly mode\n          if (readOnly && (!anchorNodeSelectable || !focusNodeSelectable)) {\n            Transforms.deselect(editor)\n          }\n        }\n      }, 100),\n    [editor, readOnly, state]\n  )\n\n  const scheduleOnDOMSelectionChange = useMemo(\n    () => debounce(onDOMSelectionChange, 0),\n    [onDOMSelectionChange]\n  )\n\n  androidInputManagerRef.current = useAndroidInputManager({\n    node: ref,\n    onDOMSelectionChange,\n    scheduleOnDOMSelectionChange,\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    // Update element-related weak maps with the DOM element ref.\n    let window\n    if (ref.current && (window = getDefaultView(ref.current))) {\n      EDITOR_TO_WINDOW.set(editor, window)\n      EDITOR_TO_ELEMENT.set(editor, ref.current)\n      NODE_TO_ELEMENT.set(editor, ref.current)\n      ELEMENT_TO_NODE.set(ref.current, editor)\n    } else {\n      NODE_TO_ELEMENT.delete(editor)\n    }\n\n    // Make sure the DOM selection state is in sync.\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (\n      !domSelection ||\n      !ReactEditor.isFocused(editor) ||\n      androidInputManagerRef.current?.hasPendingAction()\n    ) {\n      return\n    }\n\n    const setDomSelection = (forceChange?: boolean) => {\n      const hasDomSelection = domSelection.type !== 'None'\n\n      // If the DOM selection is properly unset, we're done.\n      if (!selection && !hasDomSelection) {\n        return\n      }\n\n      // Get anchorNode and focusNode\n      const focusNode = domSelection.focusNode\n      let anchorNode\n\n      // COMPAT: In firefox the normal seletion way does not work\n      // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n      if (IS_FIREFOX && domSelection.rangeCount > 1) {\n        const firstRange = domSelection.getRangeAt(0)\n        const lastRange = domSelection.getRangeAt(domSelection.rangeCount - 1)\n\n        // Right to left\n        if (firstRange.startContainer === focusNode) {\n          anchorNode = lastRange.endContainer\n        } else {\n          // Left to right\n          anchorNode = firstRange.startContainer\n        }\n      } else {\n        anchorNode = domSelection.anchorNode\n      }\n\n      // verify that the dom selection is in the editor\n      const editorElement = EDITOR_TO_ELEMENT.get(editor)!\n      let hasDomSelectionInEditor = false\n      if (\n        editorElement.contains(anchorNode) &&\n        editorElement.contains(focusNode)\n      ) {\n        hasDomSelectionInEditor = true\n      }\n\n      // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n      if (\n        hasDomSelection &&\n        hasDomSelectionInEditor &&\n        selection &&\n        !forceChange\n      ) {\n        const slateRange = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: true,\n\n          // domSelection is not necessarily a valid Slate range\n          // (e.g. when clicking on contentEditable:false element)\n          suppressThrow: true,\n        })\n\n        if (slateRange && Range.equals(slateRange, selection)) {\n          if (!state.hasMarkPlaceholder) {\n            return\n          }\n\n          // Ensure selection is inside the mark placeholder\n          if (\n            anchorNode?.parentElement?.hasAttribute(\n              'data-slate-mark-placeholder'\n            )\n          ) {\n            return\n          }\n        }\n      }\n\n      // when <Editable/> is being controlled through external value\n      // then its children might just change - DOM responds to it on its own\n      // but Slate's value is not being updated through any operation\n      // and thus it doesn't transform selection on its own\n      if (selection && !ReactEditor.hasRange(editor, selection)) {\n        editor.selection = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: false,\n          suppressThrow: true,\n        })\n        return\n      }\n\n      // Otherwise the DOM selection is out of sync, so update it.\n      state.isUpdatingSelection = true\n\n      const newDomRange: DOMRange | null =\n        selection && ReactEditor.toDOMRange(editor, selection)\n\n      if (newDomRange) {\n        if (ReactEditor.isComposing(editor) && !IS_ANDROID) {\n          domSelection.collapseToEnd()\n        } else if (Range.isBackward(selection!)) {\n          domSelection.setBaseAndExtent(\n            newDomRange.endContainer,\n            newDomRange.endOffset,\n            newDomRange.startContainer,\n            newDomRange.startOffset\n          )\n        } else {\n          domSelection.setBaseAndExtent(\n            newDomRange.startContainer,\n            newDomRange.startOffset,\n            newDomRange.endContainer,\n            newDomRange.endOffset\n          )\n        }\n        scrollSelectionIntoView(editor, newDomRange)\n      } else {\n        domSelection.removeAllRanges()\n      }\n\n      return newDomRange\n    }\n\n    // In firefox if there is more then 1 range and we call setDomSelection we remove the ability to select more cells in a table\n    if (domSelection.rangeCount <= 1) {\n      setDomSelection()\n    }\n\n    const ensureSelection =\n      androidInputManagerRef.current?.isFlushing() === 'action'\n\n    if (!IS_ANDROID || !ensureSelection) {\n      setTimeout(() => {\n        state.isUpdatingSelection = false\n      })\n      return\n    }\n\n    let timeoutId: ReturnType<typeof setTimeout> | null = null\n    const animationFrameId = requestAnimationFrame(() => {\n      if (ensureSelection) {\n        const ensureDomSelection = (forceChange?: boolean) => {\n          try {\n            const el = ReactEditor.toDOMNode(editor, editor)\n            el.focus()\n\n            setDomSelection(forceChange)\n          } catch (e) {\n            // Ignore, dom and state might be out of sync\n          }\n        }\n\n        // Compat: Android IMEs try to force their selection by manually re-applying it even after we set it.\n        // This essentially would make setting the slate selection during an update meaningless, so we force it\n        // again here. We can't only do it in the setTimeout after the animation frame since that would cause a\n        // visible flicker.\n        ensureDomSelection()\n\n        timeoutId = setTimeout(() => {\n          // COMPAT: While setting the selection in an animation frame visually correctly sets the selection,\n          // it doesn't update GBoards spellchecker state. We have to manually trigger a selection change after\n          // the animation frame to ensure it displays the correct state.\n          ensureDomSelection(true)\n          state.isUpdatingSelection = false\n        })\n      }\n    })\n\n    return () => {\n      cancelAnimationFrame(animationFrameId)\n      if (timeoutId) {\n        clearTimeout(timeoutId)\n      }\n    }\n  })\n\n  // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n  const onDOMBeforeInput = useCallback(\n    (event: InputEvent) => {\n      onUserInput()\n\n      if (\n        !readOnly &&\n        ReactEditor.hasEditableTarget(editor, event.target) &&\n        !isDOMEventHandled(event, propsOnDOMBeforeInput)\n      ) {\n        // COMPAT: BeforeInput events aren't cancelable on android, so we have to handle them differently using the android input manager.\n        if (androidInputManagerRef.current) {\n          return androidInputManagerRef.current.handleDOMBeforeInput(event)\n        }\n\n        // Some IMEs/Chrome extensions like e.g. Grammarly set the selection immediately before\n        // triggering a `beforeinput` expecting the change to be applied to the immediately before\n        // set selection.\n        scheduleOnDOMSelectionChange.flush()\n        onDOMSelectionChange.flush()\n\n        const { selection } = editor\n        const { inputType: type } = event\n        const data = (event as any).dataTransfer || event.data || undefined\n\n        const isCompositionChange =\n          type === 'insertCompositionText' || type === 'deleteCompositionText'\n\n        // COMPAT: use composition change events as a hint to where we should insert\n        // composition text if we aren't composing to work around https://github.com/ianstormtaylor/slate/issues/5038\n        if (isCompositionChange && ReactEditor.isComposing(editor)) {\n          return\n        }\n\n        let native = false\n        if (\n          type === 'insertText' &&\n          selection &&\n          Range.isCollapsed(selection) &&\n          // Only use native character insertion for single characters a-z or space for now.\n          // Long-press events (hold a + press 4 = ä) to choose a special character otherwise\n          // causes duplicate inserts.\n          event.data &&\n          event.data.length === 1 &&\n          /[a-z ]/i.test(event.data) &&\n          // Chrome has issues correctly editing the start of nodes: https://bugs.chromium.org/p/chromium/issues/detail?id=1249405\n          // When there is an inline element, e.g. a link, and you select\n          // right after it (the start of the next node).\n          selection.anchor.offset !== 0\n        ) {\n          native = true\n\n          // Skip native if there are marks, as\n          // `insertText` will insert a node, not just text.\n          if (editor.marks) {\n            native = false\n          }\n\n          // Chrome also has issues correctly editing the end of anchor elements: https://bugs.chromium.org/p/chromium/issues/detail?id=1259100\n          // Therefore we don't allow native events to insert text at the end of anchor nodes.\n          const { anchor } = selection\n\n          const [node, offset] = ReactEditor.toDOMPoint(editor, anchor)\n          const anchorNode = node.parentElement?.closest('a')\n\n          const window = ReactEditor.getWindow(editor)\n\n          if (\n            native &&\n            anchorNode &&\n            ReactEditor.hasDOMNode(editor, anchorNode)\n          ) {\n            // Find the last text node inside the anchor.\n            const lastText = window?.document\n              .createTreeWalker(anchorNode, NodeFilter.SHOW_TEXT)\n              .lastChild() as DOMText | null\n\n            if (lastText === node && lastText.textContent?.length === offset) {\n              native = false\n            }\n          }\n\n          // Chrome has issues with the presence of tab characters inside elements with whiteSpace = 'pre'\n          // causing abnormal insert behavior: https://bugs.chromium.org/p/chromium/issues/detail?id=1219139\n          if (\n            native &&\n            node.parentElement &&\n            window?.getComputedStyle(node.parentElement)?.whiteSpace === 'pre'\n          ) {\n            const block = Editor.above(editor, {\n              at: anchor.path,\n              match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n            })\n\n            if (block && Node.string(block[0]).includes('\\t')) {\n              native = false\n            }\n          }\n        }\n\n        // COMPAT: For the deleting forward/backward input types we don't want\n        // to change the selection because it is the range that will be deleted,\n        // and those commands determine that for themselves.\n        if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n          const [targetRange] = (event as any).getTargetRanges()\n\n          if (targetRange) {\n            const range = ReactEditor.toSlateRange(editor, targetRange, {\n              exactMatch: false,\n              suppressThrow: false,\n            })\n\n            if (!selection || !Range.equals(selection, range)) {\n              native = false\n\n              const selectionRef =\n                !isCompositionChange &&\n                editor.selection &&\n                Editor.rangeRef(editor, editor.selection)\n\n              Transforms.select(editor, range)\n\n              if (selectionRef) {\n                EDITOR_TO_USER_SELECTION.set(editor, selectionRef)\n              }\n            }\n          }\n        }\n\n        // Composition change types occur while a user is composing text and can't be\n        // cancelled. Let them through and wait for the composition to end.\n        if (isCompositionChange) {\n          return\n        }\n\n        if (!native) {\n          event.preventDefault()\n        }\n\n        // COMPAT: If the selection is expanded, even if the command seems like\n        // a delete forward/backward command it should delete the selection.\n        if (\n          selection &&\n          Range.isExpanded(selection) &&\n          type.startsWith('delete')\n        ) {\n          const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n          Editor.deleteFragment(editor, { direction })\n          return\n        }\n\n        switch (type) {\n          case 'deleteByComposition':\n          case 'deleteByCut':\n          case 'deleteByDrag': {\n            Editor.deleteFragment(editor)\n            break\n          }\n\n          case 'deleteContent':\n          case 'deleteContentForward': {\n            Editor.deleteForward(editor)\n            break\n          }\n\n          case 'deleteContentBackward': {\n            Editor.deleteBackward(editor)\n            break\n          }\n\n          case 'deleteEntireSoftLine': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineForward': {\n            Editor.deleteForward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineForward': {\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteWordBackward': {\n            Editor.deleteBackward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'deleteWordForward': {\n            Editor.deleteForward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'insertLineBreak':\n            Editor.insertSoftBreak(editor)\n            break\n\n          case 'insertParagraph': {\n            Editor.insertBreak(editor)\n            break\n          }\n\n          case 'insertFromComposition':\n          case 'insertFromDrop':\n          case 'insertFromPaste':\n          case 'insertFromYank':\n          case 'insertReplacementText':\n          case 'insertText': {\n            if (type === 'insertFromComposition') {\n              // COMPAT: in Safari, `compositionend` is dispatched after the\n              // `beforeinput` for \"insertFromComposition\". But if we wait for it\n              // then we will abort because we're still composing and the selection\n              // won't be updated properly.\n              // https://www.w3.org/TR/input-events-2/\n              if (ReactEditor.isComposing(editor)) {\n                setIsComposing(false)\n                IS_COMPOSING.set(editor, false)\n              }\n            }\n\n            // use a weak comparison instead of 'instanceof' to allow\n            // programmatic access of paste events coming from external windows\n            // like cypress where cy.window does not work realibly\n            if (data?.constructor.name === 'DataTransfer') {\n              ReactEditor.insertData(editor, data)\n            } else if (typeof data === 'string') {\n              // Only insertText operations use the native functionality, for now.\n              // Potentially expand to single character deletes, as well.\n              if (native) {\n                deferredOperations.current.push(() =>\n                  Editor.insertText(editor, data)\n                )\n              } else {\n                Editor.insertText(editor, data)\n              }\n            }\n\n            break\n          }\n        }\n\n        // Restore the actual user section if nothing manually set it.\n        const toRestore = EDITOR_TO_USER_SELECTION.get(editor)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(editor)\n\n        if (\n          toRestore &&\n          (!editor.selection || !Range.equals(editor.selection, toRestore))\n        ) {\n          Transforms.select(editor, toRestore)\n        }\n      }\n    },\n    [\n      editor,\n      onDOMSelectionChange,\n      onUserInput,\n      propsOnDOMBeforeInput,\n      readOnly,\n      scheduleOnDOMSelectionChange,\n    ]\n  )\n\n  const callbackRef = useCallback(\n    node => {\n      if (node == null) {\n        onDOMSelectionChange.cancel()\n        scheduleOnDOMSelectionChange.cancel()\n\n        EDITOR_TO_ELEMENT.delete(editor)\n        NODE_TO_ELEMENT.delete(editor)\n\n        if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          ref.current.removeEventListener('beforeinput', onDOMBeforeInput)\n        }\n      } else {\n        // Attach a native DOM event handler for `beforeinput` events, because React's\n        // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n        // real `beforeinput` events sadly... (2019/11/04)\n        // https://github.com/facebook/react/issues/11211\n        if (HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          node.addEventListener('beforeinput', onDOMBeforeInput)\n        }\n      }\n\n      ref.current = node\n    },\n    [\n      onDOMSelectionChange,\n      scheduleOnDOMSelectionChange,\n      editor,\n      onDOMBeforeInput,\n    ]\n  )\n\n  // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n  useIsomorphicLayoutEffect(() => {\n    const window = ReactEditor.getWindow(editor)\n\n    window.document.addEventListener(\n      'selectionchange',\n      scheduleOnDOMSelectionChange\n    )\n\n    return () => {\n      window.document.removeEventListener(\n        'selectionchange',\n        scheduleOnDOMSelectionChange\n      )\n    }\n  }, [scheduleOnDOMSelectionChange])\n\n  const decorations = decorate([editor, []])\n\n  const showPlaceholder =\n    placeholder &&\n    editor.children.length === 1 &&\n    Array.from(Node.texts(editor)).length === 1 &&\n    Node.string(editor) === '' &&\n    !isComposing\n\n  const placeHolderResizeHandler = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      if (placeholderEl && showPlaceholder) {\n        setPlaceholderHeight(placeholderEl.getBoundingClientRect()?.height)\n      } else {\n        setPlaceholderHeight(undefined)\n      }\n    },\n    [showPlaceholder]\n  )\n\n  if (showPlaceholder) {\n    const start = Editor.start(editor, [])\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      onPlaceholderResize: placeHolderResizeHandler,\n      anchor: start,\n      focus: start,\n    })\n  }\n\n  const { marks } = editor\n  state.hasMarkPlaceholder = false\n\n  if (editor.selection && Range.isCollapsed(editor.selection) && marks) {\n    const { anchor } = editor.selection\n    const leaf = Node.leaf(editor, anchor.path)\n    const { text, ...rest } = leaf\n\n    // While marks isn't a 'complete' text, we can still use loose Text.equals\n    // here which only compares marks anyway.\n    if (!Text.equals(leaf, marks as Text, { loose: true })) {\n      state.hasMarkPlaceholder = true\n\n      const unset = Object.fromEntries(\n        Object.keys(rest).map(mark => [mark, null])\n      )\n\n      decorations.push({\n        [MARK_PLACEHOLDER_SYMBOL]: true,\n        ...unset,\n        ...marks,\n\n        anchor,\n        focus: anchor,\n      })\n    }\n  }\n\n  // Update EDITOR_TO_MARK_PLACEHOLDER_MARKS in setTimeout useEffect to ensure we don't set it\n  // before we receive the composition end event.\n  useEffect(() => {\n    setTimeout(() => {\n      const { selection } = editor\n      if (selection) {\n        const { anchor } = selection\n        const text = Node.leaf(editor, anchor.path)\n\n        // While marks isn't a 'complete' text, we can still use loose Text.equals\n        // here which only compares marks anyway.\n        if (marks && !Text.equals(text, marks as Text, { loose: true })) {\n          EDITOR_TO_PENDING_INSERTION_MARKS.set(editor, marks)\n          return\n        }\n      }\n\n      EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n    })\n  })\n\n  return (\n    <ReadOnlyContext.Provider value={readOnly}>\n      <DecorateContext.Provider value={decorate}>\n        <RestoreDOM node={ref} receivedUserInput={receivedUserInput}>\n          <Component\n            role={readOnly ? undefined : 'textbox'}\n            aria-multiline={readOnly ? undefined : true}\n            {...attributes}\n            // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n            // have to use hacks to make these replacement-based features work.\n            // For SSR situations HAS_BEFORE_INPUT_SUPPORT is false and results in prop\n            // mismatch warning app moves to browser. Pass-through consumer props when\n            // not CAN_USE_DOM (SSR) and default to falsy value\n            spellCheck={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.spellCheck\n                : false\n            }\n            autoCorrect={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCorrect\n                : 'false'\n            }\n            autoCapitalize={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCapitalize\n                : 'false'\n            }\n            data-slate-editor\n            data-slate-node=\"value\"\n            // explicitly set this\n            contentEditable={!readOnly}\n            // in some cases, a decoration needs access to the range / selection to decorate a text node,\n            // then you will select the whole text node when you select part the of text\n            // this magic zIndex=\"-1\" will fix it\n            zindex={-1}\n            suppressContentEditableWarning\n            ref={callbackRef}\n            style={{\n              ...(disableDefaultStyles\n                ? {}\n                : {\n                    // Allow positioning relative to the editable element.\n                    position: 'relative',\n                    // Preserve adjacent whitespace and new lines.\n                    whiteSpace: 'pre-wrap',\n                    // Allow words to break if they are too long.\n                    wordWrap: 'break-word',\n                    // Make the minimum height that of the placeholder.\n                    ...(placeholderHeight\n                      ? { minHeight: placeholderHeight }\n                      : {}),\n                  }),\n              // Allow for passed-in styles to override anything.\n              ...userStyle,\n            }}\n            onBeforeInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                // fall back to React's leaky polyfill instead just for it. It\n                // only works for the `insertText` input type.\n                if (\n                  !HAS_BEFORE_INPUT_SUPPORT &&\n                  !readOnly &&\n                  !isEventHandled(event, attributes.onBeforeInput) &&\n                  ReactEditor.hasSelectableTarget(editor, event.target)\n                ) {\n                  event.preventDefault()\n                  if (!ReactEditor.isComposing(editor)) {\n                    const text = (event as any).data as string\n                    Editor.insertText(editor, text)\n                  }\n                }\n              },\n              [attributes.onBeforeInput, editor, readOnly]\n            )}\n            onInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                if (isEventHandled(event, attributes.onInput)) {\n                  return\n                }\n\n                if (androidInputManagerRef.current) {\n                  androidInputManagerRef.current.handleInput()\n                  return\n                }\n\n                // Flush native operations, as native events will have propogated\n                // and we can correctly compare DOM text values in components\n                // to stop rendering, so that browser functions like autocorrect\n                // and spellcheck work as expected.\n                for (const op of deferredOperations.current) {\n                  op()\n                }\n                deferredOperations.current = []\n              },\n              [attributes.onInput]\n            )}\n            onBlur={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  readOnly ||\n                  state.isUpdatingSelection ||\n                  !ReactEditor.hasSelectableTarget(editor, event.target) ||\n                  isEventHandled(event, attributes.onBlur)\n                ) {\n                  return\n                }\n\n                // COMPAT: If the current `activeElement` is still the previous\n                // one, this is due to the window being blurred when the tab\n                // itself becomes unfocused, so we want to abort early to allow to\n                // editor to stay focused when the tab becomes focused again.\n                const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                if (state.latestElement === root.activeElement) {\n                  return\n                }\n\n                const { relatedTarget } = event\n                const el = ReactEditor.toDOMNode(editor, editor)\n\n                // COMPAT: The event should be ignored if the focus is returning\n                // to the editor from an embedded editable element (eg. an <input>\n                // element inside a void node).\n                if (relatedTarget === el) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving from\n                // the editor to inside a void node's spacer element.\n                if (\n                  isDOMElement(relatedTarget) &&\n                  relatedTarget.hasAttribute('data-slate-spacer')\n                ) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving to a\n                // non- editable section of an element that isn't a void node (eg.\n                // a list item of the check list example).\n                if (\n                  relatedTarget != null &&\n                  isDOMNode(relatedTarget) &&\n                  ReactEditor.hasDOMNode(editor, relatedTarget)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, relatedTarget)\n\n                  if (Element.isElement(node) && !editor.isVoid(node)) {\n                    return\n                  }\n                }\n\n                // COMPAT: Safari doesn't always remove the selection even if the content-\n                // editable element no longer has focus. Refer to:\n                // https://stackoverflow.com/questions/12353247/force-contenteditable-div-to-stop-accepting-input-after-it-loses-focus-under-web\n                if (IS_WEBKIT) {\n                  const domSelection = root.getSelection()\n                  domSelection?.removeAllRanges()\n                }\n\n                IS_FOCUSED.delete(editor)\n              },\n              [\n                readOnly,\n                state.isUpdatingSelection,\n                state.latestElement,\n                editor,\n                attributes.onBlur,\n              ]\n            )}\n            onClick={useCallback(\n              (event: React.MouseEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onClick) &&\n                  isDOMNode(event.target)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n\n                  // At this time, the Slate document may be arbitrarily different,\n                  // because onClick handlers can change the document before we get here.\n                  // Therefore we must check that this path actually exists,\n                  // and that it still refers to the same node.\n                  if (\n                    !Editor.hasPath(editor, path) ||\n                    Node.get(editor, path) !== node\n                  ) {\n                    return\n                  }\n\n                  if (event.detail === TRIPLE_CLICK && path.length >= 1) {\n                    let blockPath = path\n                    if (\n                      !(Element.isElement(node) && Editor.isBlock(editor, node))\n                    ) {\n                      const block = Editor.above(editor, {\n                        match: n =>\n                          Element.isElement(n) && Editor.isBlock(editor, n),\n                        at: path,\n                      })\n\n                      blockPath = block?.[1] ?? path.slice(0, 1)\n                    }\n\n                    const range = Editor.range(editor, blockPath)\n                    Transforms.select(editor, range)\n                    return\n                  }\n\n                  if (readOnly) {\n                    return\n                  }\n\n                  const start = Editor.start(editor, path)\n                  const end = Editor.end(editor, path)\n                  const startVoid = Editor.void(editor, { at: start })\n                  const endVoid = Editor.void(editor, { at: end })\n\n                  if (\n                    startVoid &&\n                    endVoid &&\n                    Path.equals(startVoid[1], endVoid[1])\n                  ) {\n                    const range = Editor.range(editor, start)\n                    Transforms.select(editor, range)\n                  }\n                }\n              },\n              [editor, attributes.onClick, readOnly]\n            )}\n            onCompositionEnd={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  if (ReactEditor.isComposing(editor)) {\n                    setIsComposing(false)\n                    IS_COMPOSING.set(editor, false)\n                  }\n\n                  androidInputManagerRef.current?.handleCompositionEnd(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionEnd) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  // COMPAT: In Chrome, `beforeinput` events for compositions\n                  // aren't correct and never fire the \"insertFromComposition\"\n                  // type that we need. So instead, insert whenever a composition\n                  // ends since it will already have been committed to the DOM.\n                  if (\n                    !IS_WEBKIT &&\n                    !IS_FIREFOX_LEGACY &&\n                    !IS_IOS &&\n                    !IS_WECHATBROWSER &&\n                    !IS_UC_MOBILE &&\n                    event.data\n                  ) {\n                    const placeholderMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(\n                      editor\n                    )\n                    EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n\n                    // Ensure we insert text with the marks the user was actually seeing\n                    if (placeholderMarks !== undefined) {\n                      EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n                      editor.marks = placeholderMarks\n                    }\n\n                    Editor.insertText(editor, event.data)\n\n                    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n                    EDITOR_TO_USER_MARKS.delete(editor)\n                    if (userMarks !== undefined) {\n                      editor.marks = userMarks\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionEnd, editor]\n            )}\n            onCompositionUpdate={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCompositionUpdate)\n                ) {\n                  if (!ReactEditor.isComposing(editor)) {\n                    setIsComposing(true)\n                    IS_COMPOSING.set(editor, true)\n                  }\n                }\n              },\n              [attributes.onCompositionUpdate, editor]\n            )}\n            onCompositionStart={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  androidInputManagerRef.current?.handleCompositionStart(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionStart) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  setIsComposing(true)\n\n                  const { selection } = editor\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                      return\n                    }\n                    const inline = Editor.above(editor, {\n                      match: n =>\n                        Element.isElement(n) && Editor.isInline(editor, n),\n                      mode: 'highest',\n                    })\n                    if (inline) {\n                      const [, inlinePath] = inline\n                      if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n                        const point = Editor.after(editor, inlinePath)!\n                        Transforms.setSelection(editor, {\n                          anchor: point,\n                          focus: point,\n                        })\n                      }\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionStart, editor]\n            )}\n            onCopy={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCopy) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'copy'\n                  )\n                }\n              },\n              [attributes.onCopy, editor]\n            )}\n            onCut={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCut) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'cut'\n                  )\n                  const { selection } = editor\n\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                    } else {\n                      const node = Node.parent(editor, selection.anchor.path)\n                      if (Editor.isVoid(editor, node)) {\n                        Transforms.delete(editor)\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onCut]\n            )}\n            onDragOver={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragOver)\n                ) {\n                  // Only when the target is void, call `preventDefault` to signal\n                  // that drops are allowed. Editable content is droppable by\n                  // default, and calling `preventDefault` hides the cursor.\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n\n                  if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n                    event.preventDefault()\n                  }\n                }\n              },\n              [attributes.onDragOver, editor]\n            )}\n            onDragStart={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragStart)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n                  const voidMatch =\n                    (Element.isElement(node) && Editor.isVoid(editor, node)) ||\n                    Editor.void(editor, { at: path, voids: true })\n\n                  // If starting a drag on a void node, make sure it is selected\n                  // so that it shows up in the selection's fragment.\n                  if (voidMatch) {\n                    const range = Editor.range(editor, path)\n                    Transforms.select(editor, range)\n                  }\n\n                  state.isDraggingInternally = true\n\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.dataTransfer,\n                    'drag'\n                  )\n                }\n              },\n              [readOnly, editor, attributes.onDragStart, state]\n            )}\n            onDrop={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDrop)\n                ) {\n                  event.preventDefault()\n\n                  // Keep a reference to the dragged range before updating selection\n                  const draggedRange = editor.selection\n\n                  // Find the range where the drop happened\n                  const range = ReactEditor.findEventRange(editor, event)\n                  const data = event.dataTransfer\n\n                  Transforms.select(editor, range)\n\n                  if (state.isDraggingInternally) {\n                    if (\n                      draggedRange &&\n                      !Range.equals(draggedRange, range) &&\n                      !Editor.void(editor, { at: range, voids: true })\n                    ) {\n                      Transforms.delete(editor, {\n                        at: draggedRange,\n                      })\n                    }\n                  }\n\n                  ReactEditor.insertData(editor, data)\n\n                  // When dragging from another source into the editor, it's possible\n                  // that the current editor does not have focus.\n                  if (!ReactEditor.isFocused(editor)) {\n                    ReactEditor.focus(editor)\n                  }\n                }\n\n                state.isDraggingInternally = false\n              },\n              [readOnly, editor, attributes.onDrop, state]\n            )}\n            onDragEnd={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  state.isDraggingInternally &&\n                  attributes.onDragEnd &&\n                  ReactEditor.hasTarget(editor, event.target)\n                ) {\n                  attributes.onDragEnd(event)\n                }\n\n                // When dropping on a different droppable element than the current editor,\n                // `onDrop` is not called. So we need to clean up in `onDragEnd` instead.\n                // Note: `onDragEnd` is only called when `onDrop` is not called\n                state.isDraggingInternally = false\n              },\n              [readOnly, state, attributes, editor]\n            )}\n            onFocus={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  !state.isUpdatingSelection &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onFocus)\n                ) {\n                  const el = ReactEditor.toDOMNode(editor, editor)\n                  const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                  state.latestElement = root.activeElement\n\n                  // COMPAT: If the editor has nested editable elements, the focus\n                  // can go to them. In Firefox, this must be prevented because it\n                  // results in issues with keyboard navigation. (2017/03/30)\n                  if (IS_FIREFOX && event.target !== el) {\n                    el.focus()\n                    return\n                  }\n\n                  IS_FOCUSED.set(editor, true)\n                }\n              },\n              [readOnly, state, editor, attributes.onFocus]\n            )}\n            onKeyDown={useCallback(\n              (event: React.KeyboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target)\n                ) {\n                  androidInputManagerRef.current?.handleKeyDown(event)\n\n                  const { nativeEvent } = event\n\n                  // COMPAT: The composition end event isn't fired reliably in all browsers,\n                  // so we sometimes might end up stuck in a composition state even though we\n                  // aren't composing any more.\n                  if (\n                    ReactEditor.isComposing(editor) &&\n                    nativeEvent.isComposing === false\n                  ) {\n                    IS_COMPOSING.set(editor, false)\n                    setIsComposing(false)\n                  }\n\n                  if (\n                    isEventHandled(event, attributes.onKeyDown) ||\n                    ReactEditor.isComposing(editor)\n                  ) {\n                    return\n                  }\n\n                  const { selection } = editor\n                  const element =\n                    editor.children[\n                      selection !== null ? selection.focus.path[0] : 0\n                    ]\n                  const isRTL = getDirection(Node.string(element)) === 'rtl'\n\n                  // COMPAT: Since we prevent the default behavior on\n                  // `beforeinput` events, the browser doesn't think there's ever\n                  // any history stack to undo or redo, so we have to manage these\n                  // hotkeys ourselves. (2019/11/06)\n                  if (Hotkeys.isRedo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.redo === 'function') {\n                      maybeHistoryEditor.redo()\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isUndo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.undo === 'function') {\n                      maybeHistoryEditor.undo()\n                    }\n\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't handle the selection updates\n                  // properly. In Chrome, the selection isn't properly extended.\n                  // And in Firefox, the selection isn't properly collapsed.\n                  // (2017/10/17)\n                  if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', reverse: true })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line' })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, {\n                      unit: 'line',\n                      edge: 'focus',\n                      reverse: true,\n                    })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', edge: 'focus' })\n                    return\n                  }\n\n                  // COMPAT: If a void node is selected, or a zero-width text node\n                  // adjacent to an inline is selected, we need to handle these\n                  // hotkeys manually because browsers won't be able to skip over\n                  // the void node with the zero-width space not being an empty\n                  // string.\n                  if (Hotkeys.isMoveBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: !isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'start' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'end' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: !isRTL })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: isRTL })\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to guessing at the input intention for hotkeys.\n                  // COMPAT: In iOS, some of these hotkeys are handled in the\n                  if (!HAS_BEFORE_INPUT_SUPPORT) {\n                    // We don't have a core behavior for these, but they change the\n                    // DOM if we don't prevent them, so we have to.\n                    if (\n                      Hotkeys.isBold(nativeEvent) ||\n                      Hotkeys.isItalic(nativeEvent) ||\n                      Hotkeys.isTransposeCharacter(nativeEvent)\n                    ) {\n                      event.preventDefault()\n                      return\n                    }\n\n                    if (Hotkeys.isSoftBreak(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertSoftBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isSplitBlock(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n                  } else {\n                    if (IS_CHROME || IS_WEBKIT) {\n                      // COMPAT: Chrome and Safari support `beforeinput` event but do not fire\n                      // an event when deleting backwards in a selected void inline node\n                      if (\n                        selection &&\n                        (Hotkeys.isDeleteBackward(nativeEvent) ||\n                          Hotkeys.isDeleteForward(nativeEvent)) &&\n                        Range.isCollapsed(selection)\n                      ) {\n                        const currentNode = Node.parent(\n                          editor,\n                          selection.anchor.path\n                        )\n\n                        if (\n                          Element.isElement(currentNode) &&\n                          Editor.isVoid(editor, currentNode) &&\n                          (Editor.isInline(editor, currentNode) ||\n                            Editor.isBlock(editor, currentNode))\n                        ) {\n                          event.preventDefault()\n                          Editor.deleteBackward(editor, { unit: 'block' })\n\n                          return\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onKeyDown]\n            )}\n            onPaste={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onPaste)\n                ) {\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to React's `onPaste` here instead.\n                  // COMPAT: Firefox, Chrome and Safari don't emit `beforeinput` events\n                  // when \"paste without formatting\" is used, so fallback. (2020/02/20)\n                  // COMPAT: Safari InputEvents generated by pasting won't include\n                  // application/x-slate-fragment items, so use the\n                  // ClipboardEvent here. (2023/03/15)\n                  if (\n                    !HAS_BEFORE_INPUT_SUPPORT ||\n                    isPlainTextOnlyPaste(event.nativeEvent) ||\n                    IS_WEBKIT\n                  ) {\n                    event.preventDefault()\n                    ReactEditor.insertData(editor, event.clipboardData)\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onPaste]\n            )}\n          >\n            <Children\n              decorations={decorations}\n              node={editor}\n              renderElement={renderElement}\n              renderPlaceholder={renderPlaceholder}\n              renderLeaf={renderLeaf}\n              selection={editor.selection}\n            />\n          </Component>\n        </RestoreDOM>\n      </DecorateContext.Provider>\n    </ReadOnlyContext.Provider>\n  )\n}\n\n/**\n * The props that get passed to renderPlaceholder\n */\nexport type RenderPlaceholderProps = {\n  children: any\n  attributes: {\n    'data-slate-placeholder': boolean\n    dir?: 'rtl'\n    contentEditable: boolean\n    ref: React.RefCallback<any>\n    style: React.CSSProperties\n  }\n}\n\n/**\n * The default placeholder element\n */\n\nexport const DefaultPlaceholder = ({\n  attributes,\n  children,\n}: RenderPlaceholderProps) => (\n  // COMPAT: Artificially add a line-break to the end on the placeholder element\n  // to prevent Android IMEs to pick up its content in autocorrect and to auto-capitalize the first letter\n  <span {...attributes}>\n    {children}\n    {IS_ANDROID && <br />}\n  </span>\n)\n\n/**\n * A default memoized decorate function.\n */\n\nexport const defaultDecorate: (entry: NodeEntry) => Range[] = () => []\n\n/**\n * A default implement to scroll dom range into view.\n */\n\nconst defaultScrollSelectionIntoView = (\n  editor: ReactEditor,\n  domRange: DOMRange\n) => {\n  // This was affecting the selection of multiple blocks and dragging behavior,\n  // so enabled only if the selection has been collapsed.\n  if (\n    domRange.getBoundingClientRect &&\n    (!editor.selection ||\n      (editor.selection && Range.isCollapsed(editor.selection)))\n  ) {\n    const leafEl = domRange.startContainer.parentElement!\n    leafEl.getBoundingClientRect = domRange.getBoundingClientRect.bind(domRange)\n    scrollIntoView(leafEl, {\n      scrollMode: 'if-needed',\n    })\n\n    // @ts-expect-error an unorthodox delete D:\n    delete leafEl.getBoundingClientRect\n  }\n}\n\n/**\n * Check if an event is overrided by a handler.\n */\n\nexport const isEventHandled = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType,\n  handler?: (event: EventType) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.isDefaultPrevented() || event.isPropagationStopped()\n}\n\n/**\n * Check if the event's target is an input element\n */\nexport const isDOMEventTargetInput = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType\n) => {\n  return (\n    isDOMNode(event.target) &&\n    (event.target instanceof HTMLInputElement ||\n      event.target instanceof HTMLTextAreaElement)\n  )\n}\n\n/**\n * Check if a DOM event is overrided by a handler.\n */\n\nexport const isDOMEventHandled = <E extends Event>(\n  event: E,\n  handler?: (event: E) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.defaultPrevented\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `focused` state of the editor.\n */\n\nexport const FocusedContext = createContext(false)\n\n/**\n * Get the current `focused` state of the editor.\n */\n\nexport const useFocused = (): boolean => {\n  return useContext(FocusedContext)\n}\n","import {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react'\nimport { Editor } from 'slate'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nfunction isError(error: any): error is Error {\n  return error instanceof Error\n}\n\ntype EditorChangeHandler = (editor: Editor) => void\n/**\n * A React context for sharing the editor selector context in a way to control rerenders\n */\n\nexport const SlateSelectorContext = createContext<{\n  getSlate: () => Editor\n  addEventListener: (callback: EditorChangeHandler) => () => void\n}>({} as any)\n\nconst refEquality = (a: any, b: any) => a === b\n\n/**\n * use redux style selectors to prevent rerendering on every keystroke.\n * Bear in mind rerendering can only prevented if the returned value is a value type or for reference types (e.g. objects and arrays) add a custom equality function.\n *\n * Example:\n * ```\n *  const isSelectionActive = useSlateSelector(editor => Boolean(editor.selection));\n * ```\n */\nexport function useSlateSelector<T>(\n  selector: (editor: Editor) => T,\n  equalityFn: (a: T, b: T) => boolean = refEquality\n) {\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  const context = useContext(SlateSelectorContext)\n  if (!context) {\n    throw new Error(\n      `The \\`useSlateSelector\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n  const { getSlate, addEventListener } = context\n\n  const latestSubscriptionCallbackError = useRef<Error | undefined>()\n  const latestSelector = useRef<(editor: Editor) => T>(() => null as any)\n  const latestSelectedState = useRef<T>((null as any) as T)\n  let selectedState: T\n\n  try {\n    if (\n      selector !== latestSelector.current ||\n      latestSubscriptionCallbackError.current\n    ) {\n      selectedState = selector(getSlate())\n    } else {\n      selectedState = latestSelectedState.current\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current && isError(err)) {\n      err.message += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\n`\n    }\n\n    throw err\n  }\n  useIsomorphicLayoutEffect(() => {\n    latestSelector.current = selector\n    latestSelectedState.current = selectedState\n    latestSubscriptionCallbackError.current = undefined\n  })\n\n  useIsomorphicLayoutEffect(\n    () => {\n      function checkForUpdates() {\n        try {\n          const newSelectedState = latestSelector.current(getSlate())\n\n          if (equalityFn(newSelectedState, latestSelectedState.current)) {\n            return\n          }\n\n          latestSelectedState.current = newSelectedState\n        } catch (err) {\n          // we ignore all errors here, since when the component\n          // is re-rendered, the selectors are called again, and\n          // will throw again, if neither props nor store state\n          // changed\n          latestSubscriptionCallbackError.current = err\n        }\n\n        forceRender()\n      }\n\n      const unsubscribe = addEventListener(checkForUpdates)\n\n      checkForUpdates()\n\n      return () => unsubscribe()\n    },\n    // don't rerender on equalityFn change since we want to be able to define it inline\n    [addEventListener, getSlate]\n  )\n\n  return selectedState\n}\n\n/**\n * Create selector context with editor updating on every editor change\n */\nexport function useSelectorContext(editor: Editor) {\n  const eventListeners = useRef<EditorChangeHandler[]>([]).current\n  const slateRef = useRef<{\n    editor: Editor\n  }>({\n    editor,\n  }).current\n  const onChange = useCallback(\n    (editor: Editor) => {\n      slateRef.editor = editor\n      eventListeners.forEach((listener: EditorChangeHandler) =>\n        listener(editor)\n      )\n    },\n    [eventListeners, slateRef]\n  )\n\n  const selectorContext = useMemo(() => {\n    return {\n      getSlate: () => slateRef.editor,\n      addEventListener: (callback: EditorChangeHandler) => {\n        eventListeners.push(callback)\n        return () => {\n          eventListeners.splice(eventListeners.indexOf(callback), 1)\n        }\n      },\n    }\n  }, [eventListeners, slateRef])\n  return { selectorContext, onChange }\n}\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { Descendant, Editor, Node, Scrubber } from 'slate'\nimport { FocusedContext } from '../hooks/use-focused'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { SlateContext, SlateContextValue } from '../hooks/use-slate'\nimport {\n  useSelectorContext,\n  SlateSelectorContext,\n} from '../hooks/use-slate-selector'\nimport { EditorContext } from '../hooks/use-slate-static'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\nimport { EDITOR_TO_ON_CHANGE } from '../utils/weak-maps'\n\n/**\n * A wrapper around the provider to handle `onChange` events, because the editor\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\n */\n\nexport const Slate = (props: {\n  editor: ReactEditor\n  initialValue: Descendant[]\n  children: React.ReactNode\n  onChange?: (value: Descendant[]) => void\n}) => {\n  const { editor, children, onChange, initialValue, ...rest } = props\n  const unmountRef = useRef(false)\n\n  const [context, setContext] = React.useState<SlateContextValue>(() => {\n    if (!Node.isNodeList(initialValue)) {\n      throw new Error(\n        `[Slate] initialValue is invalid! Expected a list of elements but got: ${Scrubber.stringify(\n          initialValue\n        )}`\n      )\n    }\n    if (!Editor.isEditor(editor)) {\n      throw new Error(\n        `[Slate] editor is invalid! You passed: ${Scrubber.stringify(editor)}`\n      )\n    }\n    editor.children = initialValue\n    Object.assign(editor, rest)\n    return { v: 0, editor }\n  })\n\n  const {\n    selectorContext,\n    onChange: handleSelectorChange,\n  } = useSelectorContext(editor)\n\n  const onContextChange = useCallback(() => {\n    if (onChange) {\n      onChange(editor.children)\n    }\n\n    setContext(prevContext => ({\n      v: prevContext.v + 1,\n      editor,\n    }))\n    handleSelectorChange(editor)\n  }, [editor, handleSelectorChange, onChange])\n\n  useEffect(() => {\n    EDITOR_TO_ON_CHANGE.set(editor, onContextChange)\n\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {})\n      unmountRef.current = true\n    }\n  }, [editor, onContextChange])\n\n  const [isFocused, setIsFocused] = useState(ReactEditor.isFocused(editor))\n\n  useEffect(() => {\n    setIsFocused(ReactEditor.isFocused(editor))\n  }, [editor])\n\n  useIsomorphicLayoutEffect(() => {\n    const fn = () => setIsFocused(ReactEditor.isFocused(editor))\n    if (REACT_MAJOR_VERSION >= 17) {\n      // In React >= 17 onFocus and onBlur listen to the focusin and focusout events during the bubbling phase.\n      // Therefore in order for <Editable />'s handlers to run first, which is necessary for ReactEditor.isFocused(editor)\n      // to return the correct value, we have to listen to the focusin and focusout events without useCapture here.\n      document.addEventListener('focusin', fn)\n      document.addEventListener('focusout', fn)\n      return () => {\n        document.removeEventListener('focusin', fn)\n        document.removeEventListener('focusout', fn)\n      }\n    } else {\n      document.addEventListener('focus', fn, true)\n      document.addEventListener('blur', fn, true)\n      return () => {\n        document.removeEventListener('focus', fn, true)\n        document.removeEventListener('blur', fn, true)\n      }\n    }\n  }, [])\n\n  return (\n    <SlateSelectorContext.Provider value={selectorContext}>\n      <SlateContext.Provider value={context}>\n        <EditorContext.Provider value={context.editor}>\n          <FocusedContext.Provider value={isFocused}>\n            {children}\n          </FocusedContext.Provider>\n        </EditorContext.Provider>\n      </SlateContext.Provider>\n    </SlateSelectorContext.Provider>\n  )\n}\n","import { useContext } from 'react'\n\nimport { EditorContext } from './use-slate-static'\n\n/**\n * Get the current editor object from the React context.\n * @deprecated Use useSlateStatic instead.\n */\n\nexport const useEditor = () => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useEditor\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import { BaseSelection, Range } from 'slate'\n\nimport { useSlateSelector } from './use-slate-selector'\n\n/**\n * Get the current slate selection.\n * Only triggers a rerender when the selection actually changes\n */\nexport const useSlateSelection = () => {\n  return useSlateSelector(editor => editor.selection, isSelectionEqual)\n}\n\nconst isSelectionEqual = (a: BaseSelection, b: BaseSelection) => {\n  if (!a && !b) return true\n  if (!a || !b) return false\n  return Range.equals(a, b)\n}\n","/**\n * Utilities for single-line deletion\n */\n\nimport { Editor, Range } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\nconst doRectsIntersect = (rect: DOMRect, compareRect: DOMRect) => {\n  const middle = (compareRect.top + compareRect.bottom) / 2\n\n  return rect.top <= middle && rect.bottom >= middle\n}\n\nconst areRangesSameLine = (\n  editor: ReactEditor,\n  range1: Range,\n  range2: Range\n) => {\n  const rect1 = ReactEditor.toDOMRange(editor, range1).getBoundingClientRect()\n  const rect2 = ReactEditor.toDOMRange(editor, range2).getBoundingClientRect()\n\n  return doRectsIntersect(rect1, rect2) && doRectsIntersect(rect2, rect1)\n}\n\n/**\n * A helper utility that returns the end portion of a `Range`\n * which is located on a single line.\n *\n * @param {Editor} editor The editor object to compare against\n * @param {Range} parentRange The parent range to compare against\n * @returns {Range} A valid portion of the parentRange which is one a single line\n */\nexport const findCurrentLineRange = (\n  editor: ReactEditor,\n  parentRange: Range\n): Range => {\n  const parentRangeBoundary = Editor.range(editor, Range.end(parentRange))\n  const positions = Array.from(Editor.positions(editor, { at: parentRange }))\n\n  let left = 0\n  let right = positions.length\n  let middle = Math.floor(right / 2)\n\n  if (\n    areRangesSameLine(\n      editor,\n      Editor.range(editor, positions[left]),\n      parentRangeBoundary\n    )\n  ) {\n    return Editor.range(editor, positions[left], parentRangeBoundary)\n  }\n\n  if (positions.length < 2) {\n    return Editor.range(\n      editor,\n      positions[positions.length - 1],\n      parentRangeBoundary\n    )\n  }\n\n  while (middle !== positions.length && middle !== left) {\n    if (\n      areRangesSameLine(\n        editor,\n        Editor.range(editor, positions[middle]),\n        parentRangeBoundary\n      )\n    ) {\n      right = middle\n    } else {\n      left = middle\n    }\n\n    middle = Math.floor((left + right) / 2)\n  }\n\n  return Editor.range(editor, positions[right], parentRangeBoundary)\n}\n","import ReactDOM from 'react-dom'\nimport {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Transforms,\n} from 'slate'\nimport {\n  TextDiff,\n  transformPendingPoint,\n  transformPendingRange,\n  transformTextDiff,\n} from '../utils/diff-text'\nimport {\n  getPlainText,\n  getSlateFragmentAttribute,\n  isDOMText,\n} from '../utils/dom'\nimport { Key } from '../utils/key'\nimport { findCurrentLineRange } from '../utils/lines'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_ON_CHANGE,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  NODE_TO_KEY,\n} from '../utils/weak-maps'\nimport { ReactEditor } from './react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\n\n/**\n * `withReact` adds React and DOM specific behaviors to the editor.\n *\n * If you are using TypeScript, you must extend Slate's CustomTypes to use\n * this plugin.\n *\n * See https://docs.slatejs.org/concepts/11-typescript to learn how.\n */\n\nexport const withReact = <T extends BaseEditor>(\n  editor: T,\n  clipboardFormatKey = 'x-slate-fragment'\n): T & ReactEditor => {\n  const e = editor as T & ReactEditor\n  const { apply, onChange, deleteBackward, addMark, removeMark } = e\n\n  // The WeakMap which maps a key to a specific HTMLElement must be scoped to the editor instance to\n  // avoid collisions between editors in the DOM that share the same value.\n  EDITOR_TO_KEY_TO_ELEMENT.set(e, new WeakMap())\n\n  e.addMark = (key, value) => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(e)?.()\n\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    addMark(key, value)\n  }\n\n  e.removeMark = key => {\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    removeMark(key)\n  }\n\n  e.deleteBackward = unit => {\n    if (unit !== 'line') {\n      return deleteBackward(unit)\n    }\n\n    if (e.selection && Range.isCollapsed(e.selection)) {\n      const parentBlockEntry = Editor.above(e, {\n        match: n => Element.isElement(n) && Editor.isBlock(e, n),\n        at: e.selection,\n      })\n\n      if (parentBlockEntry) {\n        const [, parentBlockPath] = parentBlockEntry\n        const parentElementRange = Editor.range(\n          e,\n          parentBlockPath,\n          e.selection.anchor\n        )\n\n        const currentLineRange = findCurrentLineRange(e, parentElementRange)\n\n        if (!Range.isCollapsed(currentLineRange)) {\n          Transforms.delete(e, { at: currentLineRange })\n        }\n      }\n    }\n  }\n\n  // This attempts to reset the NODE_TO_KEY entry to the correct value\n  // as apply() changes the object reference and hence invalidates the NODE_TO_KEY entry\n  e.apply = (op: Operation) => {\n    const matches: [Path, Key][] = []\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(e)\n    if (pendingDiffs?.length) {\n      const transformed = pendingDiffs\n        .map(textDiff => transformTextDiff(textDiff, op))\n        .filter(Boolean) as TextDiff[]\n\n      EDITOR_TO_PENDING_DIFFS.set(e, transformed)\n    }\n\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(e)\n    if (pendingSelection) {\n      EDITOR_TO_PENDING_SELECTION.set(\n        e,\n        transformPendingRange(e, pendingSelection, op)\n      )\n    }\n\n    const pendingAction = EDITOR_TO_PENDING_ACTION.get(e)\n    if (pendingAction?.at) {\n      const at = Point.isPoint(pendingAction?.at)\n        ? transformPendingPoint(e, pendingAction.at, op)\n        : transformPendingRange(e, pendingAction.at, op)\n\n      EDITOR_TO_PENDING_ACTION.set(e, at ? { ...pendingAction, at } : null)\n    }\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n      case 'split_node': {\n        matches.push(...getMatches(e, op.path))\n        break\n      }\n\n      case 'set_selection': {\n        // Selection was manually set, don't restore the user selection after the change.\n        EDITOR_TO_USER_SELECTION.get(e)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(e)\n        break\n      }\n\n      case 'insert_node':\n      case 'remove_node': {\n        matches.push(...getMatches(e, Path.parent(op.path)))\n        break\n      }\n\n      case 'merge_node': {\n        const prevPath = Path.previous(op.path)\n        matches.push(...getMatches(e, prevPath))\n        break\n      }\n\n      case 'move_node': {\n        const commonPath = Path.common(\n          Path.parent(op.path),\n          Path.parent(op.newPath)\n        )\n        matches.push(...getMatches(e, commonPath))\n        break\n      }\n    }\n\n    apply(op)\n\n    for (const [path, key] of matches) {\n      const [node] = Editor.node(e, path)\n      NODE_TO_KEY.set(node, key)\n    }\n  }\n\n  e.setFragmentData = (data: Pick<DataTransfer, 'getData' | 'setData'>) => {\n    const { selection } = e\n\n    if (!selection) {\n      return\n    }\n\n    const [start, end] = Range.edges(selection)\n    const startVoid = Editor.void(e, { at: start.path })\n    const endVoid = Editor.void(e, { at: end.path })\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return\n    }\n\n    // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n    const domRange = ReactEditor.toDOMRange(e, selection)\n    let contents = domRange.cloneContents()\n    let attach = contents.childNodes[0] as HTMLElement\n\n    // Make sure attach is non-empty, since empty nodes will not get copied.\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node as HTMLElement\n      }\n    })\n\n    // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n    if (endVoid) {\n      const [voidNode] = endVoid\n      const r = domRange.cloneRange()\n      const domNode = ReactEditor.toDOMNode(e, voidNode)\n      r.setEndAfter(domNode)\n      contents = r.cloneContents()\n    }\n\n    // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\n    }\n\n    // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\n      zw => {\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\n        zw.textContent = isNewline ? '\\n' : ''\n      }\n    )\n\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n    if (isDOMText(attach)) {\n      const span = attach.ownerDocument.createElement('span')\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n      span.style.whiteSpace = 'pre'\n      span.appendChild(attach)\n      contents.appendChild(span)\n      attach = span\n    }\n\n    const fragment = e.getFragment()\n    const string = JSON.stringify(fragment)\n    const encoded = window.btoa(encodeURIComponent(string))\n    attach.setAttribute('data-slate-fragment', encoded)\n    data.setData(`application/${clipboardFormatKey}`, encoded)\n\n    // Add the content to a <div> so that we can get its inner HTML.\n    const div = contents.ownerDocument.createElement('div')\n    div.appendChild(contents)\n    div.setAttribute('hidden', 'true')\n    contents.ownerDocument.body.appendChild(div)\n    data.setData('text/html', div.innerHTML)\n    data.setData('text/plain', getPlainText(div))\n    contents.ownerDocument.body.removeChild(div)\n    return data\n  }\n\n  e.insertData = (data: DataTransfer) => {\n    if (!e.insertFragmentData(data)) {\n      e.insertTextData(data)\n    }\n  }\n\n  e.insertFragmentData = (data: DataTransfer): boolean => {\n    /**\n     * Checking copied fragment from application/x-slate-fragment or data-slate-fragment\n     */\n    const fragment =\n      data.getData(`application/${clipboardFormatKey}`) ||\n      getSlateFragmentAttribute(data)\n\n    if (fragment) {\n      const decoded = decodeURIComponent(window.atob(fragment))\n      const parsed = JSON.parse(decoded) as Node[]\n      e.insertFragment(parsed)\n      return true\n    }\n    return false\n  }\n\n  e.insertTextData = (data: DataTransfer): boolean => {\n    const text = data.getData('text/plain')\n\n    if (text) {\n      const lines = text.split(/\\r\\n|\\r|\\n/)\n      let split = false\n\n      for (const line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, { always: true })\n        }\n\n        e.insertText(line)\n        split = true\n      }\n      return true\n    }\n    return false\n  }\n\n  e.onChange = options => {\n    // COMPAT: React < 18 doesn't batch `setState` hook calls, which means\n    // that the children and selection can get out of sync for one render\n    // pass. So we have to use this unstable API to ensure it batches them.\n    // (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    const maybeBatchUpdates =\n      REACT_MAJOR_VERSION < 18\n        ? ReactDOM.unstable_batchedUpdates\n        : (callback: () => void) => callback()\n\n    maybeBatchUpdates(() => {\n      const onContextChange = EDITOR_TO_ON_CHANGE.get(e)\n\n      if (onContextChange) {\n        onContextChange()\n      }\n\n      onChange(options)\n    })\n  }\n\n  return e\n}\n\nconst getMatches = (e: Editor, path: Path) => {\n  const matches: [Path, Key][] = []\n  for (const [n, p] of Editor.levels(e, { at: path })) {\n    const key = ReactEditor.findKey(e, n)\n    matches.push([p, key])\n  }\n  return matches\n}\n"],"names":["EditorContext","createContext","useSlateStatic","editor","useContext","Error","REACT_MAJOR_VERSION","parseInt","React","version","split","IS_IOS","navigator","window","test","userAgent","MSStream","IS_APPLE","IS_ANDROID","IS_FIREFOX","IS_WEBKIT","IS_EDGE_LEGACY","IS_CHROME","IS_CHROME_LEGACY","IS_ANDROID_CHROME_LEGACY","IS_FIREFOX_LEGACY","IS_UC_MOBILE","IS_WECHATBROWSER","CAN_USE_DOM","document","createElement","HAS_BEFORE_INPUT_SUPPORT","globalThis","InputEvent","prototype","getTargetRanges","NODE_TO_INDEX","WeakMap","NODE_TO_PARENT","EDITOR_TO_WINDOW","EDITOR_TO_ELEMENT","EDITOR_TO_PLACEHOLDER_ELEMENT","ELEMENT_TO_NODE","NODE_TO_ELEMENT","NODE_TO_KEY","EDITOR_TO_KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","IS_COMPOSING","EDITOR_TO_USER_SELECTION","EDITOR_TO_ON_CHANGE","EDITOR_TO_SCHEDULE_FLUSH","EDITOR_TO_PENDING_INSERTION_MARKS","EDITOR_TO_USER_MARKS","EDITOR_TO_PENDING_DIFFS","EDITOR_TO_PENDING_ACTION","EDITOR_TO_PENDING_SELECTION","EDITOR_TO_FORCE_RENDER","PLACEHOLDER_SYMBOL","Symbol","MARK_PLACEHOLDER_SYMBOL","DOMText","Text","getDefaultView","value","ownerDocument","defaultView","isDOMComment","isDOMNode","nodeType","isDOMElement","Node","isDOMSelection","anchorNode","Selection","isDOMText","isPlainTextOnlyPaste","event","clipboardData","getData","types","length","normalizeDOMPoint","domPoint","node","offset","childNodes","isLast","index","getEditableChildAndIndex","i","getEditableChild","textContent","hasShadowRoot","parent","parentNode","toString","direction","child","triedForward","triedBackward","getAttribute","getPlainText","domNode","text","nodeValue","Array","from","childNode","display","getComputedStyle","getPropertyValue","tagName","catchSlateFragment","getSlateFragmentAttribute","dataTransfer","htmlData","match","fragment","isTrackedMutation","mutation","batch","target","matches","ReactEditor","getWindow","contains","hasDOMNode","editable","parentMutation","find","addedNodes","removedNodes","n","Key","id","androidPendingDiffs","get","androidScheduleFlush","blur","el","toDOMNode","root","findDocumentOrShadowRoot","set","activeElement","deselect","selection","domSelection","getSelection","rangeCount","removeAllRanges","Transforms","getRootNode","Document","ShadowRoot","findEventRange","nativeEvent","x","clientX","y","clientY","toSlateNode","path","findPath","Element","isElement","Editor","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","edge","point","before","after","range","domRange","caretRangeFromPoint","position","caretPositionFromPoint","createRange","setStart","offsetNode","setEnd","toSlateRange","exactMatch","suppressThrow","findKey","key","isEditor","unshift","Scrubber","stringify","focus","preventScroll","options","editorEl","targetEl","parentElement","err","message","includes","closest","isContentEditable","hasEditableTarget","hasRange","anchor","hasPath","hasSelectableTarget","isTargetInsideNonReadonlyVoid","hasTarget","insertData","data","insertFragmentData","insertTextData","isComposing","isFocused","isReadOnly","slateNode","setFragmentData","originEvent","KEY_TO_ELEMENT","toDOMPoint","at","selector","texts","querySelectorAll","start","attr","trueLength","end","nextText","hasAttribute","domText","startsWith","Math","min","max","toDOMRange","isBackward","Range","domAnchor","domFocus","isCollapsed","startNode","startOffset","endNode","endOffset","startEl","isStartAtZeroWidth","endEl","isEndAtZeroWidth","domEl","toSlatePoint","nearestNode","nearestOffset","textNode","potentialVoidNode","voidNode","leafNode","contents","cloneContents","removals","slice","call","forEach","textContext","removeChild","leafNodes","current","endsWith","querySelector","startContainer","anchorOffset","focusNode","focusOffset","firstRange","getRangeAt","lastRange","endContainer","collapsed","isExpanded","isForward","mode","unhangRange","voids","verifyDiffState","textDiff","diff","isText","nextPath","Path","next","nextNode","applyStringDiff","diffs","reduce","longestCommonPrefixLength","str","another","charAt","longestCommonSuffixLength","normalizeStringDiff","targetText","removedText","prefixLength","suffixLength","normalized","mergeStringDiffs","a","b","overlap","applied","sliceEnd","targetRange","normalizePoint","leaf","parentBlock","above","isBlock","entry","isDescendant","normalizeRange","transformPendingPoint","op","pendingDiffs","equals","Point","transform","affinity","transformed","type","transformPendingRange","transformTextDiff","newPath","RESOLVE_DELAY","FLUSH_DELAY","debug","isDataTransfer","constructor","name","createAndroidInputManager","scheduleOnDOMSelectionChange","onDOMSelectionChange","flushing","compositionEndTimeoutId","flushTimeoutId","actionTimeoutId","idCounter","insertPositionHint","applyPendingSelection","pendingSelection","select","performAction","action","isPoint","run","flush","clearTimeout","hasPendingDiffs","hasPendingAction","setTimeout","selectionRef","rangeRef","marks","scheduleSelectionChange","pendingMarks","undefined","insertText","deleteFragment","filter","cancel","unref","userMarks","onChange","handleCompositionEnd","_event","handleCompositionStart","updatePlaceholderVisibility","forceHide","placeholderElement","style","removeProperty","storeDiff","idx","findIndex","change","push","merged","splice","scheduleAction","handleDOMBeforeInput","inputType","nativeTargetRange","canStoreDiff","edges","relevantPendingDiffs","handleUserSelect","targetNode","deleteForward","nativeCollapsed","deleteBackward","unit","insertSoftBreak","insertBreak","replace","parts","line","hintPosition","search","diffPosition","scheduleFlush","hasPendingChanges","isFlushing","pathChanged","parentPathChanged","handleInput","handleKeyDown","_","handleDomMutations","mutations","some","useIsMounted","isMountedRef","useRef","useEffect","useIsomorphicLayoutEffect","useLayoutEffect","useMutationObserver","callback","useState","MutationObserver","mutationObserver","takeRecords","observe","disconnect","MUTATION_OBSERVER_CONFIG","subtree","childList","characterData","useAndroidInputManager","isMounted","inputManager","shallowCompare","obj1","obj2","Object","keys","every","hasOwnProperty","isDecorationFlagsEqual","other","rangeOwnProps","otherOwnProps","isElementDecorationsEqual","list","isTextDecorationsEqual","String","props","parentPath","isMarkPlaceholder","ZeroWidthString","string","children","isLineBreak","TextString","isTrailing","ref","getTextContent","initialText","textWithTrailing","MemoizedText","memo","forwardRef","attributes","disconnectPlaceholderResizeObserver","placeholderResizeObserver","releaseObserver","clearTimeoutRef","timeoutRef","Leaf","renderPlaceholder","renderLeaf","DefaultLeaf","placeholderRef","showPlaceholder","setShowPlaceholder","showPlaceholderTimeoutRef","callbackPlaceholderRef","useCallback","placeholderEl","onPlaceholderResize","ResizeObserver","ResizeObserverPolyfill","leafIsPlaceholder","placeholderProps","placeholder","pointerEvents","maxWidth","opacity","userSelect","textDecoration","WebkitUserModify","contentEditable","Fragment","MemoizedLeaf","prev","decorations","leaves","SlateText","callbackRef","span","element","renderElement","p","DefaultElement","readOnly","useReadOnly","useChildren","hasInlines","dir","getDirection","Tag","color","outline","MemoizedElement","DecorateContext","useDecorate","SelectedContext","useSelected","decorate","isLeafBlock","concat","sel","intersection","ds","dec","d","Provider","ElementComponent","TextComponent","ReadOnlyContext","SlateContext","useSlate","context","useSlateWithV","useTrackUserInput","receivedUserInput","animationFrameIdRef","onUserInput","cancelAnimationFrame","requestAnimationFrame","TRIPLE_CLICK","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isHotkey","isApple","isWindows","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSoftBreak","isSplitBlock","isTransposeCharacter","isUndo","require$$0","createRestoreDomManager","bufferedMutations","clear","registerMutations","trackedMutations","restoreDOM","reverse","insertBefore","nextSibling","characterDataOldValue","RestoreDOMComponent","manager","pendingMutations","Component","RestoreDOM","Children","Editable","defaultRenderPlaceholder","DefaultPlaceholder","autoFocus","defaultDecorate","propsOnDOMBeforeInput","onDOMBeforeInput","scrollSelectionIntoView","defaultScrollSelectionIntoView","userStyle","as","disableDefaultStyles","setIsComposing","deferredOperations","placeholderHeight","setPlaceholderHeight","useReducer","s","forceRender","state","useMemo","isDraggingInternally","isUpdatingSelection","latestElement","hasMarkPlaceholder","androidInputManagerRef","throttle","androidInputManager","anchorNodeSelectable","focusNodeSelectable","debounce","setDomSelection","forceChange","hasDomSelection","editorElement","hasDomSelectionInEditor","slateRange","newDomRange","collapseToEnd","setBaseAndExtent","ensureSelection","timeoutId","animationFrameId","ensureDomSelection","e","isDOMEventHandled","isCompositionChange","native","lastText","createTreeWalker","NodeFilter","SHOW_TEXT","lastChild","whiteSpace","block","preventDefault","toRestore","removeEventListener","addEventListener","placeHolderResizeHandler","rest","loose","unset","fromEntries","map","mark","role","spellCheck","autoCorrect","autoCapitalize","zindex","suppressContentEditableWarning","wordWrap","minHeight","onBeforeInput","isEventHandled","onInput","onBlur","relatedTarget","onClick","detail","blockPath","startVoid","endVoid","onCompositionEnd","placeholderMarks","onCompositionUpdate","onCompositionStart","inline","inlinePath","isEnd","setSelection","onCopy","isDOMEventTargetInput","onCut","onDragOver","onDragStart","voidMatch","onDrop","draggedRange","onDragEnd","onFocus","onKeyDown","isRTL","Hotkeys","maybeHistoryEditor","move","collapse","currentNode","onPaste","leafEl","bind","scrollIntoView","scrollMode","handler","shouldTreatEventAsHandled","isDefaultPrevented","isPropagationStopped","HTMLInputElement","HTMLTextAreaElement","defaultPrevented","FocusedContext","useFocused","isError","error","SlateSelectorContext","refEquality","useSlateSelector","equalityFn","getSlate","latestSubscriptionCallbackError","latestSelector","latestSelectedState","selectedState","stack","checkForUpdates","newSelectedState","unsubscribe","useSelectorContext","eventListeners","slateRef","listener","selectorContext","indexOf","Slate","initialValue","unmountRef","isNodeList","assign","v","setContext","handleSelectorChange","onContextChange","prevContext","setIsFocused","fn","useEditor","useSlateSelection","isSelectionEqual","doRectsIntersect","compareRect","middle","bottom","areRangesSameLine","range1","range2","rect1","rect2","findCurrentLineRange","parentRange","parentRangeBoundary","positions","right","floor","withReact","clipboardFormatKey","apply","addMark","removeMark","parentBlockEntry","parentBlockPath","parentElementRange","currentLineRange","Boolean","pendingAction","getMatches","prevPath","previous","commonPath","common","attach","trim","r","cloneRange","setEndAfter","zw","isNewline","appendChild","getFragment","JSON","encoded","btoa","encodeURIComponent","setAttribute","setData","div","body","innerHTML","decoded","decodeURIComponent","atob","parsed","parse","insertFragment","lines","splitNodes","always","maybeBatchUpdates","ReactDOM","unstable_batchedUpdates","levels"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"index.js","sources":["../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/defineProperty.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayWithHoles.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/nonIterableRest.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/slicedToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/objectWithoutProperties.js","../src/hooks/use-slate-static.tsx","../src/utils/environment.ts","../src/utils/weak-maps.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/iterableToArray.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/nonIterableSpread.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/toConsumableArray.js","../src/utils/dom.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/classCallCheck.js","../src/utils/key.ts","../src/plugin/react-editor.ts","../src/utils/diff-text.ts","../src/hooks/android-input-manager/android-input-manager.ts","../src/hooks/use-is-mounted.tsx","../src/hooks/use-isomorphic-layout-effect.ts","../src/hooks/use-mutation-observer.ts","../src/hooks/android-input-manager/use-android-input-manager.ts","../src/utils/range-list.ts","../src/components/string.tsx","../src/components/leaf.tsx","../src/components/text.tsx","../src/components/element.tsx","../src/hooks/use-decorate.ts","../src/hooks/use-selected.ts","../src/hooks/use-children.tsx","../src/hooks/use-read-only.ts","../src/hooks/use-slate.tsx","../src/hooks/use-track-user-input.ts","../src/utils/constants.ts","../src/utils/hotkeys.ts","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/createClass.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/setPrototypeOf.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/inherits.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/typeof.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/assertThisInitialized.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../../../.yarn/cache/@babel-runtime-npm-7.15.3-6333c71362-2f0b8d2d4e.zip/node_modules/@babel/runtime/helpers/getPrototypeOf.js","../src/components/restore-dom/restore-dom-manager.ts","../src/components/restore-dom/restore-dom.tsx","../src/components/editable.tsx","../src/hooks/use-focused.ts","../src/hooks/use-slate-selector.tsx","../src/components/slate.tsx","../src/hooks/use-editor.tsx","../src/hooks/use-slate-selection.tsx","../src/utils/lines.ts","../src/plugin/with-react.ts"],"sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose.js\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object.\n */\n\nexport const EditorContext = createContext<ReactEditor | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlateStatic = (): Editor => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useSlateStatic\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import React from 'react'\n\nexport const REACT_MAJOR_VERSION = parseInt(React.version.split('.')[0], 10)\n\nexport const IS_IOS =\n  typeof navigator !== 'undefined' &&\n  typeof window !== 'undefined' &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  !window.MSStream\n\nexport const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\n\nexport const IS_ANDROID =\n  typeof navigator !== 'undefined' && /Android/.test(navigator.userAgent)\n\nexport const IS_FIREFOX =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\n\nexport const IS_WEBKIT =\n  typeof navigator !== 'undefined' &&\n  /AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent)\n\n// \"modern\" Edge was released at 79.x\nexport const IS_EDGE_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_CHROME =\n  typeof navigator !== 'undefined' && /Chrome/i.test(navigator.userAgent)\n\n// Native `beforeInput` events don't work well with react on Chrome 75\n// and older, Chrome 76+ can use `beforeInput` though.\nexport const IS_CHROME_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_ANDROID_CHROME_LEGACY =\n  IS_ANDROID &&\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-5]?\\d)(?:\\.)/i.test(navigator.userAgent)\n\n// Firefox did not support `beforeInput` until `v87`.\nexport const IS_FIREFOX_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox\\/(?:[0-7][0-9]|[0-8][0-6])(?:\\.)).*/i.test(\n    navigator.userAgent\n  )\n\n// UC mobile browser\nexport const IS_UC_MOBILE =\n  typeof navigator !== 'undefined' && /.*UCBrowser/.test(navigator.userAgent)\n\n// Wechat browser\nexport const IS_WECHATBROWSER =\n  typeof navigator !== 'undefined' && /.*Wechat/.test(navigator.userAgent)\n\n// Check if DOM is available as React does internally.\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const CAN_USE_DOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n)\n\n// COMPAT: Firefox/Edge Legacy don't support the `beforeinput` event\n// Chrome Legacy doesn't support `beforeinput` correctly\nexport const HAS_BEFORE_INPUT_SUPPORT =\n  (!IS_CHROME_LEGACY || !IS_ANDROID_CHROME_LEGACY) &&\n  !IS_EDGE_LEGACY &&\n  // globalThis is undefined in older browsers\n  typeof globalThis !== 'undefined' &&\n  globalThis.InputEvent &&\n  // @ts-ignore The `getTargetRanges` property isn't recognized.\n  typeof globalThis.InputEvent.prototype.getTargetRanges === 'function'\n","import { Ancestor, Editor, Node, Range, RangeRef, Text } from 'slate'\nimport { Action } from '../hooks/android-input-manager/android-input-manager'\nimport { TextDiff } from './diff-text'\nimport { Key } from './key'\n\n/**\n * Two weak maps that allow us rebuild a path given a node. They are populated\n * at render time such that after a render occurs we can always backtrack.\n */\n\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\n\n/**\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\n * are used to resolve DOM event-related logic into Slate actions.\n */\nexport const EDITOR_TO_WINDOW: WeakMap<Editor, Window> = new WeakMap()\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER: WeakMap<Editor, string> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER_ELEMENT: WeakMap<\n  Editor,\n  HTMLElement\n> = new WeakMap()\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\nexport const EDITOR_TO_KEY_TO_ELEMENT: WeakMap<\n  Editor,\n  WeakMap<Key, HTMLElement>\n> = new WeakMap()\n\n/**\n * Weak maps for storing editor-related state.\n */\n\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_COMPOSING: WeakMap<Editor, boolean> = new WeakMap()\n\nexport const EDITOR_TO_USER_SELECTION: WeakMap<\n  Editor,\n  RangeRef | null\n> = new WeakMap()\n\n/**\n * Weak map for associating the context `onChange` context with the plugin.\n */\n\nexport const EDITOR_TO_ON_CHANGE = new WeakMap<Editor, () => void>()\n\n/**\n * Weak maps for saving pending state on composition stage.\n */\n\nexport const EDITOR_TO_SCHEDULE_FLUSH: WeakMap<\n  Editor,\n  () => void\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_INSERTION_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\nexport const EDITOR_TO_USER_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\n/**\n * Android input handling specific weak-maps\n */\n\nexport const EDITOR_TO_PENDING_DIFFS: WeakMap<\n  Editor,\n  TextDiff[]\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_ACTION: WeakMap<\n  Editor,\n  Action | null\n> = new WeakMap()\n\nexport const EDITOR_TO_PENDING_SELECTION: WeakMap<\n  Editor,\n  Range | null\n> = new WeakMap()\n\nexport const EDITOR_TO_FORCE_RENDER: WeakMap<Editor, () => void> = new WeakMap()\n\n/**\n * Symbols.\n */\n\nexport const PLACEHOLDER_SYMBOL = (Symbol('placeholder') as unknown) as string\nexport const MARK_PLACEHOLDER_SYMBOL = (Symbol(\n  'mark-placeholder'\n) as unknown) as string\n","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\n\nvar iterableToArray = require(\"./iterableToArray.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * Types.\n */\n\n// COMPAT: This is required to prevent TypeScript aliases from doing some very\n// weird things for Slate's types with the same name as globals. (2019/11/27)\n// https://github.com/microsoft/TypeScript/issues/35002\nimport DOMNode = globalThis.Node\nimport DOMComment = globalThis.Comment\nimport DOMElement = globalThis.Element\nimport DOMText = globalThis.Text\nimport DOMRange = globalThis.Range\nimport DOMSelection = globalThis.Selection\nimport DOMStaticRange = globalThis.StaticRange\nimport { ReactEditor } from '../plugin/react-editor'\n\nexport {\n  DOMNode,\n  DOMComment,\n  DOMElement,\n  DOMText,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n}\n\ndeclare global {\n  interface Window {\n    Selection: typeof Selection['constructor']\n    DataTransfer: typeof DataTransfer['constructor']\n    Node: typeof Node['constructor']\n  }\n}\n\nexport type DOMPoint = [Node, number]\n\n/**\n * Returns the host window of a DOM node\n */\n\nexport const getDefaultView = (value: any): Window | null => {\n  return (\n    (value && value.ownerDocument && value.ownerDocument.defaultView) || null\n  )\n}\n\n/**\n * Check if a DOM node is a comment node.\n */\n\nexport const isDOMComment = (value: any): value is DOMComment => {\n  return isDOMNode(value) && value.nodeType === 8\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMElement = (value: any): value is DOMElement => {\n  return isDOMNode(value) && value.nodeType === 1\n}\n\n/**\n * Check if a value is a DOM node.\n */\n\nexport const isDOMNode = (value: any): value is DOMNode => {\n  const window = getDefaultView(value)\n  return !!window && value instanceof window.Node\n}\n\n/**\n * Check if a value is a DOM selection.\n */\n\nexport const isDOMSelection = (value: any): value is DOMSelection => {\n  const window = value && value.anchorNode && getDefaultView(value.anchorNode)\n  return !!window && value instanceof window.Selection\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMText = (value: any): value is DOMText => {\n  return isDOMNode(value) && value.nodeType === 3\n}\n\n/**\n * Checks whether a paste event is a plaintext-only event.\n */\n\nexport const isPlainTextOnlyPaste = (event: ClipboardEvent) => {\n  return (\n    event.clipboardData &&\n    event.clipboardData.getData('text/plain') !== '' &&\n    event.clipboardData.types.length === 1\n  )\n}\n\n/**\n * Normalize a DOM point so that it always refers to a text node.\n */\n\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\n  let [node, offset] = domPoint\n\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (isDOMElement(node) && node.childNodes.length) {\n    let isLast = offset === node.childNodes.length\n    let index = isLast ? offset - 1 : offset\n    ;[node, index] = getEditableChildAndIndex(\n      node,\n      index,\n      isLast ? 'backward' : 'forward'\n    )\n    // If the editable child found is in front of input offset, we instead seek to its end\n    isLast = index < offset\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (isDOMElement(node) && node.childNodes.length) {\n      const i = isLast ? node.childNodes.length - 1 : 0\n      node = getEditableChild(node, i, isLast ? 'backward' : 'forward')\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\n  }\n\n  // Return the node and offset.\n  return [node, offset]\n}\n\n/**\n * Determines whether the active element is nested within a shadowRoot\n */\n\nexport const hasShadowRoot = (node: Node | null) => {\n  let parent = node && node.parentNode\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true\n    }\n    parent = parent.parentNode\n  }\n  return false\n}\n\n/**\n * Get the nearest editable child and index at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChildAndIndex = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): [DOMNode, number] => {\n  const { childNodes } = parent\n  let child = childNodes[index]\n  let i = index\n  let triedForward = false\n  let triedBackward = false\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (\n    isDOMComment(child) ||\n    (isDOMElement(child) && child.childNodes.length === 0) ||\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\n  ) {\n    if (triedForward && triedBackward) {\n      break\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true\n      i = index - 1\n      direction = 'backward'\n      continue\n    }\n\n    if (i < 0) {\n      triedBackward = true\n      i = index + 1\n      direction = 'forward'\n      continue\n    }\n\n    child = childNodes[i]\n    index = i\n    i += direction === 'forward' ? 1 : -1\n  }\n\n  return [child, index]\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChild = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): DOMNode => {\n  const [child] = getEditableChildAndIndex(parent, index, direction)\n  return child\n}\n\n/**\n * Get a plaintext representation of the content of a node, accounting for block\n * elements which get a newline appended.\n *\n * The domNode must be attached to the DOM.\n */\n\nexport const getPlainText = (domNode: DOMNode) => {\n  let text = ''\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue\n  }\n\n  if (isDOMElement(domNode)) {\n    for (const childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode)\n    }\n\n    const display = getComputedStyle(domNode).getPropertyValue('display')\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n'\n    }\n  }\n\n  return text\n}\n\n/**\n * Get x-slate-fragment attribute from data-slate-fragment\n */\nconst catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m\nexport const getSlateFragmentAttribute = (\n  dataTransfer: DataTransfer\n): string | void => {\n  const htmlData = dataTransfer.getData('text/html')\n  const [, fragment] = htmlData.match(catchSlateFragment) || []\n  return fragment\n}\n\n/**\n * Get the x-slate-fragment attribute that exist in text/html data\n * and append it to the DataTransfer object\n */\nexport const getClipboardData = (\n  dataTransfer: DataTransfer,\n  clipboardFormatKey = 'x-slate-fragment'\n): DataTransfer => {\n  if (!dataTransfer.getData(`application/${clipboardFormatKey}`)) {\n    const fragment = getSlateFragmentAttribute(dataTransfer)\n    if (fragment) {\n      const clipboardData = new DataTransfer()\n      dataTransfer.types.forEach(type => {\n        clipboardData.setData(type, dataTransfer.getData(type))\n      })\n      clipboardData.setData(`application/${clipboardFormatKey}`, fragment)\n      return clipboardData\n    }\n  }\n  return dataTransfer\n}\n\n/**\n * Check whether a mutation originates from a editable element inside the editor.\n */\n\nexport const isTrackedMutation = (\n  editor: ReactEditor,\n  mutation: MutationRecord,\n  batch: MutationRecord[]\n): boolean => {\n  const { target } = mutation\n  if (isDOMElement(target) && target.matches('[contentEditable=\"false\"]')) {\n    return false\n  }\n\n  const { document } = ReactEditor.getWindow(editor)\n  if (document.contains(target)) {\n    return ReactEditor.hasDOMNode(editor, target, { editable: true })\n  }\n\n  const parentMutation = batch.find(({ addedNodes, removedNodes }) => {\n    for (const node of addedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n\n    for (const node of removedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n  })\n\n  if (!parentMutation || parentMutation === mutation) {\n    return false\n  }\n\n  // Target add/remove is tracked. Track the mutation if we track the parent mutation.\n  return isTrackedMutation(editor, parentMutation, batch)\n}\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","/**\n * An auto-incrementing identifier for keys.\n */\n\nlet n = 0\n\n/**\n * A class that keeps track of a key string. We use a full class here because we\n * want to be able to use them as keys in `WeakMap` objects.\n */\n\nexport class Key {\n  id: string\n\n  constructor() {\n    this.id = `${n++}`\n  }\n}\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Path,\n  Point,\n  Range,\n  Scrubber,\n  Transforms,\n} from 'slate'\nimport { TextDiff } from '../utils/diff-text'\nimport {\n  DOMElement,\n  DOMNode,\n  DOMPoint,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n  DOMText,\n  hasShadowRoot,\n  isDOMElement,\n  isDOMNode,\n  isDOMSelection,\n  normalizeDOMPoint,\n} from '../utils/dom'\nimport { IS_ANDROID, IS_CHROME, IS_FIREFOX } from '../utils/environment'\n\nimport { Key } from '../utils/key'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  NODE_TO_INDEX,\n  NODE_TO_KEY,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\n\n/**\n * A React and DOM-specific version of the `Editor` interface.\n */\n\nexport interface ReactEditor extends BaseEditor {\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  insertData: (data: DataTransfer) => void\n  insertFragmentData: (data: DataTransfer) => boolean\n  insertTextData: (data: DataTransfer) => boolean\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n  setFragmentData: (\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n}\n\nexport interface ReactEditorInterface {\n  /**\n   * Experimental and android specific: Get pending diffs\n   */\n  androidPendingDiffs: (editor: Editor) => TextDiff[] | undefined\n\n  /**\n   * Experimental and android specific: Flush all pending diffs and cancel composition at the next possible time.\n   */\n  androidScheduleFlush: (editor: Editor) => void\n\n  /**\n   * Blur the editor.\n   */\n  blur: (editor: ReactEditor) => void\n\n  /**\n   * Deselect the editor.\n   */\n  deselect: (editor: ReactEditor) => void\n\n  /**\n   * Find the DOM node that implements DocumentOrShadowRoot for the editor.\n   */\n  findDocumentOrShadowRoot: (editor: ReactEditor) => Document | ShadowRoot\n\n  /**\n   * Get the target range from a DOM `event`.\n   */\n  findEventRange: (editor: ReactEditor, event: any) => Range\n\n  /**\n   * Find a key for a Slate node.\n   */\n  findKey: (editor: ReactEditor, node: Node) => Key\n\n  /**\n   * Find the path of Slate node.\n   */\n  findPath: (editor: ReactEditor, node: Node) => Path\n\n  /**\n   * Focus the editor.\n   */\n  focus: (editor: ReactEditor) => void\n\n  /**\n   * Return the host window of the current editor.\n   */\n  getWindow: (editor: ReactEditor) => Window\n\n  /**\n   * Check if a DOM node is within the editor.\n   */\n  hasDOMNode: (\n    editor: ReactEditor,\n    target: DOMNode,\n    options?: { editable?: boolean }\n  ) => boolean\n\n  /**\n   * Check if the target is editable and in the editor.\n   */\n  hasEditableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   *\n   */\n  hasRange: (editor: ReactEditor, range: Range) => boolean\n\n  /**\n   * Check if the target can be selectable\n   */\n  hasSelectableTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Check if the target is in the editor.\n   */\n  hasTarget: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   * Insert data from a `DataTransfer` into the editor.\n   */\n  insertData: (editor: ReactEditor, data: DataTransfer) => void\n\n  /**\n   * Insert fragment data from a `DataTransfer` into the editor.\n   */\n  insertFragmentData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Insert text data from a `DataTransfer` into the editor.\n   */\n  insertTextData: (editor: ReactEditor, data: DataTransfer) => boolean\n\n  /**\n   * Check if the user is currently composing inside the editor.\n   */\n  isComposing: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is focused.\n   */\n  isFocused: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the editor is in read-only mode.\n   */\n  isReadOnly: (editor: ReactEditor) => boolean\n\n  /**\n   * Check if the target is inside void and in an non-readonly editor.\n   */\n  isTargetInsideNonReadonlyVoid: (\n    editor: ReactEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Sets data from the currently selected fragment on a `DataTransfer`.\n   */\n  setFragmentData: (\n    editor: ReactEditor,\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n\n  /**\n   * Find the native DOM element from a Slate node.\n   */\n  toDOMNode: (editor: ReactEditor, node: Node) => HTMLElement\n\n  /**\n   * Find a native DOM selection point from a Slate point.\n   */\n  toDOMPoint: (editor: ReactEditor, point: Point) => DOMPoint\n\n  /**\n   * Find a native DOM range from a Slate `range`.\n   *\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\n   *\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\n   */\n  toDOMRange: (editor: ReactEditor, range: Range) => DOMRange\n\n  /**\n   * Find a Slate node from a native DOM `element`.\n   */\n  toSlateNode: (editor: ReactEditor, domNode: DOMNode) => Node\n\n  /**\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\n   */\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Point | null : Point\n\n  /**\n   * Find a Slate range from a DOM range or selection.\n   */\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Range | null : Range\n}\n\n// eslint-disable-next-line no-redeclare\nexport const ReactEditor: ReactEditorInterface = {\n  androidPendingDiffs: editor => EDITOR_TO_PENDING_DIFFS.get(editor),\n\n  androidScheduleFlush: editor => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(editor)?.()\n  },\n\n  blur: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, false)\n\n    if (root.activeElement === el) {\n      el.blur()\n    }\n  },\n\n  deselect: editor => {\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges()\n    }\n\n    if (selection) {\n      Transforms.deselect(editor)\n    }\n  },\n\n  findDocumentOrShadowRoot: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = el.getRootNode()\n\n    if (\n      (root instanceof Document || root instanceof ShadowRoot) &&\n      root.getSelection != null\n    ) {\n      return root\n    }\n\n    return el.ownerDocument\n  },\n\n  findEventRange: (editor, event) => {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent\n    }\n\n    const { clientX: x, clientY: y, target } = event\n\n    if (x == null || y == null) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    const node = ReactEditor.toSlateNode(editor, event.target)\n    const path = ReactEditor.findPath(editor, node)\n\n    // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n    if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n      const rect = target.getBoundingClientRect()\n      const isPrev = editor.isInline(node)\n        ? x - rect.left < rect.left + rect.width - x\n        : y - rect.top < rect.top + rect.height - y\n\n      const edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end',\n      })\n      const point = isPrev\n        ? Editor.before(editor, edge)\n        : Editor.after(editor, edge)\n\n      if (point) {\n        const range = Editor.range(editor, point)\n        return range\n      }\n    }\n\n    // Else resolve a range from the caret position where the drop occured.\n    let domRange\n    const { document } = ReactEditor.getWindow(editor)\n\n    // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y)\n    } else {\n      const position = document.caretPositionFromPoint(x, y)\n\n      if (position) {\n        domRange = document.createRange()\n        domRange.setStart(position.offsetNode, position.offset)\n        domRange.setEnd(position.offsetNode, position.offset)\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    // Resolve a Slate range from the DOM range.\n    const range = ReactEditor.toSlateRange(editor, domRange, {\n      exactMatch: false,\n      suppressThrow: false,\n    })\n    return range\n  },\n\n  findKey: (editor, node) => {\n    let key = NODE_TO_KEY.get(node)\n\n    if (!key) {\n      key = new Key()\n      NODE_TO_KEY.set(node, key)\n    }\n\n    return key\n  },\n\n  findPath: (editor, node) => {\n    const path: Path = []\n    let child = node\n\n    while (true) {\n      const parent = NODE_TO_PARENT.get(child)\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path\n        } else {\n          break\n        }\n      }\n\n      const i = NODE_TO_INDEX.get(child)\n\n      if (i == null) {\n        break\n      }\n\n      path.unshift(i)\n      child = parent\n    }\n\n    throw new Error(\n      `Unable to find the path for Slate node: ${Scrubber.stringify(node)}`\n    )\n  },\n\n  focus: editor => {\n    const el = ReactEditor.toDOMNode(editor, editor)\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, true)\n\n    if (root.activeElement !== el) {\n      el.focus({ preventScroll: true })\n    }\n  },\n\n  getWindow: editor => {\n    const window = EDITOR_TO_WINDOW.get(editor)\n    if (!window) {\n      throw new Error('Unable to find a host window element for this editor')\n    }\n    return window\n  },\n\n  hasDOMNode: (editor, target, options = {}) => {\n    const { editable = false } = options\n    const editorEl = ReactEditor.toDOMNode(editor, editor)\n    let targetEl\n\n    // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n    try {\n      targetEl = (isDOMElement(target)\n        ? target\n        : target.parentElement) as HTMLElement\n    } catch (err) {\n      if (\n        !err.message.includes('Permission denied to access property \"nodeType\"')\n      ) {\n        throw err\n      }\n    }\n\n    if (!targetEl) {\n      return false\n    }\n\n    return (\n      targetEl.closest(`[data-slate-editor]`) === editorEl &&\n      (!editable || targetEl.isContentEditable\n        ? true\n        : (typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined\n            // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable=\"false\"(readOnly)\n            (targetEl.closest('[contenteditable=\"false\"]') === editorEl) || targetEl.closest(\"[plate-firefox-fix]\") !== null) ||\n          !!targetEl.getAttribute('data-slate-zero-width'))\n    )\n  },\n\n  hasEditableTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) &&\n    ReactEditor.hasDOMNode(editor, target, { editable: true }),\n\n  hasRange: (editor, range) => {\n    const { anchor, focus } = range\n    return (\n      Editor.hasPath(editor, anchor.path) && Editor.hasPath(editor, focus.path)\n    )\n  },\n\n  hasSelectableTarget: (editor, target) =>\n    ReactEditor.hasEditableTarget(editor, target) ||\n    ReactEditor.isTargetInsideNonReadonlyVoid(editor, target),\n\n  hasTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) && ReactEditor.hasDOMNode(editor, target),\n\n  insertData: (editor, data) => {\n    editor.insertData(data)\n  },\n\n  insertFragmentData: (editor, data) => editor.insertFragmentData(data),\n\n  insertTextData: (editor, data) => editor.insertTextData(data),\n\n  isComposing: editor => {\n    return !!IS_COMPOSING.get(editor)\n  },\n\n  isFocused: editor => !!IS_FOCUSED.get(editor),\n\n  isReadOnly: editor => !!IS_READ_ONLY.get(editor),\n\n  isTargetInsideNonReadonlyVoid: (editor, target) => {\n    if (IS_READ_ONLY.get(editor)) return false\n\n    const slateNode =\n      ReactEditor.hasTarget(editor, target) &&\n      ReactEditor.toSlateNode(editor, target)\n    return Element.isElement(slateNode) && Editor.isVoid(editor, slateNode)\n  },\n\n  setFragmentData: (editor, data, originEvent) =>\n    editor.setFragmentData(data, originEvent),\n\n  toDOMNode: (editor, node) => {\n    const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n    const domNode = Editor.isEditor(node)\n      ? EDITOR_TO_ELEMENT.get(editor)\n      : KEY_TO_ELEMENT?.get(ReactEditor.findKey(editor, node))\n\n    if (!domNode) {\n      throw new Error(\n        `Cannot resolve a DOM node from Slate node: ${Scrubber.stringify(node)}`\n      )\n    }\n\n    return domNode\n  },\n\n  toDOMPoint: (editor, point) => {\n    const [node] = Editor.node(editor, point.path)\n    const el = ReactEditor.toDOMNode(editor, node)\n    let domPoint: DOMPoint | undefined\n\n    // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n    if (Editor.void(editor, { at: point })) {\n      point = { path: point.path, offset: 0 }\n    }\n\n    // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n    const selector = `[data-slate-string], [data-slate-zero-width]`\n    const texts = Array.from(el.querySelectorAll(selector))\n    let start = 0\n\n    for (let i = 0; i < texts.length; i++) {\n      const text = texts[i]\n      const domNode = text.childNodes[0] as HTMLElement\n\n      if (domNode == null || domNode.textContent == null) {\n        continue\n      }\n\n      const { length } = domNode.textContent\n      const attr = text.getAttribute('data-slate-length')\n      const trueLength = attr == null ? length : parseInt(attr, 10)\n      const end = start + trueLength\n\n      // Prefer putting the selection inside the mark placeholder to ensure\n      // composed text is displayed with the correct marks.\n      const nextText = texts[i + 1]\n      if (\n        point.offset === end &&\n        nextText?.hasAttribute('data-slate-mark-placeholder')\n      ) {\n        const domText = nextText.childNodes[0]\n\n        domPoint = [\n          // COMPAT: If we don't explicity set the dom point to be on the actual\n          // dom text element, chrome will put the selection behind the actual dom\n          // text element, causing domRange.getBoundingClientRect() calls on a collapsed\n          // selection to return incorrect zero values (https://bugs.chromium.org/p/chromium/issues/detail?id=435438)\n          // which will cause issues when scrolling to it.\n          domText instanceof DOMText ? domText : nextText,\n          nextText.textContent?.startsWith('\\uFEFF') ? 1 : 0,\n        ]\n        break\n      }\n\n      if (point.offset <= end) {\n        const offset = Math.min(length, Math.max(0, point.offset - start))\n        domPoint = [domNode, offset]\n        break\n      }\n\n      start = end\n    }\n\n    if (!domPoint) {\n      throw new Error(\n        `Cannot resolve a DOM point from Slate point: ${Scrubber.stringify(\n          point\n        )}`\n      )\n    }\n\n    return domPoint\n  },\n\n  toDOMRange: (editor, range) => {\n    const { anchor, focus } = range\n    const isBackward = Range.isBackward(range)\n    const domAnchor = ReactEditor.toDOMPoint(editor, anchor)\n    const domFocus = Range.isCollapsed(range)\n      ? domAnchor\n      : ReactEditor.toDOMPoint(editor, focus)\n\n    const window = ReactEditor.getWindow(editor)\n    const domRange = window.document.createRange()\n    const [startNode, startOffset] = isBackward ? domFocus : domAnchor\n    const [endNode, endOffset] = isBackward ? domAnchor : domFocus\n\n    // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n    const startEl = (isDOMElement(startNode)\n      ? startNode\n      : startNode.parentElement) as HTMLElement\n    const isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width')\n    const endEl = (isDOMElement(endNode)\n      ? endNode\n      : endNode.parentElement) as HTMLElement\n    const isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width')\n\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset)\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset)\n    return domRange\n  },\n\n  toSlateNode: (editor, domNode) => {\n    let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(`[data-slate-node]`)\n    }\n\n    const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\n\n    if (!node) {\n      throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\n    }\n\n    return node\n  },\n\n  toSlatePoint: <T extends boolean>(\n    editor: ReactEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Point | null : Point => {\n    const { exactMatch, suppressThrow } = options\n    const [nearestNode, nearestOffset] = exactMatch\n      ? domPoint\n      : normalizeDOMPoint(domPoint)\n    const parentNode = nearestNode.parentNode as DOMElement\n    let textNode: DOMElement | null = null\n    let offset = 0\n\n    if (parentNode) {\n      const editorEl = ReactEditor.toDOMNode(editor, editor)\n      const potentialVoidNode = parentNode.closest('[data-slate-void=\"true\"]')\n      // Need to ensure that the closest void node is actually a void node\n      // within this editor, and not a void node within some parent editor. This can happen\n      // if this editor is within a void node of another editor (\"nested editors\", like in\n      // the \"Editable Voids\" example on the docs site).\n      const voidNode =\n        potentialVoidNode && editorEl.contains(potentialVoidNode)\n          ? potentialVoidNode\n          : null\n      let leafNode = parentNode.closest('[data-slate-leaf]')\n      let domNode: DOMElement | null = null\n\n      // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]')\n\n        if (textNode) {\n          const window = ReactEditor.getWindow(editor)\n          const range = window.document.createRange()\n          range.setStart(textNode, 0)\n          range.setEnd(nearestNode, nearestOffset)\n\n          const contents = range.cloneContents()\n          const removals = [\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[data-slate-zero-width]')\n            ),\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[contenteditable=false]')\n            ),\n          ]\n\n          removals.forEach(el => {\n            // COMPAT: While composing at the start of a text node, some keyboards put\n            // the text content inside the zero width space.\n            if (\n              IS_ANDROID &&\n              !exactMatch &&\n              el.hasAttribute('data-slate-zero-width') &&\n              el.textContent.length > 0 &&\n              el.textContext !== '\\uFEFF'\n            ) {\n              if (el.textContent.startsWith('\\uFEFF')) {\n                el.textContent = el.textContent.slice(1)\n              }\n\n              return\n            }\n\n            el!.parentNode!.removeChild(el)\n          })\n\n          // COMPAT: Edge has a bug where Range.prototype.toString() will\n          // convert \\n into \\r\\n. The bug causes a loop when slate-react\n          // attempts to reposition its cursor to match the native position. Use\n          // textContent.length instead.\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n          offset = contents.textContent!.length\n          domNode = textNode\n        }\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent and taking the\n        // first one that isn't inside a nested editor.\n        const leafNodes = voidNode.querySelectorAll('[data-slate-leaf]')\n        for (let index = 0; index < leafNodes.length; index++) {\n          const current = leafNodes[index]\n          if (ReactEditor.hasDOMNode(editor, current)) {\n            leafNode = current\n            break\n          }\n        }\n\n        // COMPAT: In read-only editors the leaf is not rendered.\n        if (!leafNode) {\n          offset = 1\n        } else {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          offset = domNode.textContent!.length\n          domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n            offset -= el.textContent!.length\n          })\n        }\n      }\n\n      if (\n        domNode &&\n        offset === domNode.textContent!.length &&\n        // COMPAT: Android IMEs might remove the zero width space while composing,\n        // and we don't add it for line-breaks.\n        IS_ANDROID &&\n        domNode.getAttribute('data-slate-zero-width') === 'z' &&\n        domNode.textContent?.startsWith('\\uFEFF') &&\n        // COMPAT: If the parent node is a Slate zero-width space, editor is\n        // because the text node should have no characters. However, during IME\n        // composition the ASCII characters will be prepended to the zero-width\n        // space, so subtract 1 from the offset to account for the zero-width\n        // space character.\n        (parentNode.hasAttribute('data-slate-zero-width') ||\n          // COMPAT: In Firefox, `range.cloneContents()` returns an extra trailing '\\n'\n          // when the document ends with a new-line character. This results in the offset\n          // length being off by one, so we need to subtract one to account for this.\n          (IS_FIREFOX && domNode.textContent?.endsWith('\\n\\n')))\n      ) {\n        offset--\n      }\n    }\n\n    if (IS_ANDROID && !textNode && !exactMatch) {\n      const node = parentNode.hasAttribute('data-slate-node')\n        ? parentNode\n        : parentNode.closest('[data-slate-node]')\n\n      if (node && ReactEditor.hasDOMNode(editor, node, { editable: true })) {\n        const slateNode = ReactEditor.toSlateNode(editor, node)\n        let { path, offset } = Editor.start(\n          editor,\n          ReactEditor.findPath(editor, slateNode)\n        )\n\n        if (!node.querySelector('[data-slate-leaf]')) {\n          offset = nearestOffset\n        }\n\n        return { path, offset } as T extends true ? Point | null : Point\n      }\n    }\n\n    if (!textNode) {\n      if (suppressThrow) {\n        return null as T extends true ? Point | null : Point\n      }\n      throw new Error(\n        `Cannot resolve a Slate point from DOM point: ${domPoint}`\n      )\n    }\n\n    // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n    const slateNode = ReactEditor.toSlateNode(editor, textNode!)\n    const path = ReactEditor.findPath(editor, slateNode)\n    return { path, offset } as T extends true ? Point | null : Point\n  },\n\n  toSlateRange: <T extends boolean>(\n    editor: ReactEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Range | null : Range => {\n    const { exactMatch, suppressThrow } = options\n    const el = isDOMSelection(domRange)\n      ? domRange.anchorNode\n      : domRange.startContainer\n    let anchorNode\n    let anchorOffset\n    let focusNode\n    let focusOffset\n    let isCollapsed\n\n    if (el) {\n      if (isDOMSelection(domRange)) {\n        // COMPAT: In firefox the normal seletion way does not work\n        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n        if (IS_FIREFOX && domRange.rangeCount > 1) {\n          focusNode = domRange.focusNode // Focus node works fine\n          const firstRange = domRange.getRangeAt(0)\n          const lastRange = domRange.getRangeAt(domRange.rangeCount - 1)\n\n          // Right to left\n          if (firstRange.startContainer === focusNode) {\n            anchorNode = lastRange.endContainer\n            anchorOffset = lastRange.endOffset\n            focusOffset = firstRange.startOffset\n          } else {\n            // Left to right\n            anchorNode = firstRange.startContainer\n            anchorOffset = firstRange.endOffset\n            focusOffset = lastRange.startOffset\n          }\n        } else {\n          anchorNode = domRange.anchorNode\n          anchorOffset = domRange.anchorOffset\n          focusNode = domRange.focusNode\n          focusOffset = domRange.focusOffset\n        }\n\n        // COMPAT: There's a bug in chrome that always returns `true` for\n        // `isCollapsed` for a Selection that comes from a ShadowRoot.\n        // (2020/08/08)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n        // IsCollapsed might not work in firefox, but this will\n        if ((IS_CHROME && hasShadowRoot(anchorNode)) || IS_FIREFOX) {\n          isCollapsed =\n            domRange.anchorNode === domRange.focusNode &&\n            domRange.anchorOffset === domRange.focusOffset\n        } else {\n          isCollapsed = domRange.isCollapsed\n        }\n      } else {\n        anchorNode = domRange.startContainer\n        anchorOffset = domRange.startOffset\n        focusNode = domRange.endContainer\n        focusOffset = domRange.endOffset\n        isCollapsed = domRange.collapsed\n      }\n    }\n\n    if (\n      anchorNode == null ||\n      focusNode == null ||\n      anchorOffset == null ||\n      focusOffset == null\n    ) {\n      throw new Error(\n        `Cannot resolve a Slate range from DOM range: ${domRange}`\n      )\n    }\n\n    // COMPAT: Triple-clicking a word in chrome will sometimes place the focus\n    // inside a `contenteditable=\"false\"` DOM node following the word, which\n    // will cause `toSlatePoint` to throw an error. (2023/03/07)\n    if (\n      'getAttribute' in focusNode &&\n      (focusNode as HTMLElement).getAttribute('contenteditable') === 'false' &&\n      (focusNode as HTMLElement).getAttribute('data-slate-void') !== 'true'\n    ) {\n      focusNode = anchorNode\n      focusOffset = anchorNode.textContent?.length || 0\n    }\n\n    const anchor = ReactEditor.toSlatePoint(\n      editor,\n      [anchorNode, anchorOffset],\n      {\n        exactMatch,\n        suppressThrow,\n      }\n    )\n    if (!anchor) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    const focus = isCollapsed\n      ? anchor\n      : ReactEditor.toSlatePoint(editor, [focusNode, focusOffset], {\n          exactMatch,\n          suppressThrow,\n        })\n    if (!focus) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    let range: Range = { anchor: anchor as Point, focus: focus as Point }\n    // if the selection is a hanging range that ends in a void\n    // and the DOM focus is an Element\n    // (meaning that the selection ends before the element)\n    // unhang the range to avoid mistakenly including the void\n    if (\n      Range.isExpanded(range) &&\n      Range.isForward(range) &&\n      isDOMElement(focusNode) &&\n      Editor.void(editor, { at: range.focus, mode: 'highest' })\n    ) {\n      range = Editor.unhangRange(editor, range, { voids: true })\n    }\n\n    return (range as unknown) as T extends true ? Range | null : Range\n  },\n}\n","import {\n  Editor,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Text,\n  Element,\n} from 'slate'\nimport { EDITOR_TO_PENDING_DIFFS } from './weak-maps'\n\nexport type StringDiff = {\n  start: number\n  end: number\n  text: string\n}\n\nexport type TextDiff = {\n  id: number\n  path: Path\n  diff: StringDiff\n}\n\n/**\n * Check whether a text diff was applied in a way we can perform the pending action on /\n * recover the pending selection.\n */\nexport function verifyDiffState(editor: Editor, textDiff: TextDiff): boolean {\n  const { path, diff } = textDiff\n  if (!Editor.hasPath(editor, path)) {\n    return false\n  }\n\n  const node = Node.get(editor, path)\n  if (!Text.isText(node)) {\n    return false\n  }\n\n  if (diff.start !== node.text.length || diff.text.length === 0) {\n    return (\n      node.text.slice(diff.start, diff.start + diff.text.length) === diff.text\n    )\n  }\n\n  const nextPath = Path.next(path)\n  if (!Editor.hasPath(editor, nextPath)) {\n    return false\n  }\n\n  const nextNode = Node.get(editor, nextPath)\n  return Text.isText(nextNode) && nextNode.text.startsWith(diff.text)\n}\n\nexport function applyStringDiff(text: string, ...diffs: StringDiff[]) {\n  return diffs.reduce(\n    (text, diff) =>\n      text.slice(0, diff.start) + diff.text + text.slice(diff.end),\n    text\n  )\n}\n\nfunction longestCommonPrefixLength(str: string, another: string) {\n  const length = Math.min(str.length, another.length)\n\n  for (let i = 0; i < length; i++) {\n    if (str.charAt(i) !== another.charAt(i)) {\n      return i\n    }\n  }\n\n  return length\n}\n\nfunction longestCommonSuffixLength(\n  str: string,\n  another: string,\n  max: number\n): number {\n  const length = Math.min(str.length, another.length, max)\n\n  for (let i = 0; i < length; i++) {\n    if (\n      str.charAt(str.length - i - 1) !== another.charAt(another.length - i - 1)\n    ) {\n      return i\n    }\n  }\n\n  return length\n}\n\n/**\n * Remove redundant changes from the diff so that it spans the minimal possible range\n */\nexport function normalizeStringDiff(targetText: string, diff: StringDiff) {\n  const { start, end, text } = diff\n  const removedText = targetText.slice(start, end)\n\n  const prefixLength = longestCommonPrefixLength(removedText, text)\n  const max = Math.min(\n    removedText.length - prefixLength,\n    text.length - prefixLength\n  )\n  const suffixLength = longestCommonSuffixLength(removedText, text, max)\n\n  const normalized: StringDiff = {\n    start: start + prefixLength,\n    end: end - suffixLength,\n    text: text.slice(prefixLength, text.length - suffixLength),\n  }\n\n  if (normalized.start === normalized.end && normalized.text.length === 0) {\n    return null\n  }\n\n  return normalized\n}\n\n/**\n * Return a string diff that is equivalent to applying b after a spanning the range of\n * both changes\n */\nexport function mergeStringDiffs(\n  targetText: string,\n  a: StringDiff,\n  b: StringDiff\n): StringDiff | null {\n  const start = Math.min(a.start, b.start)\n  const overlap = Math.max(\n    0,\n    Math.min(a.start + a.text.length, b.end) - b.start\n  )\n\n  const applied = applyStringDiff(targetText, a, b)\n  const sliceEnd = Math.max(\n    b.start + b.text.length,\n    a.start +\n      a.text.length +\n      (a.start + a.text.length > b.start ? b.text.length : 0) -\n      overlap\n  )\n\n  const text = applied.slice(start, sliceEnd)\n  const end = Math.max(a.end, b.end - a.text.length + (a.end - a.start))\n  return normalizeStringDiff(targetText, { start, end, text })\n}\n\n/**\n * Get the slate range the text diff spans.\n */\nexport function targetRange(textDiff: TextDiff): Range {\n  const { path, diff } = textDiff\n  return {\n    anchor: { path, offset: diff.start },\n    focus: { path, offset: diff.end },\n  }\n}\n\n/**\n * Normalize a 'pending point' a.k.a a point based on the dom state before applying\n * the pending diffs. Since the pending diffs might have been inserted with different\n * marks we have to 'walk' the offset from the starting position to ensure we still\n * have a valid point inside the document\n */\nexport function normalizePoint(editor: Editor, point: Point): Point | null {\n  let { path, offset } = point\n  if (!Editor.hasPath(editor, path)) {\n    return null\n  }\n\n  let leaf = Node.get(editor, path)\n  if (!Text.isText(leaf)) {\n    return null\n  }\n\n  const parentBlock = Editor.above(editor, {\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n    at: path,\n  })\n\n  if (!parentBlock) {\n    return null\n  }\n\n  while (offset > leaf.text.length) {\n    const entry = Editor.next(editor, { at: path, match: Text.isText })\n    if (!entry || !Path.isDescendant(entry[1], parentBlock[1])) {\n      return null\n    }\n\n    offset -= leaf.text.length\n    leaf = entry[0]\n    path = entry[1]\n  }\n\n  return { path, offset }\n}\n\n/**\n * Normalize a 'pending selection' to ensure it's valid in the current document state.\n */\nexport function normalizeRange(editor: Editor, range: Range): Range | null {\n  const anchor = normalizePoint(editor, range.anchor)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = normalizePoint(editor, range.focus)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformPendingPoint(\n  editor: Editor,\n  point: Point,\n  op: Operation\n): Point | null {\n  const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n  const textDiff = pendingDiffs?.find(({ path }) =>\n    Path.equals(path, point.path)\n  )\n\n  if (!textDiff || point.offset <= textDiff.diff.start) {\n    return Point.transform(point, op, { affinity: 'backward' })\n  }\n\n  const { diff } = textDiff\n  // Point references location inside the diff => transform the point based on the location\n  // the diff will be applied to and add the offset inside the diff.\n  if (point.offset <= diff.start + diff.text.length) {\n    const anchor = { path: point.path, offset: diff.start }\n    const transformed = Point.transform(anchor, op, {\n      affinity: 'backward',\n    })\n\n    if (!transformed) {\n      return null\n    }\n\n    return {\n      path: transformed.path,\n      offset: transformed.offset + point.offset - diff.start,\n    }\n  }\n\n  // Point references location after the diff\n  const anchor = {\n    path: point.path,\n    offset: point.offset - diff.text.length + diff.end - diff.start,\n  }\n  const transformed = Point.transform(anchor, op, {\n    affinity: 'backward',\n  })\n  if (!transformed) {\n    return null\n  }\n\n  if (\n    op.type === 'split_node' &&\n    Path.equals(op.path, point.path) &&\n    anchor.offset < op.position &&\n    diff.start < op.position\n  ) {\n    return transformed\n  }\n\n  return {\n    path: transformed.path,\n    offset: transformed.offset + diff.text.length - diff.end + diff.start,\n  }\n}\n\nexport function transformPendingRange(\n  editor: Editor,\n  range: Range,\n  op: Operation\n): Range | null {\n  const anchor = transformPendingPoint(editor, range.anchor, op)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = transformPendingPoint(editor, range.focus, op)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformTextDiff(\n  textDiff: TextDiff,\n  op: Operation\n): TextDiff | null {\n  const { path, diff, id } = textDiff\n\n  switch (op.type) {\n    case 'insert_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset <= diff.start) {\n        return {\n          diff: {\n            start: op.text.length + diff.start,\n            end: op.text.length + diff.end,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end + op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'remove_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset + op.text.length <= diff.start) {\n        return {\n          diff: {\n            start: diff.start - op.text.length,\n            end: diff.end - op.text.length,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end - op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'split_node': {\n      if (!Path.equals(op.path, path) || op.position >= diff.end) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op, { affinity: 'backward' })!,\n        }\n      }\n\n      if (op.position > diff.start) {\n        return {\n          diff: {\n            start: diff.start,\n            end: Math.min(op.position, diff.end),\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start - op.position,\n          end: diff.end - op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op, { affinity: 'forward' })!,\n      }\n    }\n    case 'merge_node': {\n      if (!Path.equals(op.path, path)) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op)!,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start + op.position,\n          end: diff.end + op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op)!,\n      }\n    }\n  }\n\n  const newPath = Path.transform(path, op)\n  if (!newPath) {\n    return null\n  }\n\n  return {\n    diff,\n    path: newPath,\n    id,\n  }\n}\n","import { DebouncedFunc } from 'lodash'\nimport { Editor, Node, Path, Point, Range, Text, Transforms } from 'slate'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport {\n  applyStringDiff,\n  mergeStringDiffs,\n  normalizePoint,\n  normalizeRange,\n  normalizeStringDiff,\n  StringDiff,\n  targetRange,\n  TextDiff,\n  verifyDiffState,\n} from '../../utils/diff-text'\nimport { isDOMSelection, isTrackedMutation } from '../../utils/dom'\nimport {\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_USER_MARKS,\n  IS_COMPOSING,\n} from '../../utils/weak-maps'\n\nexport type Action = { at?: Point | Range; run: () => void }\n\n// https://github.com/facebook/draft-js/blob/main/src/component/handlers/composition/DraftEditorCompositionHandler.js#L41\n// When using keyboard English association function, conpositionEnd triggered too fast, resulting in after `insertText` still maintain association state.\nconst RESOLVE_DELAY = 25\n\n// Time with no user interaction before the current user action is considered as done.\nconst FLUSH_DELAY = 200\n\n// Replace with `const debug = console.log` to debug\nconst debug = (..._: unknown[]) => {}\n\n// Type guard to check if a value is a DataTransfer\nconst isDataTransfer = (value: any): value is DataTransfer =>\n  value?.constructor.name === 'DataTransfer'\n\nexport type CreateAndroidInputManagerOptions = {\n  editor: ReactEditor\n\n  scheduleOnDOMSelectionChange: DebouncedFunc<() => void>\n  onDOMSelectionChange: DebouncedFunc<() => void>\n}\n\nexport type AndroidInputManager = {\n  flush: () => void\n  scheduleFlush: () => void\n\n  hasPendingDiffs: () => boolean\n  hasPendingAction: () => boolean\n  hasPendingChanges: () => boolean\n  isFlushing: () => boolean | 'action'\n\n  handleUserSelect: (range: Range | null) => void\n  handleCompositionEnd: (event: React.CompositionEvent<HTMLDivElement>) => void\n  handleCompositionStart: (\n    event: React.CompositionEvent<HTMLDivElement>\n  ) => void\n  handleDOMBeforeInput: (event: InputEvent) => void\n  handleKeyDown: (event: React.KeyboardEvent<HTMLDivElement>) => void\n\n  handleDomMutations: (mutations: MutationRecord[]) => void\n  handleInput: () => void\n}\n\nexport function createAndroidInputManager({\n  editor,\n  scheduleOnDOMSelectionChange,\n  onDOMSelectionChange,\n}: CreateAndroidInputManagerOptions): AndroidInputManager {\n  let flushing: 'action' | boolean = false\n  let compositionEndTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let flushTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let actionTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  let idCounter = 0\n  let insertPositionHint: StringDiff | null | false = false\n\n  const applyPendingSelection = () => {\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(editor)\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n\n    if (pendingSelection) {\n      const { selection } = editor\n      const normalized = normalizeRange(editor, pendingSelection)\n\n      debug('apply pending selection', pendingSelection, normalized)\n\n      if (normalized && (!selection || !Range.equals(normalized, selection))) {\n        Transforms.select(editor, normalized)\n      }\n    }\n  }\n\n  const performAction = () => {\n    const action = EDITOR_TO_PENDING_ACTION.get(editor)\n    EDITOR_TO_PENDING_ACTION.delete(editor)\n    if (!action) {\n      return\n    }\n\n    if (action.at) {\n      const target = Point.isPoint(action.at)\n        ? normalizePoint(editor, action.at)\n        : normalizeRange(editor, action.at)\n\n      if (!target) {\n        return\n      }\n\n      const targetRange = Editor.range(editor, target)\n      if (!editor.selection || !Range.equals(editor.selection, targetRange)) {\n        Transforms.select(editor, target)\n      }\n    }\n\n    action.run()\n  }\n\n  const flush = () => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    if (actionTimeoutId) {\n      clearTimeout(actionTimeoutId)\n      actionTimeoutId = null\n    }\n\n    if (!hasPendingDiffs() && !hasPendingAction()) {\n      applyPendingSelection()\n      return\n    }\n\n    if (!flushing) {\n      flushing = true\n      setTimeout(() => (flushing = false))\n    }\n\n    if (hasPendingAction()) {\n      flushing = 'action'\n    }\n\n    const selectionRef =\n      editor.selection &&\n      Editor.rangeRef(editor, editor.selection, { affinity: 'forward' })\n    EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n\n    debug(\n      'flush',\n      EDITOR_TO_PENDING_ACTION.get(editor),\n      EDITOR_TO_PENDING_DIFFS.get(editor)\n    )\n\n    let scheduleSelectionChange = hasPendingDiffs()\n\n    let diff: TextDiff | undefined\n    while ((diff = EDITOR_TO_PENDING_DIFFS.get(editor)?.[0])) {\n      const pendingMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)\n\n      if (pendingMarks !== undefined) {\n        EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n        editor.marks = pendingMarks\n      }\n\n      if (pendingMarks && insertPositionHint === false) {\n        insertPositionHint = null\n        debug('insert after mark placeholder')\n      }\n\n      const range = targetRange(diff)\n      if (!editor.selection || !Range.equals(editor.selection, range)) {\n        Transforms.select(editor, range)\n      }\n\n      if (diff.diff.text) {\n        Editor.insertText(editor, diff.diff.text)\n      } else {\n        Editor.deleteFragment(editor)\n      }\n\n      // Remove diff only after we have applied it to account for it when transforming\n      // pending ranges.\n      EDITOR_TO_PENDING_DIFFS.set(\n        editor,\n        EDITOR_TO_PENDING_DIFFS.get(editor)?.filter(\n          ({ id }) => id !== diff!.id\n        )!\n      )\n\n      if (!verifyDiffState(editor, diff)) {\n        debug('invalid diff state')\n        scheduleSelectionChange = false\n        EDITOR_TO_PENDING_ACTION.delete(editor)\n        EDITOR_TO_USER_MARKS.delete(editor)\n        flushing = 'action'\n\n        // Ensure we don't restore the pending user (dom) selection\n        // since the document and dom state do not match.\n        EDITOR_TO_PENDING_SELECTION.delete(editor)\n        scheduleOnDOMSelectionChange.cancel()\n        onDOMSelectionChange.cancel()\n        selectionRef?.unref()\n      }\n    }\n\n    const selection = selectionRef?.unref()\n    if (\n      selection &&\n      !EDITOR_TO_PENDING_SELECTION.get(editor) &&\n      (!editor.selection || !Range.equals(selection, editor.selection))\n    ) {\n      Transforms.select(editor, selection)\n    }\n\n    if (hasPendingAction()) {\n      performAction()\n      return\n    }\n\n    // COMPAT: The selectionChange event is fired after the action is performed,\n    // so we have to manually schedule it to ensure we don't 'throw away' the selection\n    // while rendering if we have pending changes.\n    if (scheduleSelectionChange) {\n      debug('scheduleOnDOMSelectionChange pending changes')\n      scheduleOnDOMSelectionChange()\n    }\n\n    scheduleOnDOMSelectionChange.flush()\n    onDOMSelectionChange.flush()\n\n    applyPendingSelection()\n\n    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n    EDITOR_TO_USER_MARKS.delete(editor)\n    if (userMarks !== undefined) {\n      editor.marks = userMarks\n      editor.onChange()\n    }\n  }\n\n  const handleCompositionEnd = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n    }\n\n    compositionEndTimeoutId = setTimeout(() => {\n      IS_COMPOSING.set(editor, false)\n      flush()\n    }, RESOLVE_DELAY)\n  }\n\n  const handleCompositionStart = (\n    _event: React.CompositionEvent<HTMLDivElement>\n  ) => {\n    debug('composition start')\n\n    IS_COMPOSING.set(editor, true)\n\n    if (compositionEndTimeoutId) {\n      clearTimeout(compositionEndTimeoutId)\n      compositionEndTimeoutId = null\n    }\n  }\n\n  const updatePlaceholderVisibility = (forceHide = false) => {\n    const placeholderElement = EDITOR_TO_PLACEHOLDER_ELEMENT.get(editor)\n    if (!placeholderElement) {\n      return\n    }\n\n    if (hasPendingDiffs() || forceHide) {\n      placeholderElement.style.display = 'none'\n      return\n    }\n\n    placeholderElement.style.removeProperty('display')\n  }\n\n  const storeDiff = (path: Path, diff: StringDiff) => {\n    debug('storeDiff', path, diff)\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor) ?? []\n    EDITOR_TO_PENDING_DIFFS.set(editor, pendingDiffs)\n\n    const target = Node.leaf(editor, path)\n    const idx = pendingDiffs.findIndex(change => Path.equals(change.path, path))\n    if (idx < 0) {\n      const normalized = normalizeStringDiff(target.text, diff)\n      if (normalized) {\n        pendingDiffs.push({ path, diff, id: idCounter++ })\n      }\n\n      updatePlaceholderVisibility()\n      return\n    }\n\n    const merged = mergeStringDiffs(target.text, pendingDiffs[idx].diff, diff)\n    if (!merged) {\n      pendingDiffs.splice(idx, 1)\n      updatePlaceholderVisibility()\n      return\n    }\n\n    pendingDiffs[idx] = {\n      ...pendingDiffs[idx],\n      diff: merged,\n    }\n  }\n\n  const scheduleAction = (\n    run: () => void,\n    { at }: { at?: Point | Range } = {}\n  ): void => {\n    insertPositionHint = false\n    debug('scheduleAction', { at, run })\n\n    EDITOR_TO_PENDING_SELECTION.delete(editor)\n    scheduleOnDOMSelectionChange.cancel()\n    onDOMSelectionChange.cancel()\n\n    if (hasPendingAction()) {\n      flush()\n    }\n\n    EDITOR_TO_PENDING_ACTION.set(editor, { at, run })\n\n    // COMPAT: When deleting before a non-contenteditable element chrome only fires a beforeinput,\n    // (no input) and doesn't perform any dom mutations. Without a flush timeout we would never flush\n    // in this case and thus never actually perform the action.\n    actionTimeoutId = setTimeout(flush)\n  }\n\n  const handleDOMBeforeInput = (event: InputEvent): void => {\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { inputType: type } = event\n    let targetRange: Range | null = null\n    const data: DataTransfer | string | undefined =\n      (event as any).dataTransfer || event.data || undefined\n\n    if (\n      insertPositionHint !== false &&\n      type !== 'insertText' &&\n      type !== 'insertCompositionText'\n    ) {\n      insertPositionHint = false\n    }\n\n    let [nativeTargetRange] = (event as any).getTargetRanges()\n    if (nativeTargetRange) {\n      targetRange = ReactEditor.toSlateRange(editor, nativeTargetRange, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    // COMPAT: SelectionChange event is fired after the action is performed, so we\n    // have to manually get the selection here to ensure it's up-to-date.\n    const window = ReactEditor.getWindow(editor)\n    const domSelection = window.getSelection()\n    if (!targetRange && domSelection) {\n      nativeTargetRange = domSelection\n      targetRange = ReactEditor.toSlateRange(editor, domSelection, {\n        exactMatch: false,\n        suppressThrow: true,\n      })\n    }\n\n    targetRange = targetRange ?? editor.selection\n    if (!targetRange) {\n      return\n    }\n\n    // By default, the input manager tries to store text diffs so that we can\n    // defer flushing them at a later point in time. We don't want to flush\n    // for every input event as this can be expensive. However, there are some\n    // scenarios where we cannot safely store the text diff and must instead\n    // schedule an action to let Slate normalize the editor state.\n    let canStoreDiff = true\n\n    if (type.startsWith('delete')) {\n      if (Range.isExpanded(targetRange)) {\n        const [start, end] = Range.edges(targetRange)\n        const leaf = Node.leaf(editor, start.path)\n\n        if (leaf.text.length === start.offset && end.offset === 0) {\n          const next = Editor.next(editor, {\n            at: start.path,\n            match: Text.isText,\n          })\n          if (next && Path.equals(next[1], end.path)) {\n            targetRange = { anchor: end, focus: end }\n          }\n        }\n      }\n\n      const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n      const [start, end] = Range.edges(targetRange)\n      const [leaf, path] = Editor.leaf(editor, start.path)\n\n      const diff = {\n        text: '',\n        start: start.offset,\n        end: end.offset,\n      }\n      const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n      const relevantPendingDiffs = pendingDiffs?.find(change =>\n        Path.equals(change.path, path)\n      )\n      const diffs = relevantPendingDiffs\n        ? [relevantPendingDiffs.diff, diff]\n        : [diff]\n      const text = applyStringDiff(leaf.text, ...diffs)\n\n      if (text.length === 0) {\n        // Text leaf will be removed, so we need to schedule an\n        // action to remove it so that Slate can normalize instead\n        // of storing as a diff\n        canStoreDiff = false\n      }\n\n      if (Range.isExpanded(targetRange)) {\n        if (\n          canStoreDiff &&\n          Path.equals(targetRange.anchor.path, targetRange.focus.path)\n        ) {\n          const point = { path: targetRange.anchor.path, offset: start.offset }\n          const range = Editor.range(editor, point, point)\n          handleUserSelect(range)\n\n          return storeDiff(targetRange.anchor.path, {\n            text: '',\n            end: end.offset,\n            start: start.offset,\n          })\n        }\n\n        return scheduleAction(\n          () => Editor.deleteFragment(editor, { direction }),\n          { at: targetRange }\n        )\n      }\n    }\n\n    switch (type) {\n      case 'deleteByComposition':\n      case 'deleteByCut':\n      case 'deleteByDrag': {\n        return scheduleAction(() => Editor.deleteFragment(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContent':\n      case 'deleteContentForward': {\n        const { anchor } = targetRange\n        if (canStoreDiff && Range.isCollapsed(targetRange)) {\n          const targetNode = Node.leaf(editor, anchor.path)\n\n          if (anchor.offset < targetNode.text.length) {\n            return storeDiff(anchor.path, {\n              text: '',\n              start: anchor.offset,\n              end: anchor.offset + 1,\n            })\n          }\n        }\n\n        return scheduleAction(() => Editor.deleteForward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteContentBackward': {\n        const { anchor } = targetRange\n\n        // If we have a mismatch between the native and slate selection being collapsed\n        // we are most likely deleting a zero-width placeholder and thus should perform it\n        // as an action to ensure correct behavior (mostly happens with mark placeholders)\n        const nativeCollapsed = isDOMSelection(nativeTargetRange)\n          ? nativeTargetRange.isCollapsed\n          : !!nativeTargetRange?.collapsed\n\n        if (\n          canStoreDiff &&\n          nativeCollapsed &&\n          Range.isCollapsed(targetRange) &&\n          anchor.offset > 0\n        ) {\n          return storeDiff(anchor.path, {\n            text: '',\n            start: anchor.offset - 1,\n            end: anchor.offset,\n          })\n        }\n\n        return scheduleAction(() => Editor.deleteBackward(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'deleteEntireSoftLine': {\n        return scheduleAction(\n          () => {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n          },\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteHardLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'block' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteSoftLineForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'line' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordBackward': {\n        return scheduleAction(\n          () => Editor.deleteBackward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'deleteWordForward': {\n        return scheduleAction(\n          () => Editor.deleteForward(editor, { unit: 'word' }),\n          { at: targetRange }\n        )\n      }\n\n      case 'insertLineBreak': {\n        return scheduleAction(() => Editor.insertSoftBreak(editor), {\n          at: targetRange,\n        })\n      }\n\n      case 'insertParagraph': {\n        return scheduleAction(() => Editor.insertBreak(editor), {\n          at: targetRange,\n        })\n      }\n      case 'insertCompositionText':\n      case 'deleteCompositionText':\n      case 'insertFromComposition':\n      case 'insertFromDrop':\n      case 'insertFromPaste':\n      case 'insertFromYank':\n      case 'insertReplacementText':\n      case 'insertText': {\n        if (isDataTransfer(data)) {\n          return scheduleAction(() => ReactEditor.insertData(editor, data), {\n            at: targetRange,\n          })\n        }\n\n        let text = data ?? ''\n\n        // COMPAT: If we are writing inside a placeholder, the ime inserts the text inside\n        // the placeholder itself and thus includes the zero-width space inside edit events.\n        if (EDITOR_TO_PENDING_INSERTION_MARKS.get(editor)) {\n          text = text.replace('\\uFEFF', '')\n        }\n\n        // Pastes from the Android clipboard will generate `insertText` events.\n        // If the copied text contains any newlines, Android will append an\n        // extra newline to the end of the copied text.\n        if (type === 'insertText' && /.*\\n.*\\n$/.test(text)) {\n          text = text.slice(0, -1)\n        }\n\n        // If the text includes a newline, split it at newlines and paste each component\n        // string, with soft breaks in between each.\n        if (text.includes('\\n')) {\n          return scheduleAction(\n            () => {\n              const parts = text.split('\\n')\n              parts.forEach((line, i) => {\n                if (line) {\n                  Editor.insertText(editor, line)\n                }\n                if (i !== parts.length - 1) {\n                  Editor.insertSoftBreak(editor)\n                }\n              })\n            },\n            {\n              at: targetRange,\n            }\n          )\n        }\n\n        if (Path.equals(targetRange.anchor.path, targetRange.focus.path)) {\n          const [start, end] = Range.edges(targetRange)\n\n          const diff = {\n            start: start.offset,\n            end: end.offset,\n            text,\n          }\n\n          // COMPAT: Swiftkey has a weird bug where the target range of the 2nd word\n          // inserted after a mark placeholder is inserted with an anchor offset off by 1.\n          // So writing 'some text' will result in 'some ttext'. Luckily all 'normal' insert\n          // text events are fired with the correct target ranges, only the final 'insertComposition'\n          // isn't, so we can adjust the target range start offset if we are confident this is the\n          // swiftkey insert causing the issue.\n          if (text && insertPositionHint && type === 'insertCompositionText') {\n            const hintPosition =\n              insertPositionHint.start + insertPositionHint.text.search(/\\S|$/)\n            const diffPosition = diff.start + diff.text.search(/\\S|$/)\n\n            if (\n              diffPosition === hintPosition + 1 &&\n              diff.end ===\n                insertPositionHint.start + insertPositionHint.text.length\n            ) {\n              debug('adjusting swiftKey insert position using hint')\n              diff.start -= 1\n              insertPositionHint = null\n              scheduleFlush()\n            } else {\n              insertPositionHint = false\n            }\n          } else if (type === 'insertText') {\n            if (insertPositionHint === null) {\n              insertPositionHint = diff\n            } else if (\n              insertPositionHint &&\n              Range.isCollapsed(targetRange) &&\n              insertPositionHint.end + insertPositionHint.text.length ===\n                start.offset\n            ) {\n              insertPositionHint = {\n                ...insertPositionHint,\n                text: insertPositionHint.text + text,\n              }\n            } else {\n              insertPositionHint = false\n            }\n          } else {\n            insertPositionHint = false\n          }\n\n          if (canStoreDiff) {\n            storeDiff(start.path, diff)\n            return\n          }\n        }\n\n        return scheduleAction(() => Editor.insertText(editor, text), {\n          at: targetRange,\n        })\n      }\n    }\n  }\n\n  const hasPendingAction = () => {\n    return !!EDITOR_TO_PENDING_ACTION.get(editor)\n  }\n\n  const hasPendingDiffs = () => {\n    return !!EDITOR_TO_PENDING_DIFFS.get(editor)?.length\n  }\n\n  const hasPendingChanges = () => {\n    return hasPendingAction() || hasPendingDiffs()\n  }\n\n  const isFlushing = () => {\n    return flushing\n  }\n\n  const handleUserSelect = (range: Range | null) => {\n    EDITOR_TO_PENDING_SELECTION.set(editor, range)\n\n    if (flushTimeoutId) {\n      clearTimeout(flushTimeoutId)\n      flushTimeoutId = null\n    }\n\n    const { selection } = editor\n    if (!range) {\n      return\n    }\n\n    const pathChanged =\n      !selection || !Path.equals(selection.anchor.path, range.anchor.path)\n    const parentPathChanged =\n      !selection ||\n      !Path.equals(\n        selection.anchor.path.slice(0, -1),\n        range.anchor.path.slice(0, -1)\n      )\n\n    if ((pathChanged && insertPositionHint) || parentPathChanged) {\n      insertPositionHint = false\n    }\n\n    if (pathChanged || hasPendingDiffs()) {\n      flushTimeoutId = setTimeout(flush, FLUSH_DELAY)\n    }\n  }\n\n  const handleInput = () => {\n    if (hasPendingAction() || !hasPendingDiffs()) {\n      debug('flush input')\n      flush()\n    }\n  }\n\n  const handleKeyDown = (_: React.KeyboardEvent) => {\n    // COMPAT: Swiftkey closes the keyboard when typing inside a empty node\n    // directly next to a non-contenteditable element (= the placeholder).\n    // The only event fired soon enough for us to allow hiding the placeholder\n    // without swiftkey picking it up is the keydown event, so we have to hide it\n    // here. See https://github.com/ianstormtaylor/slate/pull/4988#issuecomment-1201050535\n    if (!hasPendingDiffs()) {\n      updatePlaceholderVisibility(true)\n      setTimeout(updatePlaceholderVisibility)\n    }\n  }\n\n  const scheduleFlush = () => {\n    if (!hasPendingAction()) {\n      actionTimeoutId = setTimeout(flush)\n    }\n  }\n\n  const handleDomMutations = (mutations: MutationRecord[]) => {\n    if (hasPendingDiffs() || hasPendingAction()) {\n      return\n    }\n\n    if (\n      mutations.some(mutation => isTrackedMutation(editor, mutation, mutations))\n    ) {\n      // Cause a re-render to restore the dom state if we encounter tracked mutations without\n      // a corresponding pending action.\n      EDITOR_TO_FORCE_RENDER.get(editor)?.()\n    }\n  }\n\n  return {\n    flush,\n    scheduleFlush,\n\n    hasPendingDiffs,\n    hasPendingAction,\n    hasPendingChanges,\n\n    isFlushing,\n\n    handleUserSelect,\n    handleCompositionEnd,\n    handleCompositionStart,\n    handleDOMBeforeInput,\n    handleKeyDown,\n\n    handleDomMutations,\n    handleInput,\n  }\n}\n","import { useEffect, useRef } from 'react'\n\nexport function useIsMounted() {\n  const isMountedRef = useRef(false)\n\n  useEffect(() => {\n    isMountedRef.current = true\n    return () => {\n      isMountedRef.current = false\n    }\n  }, [])\n\n  return isMountedRef.current\n}\n","import { useLayoutEffect, useEffect } from 'react'\nimport { CAN_USE_DOM } from '../utils/environment'\n\n/**\n * Prevent warning on SSR by falling back to useEffect when DOM isn't available\n */\n\nexport const useIsomorphicLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect\n","import { RefObject, useEffect, useState } from 'react'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nexport function useMutationObserver(\n  node: RefObject<HTMLElement>,\n  callback: MutationCallback,\n  options: MutationObserverInit\n) {\n  const [mutationObserver] = useState(() => new MutationObserver(callback))\n\n  useIsomorphicLayoutEffect(() => {\n    // Discard mutations caused during render phase. This works due to react calling\n    // useLayoutEffect synchronously after the render phase before the next tick.\n    mutationObserver.takeRecords()\n  })\n\n  useEffect(() => {\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    mutationObserver.observe(node.current, options)\n    return () => mutationObserver.disconnect()\n  }, [mutationObserver, node, options])\n}\n","import { RefObject, useState } from 'react'\nimport { useSlateStatic } from '../use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport { EDITOR_TO_SCHEDULE_FLUSH } from '../../utils/weak-maps'\nimport {\n  createAndroidInputManager,\n  CreateAndroidInputManagerOptions,\n} from './android-input-manager'\nimport { useIsMounted } from '../use-is-mounted'\nimport { useMutationObserver } from '../use-mutation-observer'\n\ntype UseAndroidInputManagerOptions = {\n  node: RefObject<HTMLElement>\n} & Omit<\n  CreateAndroidInputManagerOptions,\n  'editor' | 'onUserInput' | 'receivedUserInput'\n>\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n}\n\nexport const useAndroidInputManager = !IS_ANDROID\n  ? () => null\n  : ({ node, ...options }: UseAndroidInputManagerOptions) => {\n      if (!IS_ANDROID) {\n        return null\n      }\n\n      const editor = useSlateStatic()\n      const isMounted = useIsMounted()\n\n      const [inputManager] = useState(() =>\n        createAndroidInputManager({\n          editor,\n          ...options,\n        })\n      )\n\n      useMutationObserver(\n        node,\n        inputManager.handleDomMutations,\n        MUTATION_OBSERVER_CONFIG\n      )\n\n      EDITOR_TO_SCHEDULE_FLUSH.set(editor, inputManager.scheduleFlush)\n      if (isMounted) {\n        inputManager.flush()\n      }\n\n      return inputManager\n    }\n","import { Range } from 'slate'\nimport { PLACEHOLDER_SYMBOL } from './weak-maps'\n\nexport const shallowCompare = (obj1: {}, obj2: {}) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every(\n    key => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]\n  )\n\nconst isDecorationFlagsEqual = (range: Range, other: Range) => {\n  const { anchor: rangeAnchor, focus: rangeFocus, ...rangeOwnProps } = range\n  const { anchor: otherAnchor, focus: otherFocus, ...otherOwnProps } = other\n\n  return (\n    range[PLACEHOLDER_SYMBOL] === other[PLACEHOLDER_SYMBOL] &&\n    shallowCompare(rangeOwnProps, otherOwnProps)\n  )\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isElementDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    if (!Range.equals(range, other) || !isDecorationFlagsEqual(range, other)) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isTextDecorationsEqual = (\n  list: Range[],\n  another: Range[]\n): boolean => {\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    // compare only offsets because paths doesn't matter for text\n    if (\n      range.anchor.offset !== other.anchor.offset ||\n      range.focus.offset !== other.focus.offset ||\n      !isDecorationFlagsEqual(range, other)\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n","import React, { forwardRef, memo, useRef, useState } from 'react'\nimport { Editor, Text, Path, Element, Node } from 'slate'\n\nimport { ReactEditor, useSlateStatic } from '..'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { IS_ANDROID } from '../utils/environment'\nimport { MARK_PLACEHOLDER_SYMBOL } from '../utils/weak-maps'\n\n/**\n * Leaf content strings.\n */\n\nconst String = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  text: Text\n}) => {\n  const { isLast, leaf, parent, text } = props\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, text)\n  const parentPath = Path.parent(path)\n  const isMarkPlaceholder = leaf[MARK_PLACEHOLDER_SYMBOL] === true\n\n  // COMPAT: Render text inside void nodes with a zero-width space.\n  // So the node can contain selection but the text is not visible.\n  if (editor.isVoid(parent)) {\n    return <ZeroWidthString length={Node.string(parent).length} />\n  }\n\n  // COMPAT: If this is the last text node in an empty block, render a zero-\n  // width space that will convert into a line break when copying and pasting\n  // to support expected plain text.\n  if (\n    leaf.text === '' &&\n    parent.children[parent.children.length - 1] === text &&\n    !editor.isInline(parent) &&\n    Editor.string(editor, parentPath) === ''\n  ) {\n    return <ZeroWidthString isLineBreak isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: If the text is empty, it's because it's on the edge of an inline\n  // node, so we render a zero-width space so that the selection can be\n  // inserted next to it still.\n  if (leaf.text === '') {\n    return <ZeroWidthString isMarkPlaceholder={isMarkPlaceholder} />\n  }\n\n  // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n  // so we need to add an extra trailing new lines to prevent that.\n  if (isLast && leaf.text.slice(-1) === '\\n') {\n    return <TextString isTrailing text={leaf.text} />\n  }\n\n  return <TextString text={leaf.text} />\n}\n\n/**\n * Leaf strings with text in them.\n */\nconst TextString = (props: { text: string; isTrailing?: boolean }) => {\n  const { text, isTrailing = false } = props\n  const ref = useRef<HTMLSpanElement>(null)\n  const getTextContent = () => {\n    return `${text ?? ''}${isTrailing ? '\\n' : ''}`\n  }\n  const [initialText] = useState(getTextContent)\n\n  // This is the actual text rendering boundary where we interface with the DOM\n  // The text is not rendered as part of the virtual DOM, as since we handle basic character insertions natively,\n  // updating the DOM is not a one way dataflow anymore. What we need here is not reconciliation and diffing\n  // with previous version of the virtual DOM, but rather diffing with the actual DOM element, and replace the DOM <span> content\n  // exactly if and only if its current content does not match our current virtual DOM.\n  // Otherwise the DOM TextNode would always be replaced by React as the user types, which interferes with native text features,\n  // eg makes native spellcheck opt out from checking the text node.\n\n  // useLayoutEffect: updating our span before browser paint\n  useIsomorphicLayoutEffect(() => {\n    // null coalescing text to make sure we're not outputing \"null\" as a string in the extreme case it is nullish at runtime\n    const textWithTrailing = getTextContent()\n\n    if (ref.current && ref.current.textContent !== textWithTrailing) {\n      ref.current.textContent = textWithTrailing\n    }\n\n    // intentionally not specifying dependencies, so that this effect runs on every render\n    // as this effectively replaces \"specifying the text in the virtual DOM under the <span> below\" on each render\n  })\n\n  // We intentionally render a memoized <span> that only receives the initial text content when the component is mounted.\n  // We defer to the layout effect above to update the `textContent` of the span element when needed.\n  return <MemoizedText ref={ref}>{initialText}</MemoizedText>\n}\n\nconst MemoizedText = memo(\n  forwardRef<HTMLSpanElement, { children: string }>((props, ref) => {\n    return (\n      <span data-slate-string ref={ref}>\n        {props.children}\n      </span>\n    )\n  })\n)\n\n/**\n * Leaf strings without text, render as zero-width strings.\n */\n\nexport const ZeroWidthString = (props: {\n  length?: number\n  isLineBreak?: boolean\n  isMarkPlaceholder?: boolean\n}) => {\n  const { length = 0, isLineBreak = false, isMarkPlaceholder = false } = props\n\n  const attributes = {\n    'data-slate-zero-width': isLineBreak ? 'n' : 'z',\n    'data-slate-length': length,\n  }\n\n  if (isMarkPlaceholder) {\n    attributes['data-slate-mark-placeholder'] = true\n  }\n\n  return (\n    <span {...attributes}>\n      {!IS_ANDROID || !isLineBreak ? '\\uFEFF' : null}\n      {isLineBreak ? <br /> : null}\n    </span>\n  )\n}\n\nexport default String\n","import React, {\n  useRef,\n  useCallback,\n  MutableRefObject,\n  useState,\n  useEffect,\n} from 'react'\nimport { Element, Text } from 'slate'\nimport { ResizeObserver as ResizeObserverPolyfill } from '@juggle/resize-observer'\nimport String from './string'\nimport {\n  PLACEHOLDER_SYMBOL,\n  EDITOR_TO_PLACEHOLDER_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport { useSlateStatic } from '../hooks/use-slate-static'\nimport { IS_WEBKIT } from '../utils/environment'\n\nfunction disconnectPlaceholderResizeObserver(\n  placeholderResizeObserver: MutableRefObject<ResizeObserver | null>,\n  releaseObserver: boolean\n) {\n  if (placeholderResizeObserver.current) {\n    placeholderResizeObserver.current.disconnect()\n    if (releaseObserver) {\n      placeholderResizeObserver.current = null\n    }\n  }\n}\n\ntype TimerId = ReturnType<typeof setTimeout> | null\n\nfunction clearTimeoutRef(timeoutRef: MutableRefObject<TimerId>) {\n  if (timeoutRef.current) {\n    clearTimeout(timeoutRef.current)\n    timeoutRef.current = null\n  }\n}\n\n/**\n * Individual leaves in a text node with unique formatting.\n */\nconst Leaf = (props: {\n  isLast: boolean\n  leaf: Text\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: Text\n}) => {\n  const {\n    leaf,\n    isLast,\n    text,\n    parent,\n    renderPlaceholder,\n    renderLeaf = (props: RenderLeafProps) => <DefaultLeaf {...props} />,\n  } = props\n\n  const editor = useSlateStatic()\n  const placeholderResizeObserver = useRef<ResizeObserver | null>(null)\n  const placeholderRef = useRef<HTMLElement | null>(null)\n  const [showPlaceholder, setShowPlaceholder] = useState(false)\n  const showPlaceholderTimeoutRef = useRef<TimerId>(null)\n\n  const callbackPlaceholderRef = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      disconnectPlaceholderResizeObserver(\n        placeholderResizeObserver,\n        placeholderEl == null\n      )\n\n      if (placeholderEl == null) {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.delete(editor)\n        leaf.onPlaceholderResize?.(null)\n      } else {\n        EDITOR_TO_PLACEHOLDER_ELEMENT.set(editor, placeholderEl)\n\n        if (!placeholderResizeObserver.current) {\n          // Create a new observer and observe the placeholder element.\n          const ResizeObserver = window.ResizeObserver || ResizeObserverPolyfill\n          placeholderResizeObserver.current = new ResizeObserver(() => {\n            leaf.onPlaceholderResize?.(placeholderEl)\n          })\n        }\n        placeholderResizeObserver.current.observe(placeholderEl)\n        placeholderRef.current = placeholderEl\n      }\n    },\n    [placeholderRef, leaf, editor]\n  )\n\n  let children = (\n    <String isLast={isLast} leaf={leaf} parent={parent} text={text} />\n  )\n\n  const leafIsPlaceholder = leaf[PLACEHOLDER_SYMBOL]\n  useEffect(() => {\n    if (leafIsPlaceholder) {\n      if (!showPlaceholderTimeoutRef.current) {\n        // Delay the placeholder so it will not render in a selection\n        showPlaceholderTimeoutRef.current = setTimeout(() => {\n          setShowPlaceholder(true)\n          showPlaceholderTimeoutRef.current = null\n        }, 300)\n      }\n    } else {\n      clearTimeoutRef(showPlaceholderTimeoutRef)\n      setShowPlaceholder(false)\n    }\n    return () => clearTimeoutRef(showPlaceholderTimeoutRef)\n  }, [leafIsPlaceholder, setShowPlaceholder])\n\n  if (leafIsPlaceholder && showPlaceholder) {\n    const placeholderProps: RenderPlaceholderProps = {\n      children: leaf.placeholder,\n      attributes: {\n        'data-slate-placeholder': true,\n        style: {\n          position: 'absolute',\n          top: 0,\n          pointerEvents: 'none',\n          width: '100%',\n          maxWidth: '100%',\n          display: 'block',\n          opacity: '0.333',\n          userSelect: 'none',\n          textDecoration: 'none',\n          // Fixes https://github.com/udecode/plate/issues/2315\n          WebkitUserModify: IS_WEBKIT ? 'inherit' : undefined,\n        },\n        contentEditable: false,\n        ref: callbackPlaceholderRef,\n      },\n    }\n\n    children = (\n      <React.Fragment>\n        {renderPlaceholder(placeholderProps)}\n        {children}\n      </React.Fragment>\n    )\n  }\n\n  // COMPAT: Having the `data-` attributes on these leaf elements ensures that\n  // in certain misbehaving browsers they aren't weirdly cloned/destroyed by\n  // contenteditable behaviors. (2019/05/08)\n  const attributes: {\n    'data-slate-leaf': true\n  } = {\n    'data-slate-leaf': true,\n  }\n\n  return renderLeaf({ attributes, children, leaf, text })\n}\n\nconst MemoizedLeaf = React.memo(Leaf, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    Text.equals(next.leaf, prev.leaf) &&\n    next.leaf[PLACEHOLDER_SYMBOL] === prev.leaf[PLACEHOLDER_SYMBOL]\n  )\n})\n\nexport const DefaultLeaf = (props: RenderLeafProps) => {\n  const { attributes, children } = props\n  return <span {...attributes}>{children}</span>\n}\n\nexport default MemoizedLeaf\n","import React, { useCallback, useRef } from 'react'\nimport { Element, Range, Text as SlateText } from 'slate'\nimport { ReactEditor, useSlateStatic } from '..'\nimport { isTextDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n} from '../utils/weak-maps'\nimport { RenderLeafProps, RenderPlaceholderProps } from './editable'\nimport Leaf from './leaf'\n\n/**\n * Text.\n */\n\nconst Text = (props: {\n  decorations: Range[]\n  isLast: boolean\n  parent: Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  text: SlateText\n}) => {\n  const {\n    decorations,\n    isLast,\n    parent,\n    renderPlaceholder,\n    renderLeaf,\n    text,\n  } = props\n  const editor = useSlateStatic()\n  const ref = useRef<HTMLSpanElement | null>(null)\n  const leaves = SlateText.decorations(text, decorations)\n  const key = ReactEditor.findKey(editor, text)\n  const children = []\n\n  for (let i = 0; i < leaves.length; i++) {\n    const leaf = leaves[i]\n\n    children.push(\n      <Leaf\n        isLast={isLast && i === leaves.length - 1}\n        key={`${key.id}-${i}`}\n        renderPlaceholder={renderPlaceholder}\n        leaf={leaf}\n        text={text}\n        parent={parent}\n        renderLeaf={renderLeaf}\n      />\n    )\n  }\n\n  // Update element-related weak maps with the DOM element ref.\n  const callbackRef = useCallback(\n    (span: HTMLSpanElement | null) => {\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (span) {\n        KEY_TO_ELEMENT?.set(key, span)\n        NODE_TO_ELEMENT.set(text, span)\n        ELEMENT_TO_NODE.set(span, text)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(text)\n        if (ref.current) {\n          ELEMENT_TO_NODE.delete(ref.current)\n        }\n      }\n      ref.current = span\n    },\n    [ref, editor, key, text]\n  )\n  return (\n    <span data-slate-node=\"text\" ref={callbackRef}>\n      {children}\n    </span>\n  )\n}\n\nconst MemoizedText = React.memo(Text, (prev, next) => {\n  return (\n    next.parent === prev.parent &&\n    next.isLast === prev.isLast &&\n    next.renderLeaf === prev.renderLeaf &&\n    next.renderPlaceholder === prev.renderPlaceholder &&\n    next.text === prev.text &&\n    isTextDecorationsEqual(next.decorations, prev.decorations)\n  )\n})\n\nexport default MemoizedText\n","import getDirection from 'direction'\nimport React, { useCallback } from 'react'\nimport { Editor, Element as SlateElement, Node, Range } from 'slate'\nimport { ReactEditor, useReadOnly, useSlateStatic } from '..'\nimport useChildren from '../hooks/use-children'\nimport { isElementDecorationsEqual } from '../utils/range-list'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  ELEMENT_TO_NODE,\n  NODE_TO_ELEMENT,\n  NODE_TO_INDEX,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from './editable'\n\nimport Text from './text'\n\n/**\n * Element.\n */\n\nconst Element = (props: {\n  decorations: Range[]\n  element: SlateElement\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    element,\n    renderElement = (p: RenderElementProps) => <DefaultElement {...p} />,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const editor = useSlateStatic()\n  const readOnly = useReadOnly()\n  const isInline = editor.isInline(element)\n  const key = ReactEditor.findKey(editor, element)\n  const ref = useCallback(\n    (ref: HTMLElement | null) => {\n      // Update element-related weak maps with the DOM element ref.\n      const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n      if (ref) {\n        KEY_TO_ELEMENT?.set(key, ref)\n        NODE_TO_ELEMENT.set(element, ref)\n        ELEMENT_TO_NODE.set(ref, element)\n      } else {\n        KEY_TO_ELEMENT?.delete(key)\n        NODE_TO_ELEMENT.delete(element)\n      }\n    },\n    [editor, key, element]\n  )\n  let children: React.ReactNode = useChildren({\n    decorations,\n    node: element,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  })\n\n  // Attributes that the developer must mix into the element in their\n  // custom node renderer component.\n  const attributes: {\n    'data-slate-node': 'element'\n    'data-slate-void'?: true\n    'data-slate-inline'?: true\n    contentEditable?: false\n    dir?: 'rtl'\n    ref: any\n  } = {\n    'data-slate-node': 'element',\n    ref,\n  }\n\n  if (isInline) {\n    attributes['data-slate-inline'] = true\n  }\n\n  // If it's a block node with inline children, add the proper `dir` attribute\n  // for text direction.\n  if (!isInline && Editor.hasInlines(editor, element)) {\n    const text = Node.string(element)\n    const dir = getDirection(text)\n\n    if (dir === 'rtl') {\n      attributes.dir = dir\n    }\n  }\n\n  // If it's a void node, wrap the children in extra void-specific elements.\n  if (Editor.isVoid(editor, element)) {\n    attributes['data-slate-void'] = true\n\n    if (!readOnly && isInline) {\n      attributes.contentEditable = false\n    }\n\n    const Tag = isInline ? 'span' : 'div'\n    const [[text]] = Node.texts(element)\n\n    children = (\n      <Tag\n        data-slate-spacer\n        style={{\n          height: '0',\n          color: 'transparent',\n          outline: 'none',\n          position: 'absolute',\n        }}\n      >\n        <Text\n          renderPlaceholder={renderPlaceholder}\n          decorations={[]}\n          isLast={false}\n          parent={element}\n          text={text}\n        />\n      </Tag>\n    )\n\n    NODE_TO_INDEX.set(text, 0)\n    NODE_TO_PARENT.set(text, element)\n  }\n\n  return renderElement({ attributes, children, element })\n}\n\nconst MemoizedElement = React.memo(Element, (prev, next) => {\n  return (\n    prev.element === next.element &&\n    prev.renderElement === next.renderElement &&\n    prev.renderLeaf === next.renderLeaf &&\n    prev.renderPlaceholder === next.renderPlaceholder &&\n    isElementDecorationsEqual(prev.decorations, next.decorations) &&\n    (prev.selection === next.selection ||\n      (!!prev.selection &&\n        !!next.selection &&\n        Range.equals(prev.selection, next.selection)))\n  )\n})\n\n/**\n * The default element renderer.\n */\n\nexport const DefaultElement = (props: RenderElementProps) => {\n  const { attributes, children, element } = props\n  const editor = useSlateStatic()\n  const Tag = editor.isInline(element) ? 'span' : 'div'\n  return (\n    <Tag {...attributes} style={{ position: 'relative' }}>\n      {children}\n    </Tag>\n  )\n}\n\nexport default MemoizedElement\n","import { createContext, useContext } from 'react'\nimport { Range, NodeEntry } from 'slate'\n\n/**\n * A React context for sharing the `decorate` prop of the editable.\n */\n\nexport const DecorateContext = createContext<(entry: NodeEntry) => Range[]>(\n  () => []\n)\n\n/**\n * Get the current `decorate` prop of the editable.\n */\n\nexport const useDecorate = (): ((entry: NodeEntry) => Range[]) => {\n  return useContext(DecorateContext)\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `selected` state of an element.\n */\n\nexport const SelectedContext = createContext(false)\n\n/**\n * Get the current `selected` state of an element.\n */\n\nexport const useSelected = (): boolean => {\n  return useContext(SelectedContext)\n}\n","import React from 'react'\nimport { Ancestor, Descendant, Editor, Element, Range } from 'slate'\nimport {\n  RenderElementProps,\n  RenderLeafProps,\n  RenderPlaceholderProps,\n} from '../components/editable'\n\nimport ElementComponent from '../components/element'\nimport TextComponent from '../components/text'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { NODE_TO_INDEX, NODE_TO_PARENT } from '../utils/weak-maps'\nimport { useDecorate } from './use-decorate'\nimport { SelectedContext } from './use-selected'\nimport { useSlateStatic } from './use-slate-static'\n\n/**\n * Children.\n */\n\nconst useChildren = (props: {\n  decorations: Range[]\n  node: Ancestor\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderPlaceholder: (props: RenderPlaceholderProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  selection: Range | null\n}) => {\n  const {\n    decorations,\n    node,\n    renderElement,\n    renderPlaceholder,\n    renderLeaf,\n    selection,\n  } = props\n  const decorate = useDecorate()\n  const editor = useSlateStatic()\n  const path = ReactEditor.findPath(editor, node)\n  const children = []\n  const isLeafBlock =\n    Element.isElement(node) &&\n    !editor.isInline(node) &&\n    Editor.hasInlines(editor, node)\n\n  for (let i = 0; i < node.children.length; i++) {\n    const p = path.concat(i)\n    const n = node.children[i] as Descendant\n    const key = ReactEditor.findKey(editor, n)\n    const range = Editor.range(editor, p)\n    const sel = selection && Range.intersection(range, selection)\n    const ds = decorate([n, p])\n\n    for (const dec of decorations) {\n      const d = Range.intersection(dec, range)\n\n      if (d) {\n        ds.push(d)\n      }\n    }\n\n    if (Element.isElement(n)) {\n      children.push(\n        <SelectedContext.Provider key={`provider-${key.id}`} value={!!sel}>\n          <ElementComponent\n            decorations={ds}\n            element={n}\n            key={key.id}\n            renderElement={renderElement}\n            renderPlaceholder={renderPlaceholder}\n            renderLeaf={renderLeaf}\n            selection={sel}\n          />\n        </SelectedContext.Provider>\n      )\n    } else {\n      children.push(\n        <TextComponent\n          decorations={ds}\n          key={key.id}\n          isLast={isLeafBlock && i === node.children.length - 1}\n          parent={node}\n          renderPlaceholder={renderPlaceholder}\n          renderLeaf={renderLeaf}\n          text={n}\n        />\n      )\n    }\n\n    NODE_TO_INDEX.set(n, i)\n    NODE_TO_PARENT.set(n, node)\n  }\n\n  return children\n}\n\nexport default useChildren\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `readOnly` state of the editor.\n */\n\nexport const ReadOnlyContext = createContext(false)\n\n/**\n * Get the current `readOnly` state of the editor.\n */\n\nexport const useReadOnly = (): boolean => {\n  return useContext(ReadOnlyContext)\n}\n","import { createContext, useContext } from 'react'\nimport { Editor } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\n/**\n * A React context for sharing the editor object, in a way that re-renders the\n * context whenever changes occur.\n */\n\nexport interface SlateContextValue {\n  v: number\n  editor: ReactEditor\n}\n\nexport const SlateContext = createContext<{\n  v: number\n  editor: ReactEditor\n} | null>(null)\n\n/**\n * Get the current editor object from the React context.\n */\n\nexport const useSlate = (): Editor => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  const { editor } = context\n  return editor\n}\n\nexport const useSlateWithV = () => {\n  const context = useContext(SlateContext)\n\n  if (!context) {\n    throw new Error(\n      `The \\`useSlate\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return context\n}\n","import { useCallback, useEffect, useRef } from 'react'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { useSlateStatic } from './use-slate-static'\n\nexport function useTrackUserInput() {\n  const editor = useSlateStatic()\n\n  const receivedUserInput = useRef<boolean>(false)\n  const animationFrameIdRef = useRef<number>(0)\n\n  const onUserInput = useCallback(() => {\n    if (receivedUserInput.current) {\n      return\n    }\n\n    receivedUserInput.current = true\n\n    const window = ReactEditor.getWindow(editor)\n    window.cancelAnimationFrame(animationFrameIdRef.current)\n\n    animationFrameIdRef.current = window.requestAnimationFrame(() => {\n      receivedUserInput.current = false\n    })\n  }, [editor])\n\n  useEffect(() => () => cancelAnimationFrame(animationFrameIdRef.current), [])\n\n  return {\n    receivedUserInput,\n    onUserInput,\n  }\n}\n","export const TRIPLE_CLICK = 3\n","import { isHotkey } from 'is-hotkey'\nimport { IS_APPLE } from './environment'\n\n/**\n * Hotkey mappings for each platform.\n */\n\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  insertSoftBreak: 'shift+enter',\n  splitBlock: 'enter',\n  undo: 'mod+z',\n}\n\nconst APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n}\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n}\n\n/**\n * Create a platform-aware hotkey checker.\n */\n\nconst create = (key: string) => {\n  const generic = HOTKEYS[key]\n  const apple = APPLE_HOTKEYS[key]\n  const windows = WINDOWS_HOTKEYS[key]\n  const isGeneric = generic && isHotkey(generic)\n  const isApple = apple && isHotkey(apple)\n  const isWindows = windows && isHotkey(windows)\n\n  return (event: KeyboardEvent) => {\n    if (isGeneric && isGeneric(event)) return true\n    if (IS_APPLE && isApple && isApple(event)) return true\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\n    return false\n  }\n}\n\n/**\n * Hotkeys.\n */\n\nexport default {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSoftBreak: create('insertSoftBreak'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo'),\n}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var _typeof = require(\"@babel/runtime/helpers/typeof\")[\"default\"];\n\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","import { RefObject } from 'react'\nimport { ReactEditor } from '../../plugin/react-editor'\nimport { isTrackedMutation } from '../../utils/dom'\n\nexport type RestoreDOMManager = {\n  registerMutations: (mutations: MutationRecord[]) => void\n  restoreDOM: () => void\n  clear: () => void\n}\n\nexport const createRestoreDomManager = (\n  editor: ReactEditor,\n  receivedUserInput: RefObject<boolean>\n): RestoreDOMManager => {\n  let bufferedMutations: MutationRecord[] = []\n\n  const clear = () => {\n    bufferedMutations = []\n  }\n\n  const registerMutations = (mutations: MutationRecord[]) => {\n    if (!receivedUserInput.current) {\n      return\n    }\n\n    const trackedMutations = mutations.filter(mutation =>\n      isTrackedMutation(editor, mutation, mutations)\n    )\n\n    bufferedMutations.push(...trackedMutations)\n  }\n\n  function restoreDOM() {\n    if (bufferedMutations.length > 0) {\n      bufferedMutations.reverse().forEach(mutation => {\n        if (mutation.type === 'characterData') {\n          // We don't want to restore the DOM for characterData mutations\n          // because this interrupts the composition.\n          return\n        }\n\n        mutation.removedNodes.forEach(node => {\n          mutation.target.insertBefore(node, mutation.nextSibling)\n        })\n\n        mutation.addedNodes.forEach(node => {\n          mutation.target.removeChild(node)\n        })\n      })\n\n      // Clear buffered mutations to ensure we don't undo them twice\n      clear()\n    }\n  }\n\n  return {\n    registerMutations,\n    restoreDOM,\n    clear,\n  }\n}\n","import React, { Component, ComponentType, ContextType, RefObject } from 'react'\nimport { EditorContext } from '../../hooks/use-slate-static'\nimport { IS_ANDROID } from '../../utils/environment'\nimport {\n  createRestoreDomManager,\n  RestoreDOMManager,\n} from './restore-dom-manager'\n\nconst MUTATION_OBSERVER_CONFIG: MutationObserverInit = {\n  subtree: true,\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n}\n\ntype RestoreDOMProps = {\n  receivedUserInput: RefObject<boolean>\n  node: RefObject<HTMLDivElement>\n}\n\n// We have to use a class component here since we rely on `getSnapshotBeforeUpdate` which has no FC equivalent\n// to run code synchronously immediately before react commits the component update to the DOM.\nclass RestoreDOMComponent extends Component<RestoreDOMProps> {\n  static contextType = EditorContext\n  context: ContextType<typeof EditorContext> = null\n\n  private manager: RestoreDOMManager | null = null\n  private mutationObserver: MutationObserver | null = null\n\n  observe() {\n    const { node } = this.props\n    if (!node.current) {\n      throw new Error('Failed to attach MutationObserver, `node` is undefined')\n    }\n\n    this.mutationObserver?.observe(node.current, MUTATION_OBSERVER_CONFIG)\n  }\n\n  componentDidMount() {\n    const { receivedUserInput } = this.props\n    const editor = this.context!\n\n    this.manager = createRestoreDomManager(editor, receivedUserInput)\n    this.mutationObserver = new MutationObserver(this.manager.registerMutations)\n\n    this.observe()\n  }\n\n  getSnapshotBeforeUpdate() {\n    const pendingMutations = this.mutationObserver?.takeRecords()\n    if (pendingMutations?.length) {\n      this.manager?.registerMutations(pendingMutations)\n    }\n\n    this.mutationObserver?.disconnect()\n    this.manager?.restoreDOM()\n\n    return null\n  }\n\n  componentDidUpdate() {\n    this.manager?.clear()\n    this.observe()\n  }\n\n  componentWillUnmount() {\n    this.mutationObserver?.disconnect()\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport const RestoreDOM: ComponentType<RestoreDOMProps> = IS_ANDROID\n  ? RestoreDOMComponent\n  : ({ children }) => <>{children}</>\n","import getDirection from 'direction'\nimport debounce from 'lodash/debounce'\nimport throttle from 'lodash/throttle'\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {\n  Editor,\n  Element,\n  Node,\n  NodeEntry,\n  Path,\n  Range,\n  Text,\n  Transforms,\n} from 'slate'\nimport { useAndroidInputManager } from '../hooks/android-input-manager/use-android-input-manager'\nimport useChildren from '../hooks/use-children'\nimport { DecorateContext } from '../hooks/use-decorate'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { ReadOnlyContext } from '../hooks/use-read-only'\nimport { useSlate } from '../hooks/use-slate'\nimport { useTrackUserInput } from '../hooks/use-track-user-input'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { TRIPLE_CLICK } from '../utils/constants'\nimport {\n  DOMElement,\n  DOMRange,\n  DOMText,\n  getDefaultView,\n  isDOMElement,\n  isDOMNode,\n  isPlainTextOnlyPaste,\n} from '../utils/dom'\nimport {\n  CAN_USE_DOM,\n  HAS_BEFORE_INPUT_SUPPORT,\n  IS_ANDROID,\n  IS_CHROME,\n  IS_FIREFOX,\n  IS_FIREFOX_LEGACY,\n  IS_IOS,\n  IS_WEBKIT,\n  IS_UC_MOBILE,\n  IS_WECHATBROWSER,\n} from '../utils/environment'\nimport Hotkeys from '../utils/hotkeys'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_FORCE_RENDER,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  MARK_PLACEHOLDER_SYMBOL,\n  NODE_TO_ELEMENT,\n  PLACEHOLDER_SYMBOL,\n} from '../utils/weak-maps'\nimport { RestoreDOM } from './restore-dom/restore-dom'\nimport { AndroidInputManager } from '../hooks/android-input-manager/android-input-manager'\n\ntype DeferredOperation = () => void\n\nconst Children = (props: Parameters<typeof useChildren>[0]) => (\n  <React.Fragment>{useChildren(props)}</React.Fragment>\n)\n\n/**\n * `RenderElementProps` are passed to the `renderElement` handler.\n */\n\nexport interface RenderElementProps {\n  children: any\n  element: Element\n  attributes: {\n    'data-slate-node': 'element'\n    'data-slate-inline'?: true\n    'data-slate-void'?: true\n    dir?: 'rtl'\n    ref: any\n  }\n}\n\n/**\n * `RenderLeafProps` are passed to the `renderLeaf` handler.\n */\n\nexport interface RenderLeafProps {\n  children: any\n  leaf: Text\n  text: Text\n  attributes: {\n    'data-slate-leaf': true\n  }\n}\n\n/**\n * `EditableProps` are passed to the `<Editable>` component.\n */\n\nexport type EditableProps = {\n  decorate?: (entry: NodeEntry) => Range[]\n  onDOMBeforeInput?: (event: InputEvent) => void\n  placeholder?: string\n  readOnly?: boolean\n  role?: string\n  style?: React.CSSProperties\n  renderElement?: (props: RenderElementProps) => JSX.Element\n  renderLeaf?: (props: RenderLeafProps) => JSX.Element\n  renderPlaceholder?: (props: RenderPlaceholderProps) => JSX.Element\n  scrollSelectionIntoView?: (editor: ReactEditor, domRange: DOMRange) => void\n  as?: React.ElementType\n  disableDefaultStyles?: boolean\n} & React.TextareaHTMLAttributes<HTMLDivElement>\n\n/**\n * Editable.\n */\n\nexport const Editable = (props: EditableProps) => {\n  const defaultRenderPlaceholder = useCallback(\n    (props: RenderPlaceholderProps) => <DefaultPlaceholder {...props} />,\n    []\n  )\n  const {\n    autoFocus,\n    decorate = defaultDecorate,\n    onDOMBeforeInput: propsOnDOMBeforeInput,\n    placeholder,\n    readOnly = false,\n    renderElement,\n    renderLeaf,\n    renderPlaceholder = defaultRenderPlaceholder,\n    scrollSelectionIntoView = defaultScrollSelectionIntoView,\n    style: userStyle = {},\n    as: Component = 'div',\n    disableDefaultStyles = false,\n    ...attributes\n  } = props\n  const editor = useSlate()\n  // Rerender editor when composition status changed\n  const [isComposing, setIsComposing] = useState(false)\n  const ref = useRef<HTMLDivElement | null>(null)\n  const deferredOperations = useRef<DeferredOperation[]>([])\n  const [placeholderHeight, setPlaceholderHeight] = useState<\n    number | undefined\n  >()\n\n  const { onUserInput, receivedUserInput } = useTrackUserInput()\n\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  EDITOR_TO_FORCE_RENDER.set(editor, forceRender)\n\n  // Update internal state on each render.\n  IS_READ_ONLY.set(editor, readOnly)\n\n  // Keep track of some state for the event handler logic.\n  const state = useMemo(\n    () => ({\n      isDraggingInternally: false,\n      isUpdatingSelection: false,\n      latestElement: null as DOMElement | null,\n      hasMarkPlaceholder: false,\n    }),\n    []\n  )\n\n  // The autoFocus TextareaHTMLAttribute doesn't do anything on a div, so it\n  // needs to be manually focused.\n  useEffect(() => {\n    if (ref.current && autoFocus) {\n      ref.current.focus()\n    }\n  }, [autoFocus])\n\n  /**\n   * The AndroidInputManager object has a cyclical dependency on onDOMSelectionChange\n   *\n   * It is defined as a reference to simplify hook dependencies and clarify that\n   * it needs to be initialized.\n   */\n  const androidInputManagerRef = useRef<\n    AndroidInputManager | null | undefined\n  >()\n\n  // Listen on the native `selectionchange` event to be able to update any time\n  // the selection changes. This is required because React's `onSelect` is leaky\n  // and non-standard so it doesn't fire until after a selection has been\n  // released. This causes issues in situations where another change happens\n  // while a selection is being dragged.\n  const onDOMSelectionChange = useMemo(\n    () =>\n      throttle(() => {\n        const androidInputManager = androidInputManagerRef.current\n        if (\n          (IS_ANDROID || !ReactEditor.isComposing(editor)) &&\n          (!state.isUpdatingSelection || androidInputManager?.isFlushing()) &&\n          !state.isDraggingInternally\n        ) {\n          const root = ReactEditor.findDocumentOrShadowRoot(editor)\n          const { activeElement } = root\n          const el = ReactEditor.toDOMNode(editor, editor)\n          const domSelection = root.getSelection()\n\n          if (activeElement === el) {\n            state.latestElement = activeElement\n            IS_FOCUSED.set(editor, true)\n          } else {\n            IS_FOCUSED.delete(editor)\n          }\n\n          if (!domSelection) {\n            return Transforms.deselect(editor)\n          }\n\n          const { anchorNode, focusNode } = domSelection\n\n          const anchorNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, anchorNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, anchorNode)\n\n          const focusNodeSelectable =\n            ReactEditor.hasEditableTarget(editor, focusNode) ||\n            ReactEditor.isTargetInsideNonReadonlyVoid(editor, focusNode)\n\n          if (anchorNodeSelectable && focusNodeSelectable) {\n            const range = ReactEditor.toSlateRange(editor, domSelection, {\n              exactMatch: false,\n              suppressThrow: true,\n            })\n\n            if (range) {\n              if (\n                !ReactEditor.isComposing(editor) &&\n                !androidInputManager?.hasPendingChanges() &&\n                !androidInputManager?.isFlushing()\n              ) {\n                Transforms.select(editor, range)\n              } else {\n                androidInputManager?.handleUserSelect(range)\n              }\n            }\n          }\n\n          // Deselect the editor if the dom selection is not selectable in readonly mode\n          if (readOnly && (!anchorNodeSelectable || !focusNodeSelectable)) {\n            Transforms.deselect(editor)\n          }\n        }\n      }, 100),\n    [editor, readOnly, state]\n  )\n\n  const scheduleOnDOMSelectionChange = useMemo(\n    () => debounce(onDOMSelectionChange, 0),\n    [onDOMSelectionChange]\n  )\n\n  androidInputManagerRef.current = useAndroidInputManager({\n    node: ref,\n    onDOMSelectionChange,\n    scheduleOnDOMSelectionChange,\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    // Update element-related weak maps with the DOM element ref.\n    let window\n    if (ref.current && (window = getDefaultView(ref.current))) {\n      EDITOR_TO_WINDOW.set(editor, window)\n      EDITOR_TO_ELEMENT.set(editor, ref.current)\n      NODE_TO_ELEMENT.set(editor, ref.current)\n      ELEMENT_TO_NODE.set(ref.current, editor)\n    } else {\n      NODE_TO_ELEMENT.delete(editor)\n    }\n\n    // Make sure the DOM selection state is in sync.\n    const { selection } = editor\n    const root = ReactEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = root.getSelection()\n\n    if (\n      !domSelection ||\n      !ReactEditor.isFocused(editor) ||\n      androidInputManagerRef.current?.hasPendingAction()\n    ) {\n      return\n    }\n\n    const setDomSelection = (forceChange?: boolean) => {\n      const hasDomSelection = domSelection.type !== 'None'\n\n      // If the DOM selection is properly unset, we're done.\n      if (!selection && !hasDomSelection) {\n        return\n      }\n\n      // Get anchorNode and focusNode\n      const focusNode = domSelection.focusNode\n      let anchorNode\n\n      // COMPAT: In firefox the normal seletion way does not work\n      // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n      if (IS_FIREFOX && domSelection.rangeCount > 1) {\n        const firstRange = domSelection.getRangeAt(0)\n        const lastRange = domSelection.getRangeAt(domSelection.rangeCount - 1)\n\n        // Right to left\n        if (firstRange.startContainer === focusNode) {\n          anchorNode = lastRange.endContainer\n        } else {\n          // Left to right\n          anchorNode = firstRange.startContainer\n        }\n      } else {\n        anchorNode = domSelection.anchorNode\n      }\n\n      // verify that the dom selection is in the editor\n      const editorElement = EDITOR_TO_ELEMENT.get(editor)!\n      let hasDomSelectionInEditor = false\n      if (\n        editorElement.contains(anchorNode) &&\n        editorElement.contains(focusNode)\n      ) {\n        hasDomSelectionInEditor = true\n      }\n\n      // If the DOM selection is in the editor and the editor selection is already correct, we're done.\n      if (\n        hasDomSelection &&\n        hasDomSelectionInEditor &&\n        selection &&\n        !forceChange\n      ) {\n        const slateRange = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: true,\n\n          // domSelection is not necessarily a valid Slate range\n          // (e.g. when clicking on contentEditable:false element)\n          suppressThrow: true,\n        })\n\n        if (slateRange && Range.equals(slateRange, selection)) {\n          if (!state.hasMarkPlaceholder) {\n            return\n          }\n\n          // Ensure selection is inside the mark placeholder\n          if (\n            anchorNode?.parentElement?.hasAttribute(\n              'data-slate-mark-placeholder'\n            )\n          ) {\n            return\n          }\n        }\n      }\n\n      // when <Editable/> is being controlled through external value\n      // then its children might just change - DOM responds to it on its own\n      // but Slate's value is not being updated through any operation\n      // and thus it doesn't transform selection on its own\n      if (selection && !ReactEditor.hasRange(editor, selection)) {\n        editor.selection = ReactEditor.toSlateRange(editor, domSelection, {\n          exactMatch: false,\n          suppressThrow: true,\n        })\n        return\n      }\n\n      // Otherwise the DOM selection is out of sync, so update it.\n      state.isUpdatingSelection = true\n\n      const newDomRange: DOMRange | null =\n        selection && ReactEditor.toDOMRange(editor, selection)\n\n      if (newDomRange) {\n        if (ReactEditor.isComposing(editor) && !IS_ANDROID) {\n          domSelection.collapseToEnd()\n        } else if (Range.isBackward(selection!)) {\n          domSelection.setBaseAndExtent(\n            newDomRange.endContainer,\n            newDomRange.endOffset,\n            newDomRange.startContainer,\n            newDomRange.startOffset\n          )\n        } else {\n          domSelection.setBaseAndExtent(\n            newDomRange.startContainer,\n            newDomRange.startOffset,\n            newDomRange.endContainer,\n            newDomRange.endOffset\n          )\n        }\n        scrollSelectionIntoView(editor, newDomRange)\n      } else {\n        domSelection.removeAllRanges()\n      }\n\n      return newDomRange\n    }\n\n    // In firefox if there is more then 1 range and we call setDomSelection we remove the ability to select more cells in a table\n    if (domSelection.rangeCount <= 1) {\n      setDomSelection()\n    }\n\n    const ensureSelection =\n      androidInputManagerRef.current?.isFlushing() === 'action'\n\n    if (!IS_ANDROID || !ensureSelection) {\n      setTimeout(() => {\n        state.isUpdatingSelection = false\n      })\n      return\n    }\n\n    let timeoutId: ReturnType<typeof setTimeout> | null = null\n    const animationFrameId = requestAnimationFrame(() => {\n      if (ensureSelection) {\n        const ensureDomSelection = (forceChange?: boolean) => {\n          try {\n            const el = ReactEditor.toDOMNode(editor, editor)\n            el.focus()\n\n            setDomSelection(forceChange)\n          } catch (e) {\n            // Ignore, dom and state might be out of sync\n          }\n        }\n\n        // Compat: Android IMEs try to force their selection by manually re-applying it even after we set it.\n        // This essentially would make setting the slate selection during an update meaningless, so we force it\n        // again here. We can't only do it in the setTimeout after the animation frame since that would cause a\n        // visible flicker.\n        ensureDomSelection()\n\n        timeoutId = setTimeout(() => {\n          // COMPAT: While setting the selection in an animation frame visually correctly sets the selection,\n          // it doesn't update GBoards spellchecker state. We have to manually trigger a selection change after\n          // the animation frame to ensure it displays the correct state.\n          ensureDomSelection(true)\n          state.isUpdatingSelection = false\n        })\n      }\n    })\n\n    return () => {\n      cancelAnimationFrame(animationFrameId)\n      if (timeoutId) {\n        clearTimeout(timeoutId)\n      }\n    }\n  })\n\n  // Listen on the native `beforeinput` event to get real \"Level 2\" events. This\n  // is required because React's `beforeinput` is fake and never really attaches\n  // to the real event sadly. (2019/11/01)\n  // https://github.com/facebook/react/issues/11211\n  const onDOMBeforeInput = useCallback(\n    (event: InputEvent) => {\n      onUserInput()\n\n      if (\n        !readOnly &&\n        ReactEditor.hasEditableTarget(editor, event.target) &&\n        !isDOMEventHandled(event, propsOnDOMBeforeInput)\n      ) {\n        // COMPAT: BeforeInput events aren't cancelable on android, so we have to handle them differently using the android input manager.\n        if (androidInputManagerRef.current) {\n          return androidInputManagerRef.current.handleDOMBeforeInput(event)\n        }\n\n        // Some IMEs/Chrome extensions like e.g. Grammarly set the selection immediately before\n        // triggering a `beforeinput` expecting the change to be applied to the immediately before\n        // set selection.\n        scheduleOnDOMSelectionChange.flush()\n        onDOMSelectionChange.flush()\n\n        const { selection } = editor\n        const { inputType: type } = event\n        const data = (event as any).dataTransfer || event.data || undefined\n\n        const isCompositionChange =\n          type === 'insertCompositionText' || type === 'deleteCompositionText'\n\n        // COMPAT: use composition change events as a hint to where we should insert\n        // composition text if we aren't composing to work around https://github.com/ianstormtaylor/slate/issues/5038\n        if (isCompositionChange && ReactEditor.isComposing(editor)) {\n          return\n        }\n\n        let native = false\n        if (\n          type === 'insertText' &&\n          selection &&\n          Range.isCollapsed(selection) &&\n          // Only use native character insertion for single characters a-z or space for now.\n          // Long-press events (hold a + press 4 = ä) to choose a special character otherwise\n          // causes duplicate inserts.\n          event.data &&\n          event.data.length === 1 &&\n          /[a-z ]/i.test(event.data) &&\n          // Chrome has issues correctly editing the start of nodes: https://bugs.chromium.org/p/chromium/issues/detail?id=1249405\n          // When there is an inline element, e.g. a link, and you select\n          // right after it (the start of the next node).\n          selection.anchor.offset !== 0\n        ) {\n          native = true\n\n          // Skip native if there are marks, as\n          // `insertText` will insert a node, not just text.\n          if (editor.marks) {\n            native = false\n          }\n\n          // Chrome also has issues correctly editing the end of anchor elements: https://bugs.chromium.org/p/chromium/issues/detail?id=1259100\n          // Therefore we don't allow native events to insert text at the end of anchor nodes.\n          const { anchor } = selection\n\n          const [node, offset] = ReactEditor.toDOMPoint(editor, anchor)\n          const anchorNode = node.parentElement?.closest('a')\n\n          const window = ReactEditor.getWindow(editor)\n\n          if (\n            native &&\n            anchorNode &&\n            ReactEditor.hasDOMNode(editor, anchorNode)\n          ) {\n            // Find the last text node inside the anchor.\n            const lastText = window?.document\n              .createTreeWalker(anchorNode, NodeFilter.SHOW_TEXT)\n              .lastChild() as DOMText | null\n\n            if (lastText === node && lastText.textContent?.length === offset) {\n              native = false\n            }\n          }\n\n          // Chrome has issues with the presence of tab characters inside elements with whiteSpace = 'pre'\n          // causing abnormal insert behavior: https://bugs.chromium.org/p/chromium/issues/detail?id=1219139\n          if (\n            native &&\n            node.parentElement &&\n            window?.getComputedStyle(node.parentElement)?.whiteSpace === 'pre'\n          ) {\n            const block = Editor.above(editor, {\n              at: anchor.path,\n              match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n            })\n\n            if (block && Node.string(block[0]).includes('\\t')) {\n              native = false\n            }\n          }\n        }\n\n        // COMPAT: For the deleting forward/backward input types we don't want\n        // to change the selection because it is the range that will be deleted,\n        // and those commands determine that for themselves.\n        if (!type.startsWith('delete') || type.startsWith('deleteBy')) {\n          const [targetRange] = (event as any).getTargetRanges()\n\n          if (targetRange) {\n            const range = ReactEditor.toSlateRange(editor, targetRange, {\n              exactMatch: false,\n              suppressThrow: false,\n            })\n\n            if (!selection || !Range.equals(selection, range)) {\n              native = false\n\n              const selectionRef =\n                !isCompositionChange &&\n                editor.selection &&\n                Editor.rangeRef(editor, editor.selection)\n\n              Transforms.select(editor, range)\n\n              if (selectionRef) {\n                EDITOR_TO_USER_SELECTION.set(editor, selectionRef)\n              }\n            }\n          }\n        }\n\n        // Composition change types occur while a user is composing text and can't be\n        // cancelled. Let them through and wait for the composition to end.\n        if (isCompositionChange) {\n          return\n        }\n\n        if (!native) {\n          event.preventDefault()\n        }\n\n        // COMPAT: If the selection is expanded, even if the command seems like\n        // a delete forward/backward command it should delete the selection.\n        if (\n          selection &&\n          Range.isExpanded(selection) &&\n          type.startsWith('delete')\n        ) {\n          const direction = type.endsWith('Backward') ? 'backward' : 'forward'\n          Editor.deleteFragment(editor, { direction })\n          return\n        }\n\n        switch (type) {\n          case 'deleteByComposition':\n          case 'deleteByCut':\n          case 'deleteByDrag': {\n            Editor.deleteFragment(editor)\n            break\n          }\n\n          case 'deleteContent':\n          case 'deleteContentForward': {\n            Editor.deleteForward(editor)\n            break\n          }\n\n          case 'deleteContentBackward': {\n            Editor.deleteBackward(editor)\n            break\n          }\n\n          case 'deleteEntireSoftLine': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineBackward': {\n            Editor.deleteBackward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteHardLineForward': {\n            Editor.deleteForward(editor, { unit: 'block' })\n            break\n          }\n\n          case 'deleteSoftLineForward': {\n            Editor.deleteForward(editor, { unit: 'line' })\n            break\n          }\n\n          case 'deleteWordBackward': {\n            Editor.deleteBackward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'deleteWordForward': {\n            Editor.deleteForward(editor, { unit: 'word' })\n            break\n          }\n\n          case 'insertLineBreak':\n            Editor.insertSoftBreak(editor)\n            break\n\n          case 'insertParagraph': {\n            Editor.insertBreak(editor)\n            break\n          }\n\n          case 'insertFromComposition':\n          case 'insertFromDrop':\n          case 'insertFromPaste':\n          case 'insertFromYank':\n          case 'insertReplacementText':\n          case 'insertText': {\n            if (type === 'insertFromComposition') {\n              // COMPAT: in Safari, `compositionend` is dispatched after the\n              // `beforeinput` for \"insertFromComposition\". But if we wait for it\n              // then we will abort because we're still composing and the selection\n              // won't be updated properly.\n              // https://www.w3.org/TR/input-events-2/\n              if (ReactEditor.isComposing(editor)) {\n                setIsComposing(false)\n                IS_COMPOSING.set(editor, false)\n              }\n            }\n\n            // use a weak comparison instead of 'instanceof' to allow\n            // programmatic access of paste events coming from external windows\n            // like cypress where cy.window does not work realibly\n            if (data?.constructor.name === 'DataTransfer') {\n              ReactEditor.insertData(editor, data)\n            } else if (typeof data === 'string') {\n              // Only insertText operations use the native functionality, for now.\n              // Potentially expand to single character deletes, as well.\n              if (native) {\n                deferredOperations.current.push(() =>\n                  Editor.insertText(editor, data)\n                )\n              } else {\n                Editor.insertText(editor, data)\n              }\n            }\n\n            break\n          }\n        }\n\n        // Restore the actual user section if nothing manually set it.\n        const toRestore = EDITOR_TO_USER_SELECTION.get(editor)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(editor)\n\n        if (\n          toRestore &&\n          (!editor.selection || !Range.equals(editor.selection, toRestore))\n        ) {\n          Transforms.select(editor, toRestore)\n        }\n      }\n    },\n    [\n      editor,\n      onDOMSelectionChange,\n      onUserInput,\n      propsOnDOMBeforeInput,\n      readOnly,\n      scheduleOnDOMSelectionChange,\n    ]\n  )\n\n  const callbackRef = useCallback(\n    node => {\n      if (node == null) {\n        onDOMSelectionChange.cancel()\n        scheduleOnDOMSelectionChange.cancel()\n\n        EDITOR_TO_ELEMENT.delete(editor)\n        NODE_TO_ELEMENT.delete(editor)\n\n        if (ref.current && HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          ref.current.removeEventListener('beforeinput', onDOMBeforeInput)\n        }\n      } else {\n        // Attach a native DOM event handler for `beforeinput` events, because React's\n        // built-in `onBeforeInput` is actually a leaky polyfill that doesn't expose\n        // real `beforeinput` events sadly... (2019/11/04)\n        // https://github.com/facebook/react/issues/11211\n        if (HAS_BEFORE_INPUT_SUPPORT) {\n          // @ts-ignore The `beforeinput` event isn't recognized.\n          node.addEventListener('beforeinput', onDOMBeforeInput)\n        }\n      }\n\n      ref.current = node\n    },\n    [\n      onDOMSelectionChange,\n      scheduleOnDOMSelectionChange,\n      editor,\n      onDOMBeforeInput,\n    ]\n  )\n\n  // Attach a native DOM event handler for `selectionchange`, because React's\n  // built-in `onSelect` handler doesn't fire for all selection changes. It's a\n  // leaky polyfill that only fires on keypresses or clicks. Instead, we want to\n  // fire for any change to the selection inside the editor. (2019/11/04)\n  // https://github.com/facebook/react/issues/5785\n  useIsomorphicLayoutEffect(() => {\n    const window = ReactEditor.getWindow(editor)\n\n    window.document.addEventListener(\n      'selectionchange',\n      scheduleOnDOMSelectionChange\n    )\n\n    return () => {\n      window.document.removeEventListener(\n        'selectionchange',\n        scheduleOnDOMSelectionChange\n      )\n    }\n  }, [scheduleOnDOMSelectionChange])\n\n  const decorations = decorate([editor, []])\n\n  const showPlaceholder =\n    placeholder &&\n    editor.children.length === 1 &&\n    Array.from(Node.texts(editor)).length === 1 &&\n    Node.string(editor) === '' &&\n    !isComposing\n\n  const placeHolderResizeHandler = useCallback(\n    (placeholderEl: HTMLElement | null) => {\n      if (placeholderEl && showPlaceholder) {\n        setPlaceholderHeight(placeholderEl.getBoundingClientRect()?.height)\n      } else {\n        setPlaceholderHeight(undefined)\n      }\n    },\n    [showPlaceholder]\n  )\n\n  if (showPlaceholder) {\n    const start = Editor.start(editor, [])\n    decorations.push({\n      [PLACEHOLDER_SYMBOL]: true,\n      placeholder,\n      onPlaceholderResize: placeHolderResizeHandler,\n      anchor: start,\n      focus: start,\n    })\n  }\n\n  const { marks } = editor\n  state.hasMarkPlaceholder = false\n\n  if (editor.selection && Range.isCollapsed(editor.selection) && marks) {\n    const { anchor } = editor.selection\n    const leaf = Node.leaf(editor, anchor.path)\n    const { text, ...rest } = leaf\n\n    // While marks isn't a 'complete' text, we can still use loose Text.equals\n    // here which only compares marks anyway.\n    if (!Text.equals(leaf, marks as Text, { loose: true })) {\n      state.hasMarkPlaceholder = true\n\n      const unset = Object.fromEntries(\n        Object.keys(rest).map(mark => [mark, null])\n      )\n\n      decorations.push({\n        [MARK_PLACEHOLDER_SYMBOL]: true,\n        ...unset,\n        ...marks,\n\n        anchor,\n        focus: anchor,\n      })\n    }\n  }\n\n  // Update EDITOR_TO_MARK_PLACEHOLDER_MARKS in setTimeout useEffect to ensure we don't set it\n  // before we receive the composition end event.\n  useEffect(() => {\n    setTimeout(() => {\n      const { selection } = editor\n      if (selection) {\n        const { anchor } = selection\n        const text = Node.leaf(editor, anchor.path)\n\n        // While marks isn't a 'complete' text, we can still use loose Text.equals\n        // here which only compares marks anyway.\n        if (marks && !Text.equals(text, marks as Text, { loose: true })) {\n          EDITOR_TO_PENDING_INSERTION_MARKS.set(editor, marks)\n          return\n        }\n      }\n\n      EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n    })\n  })\n\n  return (\n    <ReadOnlyContext.Provider value={readOnly}>\n      <DecorateContext.Provider value={decorate}>\n        <RestoreDOM node={ref} receivedUserInput={receivedUserInput}>\n          <Component\n            role={readOnly ? undefined : 'textbox'}\n            aria-multiline={readOnly ? undefined : true}\n            {...attributes}\n            // COMPAT: Certain browsers don't support the `beforeinput` event, so we'd\n            // have to use hacks to make these replacement-based features work.\n            // For SSR situations HAS_BEFORE_INPUT_SUPPORT is false and results in prop\n            // mismatch warning app moves to browser. Pass-through consumer props when\n            // not CAN_USE_DOM (SSR) and default to falsy value\n            spellCheck={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.spellCheck\n                : false\n            }\n            autoCorrect={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCorrect\n                : 'false'\n            }\n            autoCapitalize={\n              HAS_BEFORE_INPUT_SUPPORT || !CAN_USE_DOM\n                ? attributes.autoCapitalize\n                : 'false'\n            }\n            data-slate-editor\n            data-slate-node=\"value\"\n            // explicitly set this\n            contentEditable={!readOnly}\n            // in some cases, a decoration needs access to the range / selection to decorate a text node,\n            // then you will select the whole text node when you select part the of text\n            // this magic zIndex=\"-1\" will fix it\n            zindex={-1}\n            suppressContentEditableWarning\n            ref={callbackRef}\n            style={{\n              ...(disableDefaultStyles\n                ? {}\n                : {\n                    // Allow positioning relative to the editable element.\n                    position: 'relative',\n                    // Preserve adjacent whitespace and new lines.\n                    whiteSpace: 'pre-wrap',\n                    // Allow words to break if they are too long.\n                    wordWrap: 'break-word',\n                    // Make the minimum height that of the placeholder.\n                    ...(placeholderHeight\n                      ? { minHeight: placeholderHeight }\n                      : {}),\n                  }),\n              // Allow for passed-in styles to override anything.\n              ...userStyle,\n            }}\n            onBeforeInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                // fall back to React's leaky polyfill instead just for it. It\n                // only works for the `insertText` input type.\n                if (\n                  !HAS_BEFORE_INPUT_SUPPORT &&\n                  !readOnly &&\n                  !isEventHandled(event, attributes.onBeforeInput) &&\n                  ReactEditor.hasSelectableTarget(editor, event.target)\n                ) {\n                  event.preventDefault()\n                  if (!ReactEditor.isComposing(editor)) {\n                    const text = (event as any).data as string\n                    Editor.insertText(editor, text)\n                  }\n                }\n              },\n              [attributes.onBeforeInput, editor, readOnly]\n            )}\n            onInput={useCallback(\n              (event: React.FormEvent<HTMLDivElement>) => {\n                if (isEventHandled(event, attributes.onInput)) {\n                  return\n                }\n\n                if (androidInputManagerRef.current) {\n                  androidInputManagerRef.current.handleInput()\n                  return\n                }\n\n                // Flush native operations, as native events will have propogated\n                // and we can correctly compare DOM text values in components\n                // to stop rendering, so that browser functions like autocorrect\n                // and spellcheck work as expected.\n                for (const op of deferredOperations.current) {\n                  op()\n                }\n                deferredOperations.current = []\n              },\n              [attributes.onInput]\n            )}\n            onBlur={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  readOnly ||\n                  state.isUpdatingSelection ||\n                  !ReactEditor.hasSelectableTarget(editor, event.target) ||\n                  isEventHandled(event, attributes.onBlur)\n                ) {\n                  return\n                }\n\n                // COMPAT: If the current `activeElement` is still the previous\n                // one, this is due to the window being blurred when the tab\n                // itself becomes unfocused, so we want to abort early to allow to\n                // editor to stay focused when the tab becomes focused again.\n                const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                if (state.latestElement === root.activeElement) {\n                  return\n                }\n\n                const { relatedTarget } = event\n                const el = ReactEditor.toDOMNode(editor, editor)\n\n                // COMPAT: The event should be ignored if the focus is returning\n                // to the editor from an embedded editable element (eg. an <input>\n                // element inside a void node).\n                if (relatedTarget === el) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving from\n                // the editor to inside a void node's spacer element.\n                if (\n                  isDOMElement(relatedTarget) &&\n                  relatedTarget.hasAttribute('data-slate-spacer')\n                ) {\n                  return\n                }\n\n                // COMPAT: The event should be ignored if the focus is moving to a\n                // non- editable section of an element that isn't a void node (eg.\n                // a list item of the check list example).\n                if (\n                  relatedTarget != null &&\n                  isDOMNode(relatedTarget) &&\n                  ReactEditor.hasDOMNode(editor, relatedTarget)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, relatedTarget)\n\n                  if (Element.isElement(node) && !editor.isVoid(node)) {\n                    return\n                  }\n                }\n\n                // COMPAT: Safari doesn't always remove the selection even if the content-\n                // editable element no longer has focus. Refer to:\n                // https://stackoverflow.com/questions/12353247/force-contenteditable-div-to-stop-accepting-input-after-it-loses-focus-under-web\n                if (IS_WEBKIT) {\n                  const domSelection = root.getSelection()\n                  domSelection?.removeAllRanges()\n                }\n\n                IS_FOCUSED.delete(editor)\n              },\n              [\n                readOnly,\n                state.isUpdatingSelection,\n                state.latestElement,\n                editor,\n                attributes.onBlur,\n              ]\n            )}\n            onClick={useCallback(\n              (event: React.MouseEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onClick) &&\n                  isDOMNode(event.target)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n\n                  // At this time, the Slate document may be arbitrarily different,\n                  // because onClick handlers can change the document before we get here.\n                  // Therefore we must check that this path actually exists,\n                  // and that it still refers to the same node.\n                  if (\n                    !Editor.hasPath(editor, path) ||\n                    Node.get(editor, path) !== node\n                  ) {\n                    return\n                  }\n\n                  if (event.detail === TRIPLE_CLICK && path.length >= 1) {\n                    let blockPath = path\n                    if (\n                      !(Element.isElement(node) && Editor.isBlock(editor, node))\n                    ) {\n                      const block = Editor.above(editor, {\n                        match: n =>\n                          Element.isElement(n) && Editor.isBlock(editor, n),\n                        at: path,\n                      })\n\n                      blockPath = block?.[1] ?? path.slice(0, 1)\n                    }\n\n                    const range = Editor.range(editor, blockPath)\n                    Transforms.select(editor, range)\n                    return\n                  }\n\n                  if (readOnly) {\n                    return\n                  }\n\n                  const start = Editor.start(editor, path)\n                  const end = Editor.end(editor, path)\n                  const startVoid = Editor.void(editor, { at: start })\n                  const endVoid = Editor.void(editor, { at: end })\n\n                  if (\n                    startVoid &&\n                    endVoid &&\n                    Path.equals(startVoid[1], endVoid[1])\n                  ) {\n                    const range = Editor.range(editor, start)\n                    Transforms.select(editor, range)\n                  }\n                }\n              },\n              [editor, attributes.onClick, readOnly]\n            )}\n            onCompositionEnd={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  if (ReactEditor.isComposing(editor)) {\n                    setIsComposing(false)\n                    IS_COMPOSING.set(editor, false)\n                  }\n\n                  androidInputManagerRef.current?.handleCompositionEnd(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionEnd) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  // COMPAT: In Chrome, `beforeinput` events for compositions\n                  // aren't correct and never fire the \"insertFromComposition\"\n                  // type that we need. So instead, insert whenever a composition\n                  // ends since it will already have been committed to the DOM.\n                  if (\n                    !IS_WEBKIT &&\n                    !IS_FIREFOX_LEGACY &&\n                    !IS_IOS &&\n                    !IS_WECHATBROWSER &&\n                    !IS_UC_MOBILE &&\n                    event.data\n                  ) {\n                    const placeholderMarks = EDITOR_TO_PENDING_INSERTION_MARKS.get(\n                      editor\n                    )\n                    EDITOR_TO_PENDING_INSERTION_MARKS.delete(editor)\n\n                    // Ensure we insert text with the marks the user was actually seeing\n                    if (placeholderMarks !== undefined) {\n                      EDITOR_TO_USER_MARKS.set(editor, editor.marks)\n                      editor.marks = placeholderMarks\n                    }\n\n                    Editor.insertText(editor, event.data)\n\n                    const userMarks = EDITOR_TO_USER_MARKS.get(editor)\n                    EDITOR_TO_USER_MARKS.delete(editor)\n                    if (userMarks !== undefined) {\n                      editor.marks = userMarks\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionEnd, editor]\n            )}\n            onCompositionUpdate={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCompositionUpdate)\n                ) {\n                  if (!ReactEditor.isComposing(editor)) {\n                    setIsComposing(true)\n                    IS_COMPOSING.set(editor, true)\n                  }\n                }\n              },\n              [attributes.onCompositionUpdate, editor]\n            )}\n            onCompositionStart={useCallback(\n              (event: React.CompositionEvent<HTMLDivElement>) => {\n                if (ReactEditor.hasSelectableTarget(editor, event.target)) {\n                  androidInputManagerRef.current?.handleCompositionStart(event)\n\n                  if (\n                    isEventHandled(event, attributes.onCompositionStart) ||\n                    IS_ANDROID\n                  ) {\n                    return\n                  }\n\n                  setIsComposing(true)\n\n                  const { selection } = editor\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                      return\n                    }\n                    const inline = Editor.above(editor, {\n                      match: n =>\n                        Element.isElement(n) && Editor.isInline(editor, n),\n                      mode: 'highest',\n                    })\n                    if (inline) {\n                      const [, inlinePath] = inline\n                      if (Editor.isEnd(editor, selection.anchor, inlinePath)) {\n                        const point = Editor.after(editor, inlinePath)!\n                        Transforms.setSelection(editor, {\n                          anchor: point,\n                          focus: point,\n                        })\n                      }\n                    }\n                  }\n                }\n              },\n              [attributes.onCompositionStart, editor]\n            )}\n            onCopy={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCopy) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'copy'\n                  )\n                }\n              },\n              [attributes.onCopy, editor]\n            )}\n            onCut={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasSelectableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onCut) &&\n                  !isDOMEventTargetInput(event)\n                ) {\n                  event.preventDefault()\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.clipboardData,\n                    'cut'\n                  )\n                  const { selection } = editor\n\n                  if (selection) {\n                    if (Range.isExpanded(selection)) {\n                      Editor.deleteFragment(editor)\n                    } else {\n                      const node = Node.parent(editor, selection.anchor.path)\n                      if (Editor.isVoid(editor, node)) {\n                        Transforms.delete(editor)\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onCut]\n            )}\n            onDragOver={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragOver)\n                ) {\n                  // Only when the target is void, call `preventDefault` to signal\n                  // that drops are allowed. Editable content is droppable by\n                  // default, and calling `preventDefault` hides the cursor.\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n\n                  if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n                    event.preventDefault()\n                  }\n                }\n              },\n              [attributes.onDragOver, editor]\n            )}\n            onDragStart={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDragStart)\n                ) {\n                  const node = ReactEditor.toSlateNode(editor, event.target)\n                  const path = ReactEditor.findPath(editor, node)\n                  const voidMatch =\n                    (Element.isElement(node) && Editor.isVoid(editor, node)) ||\n                    Editor.void(editor, { at: path, voids: true })\n\n                  // If starting a drag on a void node, make sure it is selected\n                  // so that it shows up in the selection's fragment.\n                  if (voidMatch) {\n                    const range = Editor.range(editor, path)\n                    Transforms.select(editor, range)\n                  }\n\n                  state.isDraggingInternally = true\n\n                  ReactEditor.setFragmentData(\n                    editor,\n                    event.dataTransfer,\n                    'drag'\n                  )\n                }\n              },\n              [readOnly, editor, attributes.onDragStart, state]\n            )}\n            onDrop={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onDrop)\n                ) {\n                  event.preventDefault()\n\n                  // Keep a reference to the dragged range before updating selection\n                  const draggedRange = editor.selection\n\n                  // Find the range where the drop happened\n                  const range = ReactEditor.findEventRange(editor, event)\n                  const data = event.dataTransfer\n\n                  Transforms.select(editor, range)\n\n                  if (state.isDraggingInternally) {\n                    if (\n                      draggedRange &&\n                      !Range.equals(draggedRange, range) &&\n                      !Editor.void(editor, { at: range, voids: true })\n                    ) {\n                      Transforms.delete(editor, {\n                        at: draggedRange,\n                      })\n                    }\n                  }\n\n                  ReactEditor.insertData(editor, data)\n\n                  // When dragging from another source into the editor, it's possible\n                  // that the current editor does not have focus.\n                  if (!ReactEditor.isFocused(editor)) {\n                    ReactEditor.focus(editor)\n                  }\n                }\n\n                state.isDraggingInternally = false\n              },\n              [readOnly, editor, attributes.onDrop, state]\n            )}\n            onDragEnd={useCallback(\n              (event: React.DragEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  state.isDraggingInternally &&\n                  attributes.onDragEnd &&\n                  ReactEditor.hasTarget(editor, event.target)\n                ) {\n                  attributes.onDragEnd(event)\n                }\n\n                // When dropping on a different droppable element than the current editor,\n                // `onDrop` is not called. So we need to clean up in `onDragEnd` instead.\n                // Note: `onDragEnd` is only called when `onDrop` is not called\n                state.isDraggingInternally = false\n              },\n              [readOnly, state, attributes, editor]\n            )}\n            onFocus={useCallback(\n              (event: React.FocusEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  !state.isUpdatingSelection &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onFocus)\n                ) {\n                  const el = ReactEditor.toDOMNode(editor, editor)\n                  const root = ReactEditor.findDocumentOrShadowRoot(editor)\n                  state.latestElement = root.activeElement\n\n                  // COMPAT: If the editor has nested editable elements, the focus\n                  // can go to them. In Firefox, this must be prevented because it\n                  // results in issues with keyboard navigation. (2017/03/30)\n                  if (IS_FIREFOX && event.target !== el) {\n                    el.focus()\n                    return\n                  }\n\n                  IS_FOCUSED.set(editor, true)\n                }\n              },\n              [readOnly, state, editor, attributes.onFocus]\n            )}\n            onKeyDown={useCallback(\n              (event: React.KeyboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target)\n                ) {\n                  androidInputManagerRef.current?.handleKeyDown(event)\n\n                  const { nativeEvent } = event\n\n                  // COMPAT: The composition end event isn't fired reliably in all browsers,\n                  // so we sometimes might end up stuck in a composition state even though we\n                  // aren't composing any more.\n                  if (\n                    ReactEditor.isComposing(editor) &&\n                    nativeEvent.isComposing === false\n                  ) {\n                    IS_COMPOSING.set(editor, false)\n                    setIsComposing(false)\n                  }\n\n                  if (\n                    isEventHandled(event, attributes.onKeyDown) ||\n                    ReactEditor.isComposing(editor)\n                  ) {\n                    return\n                  }\n\n                  const { selection } = editor\n                  const element =\n                    editor.children[\n                      selection !== null ? selection.focus.path[0] : 0\n                    ]\n                  const isRTL = getDirection(Node.string(element)) === 'rtl'\n\n                  // COMPAT: Since we prevent the default behavior on\n                  // `beforeinput` events, the browser doesn't think there's ever\n                  // any history stack to undo or redo, so we have to manage these\n                  // hotkeys ourselves. (2019/11/06)\n                  if (Hotkeys.isRedo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.redo === 'function') {\n                      maybeHistoryEditor.redo()\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isUndo(nativeEvent)) {\n                    event.preventDefault()\n                    const maybeHistoryEditor: any = editor\n\n                    if (typeof maybeHistoryEditor.undo === 'function') {\n                      maybeHistoryEditor.undo()\n                    }\n\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't handle the selection updates\n                  // properly. In Chrome, the selection isn't properly extended.\n                  // And in Firefox, the selection isn't properly collapsed.\n                  // (2017/10/17)\n                  if (Hotkeys.isMoveLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', reverse: true })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line' })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineBackward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, {\n                      unit: 'line',\n                      edge: 'focus',\n                      reverse: true,\n                    })\n                    return\n                  }\n\n                  if (Hotkeys.isExtendLineForward(nativeEvent)) {\n                    event.preventDefault()\n                    Transforms.move(editor, { unit: 'line', edge: 'focus' })\n                    return\n                  }\n\n                  // COMPAT: If a void node is selected, or a zero-width text node\n                  // adjacent to an inline is selected, we need to handle these\n                  // hotkeys manually because browsers won't be able to skip over\n                  // the void node with the zero-width space not being an empty\n                  // string.\n                  if (Hotkeys.isMoveBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: !isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'start' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isCollapsed(selection)) {\n                      Transforms.move(editor, { reverse: isRTL })\n                    } else {\n                      Transforms.collapse(editor, { edge: 'end' })\n                    }\n\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordBackward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: !isRTL })\n                    return\n                  }\n\n                  if (Hotkeys.isMoveWordForward(nativeEvent)) {\n                    event.preventDefault()\n\n                    if (selection && Range.isExpanded(selection)) {\n                      Transforms.collapse(editor, { edge: 'focus' })\n                    }\n\n                    Transforms.move(editor, { unit: 'word', reverse: isRTL })\n                    return\n                  }\n\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to guessing at the input intention for hotkeys.\n                  // COMPAT: In iOS, some of these hotkeys are handled in the\n                  if (!HAS_BEFORE_INPUT_SUPPORT) {\n                    // We don't have a core behavior for these, but they change the\n                    // DOM if we don't prevent them, so we have to.\n                    if (\n                      Hotkeys.isBold(nativeEvent) ||\n                      Hotkeys.isItalic(nativeEvent) ||\n                      Hotkeys.isTransposeCharacter(nativeEvent)\n                    ) {\n                      event.preventDefault()\n                      return\n                    }\n\n                    if (Hotkeys.isSoftBreak(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertSoftBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isSplitBlock(nativeEvent)) {\n                      event.preventDefault()\n                      Editor.insertBreak(editor)\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor)\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteLineForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'line' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordBackward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'backward' })\n                      } else {\n                        Editor.deleteBackward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n\n                    if (Hotkeys.isDeleteWordForward(nativeEvent)) {\n                      event.preventDefault()\n\n                      if (selection && Range.isExpanded(selection)) {\n                        Editor.deleteFragment(editor, { direction: 'forward' })\n                      } else {\n                        Editor.deleteForward(editor, { unit: 'word' })\n                      }\n\n                      return\n                    }\n                  } else {\n                    if (IS_CHROME || IS_WEBKIT) {\n                      // COMPAT: Chrome and Safari support `beforeinput` event but do not fire\n                      // an event when deleting backwards in a selected void inline node\n                      if (\n                        selection &&\n                        (Hotkeys.isDeleteBackward(nativeEvent) ||\n                          Hotkeys.isDeleteForward(nativeEvent)) &&\n                        Range.isCollapsed(selection)\n                      ) {\n                        const currentNode = Node.parent(\n                          editor,\n                          selection.anchor.path\n                        )\n\n                        if (\n                          Element.isElement(currentNode) &&\n                          Editor.isVoid(editor, currentNode) &&\n                          (Editor.isInline(editor, currentNode) ||\n                            Editor.isBlock(editor, currentNode))\n                        ) {\n                          event.preventDefault()\n                          Editor.deleteBackward(editor, { unit: 'block' })\n\n                          return\n                        }\n                      }\n                    }\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onKeyDown]\n            )}\n            onPaste={useCallback(\n              (event: React.ClipboardEvent<HTMLDivElement>) => {\n                if (\n                  !readOnly &&\n                  ReactEditor.hasEditableTarget(editor, event.target) &&\n                  !isEventHandled(event, attributes.onPaste)\n                ) {\n                  // COMPAT: Certain browsers don't support the `beforeinput` event, so we\n                  // fall back to React's `onPaste` here instead.\n                  // COMPAT: Firefox, Chrome and Safari don't emit `beforeinput` events\n                  // when \"paste without formatting\" is used, so fallback. (2020/02/20)\n                  // COMPAT: Safari InputEvents generated by pasting won't include\n                  // application/x-slate-fragment items, so use the\n                  // ClipboardEvent here. (2023/03/15)\n                  if (\n                    !HAS_BEFORE_INPUT_SUPPORT ||\n                    isPlainTextOnlyPaste(event.nativeEvent) ||\n                    IS_WEBKIT\n                  ) {\n                    event.preventDefault()\n                    ReactEditor.insertData(editor, event.clipboardData)\n                  }\n                }\n              },\n              [readOnly, editor, attributes.onPaste]\n            )}\n          >\n            <Children\n              decorations={decorations}\n              node={editor}\n              renderElement={renderElement}\n              renderPlaceholder={renderPlaceholder}\n              renderLeaf={renderLeaf}\n              selection={editor.selection}\n            />\n          </Component>\n        </RestoreDOM>\n      </DecorateContext.Provider>\n    </ReadOnlyContext.Provider>\n  )\n}\n\n/**\n * The props that get passed to renderPlaceholder\n */\nexport type RenderPlaceholderProps = {\n  children: any\n  attributes: {\n    'data-slate-placeholder': boolean\n    dir?: 'rtl'\n    contentEditable: boolean\n    ref: React.RefCallback<any>\n    style: React.CSSProperties\n  }\n}\n\n/**\n * The default placeholder element\n */\n\nexport const DefaultPlaceholder = ({\n  attributes,\n  children,\n}: RenderPlaceholderProps) => (\n  // COMPAT: Artificially add a line-break to the end on the placeholder element\n  // to prevent Android IMEs to pick up its content in autocorrect and to auto-capitalize the first letter\n  <span {...attributes}>\n    {children}\n    {IS_ANDROID && <br />}\n  </span>\n)\n\n/**\n * A default memoized decorate function.\n */\n\nexport const defaultDecorate: (entry: NodeEntry) => Range[] = () => []\n\n/**\n * A default implement to scroll dom range into view.\n */\n\nconst defaultScrollSelectionIntoView = (\n  editor: ReactEditor,\n  domRange: DOMRange\n) => {\n  // This was affecting the selection of multiple blocks and dragging behavior,\n  // so enabled only if the selection has been collapsed.\n  if (\n    domRange.getBoundingClientRect &&\n    (!editor.selection ||\n      (editor.selection && Range.isCollapsed(editor.selection)))\n  ) {\n    const leafEl = domRange.startContainer.parentElement!\n    leafEl.getBoundingClientRect = domRange.getBoundingClientRect.bind(domRange)\n    scrollIntoView(leafEl, {\n      scrollMode: 'if-needed',\n    })\n\n    // @ts-expect-error an unorthodox delete D:\n    delete leafEl.getBoundingClientRect\n  }\n}\n\n/**\n * Check if an event is overrided by a handler.\n */\n\nexport const isEventHandled = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType,\n  handler?: (event: EventType) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.isDefaultPrevented() || event.isPropagationStopped()\n}\n\n/**\n * Check if the event's target is an input element\n */\nexport const isDOMEventTargetInput = <\n  EventType extends React.SyntheticEvent<unknown, unknown>\n>(\n  event: EventType\n) => {\n  return (\n    isDOMNode(event.target) &&\n    (event.target instanceof HTMLInputElement ||\n      event.target instanceof HTMLTextAreaElement)\n  )\n}\n\n/**\n * Check if a DOM event is overrided by a handler.\n */\n\nexport const isDOMEventHandled = <E extends Event>(\n  event: E,\n  handler?: (event: E) => void | boolean\n) => {\n  if (!handler) {\n    return false\n  }\n\n  // The custom event handler may return a boolean to specify whether the event\n  // shall be treated as being handled or not.\n  const shouldTreatEventAsHandled = handler(event)\n\n  if (shouldTreatEventAsHandled != null) {\n    return shouldTreatEventAsHandled\n  }\n\n  return event.defaultPrevented\n}\n","import { createContext, useContext } from 'react'\n\n/**\n * A React context for sharing the `focused` state of the editor.\n */\n\nexport const FocusedContext = createContext(false)\n\n/**\n * Get the current `focused` state of the editor.\n */\n\nexport const useFocused = (): boolean => {\n  return useContext(FocusedContext)\n}\n","import {\n  createContext,\n  useCallback,\n  useContext,\n  useMemo,\n  useReducer,\n  useRef,\n} from 'react'\nimport { Editor } from 'slate'\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect'\n\nfunction isError(error: any): error is Error {\n  return error instanceof Error\n}\n\ntype EditorChangeHandler = (editor: Editor) => void\n/**\n * A React context for sharing the editor selector context in a way to control rerenders\n */\n\nexport const SlateSelectorContext = createContext<{\n  getSlate: () => Editor\n  addEventListener: (callback: EditorChangeHandler) => () => void\n}>({} as any)\n\nconst refEquality = (a: any, b: any) => a === b\n\n/**\n * use redux style selectors to prevent rerendering on every keystroke.\n * Bear in mind rerendering can only prevented if the returned value is a value type or for reference types (e.g. objects and arrays) add a custom equality function.\n *\n * Example:\n * ```\n *  const isSelectionActive = useSlateSelector(editor => Boolean(editor.selection));\n * ```\n */\nexport function useSlateSelector<T>(\n  selector: (editor: Editor) => T,\n  equalityFn: (a: T, b: T) => boolean = refEquality\n) {\n  const [, forceRender] = useReducer(s => s + 1, 0)\n  const context = useContext(SlateSelectorContext)\n  if (!context) {\n    throw new Error(\n      `The \\`useSlateSelector\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n  const { getSlate, addEventListener } = context\n\n  const latestSubscriptionCallbackError = useRef<Error | undefined>()\n  const latestSelector = useRef<(editor: Editor) => T>(() => null as any)\n  const latestSelectedState = useRef<T>((null as any) as T)\n  let selectedState: T\n\n  try {\n    if (\n      selector !== latestSelector.current ||\n      latestSubscriptionCallbackError.current\n    ) {\n      selectedState = selector(getSlate())\n    } else {\n      selectedState = latestSelectedState.current\n    }\n  } catch (err) {\n    if (latestSubscriptionCallbackError.current && isError(err)) {\n      err.message += `\\nThe error may be correlated with this previous error:\\n${latestSubscriptionCallbackError.current.stack}\\n\\n`\n    }\n\n    throw err\n  }\n  useIsomorphicLayoutEffect(() => {\n    latestSelector.current = selector\n    latestSelectedState.current = selectedState\n    latestSubscriptionCallbackError.current = undefined\n  })\n\n  useIsomorphicLayoutEffect(\n    () => {\n      function checkForUpdates() {\n        try {\n          const newSelectedState = latestSelector.current(getSlate())\n\n          if (equalityFn(newSelectedState, latestSelectedState.current)) {\n            return\n          }\n\n          latestSelectedState.current = newSelectedState\n        } catch (err) {\n          // we ignore all errors here, since when the component\n          // is re-rendered, the selectors are called again, and\n          // will throw again, if neither props nor store state\n          // changed\n          latestSubscriptionCallbackError.current = err\n        }\n\n        forceRender()\n      }\n\n      const unsubscribe = addEventListener(checkForUpdates)\n\n      checkForUpdates()\n\n      return () => unsubscribe()\n    },\n    // don't rerender on equalityFn change since we want to be able to define it inline\n    [addEventListener, getSlate]\n  )\n\n  return selectedState\n}\n\n/**\n * Create selector context with editor updating on every editor change\n */\nexport function useSelectorContext(editor: Editor) {\n  const eventListeners = useRef<EditorChangeHandler[]>([]).current\n  const slateRef = useRef<{\n    editor: Editor\n  }>({\n    editor,\n  }).current\n  const onChange = useCallback(\n    (editor: Editor) => {\n      slateRef.editor = editor\n      eventListeners.forEach((listener: EditorChangeHandler) =>\n        listener(editor)\n      )\n    },\n    [eventListeners, slateRef]\n  )\n\n  const selectorContext = useMemo(() => {\n    return {\n      getSlate: () => slateRef.editor,\n      addEventListener: (callback: EditorChangeHandler) => {\n        eventListeners.push(callback)\n        return () => {\n          eventListeners.splice(eventListeners.indexOf(callback), 1)\n        }\n      },\n    }\n  }, [eventListeners, slateRef])\n  return { selectorContext, onChange }\n}\n","import React, { useCallback, useEffect, useRef, useState } from 'react'\nimport { Descendant, Editor, Node, Scrubber } from 'slate'\nimport { FocusedContext } from '../hooks/use-focused'\nimport { useIsomorphicLayoutEffect } from '../hooks/use-isomorphic-layout-effect'\nimport { SlateContext, SlateContextValue } from '../hooks/use-slate'\nimport {\n  useSelectorContext,\n  SlateSelectorContext,\n} from '../hooks/use-slate-selector'\nimport { EditorContext } from '../hooks/use-slate-static'\nimport { ReactEditor } from '../plugin/react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\nimport { EDITOR_TO_ON_CHANGE } from '../utils/weak-maps'\n\n/**\n * A wrapper around the provider to handle `onChange` events, because the editor\n * is a mutable singleton so it won't ever register as \"changed\" otherwise.\n */\n\nexport const Slate = (props: {\n  editor: ReactEditor\n  initialValue: Descendant[]\n  children: React.ReactNode\n  onChange?: (value: Descendant[]) => void\n}) => {\n  const { editor, children, onChange, initialValue, ...rest } = props\n  const unmountRef = useRef(false)\n\n  const [context, setContext] = React.useState<SlateContextValue>(() => {\n    if (!Node.isNodeList(initialValue)) {\n      throw new Error(\n        `[Slate] initialValue is invalid! Expected a list of elements but got: ${Scrubber.stringify(\n          initialValue\n        )}`\n      )\n    }\n    if (!Editor.isEditor(editor)) {\n      throw new Error(\n        `[Slate] editor is invalid! You passed: ${Scrubber.stringify(editor)}`\n      )\n    }\n    editor.children = initialValue\n    Object.assign(editor, rest)\n    return { v: 0, editor }\n  })\n\n  const {\n    selectorContext,\n    onChange: handleSelectorChange,\n  } = useSelectorContext(editor)\n\n  const onContextChange = useCallback(() => {\n    if (onChange) {\n      onChange(editor.children)\n    }\n\n    setContext(prevContext => ({\n      v: prevContext.v + 1,\n      editor,\n    }))\n    handleSelectorChange(editor)\n  }, [editor, handleSelectorChange, onChange])\n\n  useEffect(() => {\n    EDITOR_TO_ON_CHANGE.set(editor, onContextChange)\n\n    return () => {\n      EDITOR_TO_ON_CHANGE.set(editor, () => {})\n      unmountRef.current = true\n    }\n  }, [editor, onContextChange])\n\n  const [isFocused, setIsFocused] = useState(ReactEditor.isFocused(editor))\n\n  useEffect(() => {\n    setIsFocused(ReactEditor.isFocused(editor))\n  }, [editor])\n\n  useIsomorphicLayoutEffect(() => {\n    const fn = () => setIsFocused(ReactEditor.isFocused(editor))\n    if (REACT_MAJOR_VERSION >= 17) {\n      // In React >= 17 onFocus and onBlur listen to the focusin and focusout events during the bubbling phase.\n      // Therefore in order for <Editable />'s handlers to run first, which is necessary for ReactEditor.isFocused(editor)\n      // to return the correct value, we have to listen to the focusin and focusout events without useCapture here.\n      document.addEventListener('focusin', fn)\n      document.addEventListener('focusout', fn)\n      return () => {\n        document.removeEventListener('focusin', fn)\n        document.removeEventListener('focusout', fn)\n      }\n    } else {\n      document.addEventListener('focus', fn, true)\n      document.addEventListener('blur', fn, true)\n      return () => {\n        document.removeEventListener('focus', fn, true)\n        document.removeEventListener('blur', fn, true)\n      }\n    }\n  }, [])\n\n  return (\n    <SlateSelectorContext.Provider value={selectorContext}>\n      <SlateContext.Provider value={context}>\n        <EditorContext.Provider value={context.editor}>\n          <FocusedContext.Provider value={isFocused}>\n            {children}\n          </FocusedContext.Provider>\n        </EditorContext.Provider>\n      </SlateContext.Provider>\n    </SlateSelectorContext.Provider>\n  )\n}\n","import { useContext } from 'react'\n\nimport { EditorContext } from './use-slate-static'\n\n/**\n * Get the current editor object from the React context.\n * @deprecated Use useSlateStatic instead.\n */\n\nexport const useEditor = () => {\n  const editor = useContext(EditorContext)\n\n  if (!editor) {\n    throw new Error(\n      `The \\`useEditor\\` hook must be used inside the <Slate> component's context.`\n    )\n  }\n\n  return editor\n}\n","import { BaseSelection, Range } from 'slate'\n\nimport { useSlateSelector } from './use-slate-selector'\n\n/**\n * Get the current slate selection.\n * Only triggers a rerender when the selection actually changes\n */\nexport const useSlateSelection = () => {\n  return useSlateSelector(editor => editor.selection, isSelectionEqual)\n}\n\nconst isSelectionEqual = (a: BaseSelection, b: BaseSelection) => {\n  if (!a && !b) return true\n  if (!a || !b) return false\n  return Range.equals(a, b)\n}\n","/**\n * Utilities for single-line deletion\n */\n\nimport { Editor, Range } from 'slate'\nimport { ReactEditor } from '../plugin/react-editor'\n\nconst doRectsIntersect = (rect: DOMRect, compareRect: DOMRect) => {\n  const middle = (compareRect.top + compareRect.bottom) / 2\n\n  return rect.top <= middle && rect.bottom >= middle\n}\n\nconst areRangesSameLine = (\n  editor: ReactEditor,\n  range1: Range,\n  range2: Range\n) => {\n  const rect1 = ReactEditor.toDOMRange(editor, range1).getBoundingClientRect()\n  const rect2 = ReactEditor.toDOMRange(editor, range2).getBoundingClientRect()\n\n  return doRectsIntersect(rect1, rect2) && doRectsIntersect(rect2, rect1)\n}\n\n/**\n * A helper utility that returns the end portion of a `Range`\n * which is located on a single line.\n *\n * @param {Editor} editor The editor object to compare against\n * @param {Range} parentRange The parent range to compare against\n * @returns {Range} A valid portion of the parentRange which is one a single line\n */\nexport const findCurrentLineRange = (\n  editor: ReactEditor,\n  parentRange: Range\n): Range => {\n  const parentRangeBoundary = Editor.range(editor, Range.end(parentRange))\n  const positions = Array.from(Editor.positions(editor, { at: parentRange }))\n\n  let left = 0\n  let right = positions.length\n  let middle = Math.floor(right / 2)\n\n  if (\n    areRangesSameLine(\n      editor,\n      Editor.range(editor, positions[left]),\n      parentRangeBoundary\n    )\n  ) {\n    return Editor.range(editor, positions[left], parentRangeBoundary)\n  }\n\n  if (positions.length < 2) {\n    return Editor.range(\n      editor,\n      positions[positions.length - 1],\n      parentRangeBoundary\n    )\n  }\n\n  while (middle !== positions.length && middle !== left) {\n    if (\n      areRangesSameLine(\n        editor,\n        Editor.range(editor, positions[middle]),\n        parentRangeBoundary\n      )\n    ) {\n      right = middle\n    } else {\n      left = middle\n    }\n\n    middle = Math.floor((left + right) / 2)\n  }\n\n  return Editor.range(editor, positions[right], parentRangeBoundary)\n}\n","import ReactDOM from 'react-dom'\nimport {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Transforms,\n} from 'slate'\nimport {\n  TextDiff,\n  transformPendingPoint,\n  transformPendingRange,\n  transformTextDiff,\n} from '../utils/diff-text'\nimport {\n  getPlainText,\n  getSlateFragmentAttribute,\n  isDOMText,\n} from '../utils/dom'\nimport { Key } from '../utils/key'\nimport { findCurrentLineRange } from '../utils/lines'\nimport {\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_ON_CHANGE,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  NODE_TO_KEY,\n} from '../utils/weak-maps'\nimport { ReactEditor } from './react-editor'\nimport { REACT_MAJOR_VERSION } from '../utils/environment'\n\n/**\n * `withReact` adds React and DOM specific behaviors to the editor.\n *\n * If you are using TypeScript, you must extend Slate's CustomTypes to use\n * this plugin.\n *\n * See https://docs.slatejs.org/concepts/11-typescript to learn how.\n */\n\nexport const withReact = <T extends BaseEditor>(\n  editor: T,\n  clipboardFormatKey = 'x-slate-fragment'\n): T & ReactEditor => {\n  const e = editor as T & ReactEditor\n  const { apply, onChange, deleteBackward, addMark, removeMark } = e\n\n  // The WeakMap which maps a key to a specific HTMLElement must be scoped to the editor instance to\n  // avoid collisions between editors in the DOM that share the same value.\n  EDITOR_TO_KEY_TO_ELEMENT.set(e, new WeakMap())\n\n  e.addMark = (key, value) => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(e)?.()\n\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    addMark(key, value)\n  }\n\n  e.removeMark = key => {\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    removeMark(key)\n  }\n\n  e.deleteBackward = unit => {\n    if (unit !== 'line') {\n      return deleteBackward(unit)\n    }\n\n    if (e.selection && Range.isCollapsed(e.selection)) {\n      const parentBlockEntry = Editor.above(e, {\n        match: n => Element.isElement(n) && Editor.isBlock(e, n),\n        at: e.selection,\n      })\n\n      if (parentBlockEntry) {\n        const [, parentBlockPath] = parentBlockEntry\n        const parentElementRange = Editor.range(\n          e,\n          parentBlockPath,\n          e.selection.anchor\n        )\n\n        const currentLineRange = findCurrentLineRange(e, parentElementRange)\n\n        if (!Range.isCollapsed(currentLineRange)) {\n          Transforms.delete(e, { at: currentLineRange })\n        }\n      }\n    }\n  }\n\n  // This attempts to reset the NODE_TO_KEY entry to the correct value\n  // as apply() changes the object reference and hence invalidates the NODE_TO_KEY entry\n  e.apply = (op: Operation) => {\n    const matches: [Path, Key][] = []\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(e)\n    if (pendingDiffs?.length) {\n      const transformed = pendingDiffs\n        .map(textDiff => transformTextDiff(textDiff, op))\n        .filter(Boolean) as TextDiff[]\n\n      EDITOR_TO_PENDING_DIFFS.set(e, transformed)\n    }\n\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(e)\n    if (pendingSelection) {\n      EDITOR_TO_PENDING_SELECTION.set(\n        e,\n        transformPendingRange(e, pendingSelection, op)\n      )\n    }\n\n    const pendingAction = EDITOR_TO_PENDING_ACTION.get(e)\n    if (pendingAction?.at) {\n      const at = Point.isPoint(pendingAction?.at)\n        ? transformPendingPoint(e, pendingAction.at, op)\n        : transformPendingRange(e, pendingAction.at, op)\n\n      EDITOR_TO_PENDING_ACTION.set(e, at ? { ...pendingAction, at } : null)\n    }\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n      case 'split_node': {\n        matches.push(...getMatches(e, op.path))\n        break\n      }\n\n      case 'set_selection': {\n        // Selection was manually set, don't restore the user selection after the change.\n        EDITOR_TO_USER_SELECTION.get(e)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(e)\n        break\n      }\n\n      case 'insert_node':\n      case 'remove_node': {\n        matches.push(...getMatches(e, Path.parent(op.path)))\n        break\n      }\n\n      case 'merge_node': {\n        const prevPath = Path.previous(op.path)\n        matches.push(...getMatches(e, prevPath))\n        break\n      }\n\n      case 'move_node': {\n        const commonPath = Path.common(\n          Path.parent(op.path),\n          Path.parent(op.newPath)\n        )\n        matches.push(...getMatches(e, commonPath))\n        break\n      }\n    }\n\n    apply(op)\n\n    for (const [path, key] of matches) {\n      const [node] = Editor.node(e, path)\n      NODE_TO_KEY.set(node, key)\n    }\n  }\n\n  e.setFragmentData = (data: Pick<DataTransfer, 'getData' | 'setData'>) => {\n    const { selection } = e\n\n    if (!selection) {\n      return\n    }\n\n    const [start, end] = Range.edges(selection)\n    const startVoid = Editor.void(e, { at: start.path })\n    const endVoid = Editor.void(e, { at: end.path })\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return\n    }\n\n    // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n    const domRange = ReactEditor.toDOMRange(e, selection)\n    let contents = domRange.cloneContents()\n    let attach = contents.childNodes[0] as HTMLElement\n\n    // Make sure attach is non-empty, since empty nodes will not get copied.\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node as HTMLElement\n      }\n    })\n\n    // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n    if (endVoid) {\n      const [voidNode] = endVoid\n      const r = domRange.cloneRange()\n      const domNode = ReactEditor.toDOMNode(e, voidNode)\n      r.setEndAfter(domNode)\n      contents = r.cloneContents()\n    }\n\n    // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\n    }\n\n    // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\n      zw => {\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\n        zw.textContent = isNewline ? '\\n' : ''\n      }\n    )\n\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n    if (isDOMText(attach)) {\n      const span = attach.ownerDocument.createElement('span')\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n      span.style.whiteSpace = 'pre'\n      span.appendChild(attach)\n      contents.appendChild(span)\n      attach = span\n    }\n\n    const fragment = e.getFragment()\n    const string = JSON.stringify(fragment)\n    const encoded = window.btoa(encodeURIComponent(string))\n    attach.setAttribute('data-slate-fragment', encoded)\n    data.setData(`application/${clipboardFormatKey}`, encoded)\n\n    // Add the content to a <div> so that we can get its inner HTML.\n    const div = contents.ownerDocument.createElement('div')\n    div.appendChild(contents)\n    div.setAttribute('hidden', 'true')\n    contents.ownerDocument.body.appendChild(div)\n    data.setData('text/html', div.innerHTML)\n    data.setData('text/plain', getPlainText(div))\n    contents.ownerDocument.body.removeChild(div)\n    return data\n  }\n\n  e.insertData = (data: DataTransfer) => {\n    if (!e.insertFragmentData(data)) {\n      e.insertTextData(data)\n    }\n  }\n\n  e.insertFragmentData = (data: DataTransfer): boolean => {\n    /**\n     * Checking copied fragment from application/x-slate-fragment or data-slate-fragment\n     */\n    const fragment =\n      data.getData(`application/${clipboardFormatKey}`) ||\n      getSlateFragmentAttribute(data)\n\n    if (fragment) {\n      const decoded = decodeURIComponent(window.atob(fragment))\n      const parsed = JSON.parse(decoded) as Node[]\n      e.insertFragment(parsed)\n      return true\n    }\n    return false\n  }\n\n  e.insertTextData = (data: DataTransfer): boolean => {\n    const text = data.getData('text/plain')\n\n    if (text) {\n      const lines = text.split(/\\r\\n|\\r|\\n/)\n      let split = false\n\n      for (const line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, { always: true })\n        }\n\n        e.insertText(line)\n        split = true\n      }\n      return true\n    }\n    return false\n  }\n\n  e.onChange = options => {\n    // COMPAT: React < 18 doesn't batch `setState` hook calls, which means\n    // that the children and selection can get out of sync for one render\n    // pass. So we have to use this unstable API to ensure it batches them.\n    // (2019/12/03)\n    // https://github.com/facebook/react/issues/14259#issuecomment-439702367\n    const maybeBatchUpdates =\n      REACT_MAJOR_VERSION < 18\n        ? ReactDOM.unstable_batchedUpdates\n        : (callback: () => void) => callback()\n\n    maybeBatchUpdates(() => {\n      const onContextChange = EDITOR_TO_ON_CHANGE.get(e)\n\n      if (onContextChange) {\n        onContextChange()\n      }\n\n      onChange(options)\n    })\n  }\n\n  return e\n}\n\nconst getMatches = (e: Editor, path: Path) => {\n  const matches: [Path, Key][] = []\n  for (const [n, p] of Editor.levels(e, { at: path })) {\n    const key = ReactEditor.findKey(e, n)\n    matches.push([p, key])\n  }\n  return matches\n}\n"],"names":["EditorContext","createContext","useSlateStatic","editor","useContext","Error","REACT_MAJOR_VERSION","parseInt","React","version","split","IS_IOS","navigator","window","test","userAgent","MSStream","IS_APPLE","IS_ANDROID","IS_FIREFOX","IS_WEBKIT","IS_EDGE_LEGACY","IS_CHROME","IS_CHROME_LEGACY","IS_ANDROID_CHROME_LEGACY","IS_FIREFOX_LEGACY","IS_UC_MOBILE","IS_WECHATBROWSER","CAN_USE_DOM","document","createElement","HAS_BEFORE_INPUT_SUPPORT","globalThis","InputEvent","prototype","getTargetRanges","NODE_TO_INDEX","WeakMap","NODE_TO_PARENT","EDITOR_TO_WINDOW","EDITOR_TO_ELEMENT","EDITOR_TO_PLACEHOLDER_ELEMENT","ELEMENT_TO_NODE","NODE_TO_ELEMENT","NODE_TO_KEY","EDITOR_TO_KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","IS_COMPOSING","EDITOR_TO_USER_SELECTION","EDITOR_TO_ON_CHANGE","EDITOR_TO_SCHEDULE_FLUSH","EDITOR_TO_PENDING_INSERTION_MARKS","EDITOR_TO_USER_MARKS","EDITOR_TO_PENDING_DIFFS","EDITOR_TO_PENDING_ACTION","EDITOR_TO_PENDING_SELECTION","EDITOR_TO_FORCE_RENDER","PLACEHOLDER_SYMBOL","Symbol","MARK_PLACEHOLDER_SYMBOL","DOMText","Text","getDefaultView","value","ownerDocument","defaultView","isDOMComment","isDOMNode","nodeType","isDOMElement","Node","isDOMSelection","anchorNode","Selection","isDOMText","isPlainTextOnlyPaste","event","clipboardData","getData","types","length","normalizeDOMPoint","domPoint","node","offset","childNodes","isLast","index","getEditableChildAndIndex","i","getEditableChild","textContent","hasShadowRoot","parent","parentNode","toString","direction","child","triedForward","triedBackward","getAttribute","getPlainText","domNode","text","nodeValue","Array","from","childNode","display","getComputedStyle","getPropertyValue","tagName","catchSlateFragment","getSlateFragmentAttribute","dataTransfer","htmlData","match","fragment","isTrackedMutation","mutation","batch","target","matches","ReactEditor","getWindow","contains","hasDOMNode","editable","parentMutation","find","addedNodes","removedNodes","n","Key","id","androidPendingDiffs","get","androidScheduleFlush","blur","el","toDOMNode","root","findDocumentOrShadowRoot","set","activeElement","deselect","selection","domSelection","getSelection","rangeCount","removeAllRanges","Transforms","getRootNode","Document","ShadowRoot","findEventRange","nativeEvent","x","clientX","y","clientY","toSlateNode","path","findPath","Element","isElement","Editor","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","edge","point","before","after","range","domRange","caretRangeFromPoint","position","caretPositionFromPoint","createRange","setStart","offsetNode","setEnd","toSlateRange","exactMatch","suppressThrow","findKey","key","isEditor","unshift","Scrubber","stringify","focus","preventScroll","options","editorEl","targetEl","parentElement","err","message","includes","closest","isContentEditable","hasEditableTarget","hasRange","anchor","hasPath","hasSelectableTarget","isTargetInsideNonReadonlyVoid","hasTarget","insertData","data","insertFragmentData","insertTextData","isComposing","isFocused","isReadOnly","slateNode","setFragmentData","originEvent","KEY_TO_ELEMENT","toDOMPoint","at","selector","texts","querySelectorAll","start","attr","trueLength","end","nextText","hasAttribute","domText","startsWith","Math","min","max","toDOMRange","isBackward","Range","domAnchor","domFocus","isCollapsed","startNode","startOffset","endNode","endOffset","startEl","isStartAtZeroWidth","endEl","isEndAtZeroWidth","domEl","toSlatePoint","nearestNode","nearestOffset","textNode","potentialVoidNode","voidNode","leafNode","contents","cloneContents","removals","slice","call","forEach","textContext","removeChild","leafNodes","current","endsWith","querySelector","startContainer","anchorOffset","focusNode","focusOffset","firstRange","getRangeAt","lastRange","endContainer","collapsed","isExpanded","isForward","mode","unhangRange","voids","verifyDiffState","textDiff","diff","isText","nextPath","Path","next","nextNode","applyStringDiff","diffs","reduce","longestCommonPrefixLength","str","another","charAt","longestCommonSuffixLength","normalizeStringDiff","targetText","removedText","prefixLength","suffixLength","normalized","mergeStringDiffs","a","b","overlap","applied","sliceEnd","targetRange","normalizePoint","leaf","parentBlock","above","isBlock","entry","isDescendant","normalizeRange","transformPendingPoint","op","pendingDiffs","equals","Point","transform","affinity","transformed","type","transformPendingRange","transformTextDiff","newPath","RESOLVE_DELAY","FLUSH_DELAY","debug","isDataTransfer","constructor","name","createAndroidInputManager","scheduleOnDOMSelectionChange","onDOMSelectionChange","flushing","compositionEndTimeoutId","flushTimeoutId","actionTimeoutId","idCounter","insertPositionHint","applyPendingSelection","pendingSelection","select","performAction","action","isPoint","run","flush","clearTimeout","hasPendingDiffs","hasPendingAction","setTimeout","selectionRef","rangeRef","marks","scheduleSelectionChange","pendingMarks","undefined","insertText","deleteFragment","filter","cancel","unref","userMarks","onChange","handleCompositionEnd","_event","handleCompositionStart","updatePlaceholderVisibility","forceHide","placeholderElement","style","removeProperty","storeDiff","idx","findIndex","change","push","merged","splice","scheduleAction","handleDOMBeforeInput","inputType","nativeTargetRange","canStoreDiff","edges","relevantPendingDiffs","handleUserSelect","targetNode","deleteForward","nativeCollapsed","deleteBackward","unit","insertSoftBreak","insertBreak","replace","parts","line","hintPosition","search","diffPosition","scheduleFlush","hasPendingChanges","isFlushing","pathChanged","parentPathChanged","handleInput","handleKeyDown","_","handleDomMutations","mutations","some","useIsMounted","isMountedRef","useRef","useEffect","useIsomorphicLayoutEffect","useLayoutEffect","useMutationObserver","callback","useState","MutationObserver","mutationObserver","takeRecords","observe","disconnect","MUTATION_OBSERVER_CONFIG","subtree","childList","characterData","useAndroidInputManager","isMounted","inputManager","shallowCompare","obj1","obj2","Object","keys","every","hasOwnProperty","isDecorationFlagsEqual","other","rangeOwnProps","otherOwnProps","isElementDecorationsEqual","list","isTextDecorationsEqual","String","props","parentPath","isMarkPlaceholder","ZeroWidthString","string","children","isLineBreak","TextString","isTrailing","ref","getTextContent","initialText","textWithTrailing","MemoizedText","memo","forwardRef","attributes","disconnectPlaceholderResizeObserver","placeholderResizeObserver","releaseObserver","clearTimeoutRef","timeoutRef","Leaf","renderPlaceholder","renderLeaf","DefaultLeaf","placeholderRef","showPlaceholder","setShowPlaceholder","showPlaceholderTimeoutRef","callbackPlaceholderRef","useCallback","placeholderEl","onPlaceholderResize","ResizeObserver","ResizeObserverPolyfill","leafIsPlaceholder","placeholderProps","placeholder","pointerEvents","maxWidth","opacity","userSelect","textDecoration","WebkitUserModify","contentEditable","Fragment","MemoizedLeaf","prev","decorations","leaves","SlateText","callbackRef","span","element","renderElement","p","DefaultElement","readOnly","useReadOnly","useChildren","hasInlines","dir","getDirection","Tag","color","outline","MemoizedElement","DecorateContext","useDecorate","SelectedContext","useSelected","decorate","isLeafBlock","concat","sel","intersection","ds","dec","d","Provider","ElementComponent","TextComponent","ReadOnlyContext","SlateContext","useSlate","context","useSlateWithV","useTrackUserInput","receivedUserInput","animationFrameIdRef","onUserInput","cancelAnimationFrame","requestAnimationFrame","TRIPLE_CLICK","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","extendBackward","extendForward","italic","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isHotkey","isApple","isWindows","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSoftBreak","isSplitBlock","isTransposeCharacter","isUndo","require$$0","createRestoreDomManager","bufferedMutations","clear","registerMutations","trackedMutations","restoreDOM","reverse","insertBefore","nextSibling","characterDataOldValue","RestoreDOMComponent","manager","pendingMutations","Component","RestoreDOM","Children","Editable","defaultRenderPlaceholder","DefaultPlaceholder","autoFocus","defaultDecorate","propsOnDOMBeforeInput","onDOMBeforeInput","scrollSelectionIntoView","defaultScrollSelectionIntoView","userStyle","as","disableDefaultStyles","setIsComposing","deferredOperations","placeholderHeight","setPlaceholderHeight","useReducer","s","forceRender","state","useMemo","isDraggingInternally","isUpdatingSelection","latestElement","hasMarkPlaceholder","androidInputManagerRef","throttle","androidInputManager","anchorNodeSelectable","focusNodeSelectable","debounce","setDomSelection","forceChange","hasDomSelection","editorElement","hasDomSelectionInEditor","slateRange","newDomRange","collapseToEnd","setBaseAndExtent","ensureSelection","timeoutId","animationFrameId","ensureDomSelection","e","isDOMEventHandled","isCompositionChange","native","lastText","createTreeWalker","NodeFilter","SHOW_TEXT","lastChild","whiteSpace","block","preventDefault","toRestore","removeEventListener","addEventListener","placeHolderResizeHandler","rest","loose","unset","fromEntries","map","mark","role","spellCheck","autoCorrect","autoCapitalize","zindex","suppressContentEditableWarning","wordWrap","minHeight","onBeforeInput","isEventHandled","onInput","onBlur","relatedTarget","onClick","detail","blockPath","startVoid","endVoid","onCompositionEnd","placeholderMarks","onCompositionUpdate","onCompositionStart","inline","inlinePath","isEnd","setSelection","onCopy","isDOMEventTargetInput","onCut","onDragOver","onDragStart","voidMatch","onDrop","draggedRange","onDragEnd","onFocus","onKeyDown","isRTL","Hotkeys","maybeHistoryEditor","move","collapse","currentNode","onPaste","leafEl","bind","scrollIntoView","scrollMode","handler","shouldTreatEventAsHandled","isDefaultPrevented","isPropagationStopped","HTMLInputElement","HTMLTextAreaElement","defaultPrevented","FocusedContext","useFocused","isError","error","SlateSelectorContext","refEquality","useSlateSelector","equalityFn","getSlate","latestSubscriptionCallbackError","latestSelector","latestSelectedState","selectedState","stack","checkForUpdates","newSelectedState","unsubscribe","useSelectorContext","eventListeners","slateRef","listener","selectorContext","indexOf","Slate","initialValue","unmountRef","isNodeList","assign","v","setContext","handleSelectorChange","onContextChange","prevContext","setIsFocused","fn","useEditor","useSlateSelection","isSelectionEqual","doRectsIntersect","compareRect","middle","bottom","areRangesSameLine","range1","range2","rect1","rect2","findCurrentLineRange","parentRange","parentRangeBoundary","positions","right","floor","withReact","clipboardFormatKey","apply","addMark","removeMark","parentBlockEntry","parentBlockPath","parentElementRange","currentLineRange","Boolean","pendingAction","getMatches","prevPath","previous","commonPath","common","attach","trim","r","cloneRange","setEndAfter","zw","isNewline","appendChild","getFragment","JSON","encoded","btoa","encodeURIComponent","setAttribute","setData","div","body","innerHTML","decoded","decodeURIComponent","atob","parsed","parse","insertFragment","lines","splitNodes","always","maybeBatchUpdates","ReactDOM","unstable_batchedUpdates","levels"],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/slate-react.js b/dist/slate-react.js
index 964b2ee7ff47029dc7610dee723e87098a0b3ccd..d0b8c3221ff376f9a3bf11478073007d79fce2ad 100644
--- a/dist/slate-react.js
+++ b/dist/slate-react.js
@@ -1800,7 +1800,6 @@
 	    if (el) {
 	      if (isDOMSelection(domRange)) {
 	        // COMPAT: In firefox the normal seletion way does not work
-	        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)
 	        if (IS_FIREFOX && domRange.rangeCount > 1) {
 	          focusNode = domRange.focusNode; // Focus node works fine
 
@@ -1826,7 +1825,7 @@
 	        // `isCollapsed` for a Selection that comes from a ShadowRoot.
 	        // (2020/08/08)
 	        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523
-	        // IsCollapsed might not work in firefox, but this will
+	        // IsColapsed might not work in firefox, but this will
 
 
 	        if (IS_CHROME && hasShadowRoot(anchorNode) || IS_FIREFOX) {
@@ -5200,8 +5199,7 @@
 
 
 	      var focusNode = domSelection.focusNode;
-	      var anchorNode; // COMPAT: In firefox the normal seletion way does not work
-	      // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)
+	      var anchorNode;
 
 	      if (IS_FIREFOX && domSelection.rangeCount > 1) {
 	        var firstRange = domSelection.getRangeAt(0);
@@ -5279,12 +5277,7 @@
 	      }
 
 	      return newDomRange;
-	    }; // In firefox if there is more then 1 range and we call setDomSelection we remove the ability to select more cells in a table
-
-
-	    if (domSelection.rangeCount <= 1) {
-	      setDomSelection();
-	    }
+	    };
 
 	    var ensureSelection = ((_androidInputManagerR2 = androidInputManagerRef.current) === null || _androidInputManagerR2 === void 0 ? void 0 : _androidInputManagerR2.isFlushing()) === 'action';
 
diff --git a/dist/slate-react.min.js b/dist/slate-react.min.js
index a96c094b45229a90e1482cdfe60f83c9a0b8c525..84efff9b42bb3609eac96f0e2b0a02db3d825749 100644
--- a/dist/slate-react.min.js
+++ b/dist/slate-react.min.js
@@ -1 +1 @@
-!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("slate")):"function"==typeof define&&define.amd?define(["exports","react","slate"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SlateReact={},e.React,e.Slate)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=r(t),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var u=l(i((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0}))),s=i((function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}));l(s);var c=i((function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(i)throw a}}return o}},e.exports.default=e.exports,e.exports.__esModule=!0}));l(c);var f=i((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}));l(f);var d=i((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));l(d);var p=i((function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));l(p);var h=l(i((function(e){e.exports=function(e,t){return s(e)||c(e,t)||d(e,t)||p()},e.exports.default=e.exports,e.exports.__esModule=!0}))),v=i((function(e){e.exports=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a},e.exports.default=e.exports,e.exports.__esModule=!0}));l(v);var g=l(i((function(e){e.exports=function(e,t){if(null==e)return{};var n,r,a=v(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a},e.exports.default=e.exports,e.exports.__esModule=!0}))),m=function(e){if(e=String(e||""),w.test(e))return"rtl";if(k.test(e))return"ltr";return"neutral"},b="֑-߿יִ-﷽ﹰ-ﻼ",y="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",w=new RegExp("^[^"+y+"]*["+b+"]"),k=new RegExp("^[^"+b+"]*["+y+"]");var E=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},x="object"==typeof o&&o&&o.Object===Object&&o,S="object"==typeof self&&self&&self.Object===Object&&self,C=x||S||Function("return this")(),T=function(){return C.Date.now()},_=/\s/;var O=function(e){for(var t=e.length;t--&&_.test(e.charAt(t)););return t},P=/^\s+/;var D=function(e){return e?e.slice(0,O(e)+1).replace(P,""):e},N=C.Symbol,M=Object.prototype,R=M.hasOwnProperty,L=M.toString,F=N?N.toStringTag:void 0;var z=function(e){var t=R.call(e,F),n=e[F];try{e[F]=void 0;var r=!0}catch(e){}var a=L.call(e);return r&&(t?e[F]=n:delete e[F]),a},B=Object.prototype.toString;var I=function(e){return B.call(e)},A=N?N.toStringTag:void 0;var j=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":A&&A in Object(e)?z(e):I(e)};var W=function(e){return null!=e&&"object"==typeof e};var U=function(e){return"symbol"==typeof e||W(e)&&"[object Symbol]"==j(e)},V=/^[-+]0x[0-9a-f]+$/i,H=/^0b[01]+$/i,q=/^0o[0-7]+$/i,Q=parseInt;var K=function(e){if("number"==typeof e)return e;if(U(e))return NaN;if(E(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=E(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=D(e);var n=H.test(e);return n||q.test(e)?Q(e.slice(2),n?2:8):V.test(e)?NaN:+e},$=Math.max,Y=Math.min;var X=function(e,t,n){var r,a,o,l,i,u,s=0,c=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,o=a;return r=a=void 0,s=t,l=e.apply(o,n)}function h(e){return s=e,i=setTimeout(g,t),c?p(e):l}function v(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-s>=o}function g(){var e=T();if(v(e))return m(e);i=setTimeout(g,function(e){var n=t-(e-u);return f?Y(n,o-(e-s)):n}(e))}function m(e){return i=void 0,d&&r?p(e):(r=a=void 0,l)}function b(){var e=T(),n=v(e);if(r=arguments,a=this,u=e,n){if(void 0===i)return h(u);if(f)return clearTimeout(i),i=setTimeout(g,t),p(u)}return void 0===i&&(i=setTimeout(g,t)),l}return t=K(t)||0,E(n)&&(c=!!n.leading,o=(f="maxWait"in n)?$(K(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==i&&clearTimeout(i),s=0,r=u=a=i=void 0},b.flush=function(){return void 0===i?l:m(T())},b};var G=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return E(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),X(e,t,{leading:r,maxWait:t,trailing:a})};function J(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function Z(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function ee(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return Z(n.overflowY,t)||Z(n.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function te(e,t,n,r,a,o,l,i){return o<e&&l>t||o>e&&l<t?0:o<=e&&i<=n||l>=t&&i>=n?o-e-r:l>t&&i<n||o<e&&i>n?l-t+a:0}function ne(e,t){var n=window,r=t.scrollMode,a=t.block,o=t.inline,l=t.boundary,i=t.skipOverflowHiddenElements,u="function"==typeof l?l:function(e){return e!==l};if(!J(e))throw new TypeError("Invalid target");for(var s=document.scrollingElement||document.documentElement,c=[],f=e;J(f)&&u(f);){if((f=f.parentElement)===s){c.push(f);break}null!=f&&f===document.body&&ee(f)&&!ee(document.documentElement)||null!=f&&ee(f,i)&&c.push(f)}for(var d=n.visualViewport?n.visualViewport.width:innerWidth,p=n.visualViewport?n.visualViewport.height:innerHeight,h=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,g=e.getBoundingClientRect(),m=g.height,b=g.width,y=g.top,w=g.right,k=g.bottom,E=g.left,x="start"===a||"nearest"===a?y:"end"===a?k:y+m/2,S="center"===o?E+b/2:"end"===o?w:E,C=[],T=0;T<c.length;T++){var _=c[T],O=_.getBoundingClientRect(),P=O.height,D=O.width,N=O.top,M=O.right,R=O.bottom,L=O.left;if("if-needed"===r&&y>=0&&E>=0&&k<=p&&w<=d&&y>=N&&k<=R&&E>=L&&w<=M)return C;var F=getComputedStyle(_),z=parseInt(F.borderLeftWidth,10),B=parseInt(F.borderTopWidth,10),I=parseInt(F.borderRightWidth,10),A=parseInt(F.borderBottomWidth,10),j=0,W=0,U="offsetWidth"in _?_.offsetWidth-_.clientWidth-z-I:0,V="offsetHeight"in _?_.offsetHeight-_.clientHeight-B-A:0;if(s===_)j="start"===a?x:"end"===a?x-p:"nearest"===a?te(v,v+p,p,B,A,v+x,v+x+m,m):x-p/2,W="start"===o?S:"center"===o?S-d/2:"end"===o?S-d:te(h,h+d,d,z,I,h+S,h+S+b,b),j=Math.max(0,j+v),W=Math.max(0,W+h);else{j="start"===a?x-N-B:"end"===a?x-R+A+V:"nearest"===a?te(N,R,P,B,A+V,x,x+m,m):x-(N+P/2)+V/2,W="start"===o?S-L-z:"center"===o?S-(L+D/2)+U/2:"end"===o?S-M+I+U:te(L,M,D,z,I+U,S,S+b,b);var H=_.scrollLeft,q=_.scrollTop;x+=q-(j=Math.max(0,Math.min(q+j,_.scrollHeight-P+V))),S+=H-(W=Math.max(0,Math.min(H+W,_.scrollWidth-D+U)))}C.push({el:_,top:j,left:W})}return C}function re(e){return e===Object(e)&&0!==Object.keys(e).length}function ae(e,t){var n=!e.ownerDocument.documentElement.contains(e);if(re(t)&&"function"==typeof t.behavior)return t.behavior(n?[]:ne(e,t));if(!n){var r=function(e){return!1===e?{block:"end",inline:"nearest"}:re(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var r=e.el,a=e.top,o=e.left;r.scroll&&n?r.scroll({top:a,left:o,behavior:t}):(r.scrollTop=a,r.scrollLeft=o)}))}(ne(e,r),r.behavior)}}var oe=t.createContext(null),le=function(){var e=t.useContext(oe);if(!e)throw new Error("The `useSlateStatic` hook must be used inside the <Slate> component's context.");return e},ie=parseInt(a.default.version.split(".")[0],10),ue="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,se="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),ce="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent),fe="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),de="undefined"!=typeof navigator&&/AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent),pe="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])(?:\.)/i.test(navigator.userAgent),he="undefined"!=typeof navigator&&/Chrome/i.test(navigator.userAgent),ve="undefined"!=typeof navigator&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])(?:\.)/i.test(navigator.userAgent),ge=ce&&"undefined"!=typeof navigator&&/Chrome?\/(?:[0-5]?\d)(?:\.)/i.test(navigator.userAgent),me="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])(?:\.)).*/i.test(navigator.userAgent),be="undefined"!=typeof navigator&&/.*UCBrowser/.test(navigator.userAgent),ye="undefined"!=typeof navigator&&/.*Wechat/.test(navigator.userAgent),we=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),ke=(!ve||!ge)&&!pe&&"undefined"!=typeof globalThis&&globalThis.InputEvent&&"function"==typeof globalThis.InputEvent.prototype.getTargetRanges,Ee=new WeakMap,xe=new WeakMap,Se=new WeakMap,Ce=new WeakMap,Te=new WeakMap,_e=new WeakMap,Oe=new WeakMap,Pe=new WeakMap,De=new WeakMap,Ne=new WeakMap,Me=new WeakMap,Re=new WeakMap,Le=new WeakMap,Fe=new WeakMap,ze=new WeakMap,Be=new WeakMap,Ie=new WeakMap,Ae=new WeakMap,je=new WeakMap,We=new WeakMap,Ue=new WeakMap,Ve=Symbol("placeholder"),He=Symbol("mark-placeholder"),qe=i((function(e){e.exports=function(e){if(Array.isArray(e))return f(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));l(qe);var Qe=i((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));l(Qe);var Ke=i((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));l(Ke);var $e=l(i((function(e){e.exports=function(e){return qe(e)||Qe(e)||d(e)||Ke()},e.exports.default=e.exports,e.exports.__esModule=!0})));function Ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ge=globalThis.Text,Je=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||null},Ze=function(e){return et(e)&&1===e.nodeType},et=function(e){var t=Je(e);return!!t&&e instanceof t.Node},tt=function(e){var t=e&&e.anchorNode&&Je(e.anchorNode);return!!t&&e instanceof t.Selection},nt=function(e){return et(e)&&3===e.nodeType},rt=function(e,t,n){for(var r,a=e.childNodes,o=a[t],l=t,i=!1,u=!1;(et(r=o)&&8===r.nodeType||Ze(o)&&0===o.childNodes.length||Ze(o)&&"false"===o.getAttribute("contenteditable"))&&(!i||!u);)l>=a.length?(i=!0,l=t-1,n="backward"):l<0?(u=!0,l=t+1,n="forward"):(o=a[l],t=l,l+="forward"===n?1:-1);return[o,t]},at=function(e,t,n){var r=rt(e,t,n);return h(r,1)[0]},ot=function e(t){var n="";if(nt(t)&&t.nodeValue)return t.nodeValue;if(Ze(t)){for(var r=0,a=Array.from(t.childNodes);r<a.length;r++){n+=e(a[r])}var o=getComputedStyle(t).getPropertyValue("display");"block"!==o&&"list"!==o&&"BR"!==t.tagName||(n+="\n")}return n},lt=/data-slate-fragment="(.+?)"/m,it=function(e){var t=e.getData("text/html").match(lt)||[];return h(t,2)[1]},ut=function e(t,n,r){var a=n.target;if(Ze(a)&&a.matches('[contentEditable="false"]'))return!1;if(dt.getWindow(t).document.contains(a))return dt.hasDOMNode(t,a,{editable:!0});var o=r.find((function(e){var t,n=e.addedNodes,r=e.removedNodes,o=Ye(n);try{for(o.s();!(t=o.n()).done;){var l=t.value;if(l===a||l.contains(a))return!0}}catch(e){o.e(e)}finally{o.f()}var i,u=Ye(r);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s===a||s.contains(a))return!0}}catch(e){u.e(e)}finally{u.f()}}));return!(!o||o===n)&&e(t,o,r)},st=l(i((function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0}))),ct=0,ft=function e(){st(this,e),this.id="".concat(ct++)},dt={androidPendingDiffs:function(e){return Ae.get(e)},androidScheduleFlush:function(e){var t;null===(t=ze.get(e))||void 0===t||t()},blur:function(e){var t=dt.toDOMNode(e,e),n=dt.findDocumentOrShadowRoot(e);Me.set(e,!1),n.activeElement===t&&t.blur()},deselect:function(e){var t=e.selection,r=dt.findDocumentOrShadowRoot(e).getSelection();r&&r.rangeCount>0&&r.removeAllRanges(),t&&n.Transforms.deselect(e)},findDocumentOrShadowRoot:function(e){var t=dt.toDOMNode(e,e),n=t.getRootNode();return(n instanceof Document||n instanceof ShadowRoot)&&null!=n.getSelection?n:t.ownerDocument},findEventRange:function(e,t){"nativeEvent"in t&&(t=t.nativeEvent);var r=t,a=r.clientX,o=r.clientY,l=r.target;if(null==a||null==o)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));var i,u=dt.toSlateNode(e,t.target),s=dt.findPath(e,u);if(n.Element.isElement(u)&&n.Editor.isVoid(e,u)){var c=l.getBoundingClientRect(),f=e.isInline(u)?a-c.left<c.left+c.width-a:o-c.top<c.top+c.height-o,d=n.Editor.point(e,s,{edge:f?"start":"end"}),p=f?n.Editor.before(e,d):n.Editor.after(e,d);if(p)return n.Editor.range(e,p)}var h=dt.getWindow(e).document;if(h.caretRangeFromPoint)i=h.caretRangeFromPoint(a,o);else{var v=h.caretPositionFromPoint(a,o);v&&((i=h.createRange()).setStart(v.offsetNode,v.offset),i.setEnd(v.offsetNode,v.offset))}if(!i)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));return dt.toSlateRange(e,i,{exactMatch:!1,suppressThrow:!1})},findKey:function(e,t){var n=Pe.get(t);return n||(n=new ft,Pe.set(t,n)),n},findPath:function(e,t){for(var r=[],a=t;;){var o=xe.get(a);if(null==o){if(n.Editor.isEditor(a))return r;break}var l=Ee.get(a);if(null==l)break;r.unshift(l),a=o}throw new Error("Unable to find the path for Slate node: ".concat(n.Scrubber.stringify(t)))},focus:function(e){var t=dt.toDOMNode(e,e),n=dt.findDocumentOrShadowRoot(e);Me.set(e,!0),n.activeElement!==t&&t.focus({preventScroll:!0})},getWindow:function(e){var t=Se.get(e);if(!t)throw new Error("Unable to find a host window element for this editor");return t},hasDOMNode:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.editable,o=void 0!==a&&a,l=dt.toDOMNode(e,e);try{n=Ze(t)?t:t.parentElement}catch(e){if(!e.message.includes('Permission denied to access property "nodeType"'))throw e}return!!n&&!(n.closest("[data-slate-editor]")!==l||o&&!n.isContentEditable&&("boolean"!=typeof n.isContentEditable||n.closest('[contenteditable="false"]')!==l)&&!n.getAttribute("data-slate-zero-width"))},hasEditableTarget:function(e,t){return et(t)&&dt.hasDOMNode(e,t,{editable:!0})},hasRange:function(e,t){var r=t.anchor,a=t.focus;return n.Editor.hasPath(e,r.path)&&n.Editor.hasPath(e,a.path)},hasSelectableTarget:function(e,t){return dt.hasEditableTarget(e,t)||dt.isTargetInsideNonReadonlyVoid(e,t)},hasTarget:function(e,t){return et(t)&&dt.hasDOMNode(e,t)},insertData:function(e,t){e.insertData(t)},insertFragmentData:function(e,t){return e.insertFragmentData(t)},insertTextData:function(e,t){return e.insertTextData(t)},isComposing:function(e){return!!Re.get(e)},isFocused:function(e){return!!Me.get(e)},isReadOnly:function(e){return!!Ne.get(e)},isTargetInsideNonReadonlyVoid:function(e,t){if(Ne.get(e))return!1;var r=dt.hasTarget(e,t)&&dt.toSlateNode(e,t);return n.Element.isElement(r)&&n.Editor.isVoid(e,r)},setFragmentData:function(e,t,n){return e.setFragmentData(t,n)},toDOMNode:function(e,t){var r=De.get(e),a=n.Editor.isEditor(t)?Ce.get(e):null==r?void 0:r.get(dt.findKey(e,t));if(!a)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(n.Scrubber.stringify(t)));return a},toDOMPoint:function(e,t){var r,a=n.Editor.node(e,t.path),o=h(a,1)[0],l=dt.toDOMNode(e,o);n.Editor.void(e,{at:t})&&(t={path:t.path,offset:0});for(var i=Array.from(l.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),u=0,s=0;s<i.length;s++){var c=i[s],f=c.childNodes[0];if(null!=f&&null!=f.textContent){var d=f.textContent.length,p=c.getAttribute("data-slate-length"),v=u+(null==p?d:parseInt(p,10)),g=i[s+1];if(t.offset===v&&null!=g&&g.hasAttribute("data-slate-mark-placeholder")){var m,b=g.childNodes[0];r=[b instanceof Ge?b:g,null!==(m=g.textContent)&&void 0!==m&&m.startsWith("\ufeff")?1:0];break}if(t.offset<=v){r=[f,Math.min(d,Math.max(0,t.offset-u))];break}u=v}}if(!r)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(n.Scrubber.stringify(t)));return r},toDOMRange:function(e,t){var r=t.anchor,a=t.focus,o=n.Range.isBackward(t),l=dt.toDOMPoint(e,r),i=n.Range.isCollapsed(t)?l:dt.toDOMPoint(e,a),u=dt.getWindow(e).document.createRange(),s=h(o?i:l,2),c=s[0],f=s[1],d=h(o?l:i,2),p=d[0],v=d[1],g=!!(Ze(c)?c:c.parentElement).getAttribute("data-slate-zero-width"),m=!!(Ze(p)?p:p.parentElement).getAttribute("data-slate-zero-width");return u.setStart(c,g?1:f),u.setEnd(p,m?1:v),u},toSlateNode:function(e,t){var n=Ze(t)?t:t.parentElement;n&&!n.hasAttribute("data-slate-node")&&(n=n.closest("[data-slate-node]"));var r=n?_e.get(n):null;if(!r)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(n));return r},toSlatePoint:function(e,t,r){var a=r.exactMatch,o=r.suppressThrow,l=a?t:function(e){var t=h(e,2),n=t[0],r=t[1];if(Ze(n)&&n.childNodes.length){var a=r===n.childNodes.length,o=a?r-1:r,l=rt(n,o,a?"backward":"forward"),i=h(l,2);for(n=i[0],a=(o=i[1])<r;Ze(n)&&n.childNodes.length;){var u=a?n.childNodes.length-1:0;n=at(n,u,a?"backward":"forward")}r=a&&null!=n.textContent?n.textContent.length:0}return[n,r]}(t),i=h(l,2),u=i[0],s=i[1],c=u.parentNode,f=null,d=0;if(c){var p,v,g=dt.toDOMNode(e,e),m=c.closest('[data-slate-void="true"]'),b=m&&g.contains(m)?m:null,y=c.closest("[data-slate-leaf]"),w=null;if(y){if(f=y.closest('[data-slate-node="text"]')){var k=dt.getWindow(e).document.createRange();k.setStart(f,0),k.setEnd(u,s);var E=k.cloneContents();[].concat($e(Array.prototype.slice.call(E.querySelectorAll("[data-slate-zero-width]"))),$e(Array.prototype.slice.call(E.querySelectorAll("[contenteditable=false]")))).forEach((function(e){ce&&!a&&e.hasAttribute("data-slate-zero-width")&&e.textContent.length>0&&"\ufeff"!==e.textContext?e.textContent.startsWith("\ufeff")&&(e.textContent=e.textContent.slice(1)):e.parentNode.removeChild(e)})),d=E.textContent.length,w=f}}else if(b){for(var x=b.querySelectorAll("[data-slate-leaf]"),S=0;S<x.length;S++){var C=x[S];if(dt.hasDOMNode(e,C)){y=C;break}}y?(f=y.closest('[data-slate-node="text"]'),d=(w=y).textContent.length,w.querySelectorAll("[data-slate-zero-width]").forEach((function(e){d-=e.textContent.length}))):d=1}w&&d===w.textContent.length&&ce&&"z"===w.getAttribute("data-slate-zero-width")&&null!==(p=w.textContent)&&void 0!==p&&p.startsWith("\ufeff")&&(c.hasAttribute("data-slate-zero-width")||fe&&null!==(v=w.textContent)&&void 0!==v&&v.endsWith("\n\n"))&&d--}if(ce&&!f&&!a){var T=c.hasAttribute("data-slate-node")?c:c.closest("[data-slate-node]");if(T&&dt.hasDOMNode(e,T,{editable:!0})){var _=dt.toSlateNode(e,T),O=n.Editor.start(e,dt.findPath(e,_)),P=O.path,D=O.offset;return T.querySelector("[data-slate-leaf]")||(D=s),{path:P,offset:D}}}if(!f){if(o)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t))}var N=dt.toSlateNode(e,f);return{path:dt.findPath(e,N),offset:d}},toSlateRange:function(e,t,r){var a,o,l,i,u,s,c=r.exactMatch,f=r.suppressThrow;if(tt(t)?t.anchorNode:t.startContainer)if(tt(t)){if(fe&&t.rangeCount>1){l=t.focusNode;var d=t.getRangeAt(0),p=t.getRangeAt(t.rangeCount-1);d.startContainer===l?(a=p.endContainer,o=p.endOffset,i=d.startOffset):(a=d.startContainer,o=d.endOffset,i=p.startOffset)}else a=t.anchorNode,o=t.anchorOffset,l=t.focusNode,i=t.focusOffset;u=he&&function(e){for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1}(a)||fe?t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset:t.isCollapsed}else a=t.startContainer,o=t.startOffset,l=t.endContainer,i=t.endOffset,u=t.collapsed;if(null==a||null==l||null==o||null==i)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));"getAttribute"in l&&"false"===l.getAttribute("contenteditable")&&"true"!==l.getAttribute("data-slate-void")&&(l=a,i=(null===(s=a.textContent)||void 0===s?void 0:s.length)||0);var h=dt.toSlatePoint(e,[a,o],{exactMatch:c,suppressThrow:f});if(!h)return null;var v=u?h:dt.toSlatePoint(e,[l,i],{exactMatch:c,suppressThrow:f});if(!v)return null;var g={anchor:h,focus:v};return n.Range.isExpanded(g)&&n.Range.isForward(g)&&Ze(l)&&n.Editor.void(e,{at:g.focus,mode:"highest"})&&(g=n.Editor.unhangRange(e,g,{voids:!0})),g}};function pt(e,t){var r=t.path,a=t.diff;if(!n.Editor.hasPath(e,r))return!1;var o=n.Node.get(e,r);if(!n.Text.isText(o))return!1;if(a.start!==o.text.length||0===a.text.length)return o.text.slice(a.start,a.start+a.text.length)===a.text;var l=n.Path.next(r);if(!n.Editor.hasPath(e,l))return!1;var i=n.Node.get(e,l);return n.Text.isText(i)&&i.text.startsWith(a.text)}function ht(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return e.slice(0,t.start)+t.text+e.slice(t.end)}),e)}function vt(e,t){var n=t.start,r=t.end,a=t.text,o=e.slice(n,r),l=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++)if(e.charAt(r)!==t.charAt(r))return r;return n}(o,a),i=function(e,t,n){for(var r=Math.min(e.length,t.length,n),a=0;a<r;a++)if(e.charAt(e.length-a-1)!==t.charAt(t.length-a-1))return a;return r}(o,a,Math.min(o.length-l,a.length-l)),u={start:n+l,end:r-i,text:a.slice(l,a.length-i)};return u.start===u.end&&0===u.text.length?null:u}function gt(e){var t=e.path,n=e.diff;return{anchor:{path:t,offset:n.start},focus:{path:t,offset:n.end}}}function mt(e,t){var r=t.path,a=t.offset;if(!n.Editor.hasPath(e,r))return null;var o=n.Node.get(e,r);if(!n.Text.isText(o))return null;var l=n.Editor.above(e,{match:function(t){return n.Element.isElement(t)&&n.Editor.isBlock(e,t)},at:r});if(!l)return null;for(;a>o.text.length;){var i=n.Editor.next(e,{at:r,match:n.Text.isText});if(!i||!n.Path.isDescendant(i[1],l[1]))return null;a-=o.text.length,o=i[0],r=i[1]}return{path:r,offset:a}}function bt(e,t){var r=mt(e,t.anchor);if(!r)return null;if(n.Range.isCollapsed(t))return{anchor:r,focus:r};var a=mt(e,t.focus);return a?{anchor:r,focus:a}:null}function yt(e,t,r){var a=Ae.get(e),o=null==a?void 0:a.find((function(e){var r=e.path;return n.Path.equals(r,t.path)}));if(!o||t.offset<=o.diff.start)return n.Point.transform(t,r,{affinity:"backward"});var l=o.diff;if(t.offset<=l.start+l.text.length){var i={path:t.path,offset:l.start},u=n.Point.transform(i,r,{affinity:"backward"});return u?{path:u.path,offset:u.offset+t.offset-l.start}:null}var s={path:t.path,offset:t.offset-l.text.length+l.end-l.start},c=n.Point.transform(s,r,{affinity:"backward"});return c?"split_node"===r.type&&n.Path.equals(r.path,t.path)&&s.offset<r.position&&l.start<r.position?c:{path:c.path,offset:c.offset+l.text.length-l.end+l.start}:null}function wt(e,t,r){var a=yt(e,t.anchor,r);if(!a)return null;if(n.Range.isCollapsed(t))return{anchor:a,focus:a};var o=yt(e,t.focus,r);return o?{anchor:a,focus:o}:null}function kt(e,t){var r=e.path,a=e.diff,o=e.id;switch(t.type){case"insert_text":return!n.Path.equals(t.path,r)||t.offset>=a.end?e:t.offset<=a.start?{diff:{start:t.text.length+a.start,end:t.text.length+a.end,text:a.text},id:o,path:r}:{diff:{start:a.start,end:a.end+t.text.length,text:a.text},id:o,path:r};case"remove_text":return!n.Path.equals(t.path,r)||t.offset>=a.end?e:t.offset+t.text.length<=a.start?{diff:{start:a.start-t.text.length,end:a.end-t.text.length,text:a.text},id:o,path:r}:{diff:{start:a.start,end:a.end-t.text.length,text:a.text},id:o,path:r};case"split_node":return!n.Path.equals(t.path,r)||t.position>=a.end?{diff:a,id:o,path:n.Path.transform(r,t,{affinity:"backward"})}:t.position>a.start?{diff:{start:a.start,end:Math.min(t.position,a.end),text:a.text},id:o,path:r}:{diff:{start:a.start-t.position,end:a.end-t.position,text:a.text},id:o,path:n.Path.transform(r,t,{affinity:"forward"})};case"merge_node":return n.Path.equals(t.path,r)?{diff:{start:a.start+t.position,end:a.end+t.position,text:a.text},id:o,path:n.Path.transform(r,t)}:{diff:a,id:o,path:n.Path.transform(r,t)}}var l=n.Path.transform(r,t);return l?{diff:a,path:l,id:o}:null}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e){var t=e.editor,r=e.scheduleOnDOMSelectionChange,a=e.onDOMSelectionChange,o=!1,l=null,i=null,u=null,s=0,c=!1,f=function(){var e=We.get(t);if(We.delete(t),e){var r=t.selection,a=bt(t,e);!a||r&&n.Range.equals(a,r)||n.Transforms.select(t,a)}},d=function(){if(i&&(clearTimeout(i),i=null),u&&(clearTimeout(u),u=null),b()||m()){o||(o=!0,setTimeout((function(){return o=!1}))),m()&&(o="action");var e=t.selection&&n.Editor.rangeRef(t,t.selection,{affinity:"forward"});Ie.set(t,t.marks),je.get(t),Ae.get(t);for(var l,s=b();l=null===(d=Ae.get(t))||void 0===d?void 0:d[0];){var d,p,h=Be.get(t);void 0!==h&&(Be.delete(t),t.marks=h),h&&!1===c&&(c=null);var v=gt(l);t.selection&&n.Range.equals(t.selection,v)||n.Transforms.select(t,v),l.diff.text?n.Editor.insertText(t,l.diff.text):n.Editor.deleteFragment(t),Ae.set(t,null===(p=Ae.get(t))||void 0===p?void 0:p.filter((function(e){return e.id!==l.id}))),pt(t,l)||(s=!1,je.delete(t),Ie.delete(t),o="action",We.delete(t),r.cancel(),a.cancel(),null==e||e.unref())}var g=null==e?void 0:e.unref();if(!g||We.get(t)||t.selection&&n.Range.equals(g,t.selection)||n.Transforms.select(t,g),m())!function(){var e=je.get(t);if(je.delete(t),e){if(e.at){var r=n.Point.isPoint(e.at)?mt(t,e.at):bt(t,e.at);if(!r)return;var a=n.Editor.range(t,r);t.selection&&n.Range.equals(t.selection,a)||n.Transforms.select(t,r)}e.run()}}();else{s&&r(),r.flush(),a.flush(),f();var y=Ie.get(t);Ie.delete(t),void 0!==y&&(t.marks=y,t.onChange())}}else f()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Te.get(t);n&&(b()||e?n.style.display="none":n.style.removeProperty("display"))},v=function(e,r){var a,o=null!==(a=Ae.get(t))&&void 0!==a?a:[];Ae.set(t,o);var l=n.Node.leaf(t,e),i=o.findIndex((function(t){return n.Path.equals(t.path,e)}));if(i<0)return vt(l.text,r)&&o.push({path:e,diff:r,id:s++}),void p();var u=function(e,t,n){var r=Math.min(t.start,n.start),a=Math.max(0,Math.min(t.start+t.text.length,n.end)-n.start),o=ht(e,t,n),l=Math.max(n.start+n.text.length,t.start+t.text.length+(t.start+t.text.length>n.start?n.text.length:0)-a),i=o.slice(r,l);return vt(e,{start:r,end:Math.max(t.end,n.end-t.text.length+(t.end-t.start)),text:i})}(l.text,o[i].diff,r);if(!u)return o.splice(i,1),void p();o[i]=xt(xt({},o[i]),{},{diff:u})},g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.at;c=!1,We.delete(t),r.cancel(),a.cancel(),m()&&d(),je.set(t,{at:o,run:e}),u=setTimeout(d)},m=function(){return!!je.get(t)},b=function(){var e;return!(null===(e=Ae.get(t))||void 0===e||!e.length)},y=function(e){We.set(t,e),i&&(clearTimeout(i),i=null);var r=t.selection;if(e){var a=!r||!n.Path.equals(r.anchor.path,e.anchor.path),o=!r||!n.Path.equals(r.anchor.path.slice(0,-1),e.anchor.path.slice(0,-1));(a&&c||o)&&(c=!1),(a||b())&&(i=setTimeout(d,200))}},w=function(){m()||(u=setTimeout(d))};return{flush:d,scheduleFlush:w,hasPendingDiffs:b,hasPendingAction:m,hasPendingChanges:function(){return m()||b()},isFlushing:function(){return o},handleUserSelect:y,handleCompositionEnd:function(e){l&&clearTimeout(l),l=setTimeout((function(){Re.set(t,!1),d()}),25)},handleCompositionStart:function(e){Re.set(t,!0),l&&(clearTimeout(l),l=null)},handleDOMBeforeInput:function(e){var r;i&&(clearTimeout(i),i=null);var a=e.inputType,o=null,l=e.dataTransfer||e.data||void 0;!1!==c&&"insertText"!==a&&"insertCompositionText"!==a&&(c=!1);var u=e.getTargetRanges(),s=h(u,1)[0];s&&(o=dt.toSlateRange(t,s,{exactMatch:!1,suppressThrow:!0}));var f=dt.getWindow(t).getSelection();if(!o&&f&&(s=f,o=dt.toSlateRange(t,f,{exactMatch:!1,suppressThrow:!0})),o=null!==(r=o)&&void 0!==r?r:t.selection){var d,p=!0;if(a.startsWith("delete")){if(n.Range.isExpanded(o)){var m=n.Range.edges(o),b=h(m,2),k=b[0],E=b[1];if(n.Node.leaf(t,k.path).text.length===k.offset&&0===E.offset){var x=n.Editor.next(t,{at:k.path,match:n.Text.isText});x&&n.Path.equals(x[1],E.path)&&(o={anchor:E,focus:E})}}var S=a.endsWith("Backward")?"backward":"forward",C=n.Range.edges(o),T=h(C,2),_=T[0],O=T[1],P=n.Editor.leaf(t,_.path),D=h(P,2),N=D[0],M=D[1],R={text:"",start:_.offset,end:O.offset},L=Ae.get(t),F=null==L?void 0:L.find((function(e){return n.Path.equals(e.path,M)})),z=F?[F.diff,R]:[R];if(0===ht.apply(void 0,[N.text].concat(z)).length&&(p=!1),n.Range.isExpanded(o)){if(p&&n.Path.equals(o.anchor.path,o.focus.path)){var B={path:o.anchor.path,offset:_.offset},I=n.Editor.range(t,B,B);return y(I),v(o.anchor.path,{text:"",end:O.offset,start:_.offset})}return g((function(){return n.Editor.deleteFragment(t,{direction:S})}),{at:o})}}switch(a){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":return g((function(){return n.Editor.deleteFragment(t)}),{at:o});case"deleteContent":case"deleteContentForward":var A=o.anchor;if(p&&n.Range.isCollapsed(o)){var j=n.Node.leaf(t,A.path);if(A.offset<j.text.length)return v(A.path,{text:"",start:A.offset,end:A.offset+1})}return g((function(){return n.Editor.deleteForward(t)}),{at:o});case"deleteContentBackward":var W,U=o.anchor,V=tt(s)?s.isCollapsed:!(null===(W=s)||void 0===W||!W.collapsed);return p&&V&&n.Range.isCollapsed(o)&&U.offset>0?v(U.path,{text:"",start:U.offset-1,end:U.offset}):g((function(){return n.Editor.deleteBackward(t)}),{at:o});case"deleteEntireSoftLine":return g((function(){n.Editor.deleteBackward(t,{unit:"line"}),n.Editor.deleteForward(t,{unit:"line"})}),{at:o});case"deleteHardLineBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"block"})}),{at:o});case"deleteSoftLineBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"line"})}),{at:o});case"deleteHardLineForward":return g((function(){return n.Editor.deleteForward(t,{unit:"block"})}),{at:o});case"deleteSoftLineForward":return g((function(){return n.Editor.deleteForward(t,{unit:"line"})}),{at:o});case"deleteWordBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"word"})}),{at:o});case"deleteWordForward":return g((function(){return n.Editor.deleteForward(t,{unit:"word"})}),{at:o});case"insertLineBreak":return g((function(){return n.Editor.insertSoftBreak(t)}),{at:o});case"insertParagraph":return g((function(){return n.Editor.insertBreak(t)}),{at:o});case"insertCompositionText":case"deleteCompositionText":case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":if("DataTransfer"===(null==(d=l)?void 0:d.constructor.name))return g((function(){return dt.insertData(t,l)}),{at:o});var H=null!=l?l:"";if(Be.get(t)&&(H=H.replace("\ufeff","")),"insertText"===a&&/.*\n.*\n$/.test(H)&&(H=H.slice(0,-1)),H.includes("\n"))return g((function(){var e=H.split("\n");e.forEach((function(r,a){r&&n.Editor.insertText(t,r),a!==e.length-1&&n.Editor.insertSoftBreak(t)}))}),{at:o});if(n.Path.equals(o.anchor.path,o.focus.path)){var q=n.Range.edges(o),Q=h(q,2),K=Q[0],$=Q[1],Y={start:K.offset,end:$.offset,text:H};if(H&&c&&"insertCompositionText"===a){var X=c.start+c.text.search(/\S|$/);Y.start+Y.text.search(/\S|$/)===X+1&&Y.end===c.start+c.text.length?(Y.start-=1,c=null,w()):c=!1}else c="insertText"===a&&(null===c?Y:!(!c||!n.Range.isCollapsed(o)||c.end+c.text.length!==K.offset)&&xt(xt({},c),{},{text:c.text+H}));if(p)return void v(K.path,Y)}return g((function(){return n.Editor.insertText(t,H)}),{at:o})}}},handleKeyDown:function(e){b()||(p(!0),setTimeout(p))},handleDomMutations:function(e){var n;b()||m()||e.some((function(n){return ut(t,n,e)}))&&(null===(n=Ue.get(t))||void 0===n||n())},handleInput:function(){!m()&&b()||d()}}}var Ct=we?t.useLayoutEffect:t.useEffect;var Tt=["node"];function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ot,Pt={subtree:!0,childList:!0,characterData:!0},Dt=ce?function(e){var n=e.node,r=g(e,Tt);if(!ce)return null;var a,o=le(),l=(a=t.useRef(!1),t.useEffect((function(){return a.current=!0,function(){a.current=!1}}),[]),a.current),i=t.useState((function(){return St(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({editor:o},r))})),s=h(i,1)[0];return function(e,n,r){var a=t.useState((function(){return new MutationObserver(n)})),o=h(a,1)[0];Ct((function(){o.takeRecords()})),t.useEffect((function(){if(!e.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");return o.observe(e.current,r),function(){return o.disconnect()}}),[o,e,r])}(n,s.handleDomMutations,Pt),ze.set(o,s.scheduleFlush),l&&s.flush(),s}:function(){return null},Nt=["anchor","focus"],Mt=["anchor","focus"],Rt=function(e,t){e.anchor,e.focus;var n=g(e,Nt);t.anchor,t.focus;var r,a,o=g(t,Mt);return e[Ve]===t[Ve]&&(r=n,a=o,Object.keys(r).length===Object.keys(a).length&&Object.keys(r).every((function(e){return a.hasOwnProperty(e)&&r[e]===a[e]})))},Lt=[],Ft="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(Ot||(Ot={}));var zt,Bt=function(e){return Object.freeze(e)},It=function(e,t){this.inlineSize=e,this.blockSize=t,Bt(this)},At=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Bt(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),jt=function(e){return e instanceof SVGElement&&"getBBox"in e},Wt=function(e){if(jt(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var a=e,o=a.offsetWidth,l=a.offsetHeight;return!(o||l||e.getClientRects().length)},Ut=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},Vt="undefined"!=typeof window?window:{},Ht=new WeakMap,qt=/auto|scroll/,Qt=/^tb|vertical/,Kt=/msie|trident/i.test(Vt.navigator&&Vt.navigator.userAgent),$t=function(e){return parseFloat(e||"0")},Yt=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new It((n?t:e)||0,(n?e:t)||0)},Xt=Bt({devicePixelContentBoxSize:Yt(),borderBoxSize:Yt(),contentBoxSize:Yt(),contentRect:new At(0,0,0,0)}),Gt=function(e,t){if(void 0===t&&(t=!1),Ht.has(e)&&!t)return Ht.get(e);if(Wt(e))return Ht.set(e,Xt),Xt;var n=getComputedStyle(e),r=jt(e)&&e.ownerSVGElement&&e.getBBox(),a=!Kt&&"border-box"===n.boxSizing,o=Qt.test(n.writingMode||""),l=!r&&qt.test(n.overflowY||""),i=!r&&qt.test(n.overflowX||""),u=r?0:$t(n.paddingTop),s=r?0:$t(n.paddingRight),c=r?0:$t(n.paddingBottom),f=r?0:$t(n.paddingLeft),d=r?0:$t(n.borderTopWidth),p=r?0:$t(n.borderRightWidth),h=r?0:$t(n.borderBottomWidth),v=f+s,g=u+c,m=(r?0:$t(n.borderLeftWidth))+p,b=d+h,y=i?e.offsetHeight-b-e.clientHeight:0,w=l?e.offsetWidth-m-e.clientWidth:0,k=a?v+m:0,E=a?g+b:0,x=r?r.width:$t(n.width)-k-w,S=r?r.height:$t(n.height)-E-y,C=x+v+w+m,T=S+g+y+b,_=Bt({devicePixelContentBoxSize:Yt(Math.round(x*devicePixelRatio),Math.round(S*devicePixelRatio),o),borderBoxSize:Yt(C,T,o),contentBoxSize:Yt(x,S,o),contentRect:new At(f,u,x,S)});return Ht.set(e,_),_},Jt=function(e,t,n){var r=Gt(e,n),a=r.borderBoxSize,o=r.contentBoxSize,l=r.devicePixelContentBoxSize;switch(t){case Ot.DEVICE_PIXEL_CONTENT_BOX:return l;case Ot.BORDER_BOX:return a;default:return o}},Zt=function(e){var t=Gt(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Bt([t.borderBoxSize]),this.contentBoxSize=Bt([t.contentBoxSize]),this.devicePixelContentBoxSize=Bt([t.devicePixelContentBoxSize])},en=function(e){if(Wt(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},tn=function(){var e=1/0,t=[];Lt.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new Zt(t.target),a=en(t.target);r.push(n),t.lastReportedSize=Jt(t.target,t.observedBox),a<e&&(e=a)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,r=t;n<r.length;n++){(0,r[n])()}return e},nn=function(e){Lt.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(en(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},rn=function(){var e,t=0;for(nn(t);Lt.some((function(e){return e.activeTargets.length>0}));)t=tn(),nn(t);return Lt.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:Ft}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=Ft),window.dispatchEvent(e)),t>0},an=[],on=function(e){if(!zt){var t=0,n=document.createTextNode("");new MutationObserver((function(){return an.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),zt=function(){n.textContent="".concat(t?t--:t++)}}an.push(e),zt()},ln=0,un={attributes:!0,characterData:!0,childList:!0,subtree:!0},sn=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],cn=function(e){return void 0===e&&(e=0),Date.now()+e},fn=!1,dn=function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!fn){fn=!0;var n=cn(e);!function(e){on((function(){requestAnimationFrame(e)}))}((function(){var r=!1;try{r=rn()}finally{if(fn=!1,e=n-cn(),!ln)return;r?t.run(1e3):e>0?t.run(e):t.start()}}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,un)};document.body?t():Vt.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),sn.forEach((function(t){return Vt.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),sn.forEach((function(t){return Vt.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}(),pn=new dn,hn=function(e){!ln&&e>0&&pn.start(),!(ln+=e)&&pn.stop()},vn=function(){function e(e,t){this.target=e,this.observedBox=t||Ot.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=Jt(this.target,this.observedBox,!0);return e=this.target,jt(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),gn=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},mn=new WeakMap,bn=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},yn=function(){function e(){}return e.connect=function(e,t){var n=new gn(e,t);mn.set(e,n)},e.observe=function(e,t,n){var r=mn.get(e),a=0===r.observationTargets.length;bn(r.observationTargets,t)<0&&(a&&Lt.push(r),r.observationTargets.push(new vn(t,n&&n.box)),hn(1),pn.schedule())},e.unobserve=function(e,t){var n=mn.get(e),r=bn(n.observationTargets,t),a=1===n.observationTargets.length;r>=0&&(a&&Lt.splice(Lt.indexOf(n),1),n.observationTargets.splice(r,1),hn(-1))},e.disconnect=function(e){var t=this,n=mn.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),wn=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");yn.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ut(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");yn.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ut(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");yn.unobserve(this,e)},e.prototype.disconnect=function(){yn.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),kn=function(e){var t=e.isLast,r=e.leaf,o=e.parent,l=e.text,i=le(),u=dt.findPath(i,l),s=n.Path.parent(u),c=!0===r[He];return i.isVoid(o)?a.default.createElement(Sn,{length:n.Node.string(o).length}):""!==r.text||o.children[o.children.length-1]!==l||i.isInline(o)||""!==n.Editor.string(i,s)?""===r.text?a.default.createElement(Sn,{isMarkPlaceholder:c}):t&&"\n"===r.text.slice(-1)?a.default.createElement(En,{isTrailing:!0,text:r.text}):a.default.createElement(En,{text:r.text}):a.default.createElement(Sn,{isLineBreak:!0,isMarkPlaceholder:c})},En=function(e){var n=e.text,r=e.isTrailing,o=void 0!==r&&r,l=t.useRef(null),i=function(){return"".concat(null!=n?n:"").concat(o?"\n":"")},u=t.useState(i),s=h(u,1)[0];return Ct((function(){var e=i();l.current&&l.current.textContent!==e&&(l.current.textContent=e)})),a.default.createElement(xn,{ref:l},s)},xn=t.memo(t.forwardRef((function(e,t){return a.default.createElement("span",{"data-slate-string":!0,ref:t},e.children)}))),Sn=function(e){var t=e.length,n=void 0===t?0:t,r=e.isLineBreak,o=void 0!==r&&r,l=e.isMarkPlaceholder,i={"data-slate-zero-width":o?"n":"z","data-slate-length":n};return void 0!==l&&l&&(i["data-slate-mark-placeholder"]=!0),a.default.createElement("span",Object.assign({},i),ce&&o?null:"\ufeff",o?a.default.createElement("br",null):null)};function Cn(e){e.current&&(clearTimeout(e.current),e.current=null)}var Tn=function(e){var n=e.leaf,r=e.isLast,o=e.text,l=e.parent,i=e.renderPlaceholder,u=e.renderLeaf,s=void 0===u?function(e){return a.default.createElement(On,Object.assign({},e))}:u,c=le(),f=t.useRef(null),d=t.useRef(null),p=t.useState(!1),v=h(p,2),g=v[0],m=v[1],b=t.useRef(null),y=t.useCallback((function(e){if(function(e,t){e.current&&(e.current.disconnect(),t&&(e.current=null))}(f,null==e),null==e){var t;Te.delete(c),null===(t=n.onPlaceholderResize)||void 0===t||t.call(n,null)}else{if(Te.set(c,e),!f.current){var r=window.ResizeObserver||wn;f.current=new r((function(){var t;null===(t=n.onPlaceholderResize)||void 0===t||t.call(n,e)}))}f.current.observe(e),d.current=e}}),[d,n,c]),w=a.default.createElement(kn,{isLast:r,leaf:n,parent:l,text:o}),k=n[Ve];if(t.useEffect((function(){return k?b.current||(b.current=setTimeout((function(){m(!0),b.current=null}),300)):(Cn(b),m(!1)),function(){return Cn(b)}}),[k,m]),k&&g){var E={children:n.placeholder,attributes:{"data-slate-placeholder":!0,style:{position:"absolute",top:0,pointerEvents:"none",width:"100%",maxWidth:"100%",display:"block",opacity:"0.333",userSelect:"none",textDecoration:"none",WebkitUserModify:de?"inherit":void 0},contentEditable:!1,ref:y}};w=a.default.createElement(a.default.Fragment,null,i(E),w)}return s({attributes:{"data-slate-leaf":!0},children:w,leaf:n,text:o})},_n=a.default.memo(Tn,(function(e,t){return t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&n.Text.equals(t.leaf,e.leaf)&&t.leaf[Ve]===e.leaf[Ve]})),On=function(e){var t=e.attributes,n=e.children;return a.default.createElement("span",Object.assign({},t),n)},Pn=function(e){for(var r=e.decorations,o=e.isLast,l=e.parent,i=e.renderPlaceholder,u=e.renderLeaf,s=e.text,c=le(),f=t.useRef(null),d=n.Text.decorations(s,r),p=dt.findKey(c,s),h=[],v=0;v<d.length;v++){var g=d[v];h.push(a.default.createElement(_n,{isLast:o&&v===d.length-1,key:"".concat(p.id,"-").concat(v),renderPlaceholder:i,leaf:g,text:s,parent:l,renderLeaf:u}))}var m=t.useCallback((function(e){var t=De.get(c);e?(null==t||t.set(p,e),Oe.set(s,e),_e.set(e,s)):(null==t||t.delete(p),Oe.delete(s),f.current&&_e.delete(f.current)),f.current=e}),[f,c,p,s]);return a.default.createElement("span",{"data-slate-node":"text",ref:m},h)},Dn=a.default.memo(Pn,(function(e,t){return t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(r.anchor.offset!==a.anchor.offset||r.focus.offset!==a.focus.offset||!Rt(r,a))return!1}return!0}(t.decorations,e.decorations)})),Nn=function(e){var r=e.decorations,o=e.element,l=e.renderElement,i=void 0===l?function(e){return a.default.createElement(Rn,Object.assign({},e))}:l,u=e.renderPlaceholder,s=e.renderLeaf,c=e.selection,f=le(),d=jn(),p=f.isInline(o),v=dt.findKey(f,o),g=t.useCallback((function(e){var t=De.get(f);e?(null==t||t.set(v,e),Oe.set(o,e),_e.set(e,o)):(null==t||t.delete(v),Oe.delete(o))}),[f,v,o]),b=In({decorations:r,node:o,renderElement:i,renderPlaceholder:u,renderLeaf:s,selection:c}),y={"data-slate-node":"element",ref:g};if(p&&(y["data-slate-inline"]=!0),!p&&n.Editor.hasInlines(f,o)){var w=n.Node.string(o),k=m(w);"rtl"===k&&(y.dir=k)}if(n.Editor.isVoid(f,o)){y["data-slate-void"]=!0,!d&&p&&(y.contentEditable=!1);var E=p?"span":"div",x=n.Node.texts(o),S=h(x,1),C=h(S[0],1)[0];b=a.default.createElement(E,{"data-slate-spacer":!0,style:{height:"0",color:"transparent",outline:"none",position:"absolute"}},a.default.createElement(Dn,{renderPlaceholder:u,decorations:[],isLast:!1,parent:o,text:C})),Ee.set(C,0),xe.set(C,o)}return i({attributes:y,children:b,element:o})},Mn=a.default.memo(Nn,(function(e,t){return e.element===t.element&&e.renderElement===t.renderElement&&e.renderLeaf===t.renderLeaf&&e.renderPlaceholder===t.renderPlaceholder&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var a=e[r],o=t[r];if(!n.Range.equals(a,o)||!Rt(a,o))return!1}return!0}(e.decorations,t.decorations)&&(e.selection===t.selection||!!e.selection&&!!t.selection&&n.Range.equals(e.selection,t.selection))})),Rn=function(e){var t=e.attributes,n=e.children,r=e.element,o=le().isInline(r)?"span":"div";return a.default.createElement(o,Object.assign({},t,{style:{position:"relative"}}),n)},Ln=t.createContext((function(){return[]})),Fn=t.createContext(!1);function zn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var In=function(e){for(var r=e.decorations,o=e.node,l=e.renderElement,i=e.renderPlaceholder,u=e.renderLeaf,s=e.selection,c=t.useContext(Ln),f=le(),d=dt.findPath(f,o),p=[],h=n.Element.isElement(o)&&!f.isInline(o)&&n.Editor.hasInlines(f,o),v=0;v<o.children.length;v++){var g,m=d.concat(v),b=o.children[v],y=dt.findKey(f,b),w=n.Editor.range(f,m),k=s&&n.Range.intersection(w,s),E=c([b,m]),x=zn(r);try{for(x.s();!(g=x.n()).done;){var S=g.value,C=n.Range.intersection(S,w);C&&E.push(C)}}catch(e){x.e(e)}finally{x.f()}n.Element.isElement(b)?p.push(a.default.createElement(Fn.Provider,{key:"provider-".concat(y.id),value:!!k},a.default.createElement(Mn,{decorations:E,element:b,key:y.id,renderElement:l,renderPlaceholder:i,renderLeaf:u,selection:k}))):p.push(a.default.createElement(Dn,{decorations:E,key:y.id,isLast:h&&v===o.children.length-1,parent:o,renderPlaceholder:i,renderLeaf:u,text:b})),Ee.set(b,v),xe.set(b,o)}return p},An=t.createContext(!1),jn=function(){return t.useContext(An)},Wn=t.createContext(null),Un=function(){var e=t.useContext(Wn);if(!e)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");return e.editor};var Vn=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});for(var n="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),r={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},a={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:n?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},o={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},l=1;l<20;l++)o["f"+l]=111+l;function i(e,t,n){t&&!("byKey"in t)&&(n=t,t=null),Array.isArray(e)||(e=[e]);var r=e.map((function(e){return u(e,t)})),a=function(e){return r.some((function(t){return s(t,e)}))};return null==n?a:a(n)}function u(e,t){var n=t&&t.byKey,a={},o=(e=e.replace("++","+add")).split("+"),l=o.length;for(var i in r)a[r[i]]=!1;var u=!0,s=!1,d=void 0;try{for(var p,h=o[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var v=p.value,g=v.endsWith("?")&&v.length>1;g&&(v=v.slice(0,-1));var m=f(v),b=r[m];1!==l&&b||(n?a.key=m:a.which=c(v)),b&&(a[b]=!g||null)}}catch(e){s=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(s)throw d}}return a}function s(e,t){for(var n in e){var r=e[n],a=void 0;if(null!=r&&((null!=(a="key"===n&&null!=t.key?t.key.toLowerCase():"which"===n?91===r&&93===t.which?91:t.which:t[n])||!1!==r)&&a!==r))return!1}return!0}function c(e){return e=f(e),o[e]||e.toUpperCase().charCodeAt(0)}function f(e){return e=e.toLowerCase(),e=a[e]||e}t.default=i,t.isHotkey=i,t.isCodeHotkey=function(e,t){return i(e,t)},t.isKeyHotkey=function(e,t){return i(e,{byKey:!0},t)},t.parseHotkey=u,t.compareHotkey=s,t.toKeyCode=c,t.toKeyName=f}));l(Vn);var Hn=Vn.isHotkey;Vn.isCodeHotkey,Vn.isKeyHotkey,Vn.parseHotkey,Vn.compareHotkey,Vn.toKeyCode,Vn.toKeyName;var qn={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},Qn={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},Kn={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},$n=function(e){var t=qn[e],n=Qn[e],r=Kn[e],a=t&&Hn(t),o=n&&Hn(n),l=r&&Hn(r);return function(e){return!(!a||!a(e))||(!!(se&&o&&o(e))||!(se||!l||!l(e)))}},Yn={isBold:$n("bold"),isCompose:$n("compose"),isMoveBackward:$n("moveBackward"),isMoveForward:$n("moveForward"),isDeleteBackward:$n("deleteBackward"),isDeleteForward:$n("deleteForward"),isDeleteLineBackward:$n("deleteLineBackward"),isDeleteLineForward:$n("deleteLineForward"),isDeleteWordBackward:$n("deleteWordBackward"),isDeleteWordForward:$n("deleteWordForward"),isExtendBackward:$n("extendBackward"),isExtendForward:$n("extendForward"),isExtendLineBackward:$n("extendLineBackward"),isExtendLineForward:$n("extendLineForward"),isItalic:$n("italic"),isMoveLineBackward:$n("moveLineBackward"),isMoveLineForward:$n("moveLineForward"),isMoveWordBackward:$n("moveWordBackward"),isMoveWordForward:$n("moveWordForward"),isRedo:$n("redo"),isSoftBreak:$n("insertSoftBreak"),isSplitBlock:$n("splitBlock"),isTransposeCharacter:$n("transposeCharacter"),isUndo:$n("undo")},Xn=l(i((function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0}))),Gn=i((function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));l(Gn);var Jn=l(i((function(e){e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0}))),Zn=i((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));l(Zn);var er=i((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0}));l(er);var tr=l(i((function(e){var t=Zn.default;e.exports=function(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return er(e)},e.exports.default=e.exports,e.exports.__esModule=!0}))),nr=i((function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),rr=l(nr);function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rr(e);if(t){var a=rr(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return tr(this,n)}}var or={subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0},lr=function(e){Jn(n,e);var t=ar(n);function n(){var e;return st(this,n),(e=t.apply(this,arguments)).context=null,e.manager=null,e.mutationObserver=null,e}return Xn(n,[{key:"observe",value:function(){var e,t=this.props.node;if(!t.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");null===(e=this.mutationObserver)||void 0===e||e.observe(t.current,or)}},{key:"componentDidMount",value:function(){var e=this.props.receivedUserInput,t=this.context;this.manager=function(e,t){var n=[],r=function(){n=[]};return{registerMutations:function(r){var a;if(t.current){var o=r.filter((function(t){return ut(e,t,r)}));(a=n).push.apply(a,$e(o))}},restoreDOM:function(){n.length>0&&(n.reverse().forEach((function(e){"characterData"!==e.type&&(e.removedNodes.forEach((function(t){e.target.insertBefore(t,e.nextSibling)})),e.addedNodes.forEach((function(t){e.target.removeChild(t)})))})),r())},clear:r}}(t,e),this.mutationObserver=new MutationObserver(this.manager.registerMutations),this.observe()}},{key:"getSnapshotBeforeUpdate",value:function(){var e,t,n,r,a=null===(e=this.mutationObserver)||void 0===e?void 0:e.takeRecords();null!=a&&a.length&&(null===(r=this.manager)||void 0===r||r.registerMutations(a));return null===(t=this.mutationObserver)||void 0===t||t.disconnect(),null===(n=this.manager)||void 0===n||n.restoreDOM(),null}},{key:"componentDidUpdate",value:function(){var e;null===(e=this.manager)||void 0===e||e.clear(),this.observe()}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}},{key:"render",value:function(){return this.props.children}}]),n}(t.Component);lr.contextType=oe;var ir=ce?lr:function(e){var t=e.children;return a.default.createElement(a.default.Fragment,null,t)},ur=["autoFocus","decorate","onDOMBeforeInput","placeholder","readOnly","renderElement","renderLeaf","renderPlaceholder","scrollSelectionIntoView","style","as","disableDefaultStyles"],sr=["text"];function cr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hr=function(e){return a.default.createElement(a.default.Fragment,null,In(e))},vr=function(e){var t=e.attributes,n=e.children;return a.default.createElement("span",Object.assign({},t),n,ce&&a.default.createElement("br",null))},gr=function(){return[]},mr=function(e,t){if(t.getBoundingClientRect&&(!e.selection||e.selection&&n.Range.isCollapsed(e.selection))){var r=t.startContainer.parentElement;r.getBoundingClientRect=t.getBoundingClientRect.bind(t),ae(r,{scrollMode:"if-needed"}),delete r.getBoundingClientRect}},br=function(e,t){if(!t)return!1;var n=t(e);return null!=n?n:e.isDefaultPrevented()||e.isPropagationStopped()},yr=function(e){return et(e.target)&&(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)},wr=function(e,t){if(!t)return!1;var n=t(e);return null!=n?n:e.defaultPrevented},kr=t.createContext(!1);function Er(e){return e instanceof Error}var xr=t.createContext({}),Sr=function(e,t){return e===t};function Cr(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sr,r=t.useReducer((function(e){return e+1}),0),a=h(r,2),o=a[1],l=t.useContext(xr);if(!l)throw new Error("The `useSlateSelector` hook must be used inside the <Slate> component's context.");var i,u=l.getSlate,s=l.addEventListener,c=t.useRef(),f=t.useRef((function(){return null})),d=t.useRef(null);try{i=e!==f.current||c.current?e(u()):d.current}catch(e){throw c.current&&Er(e)&&(e.message+="\nThe error may be correlated with this previous error:\n".concat(c.current.stack,"\n\n")),e}return Ct((function(){f.current=e,d.current=i,c.current=void 0})),Ct((function(){function e(){try{var e=f.current(u());if(n(e,d.current))return;d.current=e}catch(e){c.current=e}o()}var t=s(e);return e(),function(){return t()}}),[s,u]),i}var Tr=["editor","children","onChange","initialValue"],_r=function(e,t){return!e&&!t||!(!e||!t)&&n.Range.equals(e,t)},Or=Object.getOwnPropertySymbols,Pr=Object.prototype.hasOwnProperty,Dr=Object.prototype.propertyIsEnumerable;function Nr(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var Mr=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==r.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,a=Nr(e),o=1;o<arguments.length;o++){for(var l in n=Object(arguments[o]))Pr.call(n,l)&&(a[l]=n[l]);if(Or){r=Or(n);for(var i=0;i<r.length;i++)Dr.call(n,r[i])&&(a[r[i]]=n[r[i]])}}return a},Rr=i((function(e,t){var n,r,a,o;if("object"==typeof performance&&"function"==typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,u=i.now();t.unstable_now=function(){return i.now()-u}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var s=null,c=null,f=function(){if(null!==s)try{var e=t.unstable_now();s(!0,e),s=null}catch(e){throw setTimeout(f,0),e}};n=function(e){null!==s?setTimeout(n,0,e):(s=e,setTimeout(f,0))},r=function(e,t){c=setTimeout(e,t)},a=function(){clearTimeout(c)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var h=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var v=!1,g=null,m=-1,b=5,y=0;t.unstable_shouldYield=function(){return t.unstable_now()>=y},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var w=new MessageChannel,k=w.port2;w.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();y=e+b;try{g(!0,e)?k.postMessage(null):(v=!1,g=null)}catch(e){throw k.postMessage(null),e}}else v=!1},n=function(e){g=e,v||(v=!0,k.postMessage(null))},r=function(e,n){m=d((function(){e(t.unstable_now())}),n)},a=function(){p(m),m=-1}}function E(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<C(a,t)))break e;e[r]=t,e[n]=a,n=r}}function x(e){return void 0===(e=e[0])?null:e}function S(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var o=2*(r+1)-1,l=e[o],i=o+1,u=e[i];if(void 0!==l&&0>C(l,n))void 0!==u&&0>C(u,l)?(e[r]=u,e[i]=n,r=i):(e[r]=l,e[o]=n,r=o);else{if(!(void 0!==u&&0>C(u,n)))break e;e[r]=u,e[i]=n,r=i}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var T=[],_=[],O=1,P=null,D=3,N=!1,M=!1,R=!1;function L(e){for(var t=x(_);null!==t;){if(null===t.callback)S(_);else{if(!(t.startTime<=e))break;S(_),t.sortIndex=t.expirationTime,E(T,t)}t=x(_)}}function F(e){if(R=!1,L(e),!M)if(null!==x(T))M=!0,n(z);else{var t=x(_);null!==t&&r(F,t.startTime-e)}}function z(e,n){M=!1,R&&(R=!1,a()),N=!0;var o=D;try{for(L(n),P=x(T);null!==P&&(!(P.expirationTime>n)||e&&!t.unstable_shouldYield());){var l=P.callback;if("function"==typeof l){P.callback=null,D=P.priorityLevel;var i=l(P.expirationTime<=n);n=t.unstable_now(),"function"==typeof i?P.callback=i:P===x(T)&&S(T),L(n)}else S(T);P=x(T)}if(null!==P)var u=!0;else{var s=x(_);null!==s&&r(F,s.startTime-n),u=!1}return u}finally{P=null,D=o,N=!1}}var B=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){M||N||(M=!0,n(z))},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return x(T)},t.unstable_next=function(e){switch(D){case 1:case 2:case 3:var t=3;break;default:t=D}var n=D;D=t;try{return e()}finally{D=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=B,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=D;D=e;try{return t()}finally{D=n}},t.unstable_scheduleCallback=function(e,o,l){var i=t.unstable_now();switch("object"==typeof l&&null!==l?l="number"==typeof(l=l.delay)&&0<l?i+l:i:l=i,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:O++,callback:o,priorityLevel:e,startTime:l,expirationTime:u=l+u,sortIndex:-1},l>i?(e.sortIndex=l,E(_,e),null===x(T)&&e===x(_)&&(R?a():R=!0,r(F,l-i))):(e.sortIndex=u,E(T,e),M||N||(M=!0,n(z))),e},t.unstable_wrapCallback=function(e){var t=D;return function(){var n=D;D=t;try{return e.apply(this,arguments)}finally{D=n}}}}));Rr.unstable_now,Rr.unstable_shouldYield,Rr.unstable_forceFrameRate,Rr.unstable_IdlePriority,Rr.unstable_ImmediatePriority,Rr.unstable_LowPriority,Rr.unstable_NormalPriority,Rr.unstable_Profiling,Rr.unstable_UserBlockingPriority,Rr.unstable_cancelCallback,Rr.unstable_continueExecution,Rr.unstable_getCurrentPriorityLevel,Rr.unstable_getFirstCallbackNode,Rr.unstable_next,Rr.unstable_pauseExecution,Rr.unstable_requestPaint,Rr.unstable_runWithPriority,Rr.unstable_scheduleCallback,Rr.unstable_wrapCallback;var Lr=i((function(e,t){}));Lr.unstable_now,Lr.unstable_shouldYield,Lr.unstable_forceFrameRate,Lr.unstable_IdlePriority,Lr.unstable_ImmediatePriority,Lr.unstable_LowPriority,Lr.unstable_NormalPriority,Lr.unstable_Profiling,Lr.unstable_UserBlockingPriority,Lr.unstable_cancelCallback,Lr.unstable_continueExecution,Lr.unstable_getCurrentPriorityLevel,Lr.unstable_getFirstCallbackNode,Lr.unstable_next,Lr.unstable_pauseExecution,Lr.unstable_requestPaint,Lr.unstable_runWithPriority,Lr.unstable_scheduleCallback,Lr.unstable_wrapCallback;var Fr=i((function(e){e.exports=Rr}));function zr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!a.default)throw Error(zr(227));var Br=new Set,Ir={};function Ar(e,t){jr(e,t),jr(e+"Capture",t)}function jr(e,t){for(Ir[e]=t,e=0;e<t.length;e++)Br.add(t[e])}var Wr=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ur=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vr=Object.prototype.hasOwnProperty,Hr={},qr={};function Qr(e,t,n,r,a,o,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var Kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){Kr[e]=new Qr(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];Kr[t]=new Qr(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){Kr[e]=new Qr(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){Kr[e]=new Qr(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){Kr[e]=new Qr(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){Kr[e]=new Qr(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){Kr[e]=new Qr(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){Kr[e]=new Qr(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){Kr[e]=new Qr(e,5,!1,e.toLowerCase(),null,!1,!1)}));var $r=/[\-:]([a-z])/g;function Yr(e){return e[1].toUpperCase()}function Xr(e,t,n,r){var a=Kr.hasOwnProperty(t)?Kr[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!Vr.call(qr,e)||!Vr.call(Hr,e)&&(Ur.test(e)?qr[e]=!0:(Hr[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){Kr[e]=new Qr(e,1,!1,e.toLowerCase(),null,!1,!1)})),Kr.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){Kr[e]=new Qr(e,1,!1,e.toLowerCase(),null,!0,!0)}));var Gr=a.default.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jr=60103,Zr=60106,ea=60107,ta=60108,na=60114,ra=60109,aa=60110,oa=60112,la=60113,ia=60120,ua=60115,sa=60116,ca=60121,fa=60128,da=60129,pa=60130,ha=60131;if("function"==typeof Symbol&&Symbol.for){var va=Symbol.for;Jr=va("react.element"),Zr=va("react.portal"),ea=va("react.fragment"),ta=va("react.strict_mode"),na=va("react.profiler"),ra=va("react.provider"),aa=va("react.context"),oa=va("react.forward_ref"),la=va("react.suspense"),ia=va("react.suspense_list"),ua=va("react.memo"),sa=va("react.lazy"),ca=va("react.block"),va("react.scope"),fa=va("react.opaque.id"),da=va("react.debug_trace_mode"),pa=va("react.offscreen"),ha=va("react.legacy_hidden")}var ga,ma="function"==typeof Symbol&&Symbol.iterator;function ba(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=ma&&e[ma]||e["@@iterator"])?e:null}function ya(e){if(void 0===ga)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);ga=t&&t[1]||""}return"\n"+ga+e}var wa=!1;function ka(e,t){if(!e||wa)return"";wa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var a=e.stack.split("\n"),o=r.stack.split("\n"),l=a.length-1,i=o.length-1;1<=l&&0<=i&&a[l]!==o[i];)i--;for(;1<=l&&0<=i;l--,i--)if(a[l]!==o[i]){if(1!==l||1!==i)do{if(l--,0>--i||a[l]!==o[i])return"\n"+a[l].replace(" at new "," at ")}while(1<=l&&0<=i);break}}}finally{wa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ya(e):""}function Ea(e){switch(e.tag){case 5:return ya(e.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return e=ka(e.type,!1);case 11:return e=ka(e.type.render,!1);case 22:return e=ka(e.type._render,!1);case 1:return e=ka(e.type,!0);default:return""}}function xa(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ea:return"Fragment";case Zr:return"Portal";case na:return"Profiler";case ta:return"StrictMode";case la:return"Suspense";case ia:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case aa:return(e.displayName||"Context")+".Consumer";case ra:return(e._context.displayName||"Context")+".Provider";case oa:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ua:return xa(e.type);case ca:return xa(e._render);case sa:t=e._payload,e=e._init;try{return xa(e(t))}catch(e){}}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Ca(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ta(e){e._valueTracker||(e._valueTracker=function(e){var t=Ca(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function _a(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ca(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Oa(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Pa(e,t){var n=t.checked;return Mr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Da(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Sa(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Na(e,t){null!=(t=t.checked)&&Xr(e,"checked",t,!1)}function Ma(e,t){Na(e,t);var n=Sa(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?La(e,t.type,n):t.hasOwnProperty("defaultValue")&&La(e,t.type,Sa(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ra(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function La(e,t,n){"number"===t&&Oa(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Fa(e,t){return e=Mr({children:void 0},t),(t=function(e){var t="";return a.default.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function za(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Sa(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Ba(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(zr(91));return Mr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ia(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(zr(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(zr(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Sa(n)}}function Aa(e,t){var n=Sa(t.value),r=Sa(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ja(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Wa="http://www.w3.org/1999/xhtml",Ua="http://www.w3.org/2000/svg";function Va(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ha(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Va(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var qa,Qa,Ka=(Qa=function(e,t){if(e.namespaceURI!==Ua||"innerHTML"in e)e.innerHTML=t;else{for((qa=qa||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Qa(e,t)}))}:Qa);function $a(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ya={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xa=["Webkit","ms","Moz","O"];function Ga(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Ya.hasOwnProperty(e)&&Ya[e]?(""+t).trim():t+"px"}function Ja(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=Ga(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(Ya).forEach((function(e){Xa.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ya[t]=Ya[e]}))}));var Za=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function eo(e,t){if(t){if(Za[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(zr(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(zr(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(zr(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(zr(62))}}function to(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function no(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ro=null,ao=null,oo=null;function lo(e){if(e=Ru(e)){if("function"!=typeof ro)throw Error(zr(280));var t=e.stateNode;t&&(t=Fu(t),ro(e.stateNode,e.type,t))}}function io(e){ao?oo?oo.push(e):oo=[e]:ao=e}function uo(){if(ao){var e=ao,t=oo;if(oo=ao=null,lo(e),t)for(e=0;e<t.length;e++)lo(t[e])}}function so(e,t){return e(t)}function co(e,t,n,r,a){return e(t,n,r,a)}function fo(){}var po=so,ho=!1,vo=!1;function go(){null===ao&&null===oo||(fo(),uo())}function mo(e,t){var n=e.stateNode;if(null===n)return null;var r=Fu(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(zr(231,t,typeof n));return n}var bo=!1;if(Wr)try{var yo={};Object.defineProperty(yo,"passive",{get:function(){bo=!0}}),window.addEventListener("test",yo,yo),window.removeEventListener("test",yo,yo)}catch(Qa){bo=!1}function wo(e,t,n,r,a,o,l,i,u){var s=Array.prototype.slice.call(arguments,3);try{t.apply(n,s)}catch(e){this.onError(e)}}var ko=!1,Eo=null,xo=!1,So=null,Co={onError:function(e){ko=!0,Eo=e}};function To(e,t,n,r,a,o,l,i,u){ko=!1,Eo=null,wo.apply(Co,arguments)}function _o(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Oo(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Po(e){if(_o(e)!==e)throw Error(zr(188))}function Do(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=_o(e)))throw Error(zr(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Po(a),e;if(o===r)return Po(a),t;o=o.sibling}throw Error(zr(188))}if(n.return!==r.return)n=a,r=o;else{for(var l=!1,i=a.child;i;){if(i===n){l=!0,n=a,r=o;break}if(i===r){l=!0,r=a,n=o;break}i=i.sibling}if(!l){for(i=o.child;i;){if(i===n){l=!0,n=o,r=a;break}if(i===r){l=!0,r=o,n=a;break}i=i.sibling}if(!l)throw Error(zr(189))}}if(n.alternate!==r)throw Error(zr(190))}if(3!==n.tag)throw Error(zr(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function No(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var Mo,Ro,Lo,Fo,zo=!1,Bo=[],Io=null,Ao=null,jo=null,Wo=new Map,Uo=new Map,Vo=[],Ho="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qo(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function Qo(e,t){switch(e){case"focusin":case"focusout":Io=null;break;case"dragenter":case"dragleave":Ao=null;break;case"mouseover":case"mouseout":jo=null;break;case"pointerover":case"pointerout":Wo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(t.pointerId)}}function Ko(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e=qo(t,n,r,a,o),null!==t&&(null!==(t=Ru(t))&&Ro(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function $o(e){var t=Mu(e.target);if(null!==t){var n=_o(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Oo(n)))return e.blockedOn=t,void Fo(e.lanePriority,(function(){Fr.unstable_runWithPriority(e.priority,(function(){Lo(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Yo(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ru(n))&&Ro(t),e.blockedOn=n,!1;t.shift()}return!0}function Xo(e,t,n){Yo(e)&&n.delete(t)}function Go(){for(zo=!1;0<Bo.length;){var e=Bo[0];if(null!==e.blockedOn){null!==(e=Ru(e.blockedOn))&&Mo(e);break}for(var t=e.targetContainers;0<t.length;){var n=Dl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&Bo.shift()}null!==Io&&Yo(Io)&&(Io=null),null!==Ao&&Yo(Ao)&&(Ao=null),null!==jo&&Yo(jo)&&(jo=null),Wo.forEach(Xo),Uo.forEach(Xo)}function Jo(e,t){e.blockedOn===t&&(e.blockedOn=null,zo||(zo=!0,Fr.unstable_scheduleCallback(Fr.unstable_NormalPriority,Go)))}function Zo(e){function t(t){return Jo(t,e)}if(0<Bo.length){Jo(Bo[0],e);for(var n=1;n<Bo.length;n++){var r=Bo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Io&&Jo(Io,e),null!==Ao&&Jo(Ao,e),null!==jo&&Jo(jo,e),Wo.forEach(t),Uo.forEach(t),n=0;n<Vo.length;n++)(r=Vo[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Vo.length&&null===(n=Vo[0]).blockedOn;)$o(n),null===n.blockedOn&&Vo.shift()}function el(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tl={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},nl={},rl={};function al(e){if(nl[e])return nl[e];if(!tl[e])return e;var t,n=tl[e];for(t in n)if(n.hasOwnProperty(t)&&t in rl)return nl[e]=n[t];return e}Wr&&(rl=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);var ol=al("animationend"),ll=al("animationiteration"),il=al("animationstart"),ul=al("transitionend"),sl=new Map,cl=new Map,fl=["abort","abort",ol,"animationEnd",ll,"animationIteration",il,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ul,"transitionEnd","waiting","waiting"];function dl(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),cl.set(r,t),sl.set(r,a),Ar(a,[r])}}(0,Fr.unstable_now)();var pl=8;function hl(e){if(0!=(1&e))return pl=15,1;if(0!=(2&e))return pl=14,2;if(0!=(4&e))return pl=13,4;var t=24&e;return 0!==t?(pl=12,t):0!=(32&e)?(pl=11,32):0!==(t=192&e)?(pl=10,t):0!=(256&e)?(pl=9,256):0!==(t=3584&e)?(pl=8,t):0!=(4096&e)?(pl=7,4096):0!==(t=4186112&e)?(pl=6,t):0!==(t=62914560&e)?(pl=5,t):67108864&e?(pl=4,67108864):0!=(134217728&e)?(pl=3,134217728):0!==(t=805306368&e)?(pl=2,t):0!=(1073741824&e)?(pl=1,1073741824):(pl=8,e)}function vl(e,t){var n=e.pendingLanes;if(0===n)return pl=0;var r=0,a=0,o=e.expiredLanes,l=e.suspendedLanes,i=e.pingedLanes;if(0!==o)r=o,a=pl=15;else if(0!==(o=134217727&n)){var u=o&~l;0!==u?(r=hl(u),a=pl):0!==(i&=o)&&(r=hl(i),a=pl)}else 0!==(o=n&~l)?(r=hl(o),a=pl):0!==i&&(r=hl(i),a=pl);if(0===r)return 0;if(r=n&((0>(r=31-kl(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&l)){if(hl(t),a<=pl)return t;pl=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-kl(t)),r|=e[n],t&=~a;return r}function gl(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ml(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=bl(24&~t))?ml(10,t):e;case 10:return 0===(e=bl(192&~t))?ml(8,t):e;case 8:return 0===(e=bl(3584&~t))&&(0===(e=bl(4186112&~t))&&(e=512)),e;case 2:return 0===(t=bl(805306368&~t))&&(t=268435456),t}throw Error(zr(358,e))}function bl(e){return e&-e}function yl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wl(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-kl(t)]=n}var kl=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(El(e)/xl|0)|0},El=Math.log,xl=Math.LN2;var Sl=Fr.unstable_UserBlockingPriority,Cl=Fr.unstable_runWithPriority,Tl=!0;function _l(e,t,n,r){ho||fo();var a=Pl,o=ho;ho=!0;try{co(a,e,t,n,r)}finally{(ho=o)||go()}}function Ol(e,t,n,r){Cl(Sl,Pl.bind(null,e,t,n,r))}function Pl(e,t,n,r){var a;if(Tl)if((a=0==(4&t))&&0<Bo.length&&-1<Ho.indexOf(e))e=qo(null,e,t,n,r),Bo.push(e);else{var o=Dl(e,t,n,r);if(null===o)a&&Qo(e,r);else{if(a){if(-1<Ho.indexOf(e))return e=qo(o,e,t,n,r),void Bo.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return Io=Ko(Io,e,t,n,r,a),!0;case"dragenter":return Ao=Ko(Ao,e,t,n,r,a),!0;case"mouseover":return jo=Ko(jo,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return Wo.set(o,Ko(Wo.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Uo.set(o,Ko(Uo.get(o)||null,e,t,n,r,a)),!0}return!1}(o,e,t,n,r))return;Qo(e,r)}fu(e,t,r,null,n)}}}function Dl(e,t,n,r){var a=no(r);if(null!==(a=Mu(a))){var o=_o(a);if(null===o)a=null;else{var l=o.tag;if(13===l){if(null!==(a=Oo(o)))return a;a=null}else if(3===l){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return fu(e,t,r,a,n),null}var Nl=null,Ml=null,Rl=null;function Ll(){if(Rl)return Rl;var e,t,n=Ml,r=n.length,a="value"in Nl?Nl.value:Nl.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var l=r-e;for(t=1;t<=l&&n[r-t]===a[o-t];t++);return Rl=a.slice(e,1<t?1-t:void 0)}function Fl(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function zl(){return!0}function Bl(){return!1}function Il(e){function t(t,n,r,a,o){for(var l in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(a):a[l]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?zl:Bl,this.isPropagationStopped=Bl,this}return Mr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),t}var Al,jl,Wl,Ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vl=Il(Ul),Hl=Mr({},Ul,{view:0,detail:0}),ql=Il(Hl),Ql=Mr({},Hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ai,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Wl&&(Wl&&"mousemove"===e.type?(Al=e.screenX-Wl.screenX,jl=e.screenY-Wl.screenY):jl=Al=0,Wl=e),Al)},movementY:function(e){return"movementY"in e?e.movementY:jl}}),Kl=Il(Ql),$l=Il(Mr({},Ql,{dataTransfer:0})),Yl=Il(Mr({},Hl,{relatedTarget:0})),Xl=Il(Mr({},Ul,{animationName:0,elapsedTime:0,pseudoElement:0})),Gl=Mr({},Ul,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jl=Il(Gl),Zl=Il(Mr({},Ul,{data:0})),ei={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ti={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ni={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ri(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ni[e])&&!!t[e]}function ai(){return ri}var oi=Mr({},Hl,{key:function(e){if(e.key){var t=ei[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Fl(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ti[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ai,charCode:function(e){return"keypress"===e.type?Fl(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Fl(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),li=Il(oi),ii=Il(Mr({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ui=Il(Mr({},Hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ai})),si=Il(Mr({},Ul,{propertyName:0,elapsedTime:0,pseudoElement:0})),ci=Mr({},Ql,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fi=Il(ci),di=[9,13,27,32],pi=Wr&&"CompositionEvent"in window,hi=null;Wr&&"documentMode"in document&&(hi=document.documentMode);var vi=Wr&&"TextEvent"in window&&!hi,gi=Wr&&(!pi||hi&&8<hi&&11>=hi),mi=String.fromCharCode(32),bi=!1;function yi(e,t){switch(e){case"keyup":return-1!==di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wi(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var ki=!1;var Ei={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ei[e.type]:"textarea"===t}function Si(e,t,n,r){io(r),0<(t=pu(t,"onChange")).length&&(n=new Vl("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ci=null,Ti=null;function _i(e){ou(e,0)}function Oi(e){if(_a(Lu(e)))return e}function Pi(e,t){if("change"===e)return t}var Di=!1;if(Wr){var Ni;if(Wr){var Mi="oninput"in document;if(!Mi){var Ri=document.createElement("div");Ri.setAttribute("oninput","return;"),Mi="function"==typeof Ri.oninput}Ni=Mi}else Ni=!1;Di=Ni&&(!document.documentMode||9<document.documentMode)}function Li(){Ci&&(Ci.detachEvent("onpropertychange",Fi),Ti=Ci=null)}function Fi(e){if("value"===e.propertyName&&Oi(Ti)){var t=[];if(Si(t,Ti,e,no(e)),e=_i,ho)e(t);else{ho=!0;try{so(e,t)}finally{ho=!1,go()}}}}function zi(e,t,n){"focusin"===e?(Li(),Ti=n,(Ci=t).attachEvent("onpropertychange",Fi)):"focusout"===e&&Li()}function Bi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Oi(Ti)}function Ii(e,t){if("click"===e)return Oi(t)}function Ai(e,t){if("input"===e||"change"===e)return Oi(t)}var ji="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Wi=Object.prototype.hasOwnProperty;function Ui(e,t){if(ji(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Wi.call(t,n[r])||!ji(e[n[r]],t[n[r]]))return!1;return!0}function Vi(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hi(e,t){var n,r=Vi(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Vi(r)}}function qi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?qi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Qi(){for(var e=window,t=Oa();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Oa((e=t.contentWindow).document)}return t}function Ki(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var $i=Wr&&"documentMode"in document&&11>=document.documentMode,Yi=null,Xi=null,Gi=null,Ji=!1;function Zi(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Ji||null==Yi||Yi!==Oa(r)||("selectionStart"in(r=Yi)&&Ki(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Gi&&Ui(Gi,r)||(Gi=r,0<(r=pu(Xi,"onSelect")).length&&(t=new Vl("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Yi)))}dl("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),dl("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),dl(fl,2);for(var eu="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),tu=0;tu<eu.length;tu++)cl.set(eu[tu],0);jr("onMouseEnter",["mouseout","mouseover"]),jr("onMouseLeave",["mouseout","mouseover"]),jr("onPointerEnter",["pointerout","pointerover"]),jr("onPointerLeave",["pointerout","pointerover"]),Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ru=new Set("cancel close invalid load scroll toggle".split(" ").concat(nu));function au(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,l,i,u){if(To.apply(this,arguments),ko){if(!ko)throw Error(zr(198));var s=Eo;ko=!1,Eo=null,xo||(xo=!0,So=s)}}(r,t,void 0,e),e.currentTarget=null}function ou(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var i=r[l],u=i.instance,s=i.currentTarget;if(i=i.listener,u!==o&&a.isPropagationStopped())break e;au(a,i,s),o=u}else for(l=0;l<r.length;l++){if(u=(i=r[l]).instance,s=i.currentTarget,i=i.listener,u!==o&&a.isPropagationStopped())break e;au(a,i,s),o=u}}}if(xo)throw e=So,xo=!1,So=null,e}function lu(e,t){var n=zu(t),r=e+"__bubble";n.has(r)||(cu(t,e,2,!1),n.add(r))}var iu="_reactListening"+Math.random().toString(36).slice(2);function uu(e){e[iu]||(e[iu]=!0,Br.forEach((function(t){ru.has(t)||su(t,!1,e,null),su(t,!0,e,null)})))}function su(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&ru.has(e)){if("scroll"!==e)return;a|=2,o=r}var l=zu(o),i=e+"__"+(t?"capture":"bubble");l.has(i)||(t&&(a|=4),cu(o,e,a,t),l.add(i))}function cu(e,t,n,r){var a=cl.get(t);switch(void 0===a?2:a){case 0:a=_l;break;case 1:a=Ol;break;default:a=Pl}n=a.bind(null,t,n,e),a=void 0,!bo||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function fu(e,t,n,r,a){var o=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var l=r.tag;if(3===l||4===l){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===l)for(l=r.return;null!==l;){var u=l.tag;if((3===u||4===u)&&((u=l.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;l=l.return}for(;null!==i;){if(null===(l=Mu(i)))return;if(5===(u=l.tag)||6===u){r=o=l;continue e}i=i.parentNode}}r=r.return}!function(e,t,n){if(vo)return e(t,n);vo=!0;try{po(e,t,n)}finally{vo=!1,go()}}((function(){var r=o,a=no(n),l=[];e:{var i=sl.get(e);if(void 0!==i){var u=Vl,s=e;switch(e){case"keypress":if(0===Fl(n))break e;case"keydown":case"keyup":u=li;break;case"focusin":s="focus",u=Yl;break;case"focusout":s="blur",u=Yl;break;case"beforeblur":case"afterblur":u=Yl;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=$l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=ui;break;case ol:case ll:case il:u=Xl;break;case ul:u=si;break;case"scroll":u=ql;break;case"wheel":u=fi;break;case"copy":case"cut":case"paste":u=Jl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=ii}var c=0!=(4&t),f=!c&&"scroll"===e,d=c?null!==i?i+"Capture":null:i;c=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==d&&(null!=(v=mo(h,d))&&c.push(du(h,v,p)))),f)break;h=h.return}0<c.length&&(i=new u(i,s,null,n,a),l.push({event:i,listeners:c}))}}if(0==(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(s=n.relatedTarget||n.fromElement)||!Mu(s)&&!s[Du])&&(u||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,u?(u=r,null!==(s=(s=n.relatedTarget||n.toElement)?Mu(s):null)&&(s!==(f=_o(s))||5!==s.tag&&6!==s.tag)&&(s=null)):(u=null,s=r),u!==s)){if(c=Kl,v="onMouseLeave",d="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=ii,v="onPointerLeave",d="onPointerEnter",h="pointer"),f=null==u?i:Lu(u),p=null==s?i:Lu(s),(i=new c(v,h+"leave",u,n,a)).target=f,i.relatedTarget=p,v=null,Mu(a)===r&&((c=new c(d,h+"enter",s,n,a)).target=p,c.relatedTarget=f,v=c),f=v,u&&s)e:{for(d=s,h=0,p=c=u;p;p=hu(p))h++;for(p=0,v=d;v;v=hu(v))p++;for(;0<h-p;)c=hu(c),h--;for(;0<p-h;)d=hu(d),p--;for(;h--;){if(c===d||null!==d&&c===d.alternate)break e;c=hu(c),d=hu(d)}c=null}else c=null;null!==u&&vu(l,i,u,c,!1),null!==s&&null!==f&&vu(l,f,s,c,!0)}if("select"===(u=(i=r?Lu(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===u&&"file"===i.type)var g=Pi;else if(xi(i))if(Di)g=Ai;else{g=Bi;var m=zi}else(u=i.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=Ii);switch(g&&(g=g(e,r))?Si(l,g,n,a):(m&&m(e,i,r),"focusout"===e&&(m=i._wrapperState)&&m.controlled&&"number"===i.type&&La(i,"number",i.value)),m=r?Lu(r):window,e){case"focusin":(xi(m)||"true"===m.contentEditable)&&(Yi=m,Xi=r,Gi=null);break;case"focusout":Gi=Xi=Yi=null;break;case"mousedown":Ji=!0;break;case"contextmenu":case"mouseup":case"dragend":Ji=!1,Zi(l,n,a);break;case"selectionchange":if($i)break;case"keydown":case"keyup":Zi(l,n,a)}var b;if(pi)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ki?yi(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(gi&&"ko"!==n.locale&&(ki||"onCompositionStart"!==y?"onCompositionEnd"===y&&ki&&(b=Ll()):(Ml="value"in(Nl=a)?Nl.value:Nl.textContent,ki=!0)),0<(m=pu(r,y)).length&&(y=new Zl(y,e,null,n,a),l.push({event:y,listeners:m}),b?y.data=b:null!==(b=wi(n))&&(y.data=b))),(b=vi?function(e,t){switch(e){case"compositionend":return wi(t);case"keypress":return 32!==t.which?null:(bi=!0,mi);case"textInput":return(e=t.data)===mi&&bi?null:e;default:return null}}(e,n):function(e,t){if(ki)return"compositionend"===e||!pi&&yi(e,t)?(e=Ll(),Rl=Ml=Nl=null,ki=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return gi&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=pu(r,"onBeforeInput")).length&&(a=new Zl("onBeforeInput","beforeinput",null,n,a),l.push({event:a,listeners:r}),a.data=b))}ou(l,t)}))}function du(e,t,n){return{instance:e,listener:t,currentTarget:n}}function pu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=mo(e,n))&&r.unshift(du(e,o,a)),null!=(o=mo(e,t))&&r.push(du(e,o,a))),e=e.return}return r}function hu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function vu(e,t,n,r,a){for(var o=t._reactName,l=[];null!==n&&n!==r;){var i=n,u=i.alternate,s=i.stateNode;if(null!==u&&u===r)break;5===i.tag&&null!==s&&(i=s,a?null!=(u=mo(n,o))&&l.unshift(du(n,u,i)):a||null!=(u=mo(n,o))&&l.push(du(n,u,i))),n=n.return}0!==l.length&&e.push({event:t,listeners:l})}function gu(){}var mu=null,bu=null;function yu(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function wu(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ku="function"==typeof setTimeout?setTimeout:void 0,Eu="function"==typeof clearTimeout?clearTimeout:void 0;function xu(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Su(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Cu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Tu=0;var _u=Math.random().toString(36).slice(2),Ou="__reactFiber$"+_u,Pu="__reactProps$"+_u,Du="__reactContainer$"+_u,Nu="__reactEvents$"+_u;function Mu(e){var t=e[Ou];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Du]||n[Ou]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Cu(e);null!==e;){if(n=e[Ou])return n;e=Cu(e)}return t}n=(e=n).parentNode}return null}function Ru(e){return!(e=e[Ou]||e[Du])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Lu(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(zr(33))}function Fu(e){return e[Pu]||null}function zu(e){var t=e[Nu];return void 0===t&&(t=e[Nu]=new Set),t}var Bu=[],Iu=-1;function Au(e){return{current:e}}function ju(e){0>Iu||(e.current=Bu[Iu],Bu[Iu]=null,Iu--)}function Wu(e,t){Iu++,Bu[Iu]=e.current,e.current=t}var Uu={},Vu=Au(Uu),Hu=Au(!1),qu=Uu;function Qu(e,t){var n=e.type.contextTypes;if(!n)return Uu;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ku(e){return null!=(e=e.childContextTypes)}function $u(){ju(Hu),ju(Vu)}function Yu(e,t,n){if(Vu.current!==Uu)throw Error(zr(168));Wu(Vu,t),Wu(Hu,n)}function Xu(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(zr(108,xa(t)||"Unknown",a));return Mr({},n,r)}function Gu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uu,qu=Vu.current,Wu(Vu,e),Wu(Hu,Hu.current),!0}function Ju(e,t,n){var r=e.stateNode;if(!r)throw Error(zr(169));n?(e=Xu(e,t,qu),r.__reactInternalMemoizedMergedChildContext=e,ju(Hu),ju(Vu),Wu(Vu,e)):ju(Hu),Wu(Hu,n)}var Zu=null,es=null,ts=Fr.unstable_runWithPriority,ns=Fr.unstable_scheduleCallback,rs=Fr.unstable_cancelCallback,as=Fr.unstable_shouldYield,os=Fr.unstable_requestPaint,ls=Fr.unstable_now,is=Fr.unstable_getCurrentPriorityLevel,us=Fr.unstable_ImmediatePriority,ss=Fr.unstable_UserBlockingPriority,cs=Fr.unstable_NormalPriority,fs=Fr.unstable_LowPriority,ds=Fr.unstable_IdlePriority,ps={},hs=void 0!==os?os:function(){},vs=null,gs=null,ms=!1,bs=ls(),ys=1e4>bs?ls:function(){return ls()-bs};function ws(){switch(is()){case us:return 99;case ss:return 98;case cs:return 97;case fs:return 96;case ds:return 95;default:throw Error(zr(332))}}function ks(e){switch(e){case 99:return us;case 98:return ss;case 97:return cs;case 96:return fs;case 95:return ds;default:throw Error(zr(332))}}function Es(e,t){return e=ks(e),ts(e,t)}function xs(e,t,n){return e=ks(e),ns(e,t,n)}function Ss(){if(null!==gs){var e=gs;gs=null,rs(e)}Cs()}function Cs(){if(!ms&&null!==vs){ms=!0;var e=0;try{var t=vs;Es(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),vs=null}catch(t){throw null!==vs&&(vs=vs.slice(e+1)),ns(us,Ss),t}finally{ms=!1}}}var Ts=Gr.ReactCurrentBatchConfig;function _s(e,t){if(e&&e.defaultProps){for(var n in t=Mr({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Os=Au(null),Ps=null,Ds=null,Ns=null;function Ms(){Ns=Ds=Ps=null}function Rs(e){var t=Os.current;ju(Os),e.type._context._currentValue=t}function Ls(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function Fs(e,t){Ps=e,Ns=Ds=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(pf=!0),e.firstContext=null)}function zs(e,t){if(Ns!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Ns=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ds){if(null===Ps)throw Error(zr(308));Ds=t,Ps.dependencies={lanes:0,firstContext:t,responders:null}}else Ds=Ds.next=t;return e._currentValue}var Bs=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function js(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ws(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function Us(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=l:o=o.next=l,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,r){var a=e.updateQueue;Bs=!1;var o=a.firstBaseUpdate,l=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var u=i,s=u.next;u.next=null,null===l?o=s:l.next=s,l=u;var c=e.alternate;if(null!==c){var f=(c=c.updateQueue).lastBaseUpdate;f!==l&&(null===f?c.firstBaseUpdate=s:f.next=s,c.lastBaseUpdate=u)}}if(null!==o){for(f=a.baseState,l=0,c=s=u=null;;){i=o.lane;var d=o.eventTime;if((r&i)===i){null!==c&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,h=o;switch(i=t,d=n,h.tag){case 1:if("function"==typeof(p=h.payload)){f=p.call(d,f,i);break e}f=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(i="function"==typeof(p=h.payload)?p.call(d,f,i):p))break e;f=Mr({},f,i);break e;case 2:Bs=!0}}null!==o.callback&&(e.flags|=32,null===(i=a.effects)?a.effects=[o]:i.push(o))}else d={eventTime:d,lane:i,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(s=c=d,u=f):c=c.next=d,l|=i;if(null===(o=o.next)){if(null===(i=a.shared.pending))break;o=i.next,i.next=null,a.lastBaseUpdate=i,a.shared.pending=null}}null===c&&(u=f),a.baseState=u,a.firstBaseUpdate=s,a.lastBaseUpdate=c,md|=l,e.lanes=l,e.memoizedState=f}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!=typeof a)throw Error(zr(191,a));a.call(r)}}}var qs=(new a.default.Component).refs;function Qs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:Mr({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ks={isMounted:function(e){return!!(e=e._reactInternals)&&_o(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ud(),a=Vd(e),o=js(r,a);o.payload=t,null!=n&&(o.callback=n),Ws(e,o),Hd(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ud(),a=Vd(e),o=js(r,a);o.tag=1,o.payload=t,null!=n&&(o.callback=n),Ws(e,o),Hd(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ud(),r=Vd(e),a=js(n,r);a.tag=2,null!=t&&(a.callback=t),Ws(e,a),Hd(e,r,n)}};function $s(e,t,n,r,a,o,l){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,l):!t.prototype||!t.prototype.isPureReactComponent||(!Ui(n,r)||!Ui(a,o))}function Ys(e,t,n){var r=!1,a=Uu,o=t.contextType;return"object"==typeof o&&null!==o?o=zs(o):(a=Ku(t)?qu:Vu.current,o=(r=null!=(r=t.contextTypes))?Qu(e,a):Uu),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ks,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function Xs(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ks.enqueueReplaceState(t,t.state,null)}function Gs(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=qs,Is(e);var o=t.contextType;"object"==typeof o&&null!==o?a.context=zs(o):(o=Ku(t)?qu:Vu.current,a.context=Qu(e,o)),Vs(e,n,a,r),a.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(Qs(e,t,o,n),a.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(t=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Ks.enqueueReplaceState(a,a.state,null),Vs(e,n,a,r),a.state=e.memoizedState),"function"==typeof a.componentDidMount&&(e.flags|=4)}var Js=Array.isArray;function Zs(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(zr(309));var r=n.stateNode}if(!r)throw Error(zr(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===qs&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(zr(284));if(!n._owner)throw Error(zr(290,e))}return e}function ec(e,t){if("textarea"!==e.type)throw Error(zr(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function tc(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ep(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function l(t){return e&&null===t.alternate&&(t.flags=2),t}function i(e,t,n,r){return null===t||6!==t.tag?((t=Tp(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Zs(e,t,n),r.return=e,r):((r=xp(n.type,n.key,n.props,null,e.mode,r)).ref=Zs(e,t,n),r.return=e,r)}function s(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=_p(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function c(e,t,n,r,o){return null===t||7!==t.tag?((t=Sp(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Tp(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Jr:return(n=xp(t.type,t.key,t.props,null,e.mode,n)).ref=Zs(e,null,t),n.return=e,n;case Zr:return(t=_p(t,e.mode,n)).return=e,t}if(Js(t)||ba(t))return(t=Sp(t,e.mode,n,null)).return=e,t;ec(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==a?null:i(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Jr:return n.key===a?n.type===ea?c(e,t,n.props.children,r,a):u(e,t,n,r):null;case Zr:return n.key===a?s(e,t,n,r):null}if(Js(n)||ba(n))return null!==a?null:c(e,t,n,r,null);ec(e,n)}return null}function p(e,t,n,r,a){if("string"==typeof r||"number"==typeof r)return i(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Jr:return e=e.get(null===r.key?n:r.key)||null,r.type===ea?c(t,e,r.props.children,a,r.key):u(t,e,r,a);case Zr:return s(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(Js(r)||ba(r))return c(t,e=e.get(n)||null,r,a,null);ec(t,r)}return null}function h(a,l,i,u){for(var s=null,c=null,h=l,v=l=0,g=null;null!==h&&v<i.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var m=d(a,h,i[v],u);if(null===m){null===h&&(h=g);break}e&&h&&null===m.alternate&&t(a,h),l=o(m,l,v),null===c?s=m:c.sibling=m,c=m,h=g}if(v===i.length)return n(a,h),s;if(null===h){for(;v<i.length;v++)null!==(h=f(a,i[v],u))&&(l=o(h,l,v),null===c?s=h:c.sibling=h,c=h);return s}for(h=r(a,h);v<i.length;v++)null!==(g=p(h,a,v,i[v],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?v:g.key),l=o(g,l,v),null===c?s=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(a,e)})),s}function v(a,l,i,u){var s=ba(i);if("function"!=typeof s)throw Error(zr(150));if(null==(i=s.call(i)))throw Error(zr(151));for(var c=s=null,h=l,v=l=0,g=null,m=i.next();null!==h&&!m.done;v++,m=i.next()){h.index>v?(g=h,h=null):g=h.sibling;var b=d(a,h,m.value,u);if(null===b){null===h&&(h=g);break}e&&h&&null===b.alternate&&t(a,h),l=o(b,l,v),null===c?s=b:c.sibling=b,c=b,h=g}if(m.done)return n(a,h),s;if(null===h){for(;!m.done;v++,m=i.next())null!==(m=f(a,m.value,u))&&(l=o(m,l,v),null===c?s=m:c.sibling=m,c=m);return s}for(h=r(a,h);!m.done;v++,m=i.next())null!==(m=p(h,a,v,m.value,u))&&(e&&null!==m.alternate&&h.delete(null===m.key?v:m.key),l=o(m,l,v),null===c?s=m:c.sibling=m,c=m);return e&&h.forEach((function(e){return t(a,e)})),s}return function(e,r,o,i){var u="object"==typeof o&&null!==o&&o.type===ea&&null===o.key;u&&(o=o.props.children);var s="object"==typeof o&&null!==o;if(s)switch(o.$$typeof){case Jr:e:{for(s=o.key,u=r;null!==u;){if(u.key===s){if(7===u.tag){if(o.type===ea){n(e,u.sibling),(r=a(u,o.props.children)).return=e,e=r;break e}}else if(u.elementType===o.type){n(e,u.sibling),(r=a(u,o.props)).ref=Zs(e,u,o),r.return=e,e=r;break e}n(e,u);break}t(e,u),u=u.sibling}o.type===ea?((r=Sp(o.props.children,e.mode,i,o.key)).return=e,e=r):((i=xp(o.type,o.key,o.props,null,e.mode,i)).ref=Zs(e,r,o),i.return=e,e=i)}return l(e);case Zr:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=a(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=_p(o,e.mode,i)).return=e,e=r}return l(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,o)).return=e,e=r):(n(e,r),(r=Tp(o,e.mode,i)).return=e,e=r),l(e);if(Js(o))return h(e,r,o,i);if(ba(o))return v(e,r,o,i);if(s&&ec(e,o),void 0===o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(zr(152,xa(e.type)||"Component"))}return n(e,r)}}var nc=tc(!0),rc=tc(!1),ac={},oc=Au(ac),lc=Au(ac),ic=Au(ac);function uc(e){if(e===ac)throw Error(zr(174));return e}function sc(e,t){switch(Wu(ic,t),Wu(lc,e),Wu(oc,ac),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ha(null,"");break;default:t=Ha(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ju(oc),Wu(oc,t)}function cc(){ju(oc),ju(lc),ju(ic)}function fc(e){uc(ic.current);var t=uc(oc.current),n=Ha(t,e.type);t!==n&&(Wu(lc,e),Wu(oc,n))}function dc(e){lc.current===e&&(ju(oc),ju(lc))}var pc=Au(0);function hc(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vc=null,gc=null,mc=!1;function bc(e,t){var n=wp(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function yc(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function wc(e){if(mc){var t=gc;if(t){var n=t;if(!yc(e,t)){if(!(t=Su(n.nextSibling))||!yc(e,t))return e.flags=-1025&e.flags|2,mc=!1,void(vc=e);bc(vc,n)}vc=e,gc=Su(t.firstChild)}else e.flags=-1025&e.flags|2,mc=!1,vc=e}}function kc(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;vc=e}function Ec(e){if(e!==vc)return!1;if(!mc)return kc(e),mc=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!wu(t,e.memoizedProps))for(t=gc;t;)bc(e,t),t=Su(t.nextSibling);if(kc(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(zr(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){gc=Su(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}gc=null}}else gc=vc?Su(e.stateNode.nextSibling):null;return!0}function xc(){gc=vc=null,mc=!1}var Sc=[];function Cc(){for(var e=0;e<Sc.length;e++)Sc[e]._workInProgressVersionPrimary=null;Sc.length=0}var Tc=Gr.ReactCurrentDispatcher,_c=Gr.ReactCurrentBatchConfig,Oc=0,Pc=null,Dc=null,Nc=null,Mc=!1,Rc=!1;function Lc(){throw Error(zr(321))}function Fc(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ji(e[n],t[n]))return!1;return!0}function zc(e,t,n,r,a,o){if(Oc=o,Pc=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Tc.current=null===e||null===e.memoizedState?sf:cf,e=n(r,a),Rc){o=0;do{if(Rc=!1,!(25>o))throw Error(zr(301));o+=1,Nc=Dc=null,t.updateQueue=null,Tc.current=ff,e=n(r,a)}while(Rc)}if(Tc.current=uf,t=null!==Dc&&null!==Dc.next,Oc=0,Nc=Dc=Pc=null,Mc=!1,t)throw Error(zr(300));return e}function Bc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Nc?Pc.memoizedState=Nc=e:Nc=Nc.next=e,Nc}function Ic(){if(null===Dc){var e=Pc.alternate;e=null!==e?e.memoizedState:null}else e=Dc.next;var t=null===Nc?Pc.memoizedState:Nc.next;if(null!==t)Nc=t,Dc=e;else{if(null===e)throw Error(zr(310));e={memoizedState:(Dc=e).memoizedState,baseState:Dc.baseState,baseQueue:Dc.baseQueue,queue:Dc.queue,next:null},null===Nc?Pc.memoizedState=Nc=e:Nc=Nc.next=e}return Nc}function Ac(e,t){return"function"==typeof t?t(e):t}function jc(e){var t=Ic(),n=t.queue;if(null===n)throw Error(zr(311));n.lastRenderedReducer=e;var r=Dc,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var l=a.next;a.next=o.next,o.next=l}r.baseQueue=a=o,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var i=l=o=null,u=a;do{var s=u.lane;if((Oc&s)===s)null!==i&&(i=i.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var c={lane:s,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===i?(l=i=c,o=r):i=i.next=c,Pc.lanes|=s,md|=s}u=u.next}while(null!==u&&u!==a);null===i?o=r:i.next=l,ji(r,t.memoizedState)||(pf=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=i,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Wc(e){var t=Ic(),n=t.queue;if(null===n)throw Error(zr(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var l=a=a.next;do{o=e(o,l.action),l=l.next}while(l!==a);ji(o,t.memoizedState)||(pf=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Uc(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Oc&e)===e)&&(t._workInProgressVersionPrimary=r,Sc.push(t))),e)return n(t._source);throw Sc.push(t),Error(zr(350))}function Vc(e,t,n,r){var a=sd;if(null===a)throw Error(zr(349));var o=t._getVersion,l=o(t._source),i=Tc.current,u=i.useState((function(){return Uc(a,t,n)})),s=u[1],c=u[0];u=Nc;var f=e.memoizedState,d=f.refs,p=d.getSnapshot,h=f.source;f=f.subscribe;var v=Pc;return e.memoizedState={refs:d,source:t,subscribe:r},i.useEffect((function(){d.getSnapshot=n,d.setSnapshot=s;var e=o(t._source);if(!ji(l,e)){e=n(t._source),ji(c,e)||(s(e),e=Vd(v),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,i=e;0<i;){var u=31-kl(i),f=1<<u;r[u]|=e,i&=~f}}}),[n,t,r]),i.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=Vd(v);a.mutableReadLanes|=r&a.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),ji(p,n)&&ji(h,t)&&ji(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:c}).dispatch=s=lf.bind(null,Pc,e),u.queue=e,u.baseQueue=null,c=Uc(a,t,n),u.memoizedState=u.baseState=c),c}function Hc(e,t,n){return Vc(Ic(),e,t,n)}function qc(e){var t=Bc();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:e}).dispatch=lf.bind(null,Pc,e),[t.memoizedState,e]}function Qc(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Pc.updateQueue)?(t={lastEffect:null},Pc.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Kc(e){return e={current:e},Bc().memoizedState=e}function $c(){return Ic().memoizedState}function Yc(e,t,n,r){var a=Bc();Pc.flags|=e,a.memoizedState=Qc(1|t,n,void 0,void 0===r?null:r)}function Xc(e,t,n,r){var a=Ic();r=void 0===r?null:r;var o=void 0;if(null!==Dc){var l=Dc.memoizedState;if(o=l.destroy,null!==r&&Fc(r,l.deps))return void Qc(t,n,o,r)}Pc.flags|=e,a.memoizedState=Qc(1|t,n,o,r)}function Gc(e,t){return Yc(516,4,e,t)}function Jc(e,t){return Xc(516,4,e,t)}function Zc(e,t){return Xc(4,2,e,t)}function ef(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tf(e,t,n){return n=null!=n?n.concat([e]):null,Xc(4,2,ef.bind(null,t,e),n)}function nf(){}function rf(e,t){var n=Ic();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Fc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function af(e,t){var n=Ic();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Fc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function of(e,t){var n=ws();Es(98>n?98:n,(function(){e(!0)})),Es(97<n?97:n,(function(){var n=_c.transition;_c.transition=1;try{e(!1),t()}finally{_c.transition=n}}))}function lf(e,t,n){var r=Ud(),a=Vd(e),o={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},l=t.pending;if(null===l?o.next=o:(o.next=l.next,l.next=o),t.pending=o,l=e.alternate,e===Pc||null!==l&&l===Pc)Rc=Mc=!0;else{if(0===e.lanes&&(null===l||0===l.lanes)&&null!==(l=t.lastRenderedReducer))try{var i=t.lastRenderedState,u=l(i,n);if(o.eagerReducer=l,o.eagerState=u,ji(u,i))return}catch(e){}Hd(e,a,r)}}var uf={readContext:zs,useCallback:Lc,useContext:Lc,useEffect:Lc,useImperativeHandle:Lc,useLayoutEffect:Lc,useMemo:Lc,useReducer:Lc,useRef:Lc,useState:Lc,useDebugValue:Lc,useDeferredValue:Lc,useTransition:Lc,useMutableSource:Lc,useOpaqueIdentifier:Lc,unstable_isNewReconciler:!1},sf={readContext:zs,useCallback:function(e,t){return Bc().memoizedState=[e,void 0===t?null:t],e},useContext:zs,useEffect:Gc,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Yc(4,2,ef.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yc(4,2,e,t)},useMemo:function(e,t){var n=Bc();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Bc();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=lf.bind(null,Pc,e),[r.memoizedState,e]},useRef:Kc,useState:qc,useDebugValue:nf,useDeferredValue:function(e){var t=qc(e),n=t[0],r=t[1];return Gc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=qc(!1),t=e[0];return Kc(e=of.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=Bc();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},Vc(r,e,t,n)},useOpaqueIdentifier:function(){if(mc){var e=!1,t=function(e){return{$$typeof:fa,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Tu++).toString(36))),Error(zr(355))})),n=qc(t)[1];return 0==(2&Pc.mode)&&(Pc.flags|=516,Qc(5,(function(){n("r:"+(Tu++).toString(36))}),void 0,null)),t}return qc(t="r:"+(Tu++).toString(36)),t},unstable_isNewReconciler:!1},cf={readContext:zs,useCallback:rf,useContext:zs,useEffect:Jc,useImperativeHandle:tf,useLayoutEffect:Zc,useMemo:af,useReducer:jc,useRef:$c,useState:function(){return jc(Ac)},useDebugValue:nf,useDeferredValue:function(e){var t=jc(Ac),n=t[0],r=t[1];return Jc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=jc(Ac)[0];return[$c().current,e]},useMutableSource:Hc,useOpaqueIdentifier:function(){return jc(Ac)[0]},unstable_isNewReconciler:!1},ff={readContext:zs,useCallback:rf,useContext:zs,useEffect:Jc,useImperativeHandle:tf,useLayoutEffect:Zc,useMemo:af,useReducer:Wc,useRef:$c,useState:function(){return Wc(Ac)},useDebugValue:nf,useDeferredValue:function(e){var t=Wc(Ac),n=t[0],r=t[1];return Jc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=Wc(Ac)[0];return[$c().current,e]},useMutableSource:Hc,useOpaqueIdentifier:function(){return Wc(Ac)[0]},unstable_isNewReconciler:!1},df=Gr.ReactCurrentOwner,pf=!1;function hf(e,t,n,r){t.child=null===e?rc(t,null,n,r):nc(t,e.child,n,r)}function vf(e,t,n,r,a){n=n.render;var o=t.ref;return Fs(t,a),r=zc(e,t,n,r,o,a),null===e||pf?(t.flags|=1,hf(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,Ff(e,t,a))}function gf(e,t,n,r,a,o){if(null===e){var l=n.type;return"function"!=typeof l||kp(l)||void 0!==l.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=xp(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=l,mf(e,t,l,r,a,o))}return l=e.child,0==(a&o)&&(a=l.memoizedProps,(n=null!==(n=n.compare)?n:Ui)(a,r)&&e.ref===t.ref)?Ff(e,t,o):(t.flags|=1,(e=Ep(l,r)).ref=t.ref,e.return=t,t.child=e)}function mf(e,t,n,r,a,o){if(null!==e&&Ui(e.memoizedProps,r)&&e.ref===t.ref){if(pf=!1,0==(o&a))return t.lanes=e.lanes,Ff(e,t,o);0!=(16384&e.flags)&&(pf=!0)}return wf(e,t,n,r,o)}function bf(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},Jd(t,n);else{if(0==(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Jd(t,e),null;t.memoizedState={baseLanes:0},Jd(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Jd(t,r);return hf(e,t,a,n),t.child}function yf(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function wf(e,t,n,r,a){var o=Ku(n)?qu:Vu.current;return o=Qu(t,o),Fs(t,a),n=zc(e,t,n,r,o,a),null===e||pf?(t.flags|=1,hf(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,Ff(e,t,a))}function kf(e,t,n,r,a){if(Ku(n)){var o=!0;Gu(t)}else o=!1;if(Fs(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Ys(t,n,r),Gs(t,n,r,a),r=!0;else if(null===e){var l=t.stateNode,i=t.memoizedProps;l.props=i;var u=l.context,s=n.contextType;"object"==typeof s&&null!==s?s=zs(s):s=Qu(t,s=Ku(n)?qu:Vu.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof l.getSnapshotBeforeUpdate;f||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(i!==r||u!==s)&&Xs(t,l,r,s),Bs=!1;var d=t.memoizedState;l.state=d,Vs(t,r,l,a),u=t.memoizedState,i!==r||d!==u||Hu.current||Bs?("function"==typeof c&&(Qs(t,n,c,r),u=t.memoizedState),(i=Bs||$s(t,n,i,r,d,u,s))?(f||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||("function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"==typeof l.componentDidMount&&(t.flags|=4)):("function"==typeof l.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=s,r=i):("function"==typeof l.componentDidMount&&(t.flags|=4),r=!1)}else{l=t.stateNode,As(e,t),i=t.memoizedProps,s=t.type===t.elementType?i:_s(t.type,i),l.props=s,f=t.pendingProps,d=l.context,"object"==typeof(u=n.contextType)&&null!==u?u=zs(u):u=Qu(t,u=Ku(n)?qu:Vu.current);var p=n.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof l.getSnapshotBeforeUpdate)||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(i!==f||d!==u)&&Xs(t,l,r,u),Bs=!1,d=t.memoizedState,l.state=d,Vs(t,r,l,a);var h=t.memoizedState;i!==f||d!==h||Hu.current||Bs?("function"==typeof p&&(Qs(t,n,p,r),h=t.memoizedState),(s=Bs||$s(t,n,s,r,d,h,u))?(c||"function"!=typeof l.UNSAFE_componentWillUpdate&&"function"!=typeof l.componentWillUpdate||("function"==typeof l.componentWillUpdate&&l.componentWillUpdate(r,h,u),"function"==typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(r,h,u)),"function"==typeof l.componentDidUpdate&&(t.flags|=4),"function"==typeof l.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof l.componentDidUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),l.props=r,l.state=h,l.context=u,r=s):("function"!=typeof l.componentDidUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Ef(e,t,n,r,o,a)}function Ef(e,t,n,r,a,o){yf(e,t);var l=0!=(64&t.flags);if(!r&&!l)return a&&Ju(t,n,!1),Ff(e,t,o);r=t.stateNode,df.current=t;var i=l&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&l?(t.child=nc(t,e.child,null,o),t.child=nc(t,null,i,o)):hf(e,t,i,o),t.memoizedState=r.state,a&&Ju(t,n,!0),t.child}function xf(e){var t=e.stateNode;t.pendingContext?Yu(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Yu(0,t.context,!1),sc(e,t.containerInfo)}var Sf,Cf,Tf,_f={dehydrated:null,retryLane:0};function Of(e,t,n){var r,a=t.pendingProps,o=pc.current,l=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&o)),r?(l=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),Wu(pc,1&o),null===e?(void 0!==a.fallback&&wc(t),e=a.children,o=a.fallback,l?(e=Pf(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=_f,e):"number"==typeof a.unstable_expectedLoadTime?(e=Pf(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=_f,t.lanes=33554432,e):((n=Cp({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,l?(a=Nf(e,t,a.children,a.fallback,n),l=t.child,o=e.child.memoizedState,l.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},l.childLanes=e.childLanes&~n,t.memoizedState=_f,a):(n=Df(e,t,a.children,n),t.memoizedState=null,n))}function Pf(e,t,n,r){var a=e.mode,o=e.child;return t={mode:"hidden",children:t},0==(2&a)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Cp(t,a,0,null),n=Sp(n,a,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Df(e,t,n,r){var a=e.child;return e=a.sibling,n=Ep(a,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Nf(e,t,n,r,a){var o=t.mode,l=e.child;e=l.sibling;var i={mode:"hidden",children:n};return 0==(2&o)&&t.child!==l?((n=t.child).childLanes=0,n.pendingProps=i,null!==(l=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=l,l.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Ep(l,i),null!==e?r=Ep(e,r):(r=Sp(r,o,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Mf(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ls(e.return,t)}function Rf(e,t,n,r,a,o){var l=e.memoizedState;null===l?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a,l.lastEffect=o)}function Lf(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(hf(e,t,r.children,n),0!=(2&(r=pc.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Mf(e,n);else if(19===e.tag)Mf(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Wu(pc,r),0==(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===hc(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Rf(t,!1,a,n,o,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===hc(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Rf(t,!0,n,null,o,t.lastEffect);break;case"together":Rf(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ff(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),md|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(zr(153));if(null!==t.child){for(n=Ep(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ep(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function zf(e,t){if(!mc)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Bf(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return Ku(t.type)&&$u(),null;case 3:return cc(),ju(Hu),ju(Vu),Cc(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Ec(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:dc(t);var a=uc(ic.current);if(n=t.type,null!==e&&null!=t.stateNode)Cf(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(zr(166));return null}if(e=uc(oc.current),Ec(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Ou]=t,r[Pu]=o,n){case"dialog":lu("cancel",r),lu("close",r);break;case"iframe":case"object":case"embed":lu("load",r);break;case"video":case"audio":for(e=0;e<nu.length;e++)lu(nu[e],r);break;case"source":lu("error",r);break;case"img":case"image":case"link":lu("error",r),lu("load",r);break;case"details":lu("toggle",r);break;case"input":Da(r,o),lu("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},lu("invalid",r);break;case"textarea":Ia(r,o),lu("invalid",r)}for(var l in eo(n,o),e=null,o)o.hasOwnProperty(l)&&(a=o[l],"children"===l?"string"==typeof a?r.textContent!==a&&(e=["children",a]):"number"==typeof a&&r.textContent!==""+a&&(e=["children",""+a]):Ir.hasOwnProperty(l)&&null!=a&&"onScroll"===l&&lu("scroll",r));switch(n){case"input":Ta(r),Ra(r,o,!0);break;case"textarea":Ta(r),ja(r);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(r.onclick=gu)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(l=9===a.nodeType?a:a.ownerDocument,e===Wa&&(e=Va(n)),e===Wa?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Ou]=t,e[Pu]=r,Sf(e,t),t.stateNode=e,l=to(n,r),n){case"dialog":lu("cancel",e),lu("close",e),a=r;break;case"iframe":case"object":case"embed":lu("load",e),a=r;break;case"video":case"audio":for(a=0;a<nu.length;a++)lu(nu[a],e);a=r;break;case"source":lu("error",e),a=r;break;case"img":case"image":case"link":lu("error",e),lu("load",e),a=r;break;case"details":lu("toggle",e),a=r;break;case"input":Da(e,r),a=Pa(e,r),lu("invalid",e);break;case"option":a=Fa(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Mr({},r,{value:void 0}),lu("invalid",e);break;case"textarea":Ia(e,r),a=Ba(e,r),lu("invalid",e);break;default:a=r}eo(n,a);var i=a;for(o in i)if(i.hasOwnProperty(o)){var u=i[o];"style"===o?Ja(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&Ka(e,u):"children"===o?"string"==typeof u?("textarea"!==n||""!==u)&&$a(e,u):"number"==typeof u&&$a(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(Ir.hasOwnProperty(o)?null!=u&&"onScroll"===o&&lu("scroll",e):null!=u&&Xr(e,o,u,l))}switch(n){case"input":Ta(e),Ra(e,r,!1);break;case"textarea":Ta(e),ja(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Sa(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?za(e,!!r.multiple,o,!1):null!=r.defaultValue&&za(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=gu)}yu(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Tf(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(zr(166));n=uc(ic.current),uc(oc.current),Ec(t)?(r=t.stateNode,n=t.memoizedProps,r[Ou]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ou]=t,t.stateNode=r)}return null;case 13:return ju(pc),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Ec(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&pc.current)?0===hd&&(hd=3):(0!==hd&&3!==hd||(hd=4),null===sd||0==(134217727&md)&&0==(134217727&bd)||$d(sd,fd))),(r||n)&&(t.flags|=4),null);case 4:return cc(),null===e&&uu(t.stateNode.containerInfo),null;case 10:return Rs(t),null;case 19:if(ju(pc),null===(r=t.memoizedState))return null;if(o=0!=(64&t.flags),null===(l=r.rendering))if(o)zf(r,!1);else{if(0!==hd||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(l=hc(e))){for(t.flags|=64,zf(r,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Wu(pc,1&pc.current|2),t.child}e=e.sibling}null!==r.tail&&ys()>Ed&&(t.flags|=64,o=!0,zf(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=hc(l))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),zf(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!mc)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*ys()-r.renderingStartTime>Ed&&1073741824!==n&&(t.flags|=64,o=!0,zf(r,!1),t.lanes=33554432);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=ys(),n.sibling=null,t=pc.current,Wu(pc,o?1&t|2:1&t),n):null;case 23:case 24:return Zd(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(zr(156,t.tag))}function If(e){switch(e.tag){case 1:Ku(e.type)&&$u();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(cc(),ju(Hu),ju(Vu),Cc(),0!=(64&(t=e.flags)))throw Error(zr(285));return e.flags=-4097&t|64,e;case 5:return dc(e),null;case 13:return ju(pc),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ju(pc),null;case 4:return cc(),null;case 10:return Rs(e),null;case 23:case 24:return Zd(),null;default:return null}}function Af(e,t){try{var n="",r=t;do{n+=Ea(r),r=r.return}while(r);var a=n}catch(e){a="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:a}}function jf(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Sf=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Cf=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,uc(oc.current);var o,l=null;switch(n){case"input":a=Pa(e,a),r=Pa(e,r),l=[];break;case"option":a=Fa(e,a),r=Fa(e,r),l=[];break;case"select":a=Mr({},a,{value:void 0}),r=Mr({},r,{value:void 0}),l=[];break;case"textarea":a=Ba(e,a),r=Ba(e,r),l=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(e.onclick=gu)}for(s in eo(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s){var i=a[s];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(Ir.hasOwnProperty(s)?l||(l=[]):(l=l||[]).push(s,null));for(s in r){var u=r[s];if(i=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&u!==i&&(null!=u||null!=i))if("style"===s)if(i){for(o in i)!i.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&i[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(l||(l=[]),l.push(s,n)),n=u;else"dangerouslySetInnerHTML"===s?(u=u?u.__html:void 0,i=i?i.__html:void 0,null!=u&&i!==u&&(l=l||[]).push(s,u)):"children"===s?"string"!=typeof u&&"number"!=typeof u||(l=l||[]).push(s,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(Ir.hasOwnProperty(s)?(null!=u&&"onScroll"===s&&lu("scroll",e),l||i===u||(l=[])):"object"==typeof u&&null!==u&&u.$$typeof===fa?u.toString():(l=l||[]).push(s,u))}n&&(l=l||[]).push("style",n);var s=l;(t.updateQueue=s)&&(t.flags|=4)}},Tf=function(e,t,n,r){n!==r&&(t.flags|=4)};var Wf="function"==typeof WeakMap?WeakMap:Map;function Uf(e,t,n){(n=js(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Td||(Td=!0,_d=r),jf(0,t)},n}function Vf(e,t,n){(n=js(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var a=t.value;n.payload=function(){return jf(0,t),r(a)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Od?Od=new Set([this]):Od.add(this),jf(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var Hf="function"==typeof WeakSet?WeakSet:Set;function qf(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){gp(e,t)}else t.current=null}function Qf(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:_s(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&xu(t.stateNode.containerInfo))}throw Error(zr(163))}function Kf(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!=(4&(a=a.tag))&&0!=(1&a)&&(pp(n,e),dp(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:_s(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&Hs(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}Hs(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&yu(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Zo(n)))))}throw Error(zr(163))}function $f(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=null!=a&&a.hasOwnProperty("display")?a.display:null,r.style.display=Ga("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Yf(e,t){if(es&&"function"==typeof es.onCommitFiberUnmount)try{es.onCommitFiberUnmount(Zu,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!=(4&r))pp(t,n);else{r=t;try{a()}catch(e){gp(r,e)}}n=n.next}while(n!==e)}break;case 1:if(qf(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){gp(t,e)}break;case 5:qf(t);break;case 4:td(e,t)}}function Xf(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Gf(e){return 5===e.tag||3===e.tag||4===e.tag}function Jf(e){e:{for(var t=e.return;null!==t;){if(Gf(t))break e;t=t.return}throw Error(zr(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(zr(161))}16&n.flags&&($a(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Gf(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Zf(e,n,t):ed(e,n,t)}function Zf(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=gu));else if(4!==r&&null!==(e=e.child))for(Zf(e,t,n),e=e.sibling;null!==e;)Zf(e,t,n),e=e.sibling}function ed(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ed(e,t,n),e=e.sibling;null!==e;)ed(e,t,n),e=e.sibling}function td(e,t){for(var n,r,a=t,o=!1;;){if(!o){o=a.return;e:for(;;){if(null===o)throw Error(zr(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===a.tag||6===a.tag){e:for(var l=e,i=a,u=i;;)if(Yf(l,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===i)break e;for(;null===u.sibling;){if(null===u.return||u.return===i)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(l=n,i=a.stateNode,8===l.nodeType?l.parentNode.removeChild(i):l.removeChild(i)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(Yf(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function nd(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Pu]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Na(n,r),to(e,a),t=to(e,r),a=0;a<o.length;a+=2){var l=o[a],i=o[a+1];"style"===l?Ja(n,i):"dangerouslySetInnerHTML"===l?Ka(n,i):"children"===l?$a(n,i):Xr(n,l,i,t)}switch(e){case"input":Ma(n,r);break;case"textarea":Aa(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?za(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?za(n,!!r.multiple,r.defaultValue,!0):za(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(zr(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,Zo(n.containerInfo)));case 13:return null!==t.memoizedState&&(kd=ys(),$f(t.child,!0)),void rd(t);case 19:return void rd(t);case 23:case 24:return void $f(t,null!==t.memoizedState)}throw Error(zr(163))}function rd(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Hf),t.forEach((function(t){var r=bp.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ad(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var od=Math.ceil,ld=Gr.ReactCurrentDispatcher,id=Gr.ReactCurrentOwner,ud=0,sd=null,cd=null,fd=0,dd=0,pd=Au(0),hd=0,vd=null,gd=0,md=0,bd=0,yd=0,wd=null,kd=0,Ed=1/0;function xd(){Ed=ys()+500}var Sd,Cd=null,Td=!1,_d=null,Od=null,Pd=!1,Dd=null,Nd=90,Md=[],Rd=[],Ld=null,Fd=0,zd=null,Bd=-1,Id=0,Ad=0,jd=null,Wd=!1;function Ud(){return 0!=(48&ud)?ys():-1!==Bd?Bd:Bd=ys()}function Vd(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===ws()?1:2;if(0===Id&&(Id=gd),0!==Ts.transition){0!==Ad&&(Ad=null!==wd?wd.pendingLanes:0),e=Id;var t=4186112&~Ad;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=ws(),0!=(4&ud)&&98===e?e=ml(12,Id):e=ml(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Id),e}function Hd(e,t,n){if(50<Fd)throw Fd=0,zd=null,Error(zr(185));if(null===(e=qd(e,t)))return null;wl(e,t,n),e===sd&&(bd|=t,4===hd&&$d(e,fd));var r=ws();1===t?0!=(8&ud)&&0==(48&ud)?Yd(e):(Qd(e,n),0===ud&&(xd(),Ss())):(0==(4&ud)||98!==r&&99!==r||(null===Ld?Ld=new Set([e]):Ld.add(e)),Qd(e,n)),wd=e}function qd(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Qd(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-kl(l),u=1<<i,s=o[i];if(-1===s){if(0==(u&r)||0!=(u&a)){s=t,hl(u);var c=pl;o[i]=10<=c?s+250:6<=c?s+5e3:-1}}else s<=t&&(e.expiredLanes|=u);l&=~u}if(r=vl(e,e===sd?fd:0),t=pl,0===r)null!==n&&(n!==ps&&rs(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==ps&&rs(n)}15===t?(n=Yd.bind(null,e),null===vs?(vs=[n],gs=ns(us,Cs)):vs.push(n),n=ps):14===t?n=xs(99,Yd.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(zr(358,e))}}(t),n=xs(n,Kd.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function Kd(e){if(Bd=-1,Ad=Id=0,0!=(48&ud))throw Error(zr(327));var t=e.callbackNode;if(fp()&&e.callbackNode!==t)return null;var n=vl(e,e===sd?fd:0);if(0===n)return null;var r=n,a=ud;ud|=16;var o=np();for(sd===e&&fd===r||(xd(),ep(e,r));;)try{op();break}catch(t){tp(e,t)}if(Ms(),ld.current=o,ud=a,null!==cd?r=0:(sd=null,fd=0,r=hd),0!=(gd&bd))ep(e,0);else if(0!==r){if(2===r&&(ud|=64,e.hydrate&&(e.hydrate=!1,xu(e.containerInfo)),0!==(n=gl(e))&&(r=rp(e,n))),1===r)throw t=vd,ep(e,0),$d(e,n),Qd(e,ys()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(zr(345));case 2:case 5:up(e);break;case 3:if($d(e,n),(62914560&n)===n&&10<(r=kd+500-ys())){if(0!==vl(e,0))break;if(((a=e.suspendedLanes)&n)!==n){Ud(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ku(up.bind(null,e),r);break}up(e);break;case 4:if($d(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var l=31-kl(n);o=1<<l,(l=r[l])>a&&(a=l),n&=~o}if(n=a,10<(n=(120>(n=ys()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*od(n/1960))-n)){e.timeoutHandle=ku(up.bind(null,e),n);break}up(e);break;default:throw Error(zr(329))}}return Qd(e,ys()),e.callbackNode===t?Kd.bind(null,e):null}function $d(e,t){for(t&=~yd,t&=~bd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-kl(t),r=1<<n;e[n]=-1,t&=~r}}function Yd(e){if(0!=(48&ud))throw Error(zr(327));if(fp(),e===sd&&0!=(e.expiredLanes&fd)){var t=fd,n=rp(e,t);0!=(gd&bd)&&(n=rp(e,t=vl(e,t)))}else n=rp(e,t=vl(e,0));if(0!==e.tag&&2===n&&(ud|=64,e.hydrate&&(e.hydrate=!1,xu(e.containerInfo)),0!==(t=gl(e))&&(n=rp(e,t))),1===n)throw n=vd,ep(e,0),$d(e,t),Qd(e,ys()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,up(e),Qd(e,ys()),null}function Xd(e,t){var n=ud;ud|=1;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}}function Gd(e,t){var n=ud;ud&=-2,ud|=8;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}}function Jd(e,t){Wu(pd,dd),dd|=t,gd|=t}function Zd(){dd=pd.current,ju(pd)}function ep(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Eu(n)),null!==cd)for(n=cd.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&$u();break;case 3:cc(),ju(Hu),ju(Vu),Cc();break;case 5:dc(r);break;case 4:cc();break;case 13:case 19:ju(pc);break;case 10:Rs(r);break;case 23:case 24:Zd()}n=n.return}sd=e,cd=Ep(e.current,null),fd=dd=gd=t,hd=0,vd=null,yd=bd=md=0}function tp(e,t){for(;;){var n=cd;try{if(Ms(),Tc.current=uf,Mc){for(var r=Pc.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}Mc=!1}if(Oc=0,Nc=Dc=Pc=null,Rc=!1,id.current=null,null===n||null===n.return){hd=1,vd=t,cd=null;break}e:{var o=e,l=n.return,i=n,u=t;if(t=fd,i.flags|=2048,i.firstEffect=i.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var s=u;if(0==(2&i.mode)){var c=i.alternate;c?(i.updateQueue=c.updateQueue,i.memoizedState=c.memoizedState,i.lanes=c.lanes):(i.updateQueue=null,i.memoizedState=null)}var f=0!=(1&pc.current),d=l;do{var p;if(p=13===d.tag){var h=d.memoizedState;if(null!==h)p=null!==h.dehydrated;else{var v=d.memoizedProps;p=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(p){var g=d.updateQueue;if(null===g){var m=new Set;m.add(s),d.updateQueue=m}else g.add(s);if(0==(2&d.mode)){if(d.flags|=64,i.flags|=16384,i.flags&=-2981,1===i.tag)if(null===i.alternate)i.tag=17;else{var b=js(-1,1);b.tag=2,Ws(i,b)}i.lanes|=1;break e}u=void 0,i=t;var y=o.pingCache;if(null===y?(y=o.pingCache=new Wf,u=new Set,y.set(s,u)):void 0===(u=y.get(s))&&(u=new Set,y.set(s,u)),!u.has(i)){u.add(i);var w=mp.bind(null,o,s,i);s.then(w,w)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((xa(i.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==hd&&(hd=2),u=Af(u,i),d=l;do{switch(d.tag){case 3:o=u,d.flags|=4096,t&=-t,d.lanes|=t,Us(d,Uf(0,o,t));break e;case 1:o=u;var k=d.type,E=d.stateNode;if(0==(64&d.flags)&&("function"==typeof k.getDerivedStateFromError||null!==E&&"function"==typeof E.componentDidCatch&&(null===Od||!Od.has(E)))){d.flags|=4096,t&=-t,d.lanes|=t,Us(d,Vf(d,o,t));break e}}d=d.return}while(null!==d)}ip(n)}catch(e){t=e,cd===n&&null!==n&&(cd=n=n.return);continue}break}}function np(){var e=ld.current;return ld.current=uf,null===e?uf:e}function rp(e,t){var n=ud;ud|=16;var r=np();for(sd===e&&fd===t||ep(e,t);;)try{ap();break}catch(t){tp(e,t)}if(Ms(),ud=n,ld.current=r,null!==cd)throw Error(zr(261));return sd=null,fd=0,hd}function ap(){for(;null!==cd;)lp(cd)}function op(){for(;null!==cd&&!as();)lp(cd)}function lp(e){var t=Sd(e.alternate,e,dd);e.memoizedProps=e.pendingProps,null===t?ip(e):cd=t,id.current=null}function ip(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=Bf(n,t,dd)))return void(cd=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&dd)||0==(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=If(t)))return n.flags&=2047,void(cd=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(cd=t);cd=t=e}while(null!==t);0===hd&&(hd=5)}function up(e){var t=ws();return Es(99,sp.bind(null,e,t)),null}function sp(e,t){do{fp()}while(null!==Dd);if(0!=(48&ud))throw Error(zr(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(zr(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,o=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var l=e.eventTimes,i=e.expirationTimes;0<o;){var u=31-kl(o),s=1<<u;a[u]=0,l[u]=-1,i[u]=-1,o&=~s}if(null!==Ld&&0==(24&r)&&Ld.has(e)&&Ld.delete(e),e===sd&&(cd=sd=null,fd=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=ud,ud|=32,id.current=null,mu=Tl,Ki(l=Qi())){if("selectionStart"in l)i={start:l.selectionStart,end:l.selectionEnd};else e:if(i=(i=l.ownerDocument)&&i.defaultView||window,(s=i.getSelection&&i.getSelection())&&0!==s.rangeCount){i=s.anchorNode,o=s.anchorOffset,u=s.focusNode,s=s.focusOffset;try{i.nodeType,u.nodeType}catch(e){i=null;break e}var c=0,f=-1,d=-1,p=0,h=0,v=l,g=null;t:for(;;){for(var m;v!==i||0!==o&&3!==v.nodeType||(f=c+o),v!==u||0!==s&&3!==v.nodeType||(d=c+s),3===v.nodeType&&(c+=v.nodeValue.length),null!==(m=v.firstChild);)g=v,v=m;for(;;){if(v===l)break t;if(g===i&&++p===o&&(f=c),g===u&&++h===s&&(d=c),null!==(m=v.nextSibling))break;g=(v=g).parentNode}v=m}i=-1===f||-1===d?null:{start:f,end:d}}else i=null;i=i||{start:0,end:0}}else i=null;bu={focusedElem:l,selectionRange:i},Tl=!1,jd=null,Wd=!1,Cd=r;do{try{cp()}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);jd=null,Cd=r;do{try{for(l=e;null!==Cd;){var b=Cd.flags;if(16&b&&$a(Cd.stateNode,""),128&b){var y=Cd.alternate;if(null!==y){var w=y.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&b){case 2:Jf(Cd),Cd.flags&=-3;break;case 6:Jf(Cd),Cd.flags&=-3,nd(Cd.alternate,Cd);break;case 1024:Cd.flags&=-1025;break;case 1028:Cd.flags&=-1025,nd(Cd.alternate,Cd);break;case 4:nd(Cd.alternate,Cd);break;case 8:td(l,i=Cd);var k=i.alternate;Xf(i),null!==k&&Xf(k)}Cd=Cd.nextEffect}}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);if(w=bu,y=Qi(),b=w.focusedElem,l=w.selectionRange,y!==b&&b&&b.ownerDocument&&qi(b.ownerDocument.documentElement,b)){null!==l&&Ki(b)&&(y=l.start,void 0===(w=l.end)&&(w=y),"selectionStart"in b?(b.selectionStart=y,b.selectionEnd=Math.min(w,b.value.length)):(w=(y=b.ownerDocument||document)&&y.defaultView||window).getSelection&&(w=w.getSelection(),i=b.textContent.length,k=Math.min(l.start,i),l=void 0===l.end?k:Math.min(l.end,i),!w.extend&&k>l&&(i=l,l=k,k=i),i=Hi(b,k),o=Hi(b,l),i&&o&&(1!==w.rangeCount||w.anchorNode!==i.node||w.anchorOffset!==i.offset||w.focusNode!==o.node||w.focusOffset!==o.offset)&&((y=y.createRange()).setStart(i.node,i.offset),w.removeAllRanges(),k>l?(w.addRange(y),w.extend(o.node,o.offset)):(y.setEnd(o.node,o.offset),w.addRange(y))))),y=[];for(w=b;w=w.parentNode;)1===w.nodeType&&y.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof b.focus&&b.focus(),b=0;b<y.length;b++)(w=y[b]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Tl=!!mu,bu=mu=null,e.current=n,Cd=r;do{try{for(b=e;null!==Cd;){var E=Cd.flags;if(36&E&&Kf(b,Cd.alternate,Cd),128&E){y=void 0;var x=Cd.ref;if(null!==x){var S=Cd.stateNode;Cd.tag,y=S,"function"==typeof x?x(y):x.current=y}}Cd=Cd.nextEffect}}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);Cd=null,hs(),ud=a}else e.current=n;if(Pd)Pd=!1,Dd=e,Nd=t;else for(Cd=r;null!==Cd;)t=Cd.nextEffect,Cd.nextEffect=null,8&Cd.flags&&((E=Cd).sibling=null,E.stateNode=null),Cd=t;if(0===(r=e.pendingLanes)&&(Od=null),1===r?e===zd?Fd++:(Fd=0,zd=e):Fd=0,n=n.stateNode,es&&"function"==typeof es.onCommitFiberRoot)try{es.onCommitFiberRoot(Zu,n,void 0,64==(64&n.current.flags))}catch(e){}if(Qd(e,ys()),Td)throw Td=!1,e=_d,_d=null,e;return 0!=(8&ud)||Ss(),null}function cp(){for(;null!==Cd;){var e=Cd.alternate;Wd||null===jd||(0!=(8&Cd.flags)?No(Cd,jd)&&(Wd=!0):13===Cd.tag&&ad(e,Cd)&&No(Cd,jd)&&(Wd=!0));var t=Cd.flags;0!=(256&t)&&Qf(e,Cd),0==(512&t)||Pd||(Pd=!0,xs(97,(function(){return fp(),null}))),Cd=Cd.nextEffect}}function fp(){if(90!==Nd){var e=97<Nd?97:Nd;return Nd=90,Es(e,hp)}return!1}function dp(e,t){Md.push(t,e),Pd||(Pd=!0,xs(97,(function(){return fp(),null})))}function pp(e,t){Rd.push(t,e),Pd||(Pd=!0,xs(97,(function(){return fp(),null})))}function hp(){if(null===Dd)return!1;var e=Dd;if(Dd=null,0!=(48&ud))throw Error(zr(331));var t=ud;ud|=32;var n=Rd;Rd=[];for(var r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],l=a.destroy;if(a.destroy=void 0,"function"==typeof l)try{l()}catch(e){if(null===o)throw Error(zr(330));gp(o,e)}}for(n=Md,Md=[],r=0;r<n.length;r+=2){a=n[r],o=n[r+1];try{var i=a.create;a.destroy=i()}catch(e){if(null===o)throw Error(zr(330));gp(o,e)}}for(i=e.current.firstEffect;null!==i;)e=i.nextEffect,i.nextEffect=null,8&i.flags&&(i.sibling=null,i.stateNode=null),i=e;return ud=t,Ss(),!0}function vp(e,t,n){Ws(e,t=Uf(0,t=Af(n,t),1)),t=Ud(),null!==(e=qd(e,1))&&(wl(e,1,t),Qd(e,t))}function gp(e,t){if(3===e.tag)vp(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){vp(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Od||!Od.has(r))){var a=Vf(n,e=Af(t,e),1);if(Ws(n,a),a=Ud(),null!==(n=qd(n,1)))wl(n,1,a),Qd(n,a);else if("function"==typeof r.componentDidCatch&&(null===Od||!Od.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function mp(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ud(),e.pingedLanes|=e.suspendedLanes&n,sd===e&&(fd&n)===n&&(4===hd||3===hd&&(62914560&fd)===fd&&500>ys()-kd?ep(e,0):yd|=n),Qd(e,t)}function bp(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===ws()?1:2:(0===Id&&(Id=gd),0===(t=bl(62914560&~Id))&&(t=4194304))),n=Ud(),null!==(e=qd(e,t))&&(wl(e,t,n),Qd(e,n))}function yp(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function wp(e,t,n,r){return new yp(e,t,n,r)}function kp(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ep(e,t){var n=e.alternate;return null===n?((n=wp(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xp(e,t,n,r,a,o){var l=2;if(r=e,"function"==typeof e)kp(e)&&(l=1);else if("string"==typeof e)l=5;else e:switch(e){case ea:return Sp(n.children,a,o,t);case da:l=8,a|=16;break;case ta:l=8,a|=1;break;case na:return(e=wp(12,n,t,8|a)).elementType=na,e.type=na,e.lanes=o,e;case la:return(e=wp(13,n,t,a)).type=la,e.elementType=la,e.lanes=o,e;case ia:return(e=wp(19,n,t,a)).elementType=ia,e.lanes=o,e;case pa:return Cp(n,a,o,t);case ha:return(e=wp(24,n,t,a)).elementType=ha,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case ra:l=10;break e;case aa:l=9;break e;case oa:l=11;break e;case ua:l=14;break e;case sa:l=16,r=null;break e;case ca:l=22;break e}throw Error(zr(130,null==e?e:typeof e,""))}return(t=wp(l,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Sp(e,t,n,r){return(e=wp(7,e,r,t)).lanes=n,e}function Cp(e,t,n,r){return(e=wp(23,e,r,t)).elementType=pa,e.lanes=n,e}function Tp(e,t,n){return(e=wp(6,e,null,t)).lanes=n,e}function _p(e,t,n){return(t=wp(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Op(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=yl(0),this.expirationTimes=yl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.mutableSourceEagerHydrationData=null}function Pp(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Zr,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Dp(e,t,n,r){var a=t.current,o=Ud(),l=Vd(a);e:if(n){t:{if(_o(n=n._reactInternals)!==n||1!==n.tag)throw Error(zr(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Ku(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(null!==i);throw Error(zr(171))}if(1===n.tag){var u=n.type;if(Ku(u)){n=Xu(n,u,i);break e}}n=i}else n=Uu;return null===t.context?t.context=n:t.pendingContext=n,(t=js(o,l)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),Ws(a,t),Hd(a,l,o),l}function Np(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Mp(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Rp(e,t){Mp(e,t),(e=e.alternate)&&Mp(e,t)}function Lp(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Op(e,t,null!=n&&!0===n.hydrate),t=wp(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,Is(t),e[Du]=n.current,uu(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function Fp(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function zp(e,t,n,r,a){var o=n._reactRootContainer;if(o){var l=o._internalRoot;if("function"==typeof a){var i=a;a=function(){var e=Np(l);i.call(e)}}Dp(t,l,e,a)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Lp(e,0,t?{hydrate:!0}:void 0)}(n,r),l=o._internalRoot,"function"==typeof a){var u=a;a=function(){var e=Np(l);u.call(e)}}Gd((function(){Dp(t,l,e,a)}))}return Np(l)}function Bp(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Fp(t))throw Error(zr(200));return Pp(e,t,null,n)}Sd=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||Hu.current)pf=!0;else{if(0==(n&r)){switch(pf=!1,t.tag){case 3:xf(t),xc();break;case 5:fc(t);break;case 1:Ku(t.type)&&Gu(t);break;case 4:sc(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;Wu(Os,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?Of(e,t,n):(Wu(pc,1&pc.current),null!==(t=Ff(e,t,n))?t.sibling:null);Wu(pc,1&pc.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return Lf(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Wu(pc,pc.current),r)break;return null;case 23:case 24:return t.lanes=0,bf(e,t,n)}return Ff(e,t,n)}pf=0!=(16384&e.flags)}else pf=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=Qu(t,Vu.current),Fs(t,n),a=zc(null,t,r,e,a,n),t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ku(r)){var o=!0;Gu(t)}else o=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Is(t);var l=r.getDerivedStateFromProps;"function"==typeof l&&Qs(t,r,l,e),a.updater=Ks,t.stateNode=a,a._reactInternals=t,Gs(t,r,e,n),t=Ef(null,t,r,!0,o,n)}else t.tag=0,hf(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(o=a._init)(a._payload),t.type=a,o=t.tag=function(e){if("function"==typeof e)return kp(e)?1:0;if(null!=e){if((e=e.$$typeof)===oa)return 11;if(e===ua)return 14}return 2}(a),e=_s(a,e),o){case 0:t=wf(null,t,a,e,n);break e;case 1:t=kf(null,t,a,e,n);break e;case 11:t=vf(null,t,a,e,n);break e;case 14:t=gf(null,t,a,_s(a.type,e),r,n);break e}throw Error(zr(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,wf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 1:return r=t.type,a=t.pendingProps,kf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 3:if(xf(t),r=t.updateQueue,null===e||null===r)throw Error(zr(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,As(e,t),Vs(t,r,null,n),(r=t.memoizedState.element)===a)xc(),t=Ff(e,t,n);else{if((o=(a=t.stateNode).hydrate)&&(gc=Su(t.stateNode.containerInfo.firstChild),vc=t,o=mc=!0),o){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(o=e[a])._workInProgressVersionPrimary=e[a+1],Sc.push(o);for(n=rc(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else hf(e,t,r,n),xc();t=t.child}return t;case 5:return fc(t),null===e&&wc(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,l=a.children,wu(r,a)?l=null:null!==o&&wu(r,o)&&(t.flags|=16),yf(e,t),hf(e,t,l,n),t.child;case 6:return null===e&&wc(t),null;case 13:return Of(e,t,n);case 4:return sc(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=nc(t,null,r,n):hf(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,vf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 7:return hf(e,t,t.pendingProps,n),t.child;case 8:case 12:return hf(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value;var i=t.type._context;if(Wu(Os,i._currentValue),i._currentValue=o,null!==l)if(i=l.value,0===(o=ji(i,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(i,o):1073741823))){if(l.children===a.children&&!Hu.current){t=Ff(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var u=i.dependencies;if(null!==u){l=i.child;for(var s=u.firstContext;null!==s;){if(s.context===r&&0!=(s.observedBits&o)){1===i.tag&&((s=js(-1,n&-n)).tag=2,Ws(i,s)),i.lanes|=n,null!==(s=i.alternate)&&(s.lanes|=n),Ls(i.return,n),u.lanes|=n;break}s=s.next}}else l=10===i.tag&&i.type===t.type?null:i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}hf(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(o=t.pendingProps).children,Fs(t,n),r=r(a=zs(a,o.unstable_observedBits)),t.flags|=1,hf(e,t,r,n),t.child;case 14:return o=_s(a=t.type,t.pendingProps),gf(e,t,a,o=_s(a.type,o),r,n);case 15:return mf(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_s(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Ku(r)?(e=!0,Gu(t)):e=!1,Fs(t,n),Ys(t,r,a),Gs(t,r,a,n),Ef(null,t,r,!0,e,n);case 19:return Lf(e,t,n);case 23:case 24:return bf(e,t,n)}throw Error(zr(156,t.tag))},Lp.prototype.render=function(e){Dp(e,this._internalRoot,null,null)},Lp.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Dp(null,e,null,(function(){t[Du]=null}))},Mo=function(e){13===e.tag&&(Hd(e,4,Ud()),Rp(e,4))},Ro=function(e){13===e.tag&&(Hd(e,67108864,Ud()),Rp(e,67108864))},Lo=function(e){if(13===e.tag){var t=Ud(),n=Vd(e);Hd(e,n,t),Rp(e,n)}},Fo=function(e,t){return t()},ro=function(e,t,n){switch(t){case"input":if(Ma(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Fu(r);if(!a)throw Error(zr(90));_a(r),Ma(r,a)}}}break;case"textarea":Aa(e,n);break;case"select":null!=(t=n.value)&&za(e,!!n.multiple,t,!1)}},so=Xd,co=function(e,t,n,r,a){var o=ud;ud|=4;try{return Es(98,e.bind(null,t,n,r,a))}finally{0===(ud=o)&&(xd(),Ss())}},fo=function(){0==(49&ud)&&(function(){if(null!==Ld){var e=Ld;Ld=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Qd(e,ys())}))}Ss()}(),fp())},po=function(e,t){var n=ud;ud|=2;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}};var Ip={Events:[Ru,Lu,Fu,io,uo,fp,{current:!1}]},Ap={findFiberByHostInstance:Mu,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},jp={bundleType:Ap.bundleType,version:Ap.version,rendererPackageName:Ap.rendererPackageName,rendererConfig:Ap.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Do(e))?null:e.stateNode},findFiberByHostInstance:Ap.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{Zu=Wp.inject(jp),es=Wp}catch(Qa){}}var Up={__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Ip,createPortal:Bp,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(zr(188));throw Error(zr(268,Object.keys(e)))}return e=null===(e=Do(t))?null:e.stateNode},flushSync:function(e,t){var n=ud;if(0!=(48&n))return e(t);ud|=1;try{if(e)return Es(99,e.bind(null,t))}finally{ud=n,Ss()}},hydrate:function(e,t,n){if(!Fp(t))throw Error(zr(200));return zp(null,e,t,!0,n)},render:function(e,t,n){if(!Fp(t))throw Error(zr(200));return zp(null,e,t,!1,n)},unmountComponentAtNode:function(e){if(!Fp(e))throw Error(zr(40));return!!e._reactRootContainer&&(Gd((function(){zp(null,null,e,!1,(function(){e._reactRootContainer=null,e[Du]=null}))})),!0)},unstable_batchedUpdates:Xd,unstable_createPortal:function(e,t){return Bp(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){if(!Fp(n))throw Error(zr(200));if(null==e||void 0===e._reactInternals)throw Error(zr(38));return zp(e,t,n,!1,r)},version:"17.0.2"},Vp=0,Hp={__interactionsRef:null,__subscriberRef:null,unstable_clear:function(e){return e()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Vp},unstable_subscribe:function(){},unstable_trace:function(e,t,n){return n()},unstable_unsubscribe:function(){},unstable_wrap:function(e){return e}},qp=i((function(e,t){}));qp.__interactionsRef,qp.__subscriberRef,qp.unstable_clear,qp.unstable_getCurrent,qp.unstable_getThreadID,qp.unstable_subscribe,qp.unstable_trace,qp.unstable_unsubscribe,qp.unstable_wrap,i((function(e){e.exports=Hp}));var Qp=i((function(e,t){}));Qp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qp.createPortal,Qp.findDOMNode,Qp.flushSync,Qp.hydrate,Qp.render,Qp.unmountComponentAtNode,Qp.unstable_batchedUpdates,Qp.unstable_createPortal,Qp.unstable_renderSubtreeIntoContainer,Qp.version;var Kp=i((function(e){!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=Up})),$p=function(e,t){var n=(t.top+t.bottom)/2;return e.top<=n&&e.bottom>=n},Yp=function(e,t,n){var r=dt.toDOMRange(e,t).getBoundingClientRect(),a=dt.toDOMRange(e,n).getBoundingClientRect();return $p(r,a)&&$p(a,r)},Xp=function(e,t){var r=n.Editor.range(e,n.Range.end(t)),a=Array.from(n.Editor.positions(e,{at:t})),o=0,l=a.length,i=Math.floor(l/2);if(Yp(e,n.Editor.range(e,a[o]),r))return n.Editor.range(e,a[o],r);if(a.length<2)return n.Editor.range(e,a[a.length-1],r);for(;i!==a.length&&i!==o;)Yp(e,n.Editor.range(e,a[i]),r)?l=i:o=i,i=Math.floor((o+l)/2);return n.Editor.range(e,a[l],r)};function Gp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Jp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Jp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zp(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var th=function(e,t){var r,a=[],o=Gp(n.Editor.levels(e,{at:t}));try{for(o.s();!(r=o.n()).done;){var l=h(r.value,2),i=l[0],u=l[1],s=dt.findKey(e,i);a.push([u,s])}}catch(e){o.e(e)}finally{o.f()}return a};e.DefaultElement=Rn,e.DefaultLeaf=On,e.DefaultPlaceholder=vr,e.Editable=function(e){var r=t.useCallback((function(e){return a.default.createElement(vr,Object.assign({},e))}),[]),o=e.autoFocus,l=e.decorate,i=void 0===l?gr:l,s=e.onDOMBeforeInput,c=e.placeholder,f=e.readOnly,d=void 0!==f&&f,p=e.renderElement,v=e.renderLeaf,b=e.renderPlaceholder,y=void 0===b?r:b,w=e.scrollSelectionIntoView,k=void 0===w?mr:w,E=e.style,x=void 0===E?{}:E,S=e.as,C=void 0===S?"div":S,T=e.disableDefaultStyles,_=void 0!==T&&T,O=g(e,ur),P=Un(),D=t.useState(!1),N=h(D,2),M=N[0],R=N[1],L=t.useRef(null),F=t.useRef([]),z=t.useState(),B=h(z,2),I=B[0],A=B[1],j=function(){var e=le(),n=t.useRef(!1),r=t.useRef(0),a=t.useCallback((function(){if(!n.current){n.current=!0;var t=dt.getWindow(e);t.cancelAnimationFrame(r.current),r.current=t.requestAnimationFrame((function(){n.current=!1}))}}),[e]);return t.useEffect((function(){return function(){return cancelAnimationFrame(r.current)}}),[]),{receivedUserInput:n,onUserInput:a}}(),W=j.onUserInput,U=j.receivedUserInput,V=t.useReducer((function(e){return e+1}),0),H=h(V,2)[1];Ue.set(P,H),Ne.set(P,d);var q=t.useMemo((function(){return{isDraggingInternally:!1,isUpdatingSelection:!1,latestElement:null,hasMarkPlaceholder:!1}}),[]);t.useEffect((function(){L.current&&o&&L.current.focus()}),[o]);var Q=t.useRef(),K=t.useMemo((function(){return G((function(){var e=Q.current;if((ce||!dt.isComposing(P))&&(!q.isUpdatingSelection||null!=e&&e.isFlushing())&&!q.isDraggingInternally){var t=dt.findDocumentOrShadowRoot(P),r=t.activeElement,a=dt.toDOMNode(P,P),o=t.getSelection();if(r===a?(q.latestElement=r,Me.set(P,!0)):Me.delete(P),!o)return n.Transforms.deselect(P);var l=o.anchorNode,i=o.focusNode,u=dt.hasEditableTarget(P,l)||dt.isTargetInsideNonReadonlyVoid(P,l),s=dt.hasEditableTarget(P,i)||dt.isTargetInsideNonReadonlyVoid(P,i);if(u&&s){var c=dt.toSlateRange(P,o,{exactMatch:!1,suppressThrow:!0});c&&(dt.isComposing(P)||null!=e&&e.hasPendingChanges()||null!=e&&e.isFlushing()?null==e||e.handleUserSelect(c):n.Transforms.select(P,c))}!d||u&&s||n.Transforms.deselect(P)}}),100)}),[P,d,q]),$=t.useMemo((function(){return X(K,0)}),[K]);Q.current=Dt({node:L,onDOMSelectionChange:K,scheduleOnDOMSelectionChange:$}),Ct((function(){var e,t,r;L.current&&(r=Je(L.current))?(Se.set(P,r),Ce.set(P,L.current),Oe.set(P,L.current),_e.set(L.current,P)):Oe.delete(P);var a=P.selection,o=dt.findDocumentOrShadowRoot(P).getSelection();if(o&&dt.isFocused(P)&&(null===(e=Q.current)||void 0===e||!e.hasPendingAction())){var l=function(e){var t="None"!==o.type;if(a||t){var r,l=o.focusNode;if(fe&&o.rangeCount>1){var i=o.getRangeAt(0),u=o.getRangeAt(o.rangeCount-1);r=i.startContainer===l?u.endContainer:i.startContainer}else r=o.anchorNode;var s=Ce.get(P),c=!1;if(s.contains(r)&&s.contains(l)&&(c=!0),t&&c&&a&&!e){var f=dt.toSlateRange(P,o,{exactMatch:!0,suppressThrow:!0});if(f&&n.Range.equals(f,a)){var d,p;if(!q.hasMarkPlaceholder)return;if(null!==(d=r)&&void 0!==d&&null!==(p=d.parentElement)&&void 0!==p&&p.hasAttribute("data-slate-mark-placeholder"))return}}if(!a||dt.hasRange(P,a)){q.isUpdatingSelection=!0;var h=a&&dt.toDOMRange(P,a);return h?(dt.isComposing(P)&&!ce?o.collapseToEnd():n.Range.isBackward(a)?o.setBaseAndExtent(h.endContainer,h.endOffset,h.startContainer,h.startOffset):o.setBaseAndExtent(h.startContainer,h.startOffset,h.endContainer,h.endOffset),k(P,h)):o.removeAllRanges(),h}P.selection=dt.toSlateRange(P,o,{exactMatch:!1,suppressThrow:!0})}};o.rangeCount<=1&&l();var i="action"===(null===(t=Q.current)||void 0===t?void 0:t.isFlushing());if(ce&&i){var u=null,s=requestAnimationFrame((function(){if(i){var e=function(e){try{dt.toDOMNode(P,P).focus(),l(e)}catch(e){}};e(),u=setTimeout((function(){e(!0),q.isUpdatingSelection=!1}))}}));return function(){cancelAnimationFrame(s),u&&clearTimeout(u)}}setTimeout((function(){q.isUpdatingSelection=!1}))}}));var Y=t.useCallback((function(e){if(W(),!d&&dt.hasEditableTarget(P,e.target)&&!wr(e,s)){var t;if(Q.current)return Q.current.handleDOMBeforeInput(e);$.flush(),K.flush();var r=P.selection,a=e.inputType,o=e.dataTransfer||e.data||void 0,l="insertCompositionText"===a||"deleteCompositionText"===a;if(l&&dt.isComposing(P))return;var i=!1;if("insertText"===a&&r&&n.Range.isCollapsed(r)&&e.data&&1===e.data.length&&/[a-z ]/i.test(e.data)&&0!==r.anchor.offset){var u,c;i=!0,P.marks&&(i=!1);var f=r.anchor,p=dt.toDOMPoint(P,f),v=h(p,2),g=v[0],m=v[1],b=null===(u=g.parentElement)||void 0===u?void 0:u.closest("a"),y=dt.getWindow(P);if(i&&b&&dt.hasDOMNode(P,b)){var w,k=null==y?void 0:y.document.createTreeWalker(b,NodeFilter.SHOW_TEXT).lastChild();k===g&&(null===(w=k.textContent)||void 0===w?void 0:w.length)===m&&(i=!1)}if(i&&g.parentElement&&"pre"===(null==y||null===(c=y.getComputedStyle(g.parentElement))||void 0===c?void 0:c.whiteSpace)){var E=n.Editor.above(P,{at:f.path,match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(P,e)}});E&&n.Node.string(E[0]).includes("\t")&&(i=!1)}}if(!a.startsWith("delete")||a.startsWith("deleteBy")){var x=e.getTargetRanges(),S=h(x,1)[0];if(S){var C=dt.toSlateRange(P,S,{exactMatch:!1,suppressThrow:!1});if(!r||!n.Range.equals(r,C)){i=!1;var T=!l&&P.selection&&n.Editor.rangeRef(P,P.selection);n.Transforms.select(P,C),T&&Le.set(P,T)}}}if(l)return;if(i||e.preventDefault(),r&&n.Range.isExpanded(r)&&a.startsWith("delete")){var _=a.endsWith("Backward")?"backward":"forward";return void n.Editor.deleteFragment(P,{direction:_})}switch(a){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":n.Editor.deleteFragment(P);break;case"deleteContent":case"deleteContentForward":n.Editor.deleteForward(P);break;case"deleteContentBackward":n.Editor.deleteBackward(P);break;case"deleteEntireSoftLine":n.Editor.deleteBackward(P,{unit:"line"}),n.Editor.deleteForward(P,{unit:"line"});break;case"deleteHardLineBackward":n.Editor.deleteBackward(P,{unit:"block"});break;case"deleteSoftLineBackward":n.Editor.deleteBackward(P,{unit:"line"});break;case"deleteHardLineForward":n.Editor.deleteForward(P,{unit:"block"});break;case"deleteSoftLineForward":n.Editor.deleteForward(P,{unit:"line"});break;case"deleteWordBackward":n.Editor.deleteBackward(P,{unit:"word"});break;case"deleteWordForward":n.Editor.deleteForward(P,{unit:"word"});break;case"insertLineBreak":n.Editor.insertSoftBreak(P);break;case"insertParagraph":n.Editor.insertBreak(P);break;case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":"insertFromComposition"===a&&dt.isComposing(P)&&(R(!1),Re.set(P,!1)),"DataTransfer"===(null==o?void 0:o.constructor.name)?dt.insertData(P,o):"string"==typeof o&&(i?F.current.push((function(){return n.Editor.insertText(P,o)})):n.Editor.insertText(P,o))}var O=null===(t=Le.get(P))||void 0===t?void 0:t.unref();Le.delete(P),!O||P.selection&&n.Range.equals(P.selection,O)||n.Transforms.select(P,O)}}),[P,K,W,s,d,$]),J=t.useCallback((function(e){null==e?(K.cancel(),$.cancel(),Ce.delete(P),Oe.delete(P),L.current&&ke&&L.current.removeEventListener("beforeinput",Y)):ke&&e.addEventListener("beforeinput",Y),L.current=e}),[K,$,P,Y]);Ct((function(){var e=dt.getWindow(P);return e.document.addEventListener("selectionchange",$),function(){e.document.removeEventListener("selectionchange",$)}}),[$]);var Z=i([P,[]]),ee=c&&1===P.children.length&&1===Array.from(n.Node.texts(P)).length&&""===n.Node.string(P)&&!M,te=t.useCallback((function(e){var t;e&&ee?A(null===(t=e.getBoundingClientRect())||void 0===t?void 0:t.height):A(void 0)}),[ee]);if(ee){var ne,re=n.Editor.start(P,[]);Z.push((u(ne={},Ve,!0),u(ne,"placeholder",c),u(ne,"onPlaceholderResize",te),u(ne,"anchor",re),u(ne,"focus",re),ne))}var ae=P.marks;if(q.hasMarkPlaceholder=!1,P.selection&&n.Range.isCollapsed(P.selection)&&ae){var oe=P.selection.anchor,ie=n.Node.leaf(P,oe.path);ie.text;var se=g(ie,sr);if(!n.Text.equals(ie,ae,{loose:!0})){q.hasMarkPlaceholder=!0;var pe=Object.fromEntries(Object.keys(se).map((function(e){return[e,null]})));Z.push(pr(pr(pr(u({},He,!0),pe),ae),{},{anchor:oe,focus:oe}))}}return t.useEffect((function(){setTimeout((function(){var e=P.selection;if(e){var t=e.anchor,r=n.Node.leaf(P,t.path);if(ae&&!n.Text.equals(r,ae,{loose:!0}))return void Be.set(P,ae)}Be.delete(P)}))})),a.default.createElement(An.Provider,{value:d},a.default.createElement(Ln.Provider,{value:i},a.default.createElement(ir,{node:L,receivedUserInput:U},a.default.createElement(C,Object.assign({role:d?void 0:"textbox","aria-multiline":!d||void 0},O,{spellCheck:!(!ke&&we)&&O.spellCheck,autoCorrect:ke||!we?O.autoCorrect:"false",autoCapitalize:ke||!we?O.autoCapitalize:"false","data-slate-editor":!0,"data-slate-node":"value",contentEditable:!d,zindex:-1,suppressContentEditableWarning:!0,ref:J,style:pr(pr({},_?{}:pr({position:"relative",whiteSpace:"pre-wrap",wordWrap:"break-word"},I?{minHeight:I}:{})),x),onBeforeInput:t.useCallback((function(e){if(!ke&&!d&&!br(e,O.onBeforeInput)&&dt.hasSelectableTarget(P,e.target)&&(e.preventDefault(),!dt.isComposing(P))){var t=e.data;n.Editor.insertText(P,t)}}),[O.onBeforeInput,P,d]),onInput:t.useCallback((function(e){if(!br(e,O.onInput))if(Q.current)Q.current.handleInput();else{var t,n=cr(F.current);try{for(n.s();!(t=n.n()).done;){(0,t.value)()}}catch(e){n.e(e)}finally{n.f()}F.current=[]}}),[O.onInput]),onBlur:t.useCallback((function(e){if(!d&&!q.isUpdatingSelection&&dt.hasSelectableTarget(P,e.target)&&!br(e,O.onBlur)){var t=dt.findDocumentOrShadowRoot(P);if(q.latestElement!==t.activeElement){var r=e.relatedTarget;if(!(r===dt.toDOMNode(P,P)||Ze(r)&&r.hasAttribute("data-slate-spacer"))){if(null!=r&&et(r)&&dt.hasDOMNode(P,r)){var a=dt.toSlateNode(P,r);if(n.Element.isElement(a)&&!P.isVoid(a))return}if(de){var o=t.getSelection();null==o||o.removeAllRanges()}Me.delete(P)}}}}),[d,q.isUpdatingSelection,q.latestElement,P,O.onBlur]),onClick:t.useCallback((function(e){if(dt.hasTarget(P,e.target)&&!br(e,O.onClick)&&et(e.target)){var t=dt.toSlateNode(P,e.target),r=dt.findPath(P,t);if(!n.Editor.hasPath(P,r)||n.Node.get(P,r)!==t)return;if(3===e.detail&&r.length>=1){var a=r;if(!n.Element.isElement(t)||!n.Editor.isBlock(P,t)){var o,l=n.Editor.above(P,{match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(P,e)},at:r});a=null!==(o=null==l?void 0:l[1])&&void 0!==o?o:r.slice(0,1)}var i=n.Editor.range(P,a);return void n.Transforms.select(P,i)}if(d)return;var u=n.Editor.start(P,r),s=n.Editor.end(P,r),c=n.Editor.void(P,{at:u}),f=n.Editor.void(P,{at:s});if(c&&f&&n.Path.equals(c[1],f[1])){var p=n.Editor.range(P,u);n.Transforms.select(P,p)}}}),[P,O.onClick,d]),onCompositionEnd:t.useCallback((function(e){if(dt.hasSelectableTarget(P,e.target)){var t;if(dt.isComposing(P)&&(R(!1),Re.set(P,!1)),null===(t=Q.current)||void 0===t||t.handleCompositionEnd(e),br(e,O.onCompositionEnd)||ce)return;if(!de&&!me&&!ue&&!ye&&!be&&e.data){var r=Be.get(P);Be.delete(P),void 0!==r&&(Ie.set(P,P.marks),P.marks=r),n.Editor.insertText(P,e.data);var a=Ie.get(P);Ie.delete(P),void 0!==a&&(P.marks=a)}}}),[O.onCompositionEnd,P]),onCompositionUpdate:t.useCallback((function(e){dt.hasSelectableTarget(P,e.target)&&!br(e,O.onCompositionUpdate)&&(dt.isComposing(P)||(R(!0),Re.set(P,!0)))}),[O.onCompositionUpdate,P]),onCompositionStart:t.useCallback((function(e){if(dt.hasSelectableTarget(P,e.target)){var t;if(null===(t=Q.current)||void 0===t||t.handleCompositionStart(e),br(e,O.onCompositionStart)||ce)return;R(!0);var r=P.selection;if(r){if(n.Range.isExpanded(r))return void n.Editor.deleteFragment(P);var a=n.Editor.above(P,{match:function(e){return n.Element.isElement(e)&&n.Editor.isInline(P,e)},mode:"highest"});if(a){var o=h(a,2)[1];if(n.Editor.isEnd(P,r.anchor,o)){var l=n.Editor.after(P,o);n.Transforms.setSelection(P,{anchor:l,focus:l})}}}}}),[O.onCompositionStart,P]),onCopy:t.useCallback((function(e){!dt.hasSelectableTarget(P,e.target)||br(e,O.onCopy)||yr(e)||(e.preventDefault(),dt.setFragmentData(P,e.clipboardData,"copy"))}),[O.onCopy,P]),onCut:t.useCallback((function(e){if(!d&&dt.hasSelectableTarget(P,e.target)&&!br(e,O.onCut)&&!yr(e)){e.preventDefault(),dt.setFragmentData(P,e.clipboardData,"cut");var t=P.selection;if(t)if(n.Range.isExpanded(t))n.Editor.deleteFragment(P);else{var r=n.Node.parent(P,t.anchor.path);n.Editor.isVoid(P,r)&&n.Transforms.delete(P)}}}),[d,P,O.onCut]),onDragOver:t.useCallback((function(e){if(dt.hasTarget(P,e.target)&&!br(e,O.onDragOver)){var t=dt.toSlateNode(P,e.target);n.Element.isElement(t)&&n.Editor.isVoid(P,t)&&e.preventDefault()}}),[O.onDragOver,P]),onDragStart:t.useCallback((function(e){if(!d&&dt.hasTarget(P,e.target)&&!br(e,O.onDragStart)){var t=dt.toSlateNode(P,e.target),r=dt.findPath(P,t);if(n.Element.isElement(t)&&n.Editor.isVoid(P,t)||n.Editor.void(P,{at:r,voids:!0})){var a=n.Editor.range(P,r);n.Transforms.select(P,a)}q.isDraggingInternally=!0,dt.setFragmentData(P,e.dataTransfer,"drag")}}),[d,P,O.onDragStart,q]),onDrop:t.useCallback((function(e){if(!d&&dt.hasTarget(P,e.target)&&!br(e,O.onDrop)){e.preventDefault();var t=P.selection,r=dt.findEventRange(P,e),a=e.dataTransfer;n.Transforms.select(P,r),q.isDraggingInternally&&(!t||n.Range.equals(t,r)||n.Editor.void(P,{at:r,voids:!0})||n.Transforms.delete(P,{at:t})),dt.insertData(P,a),dt.isFocused(P)||dt.focus(P)}q.isDraggingInternally=!1}),[d,P,O.onDrop,q]),onDragEnd:t.useCallback((function(e){!d&&q.isDraggingInternally&&O.onDragEnd&&dt.hasTarget(P,e.target)&&O.onDragEnd(e),q.isDraggingInternally=!1}),[d,q,O,P]),onFocus:t.useCallback((function(e){if(!d&&!q.isUpdatingSelection&&dt.hasEditableTarget(P,e.target)&&!br(e,O.onFocus)){var t=dt.toDOMNode(P,P),n=dt.findDocumentOrShadowRoot(P);if(q.latestElement=n.activeElement,fe&&e.target!==t)return void t.focus();Me.set(P,!0)}}),[d,q,P,O.onFocus]),onKeyDown:t.useCallback((function(e){if(!d&&dt.hasEditableTarget(P,e.target)){var t;null===(t=Q.current)||void 0===t||t.handleKeyDown(e);var r=e.nativeEvent;if(dt.isComposing(P)&&!1===r.isComposing&&(Re.set(P,!1),R(!1)),br(e,O.onKeyDown)||dt.isComposing(P))return;var a=P.selection,o=P.children[null!==a?a.focus.path[0]:0],l="rtl"===m(n.Node.string(o));if(Yn.isRedo(r)){e.preventDefault();var i=P;return void("function"==typeof i.redo&&i.redo())}if(Yn.isUndo(r)){e.preventDefault();var u=P;return void("function"==typeof u.undo&&u.undo())}if(Yn.isMoveLineBackward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",reverse:!0});if(Yn.isMoveLineForward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line"});if(Yn.isExtendLineBackward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",edge:"focus",reverse:!0});if(Yn.isExtendLineForward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",edge:"focus"});if(Yn.isMoveBackward(r))return e.preventDefault(),void(a&&n.Range.isCollapsed(a)?n.Transforms.move(P,{reverse:!l}):n.Transforms.collapse(P,{edge:"start"}));if(Yn.isMoveForward(r))return e.preventDefault(),void(a&&n.Range.isCollapsed(a)?n.Transforms.move(P,{reverse:l}):n.Transforms.collapse(P,{edge:"end"}));if(Yn.isMoveWordBackward(r))return e.preventDefault(),a&&n.Range.isExpanded(a)&&n.Transforms.collapse(P,{edge:"focus"}),void n.Transforms.move(P,{unit:"word",reverse:!l});if(Yn.isMoveWordForward(r))return e.preventDefault(),a&&n.Range.isExpanded(a)&&n.Transforms.collapse(P,{edge:"focus"}),void n.Transforms.move(P,{unit:"word",reverse:l});if(ke){if((he||de)&&a&&(Yn.isDeleteBackward(r)||Yn.isDeleteForward(r))&&n.Range.isCollapsed(a)){var s=n.Node.parent(P,a.anchor.path);if(n.Element.isElement(s)&&n.Editor.isVoid(P,s)&&(n.Editor.isInline(P,s)||n.Editor.isBlock(P,s)))return e.preventDefault(),void n.Editor.deleteBackward(P,{unit:"block"})}}else{if(Yn.isBold(r)||Yn.isItalic(r)||Yn.isTransposeCharacter(r))return void e.preventDefault();if(Yn.isSoftBreak(r))return e.preventDefault(),void n.Editor.insertSoftBreak(P);if(Yn.isSplitBlock(r))return e.preventDefault(),void n.Editor.insertBreak(P);if(Yn.isDeleteBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P));if(Yn.isDeleteForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P));if(Yn.isDeleteLineBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P,{unit:"line"}));if(Yn.isDeleteLineForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P,{unit:"line"}));if(Yn.isDeleteWordBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P,{unit:"word"}));if(Yn.isDeleteWordForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P,{unit:"word"}))}}}),[d,P,O.onKeyDown]),onPaste:t.useCallback((function(e){d||!dt.hasEditableTarget(P,e.target)||br(e,O.onPaste)||(!ke||function(e){return e.clipboardData&&""!==e.clipboardData.getData("text/plain")&&1===e.clipboardData.types.length}(e.nativeEvent)||de)&&(e.preventDefault(),dt.insertData(P,e.clipboardData))}),[d,P,O.onPaste])}),a.default.createElement(hr,{decorations:Z,node:P,renderElement:p,renderPlaceholder:y,renderLeaf:v,selection:P.selection})))))},e.ReactEditor=dt,e.Slate=function(e){var r=e.editor,o=e.children,l=e.onChange,i=e.initialValue,u=g(e,Tr),s=t.useRef(!1),c=a.default.useState((function(){if(!n.Node.isNodeList(i))throw new Error("[Slate] initialValue is invalid! Expected a list of elements but got: ".concat(n.Scrubber.stringify(i)));if(!n.Editor.isEditor(r))throw new Error("[Slate] editor is invalid! You passed: ".concat(n.Scrubber.stringify(r)));return r.children=i,Object.assign(r,u),{v:0,editor:r}})),f=h(c,2),d=f[0],p=f[1],v=function(e){var n=t.useRef([]).current,r=t.useRef({editor:e}).current,a=t.useCallback((function(e){r.editor=e,n.forEach((function(t){return t(e)}))}),[n,r]);return{selectorContext:t.useMemo((function(){return{getSlate:function(){return r.editor},addEventListener:function(e){return n.push(e),function(){n.splice(n.indexOf(e),1)}}}}),[n,r]),onChange:a}}(r),m=v.selectorContext,b=v.onChange,y=t.useCallback((function(){l&&l(r.children),p((function(e){return{v:e.v+1,editor:r}})),b(r)}),[r,b,l]);t.useEffect((function(){return Fe.set(r,y),function(){Fe.set(r,(function(){})),s.current=!0}}),[r,y]);var w=t.useState(dt.isFocused(r)),k=h(w,2),E=k[0],x=k[1];return t.useEffect((function(){x(dt.isFocused(r))}),[r]),Ct((function(){var e=function(){return x(dt.isFocused(r))};return ie>=17?(document.addEventListener("focusin",e),document.addEventListener("focusout",e),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",e)}):(document.addEventListener("focus",e,!0),document.addEventListener("blur",e,!0),function(){document.removeEventListener("focus",e,!0),document.removeEventListener("blur",e,!0)})}),[]),a.default.createElement(xr.Provider,{value:m},a.default.createElement(Wn.Provider,{value:d},a.default.createElement(oe.Provider,{value:d.editor},a.default.createElement(kr.Provider,{value:E},o))))},e.useEditor=function(){var e=t.useContext(oe);if(!e)throw new Error("The `useEditor` hook must be used inside the <Slate> component's context.");return e},e.useFocused=function(){return t.useContext(kr)},e.useReadOnly=jn,e.useSelected=function(){return t.useContext(Fn)},e.useSlate=Un,e.useSlateSelection=function(){return Cr((function(e){return e.selection}),_r)},e.useSlateSelector=Cr,e.useSlateStatic=le,e.useSlateWithV=function(){var e=t.useContext(Wn);if(!e)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");return e},e.withReact=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x-slate-fragment",r=e,a=r.apply,o=r.onChange,l=r.deleteBackward,i=r.addMark,u=r.removeMark;return De.set(r,new WeakMap),r.addMark=function(e,t){var n,a;null===(n=ze.get(r))||void 0===n||n(),!Be.get(r)&&null!==(a=Ae.get(r))&&void 0!==a&&a.length&&Be.set(r,null),Ie.delete(r),i(e,t)},r.removeMark=function(e){var t;!Be.get(r)&&null!==(t=Ae.get(r))&&void 0!==t&&t.length&&Be.set(r,null),Ie.delete(r),u(e)},r.deleteBackward=function(e){if("line"!==e)return l(e);if(r.selection&&n.Range.isCollapsed(r.selection)){var t=n.Editor.above(r,{match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(r,e)},at:r.selection});if(t){var a=h(t,2)[1],o=n.Editor.range(r,a,r.selection.anchor),i=Xp(r,o);n.Range.isCollapsed(i)||n.Transforms.delete(r,{at:i})}}},r.apply=function(e){var t=[],o=Ae.get(r);if(null!=o&&o.length){var l=o.map((function(t){return kt(t,e)})).filter(Boolean);Ae.set(r,l)}var i=We.get(r);i&&We.set(r,wt(r,i,e));var u=je.get(r);if(null!=u&&u.at){var s=n.Point.isPoint(null==u?void 0:u.at)?yt(r,u.at,e):wt(r,u.at,e);je.set(r,s?eh(eh({},u),{},{at:s}):null)}switch(e.type){case"insert_text":case"remove_text":case"set_node":case"split_node":t.push.apply(t,$e(th(r,e.path)));break;case"set_selection":var c;null===(c=Le.get(r))||void 0===c||c.unref(),Le.delete(r);break;case"insert_node":case"remove_node":t.push.apply(t,$e(th(r,n.Path.parent(e.path))));break;case"merge_node":var f=n.Path.previous(e.path);t.push.apply(t,$e(th(r,f)));break;case"move_node":var d=n.Path.common(n.Path.parent(e.path),n.Path.parent(e.newPath));t.push.apply(t,$e(th(r,d)))}a(e);for(var p=0,v=t;p<v.length;p++){var g=h(v[p],2),m=g[0],b=g[1],y=n.Editor.node(r,m),w=h(y,1)[0];Pe.set(w,b)}},r.setFragmentData=function(e){var a=r.selection;if(a){var o=n.Range.edges(a),l=h(o,2),i=l[0],u=l[1],s=n.Editor.void(r,{at:i.path}),c=n.Editor.void(r,{at:u.path});if(!n.Range.isCollapsed(a)||s){var f=dt.toDOMRange(r,a),d=f.cloneContents(),p=d.childNodes[0];if(d.childNodes.forEach((function(e){e.textContent&&""!==e.textContent.trim()&&(p=e)})),c){var v=h(c,1)[0],g=f.cloneRange(),m=dt.toDOMNode(r,v);g.setEndAfter(m),d=g.cloneContents()}if(s&&(p=d.querySelector("[data-slate-spacer]")),Array.from(d.querySelectorAll("[data-slate-zero-width]")).forEach((function(e){var t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""})),nt(p)){var b=p.ownerDocument.createElement("span");b.style.whiteSpace="pre",b.appendChild(p),d.appendChild(b),p=b}var y=r.getFragment(),w=JSON.stringify(y),k=window.btoa(encodeURIComponent(w));p.setAttribute("data-slate-fragment",k),e.setData("application/".concat(t),k);var E=d.ownerDocument.createElement("div");return E.appendChild(d),E.setAttribute("hidden","true"),d.ownerDocument.body.appendChild(E),e.setData("text/html",E.innerHTML),e.setData("text/plain",ot(E)),d.ownerDocument.body.removeChild(E),e}}},r.insertData=function(e){r.insertFragmentData(e)||r.insertTextData(e)},r.insertFragmentData=function(e){var n=e.getData("application/".concat(t))||it(e);if(n){var a=decodeURIComponent(window.atob(n)),o=JSON.parse(a);return r.insertFragment(o),!0}return!1},r.insertTextData=function(e){var t=e.getData("text/plain");if(t){var a,o=!1,l=Gp(t.split(/\r\n|\r|\n/));try{for(l.s();!(a=l.n()).done;){var i=a.value;o&&n.Transforms.splitNodes(r,{always:!0}),r.insertText(i),o=!0}}catch(e){l.e(e)}finally{l.f()}return!0}return!1},r.onChange=function(e){(ie<18?Kp.unstable_batchedUpdates:function(e){return e()})((function(){var t=Fe.get(r);t&&t(),o(e)}))},r},Object.defineProperty(e,"__esModule",{value:!0})}));
+!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("slate")):"function"==typeof define&&define.amd?define(["exports","react","slate"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SlateReact={},e.React,e.Slate)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=r(t),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var u=l(i((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0}))),s=i((function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}));l(s);var c=i((function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(i)throw a}}return o}},e.exports.default=e.exports,e.exports.__esModule=!0}));l(c);var f=i((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}));l(f);var d=i((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));l(d);var p=i((function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));l(p);var h=l(i((function(e){e.exports=function(e,t){return s(e)||c(e,t)||d(e,t)||p()},e.exports.default=e.exports,e.exports.__esModule=!0}))),v=i((function(e){e.exports=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a},e.exports.default=e.exports,e.exports.__esModule=!0}));l(v);var g=l(i((function(e){e.exports=function(e,t){if(null==e)return{};var n,r,a=v(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a},e.exports.default=e.exports,e.exports.__esModule=!0}))),m=function(e){if(e=String(e||""),w.test(e))return"rtl";if(k.test(e))return"ltr";return"neutral"},b="֑-߿יִ-﷽ﹰ-ﻼ",y="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",w=new RegExp("^[^"+y+"]*["+b+"]"),k=new RegExp("^[^"+b+"]*["+y+"]");var E=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},x="object"==typeof o&&o&&o.Object===Object&&o,S="object"==typeof self&&self&&self.Object===Object&&self,C=x||S||Function("return this")(),T=function(){return C.Date.now()},_=/\s/;var O=function(e){for(var t=e.length;t--&&_.test(e.charAt(t)););return t},P=/^\s+/;var D=function(e){return e?e.slice(0,O(e)+1).replace(P,""):e},N=C.Symbol,M=Object.prototype,R=M.hasOwnProperty,L=M.toString,F=N?N.toStringTag:void 0;var z=function(e){var t=R.call(e,F),n=e[F];try{e[F]=void 0;var r=!0}catch(e){}var a=L.call(e);return r&&(t?e[F]=n:delete e[F]),a},B=Object.prototype.toString;var I=function(e){return B.call(e)},A=N?N.toStringTag:void 0;var j=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":A&&A in Object(e)?z(e):I(e)};var W=function(e){return null!=e&&"object"==typeof e};var U=function(e){return"symbol"==typeof e||W(e)&&"[object Symbol]"==j(e)},V=/^[-+]0x[0-9a-f]+$/i,H=/^0b[01]+$/i,q=/^0o[0-7]+$/i,Q=parseInt;var K=function(e){if("number"==typeof e)return e;if(U(e))return NaN;if(E(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=E(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=D(e);var n=H.test(e);return n||q.test(e)?Q(e.slice(2),n?2:8):V.test(e)?NaN:+e},$=Math.max,Y=Math.min;var X=function(e,t,n){var r,a,o,l,i,u,s=0,c=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,o=a;return r=a=void 0,s=t,l=e.apply(o,n)}function h(e){return s=e,i=setTimeout(g,t),c?p(e):l}function v(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-s>=o}function g(){var e=T();if(v(e))return m(e);i=setTimeout(g,function(e){var n=t-(e-u);return f?Y(n,o-(e-s)):n}(e))}function m(e){return i=void 0,d&&r?p(e):(r=a=void 0,l)}function b(){var e=T(),n=v(e);if(r=arguments,a=this,u=e,n){if(void 0===i)return h(u);if(f)return clearTimeout(i),i=setTimeout(g,t),p(u)}return void 0===i&&(i=setTimeout(g,t)),l}return t=K(t)||0,E(n)&&(c=!!n.leading,o=(f="maxWait"in n)?$(K(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==i&&clearTimeout(i),s=0,r=u=a=i=void 0},b.flush=function(){return void 0===i?l:m(T())},b};var G=function(e,t,n){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return E(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),X(e,t,{leading:r,maxWait:t,trailing:a})};function J(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function Z(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function ee(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return Z(n.overflowY,t)||Z(n.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function te(e,t,n,r,a,o,l,i){return o<e&&l>t||o>e&&l<t?0:o<=e&&i<=n||l>=t&&i>=n?o-e-r:l>t&&i<n||o<e&&i>n?l-t+a:0}function ne(e,t){var n=window,r=t.scrollMode,a=t.block,o=t.inline,l=t.boundary,i=t.skipOverflowHiddenElements,u="function"==typeof l?l:function(e){return e!==l};if(!J(e))throw new TypeError("Invalid target");for(var s=document.scrollingElement||document.documentElement,c=[],f=e;J(f)&&u(f);){if((f=f.parentElement)===s){c.push(f);break}null!=f&&f===document.body&&ee(f)&&!ee(document.documentElement)||null!=f&&ee(f,i)&&c.push(f)}for(var d=n.visualViewport?n.visualViewport.width:innerWidth,p=n.visualViewport?n.visualViewport.height:innerHeight,h=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,g=e.getBoundingClientRect(),m=g.height,b=g.width,y=g.top,w=g.right,k=g.bottom,E=g.left,x="start"===a||"nearest"===a?y:"end"===a?k:y+m/2,S="center"===o?E+b/2:"end"===o?w:E,C=[],T=0;T<c.length;T++){var _=c[T],O=_.getBoundingClientRect(),P=O.height,D=O.width,N=O.top,M=O.right,R=O.bottom,L=O.left;if("if-needed"===r&&y>=0&&E>=0&&k<=p&&w<=d&&y>=N&&k<=R&&E>=L&&w<=M)return C;var F=getComputedStyle(_),z=parseInt(F.borderLeftWidth,10),B=parseInt(F.borderTopWidth,10),I=parseInt(F.borderRightWidth,10),A=parseInt(F.borderBottomWidth,10),j=0,W=0,U="offsetWidth"in _?_.offsetWidth-_.clientWidth-z-I:0,V="offsetHeight"in _?_.offsetHeight-_.clientHeight-B-A:0;if(s===_)j="start"===a?x:"end"===a?x-p:"nearest"===a?te(v,v+p,p,B,A,v+x,v+x+m,m):x-p/2,W="start"===o?S:"center"===o?S-d/2:"end"===o?S-d:te(h,h+d,d,z,I,h+S,h+S+b,b),j=Math.max(0,j+v),W=Math.max(0,W+h);else{j="start"===a?x-N-B:"end"===a?x-R+A+V:"nearest"===a?te(N,R,P,B,A+V,x,x+m,m):x-(N+P/2)+V/2,W="start"===o?S-L-z:"center"===o?S-(L+D/2)+U/2:"end"===o?S-M+I+U:te(L,M,D,z,I+U,S,S+b,b);var H=_.scrollLeft,q=_.scrollTop;x+=q-(j=Math.max(0,Math.min(q+j,_.scrollHeight-P+V))),S+=H-(W=Math.max(0,Math.min(H+W,_.scrollWidth-D+U)))}C.push({el:_,top:j,left:W})}return C}function re(e){return e===Object(e)&&0!==Object.keys(e).length}function ae(e,t){var n=!e.ownerDocument.documentElement.contains(e);if(re(t)&&"function"==typeof t.behavior)return t.behavior(n?[]:ne(e,t));if(!n){var r=function(e){return!1===e?{block:"end",inline:"nearest"}:re(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var r=e.el,a=e.top,o=e.left;r.scroll&&n?r.scroll({top:a,left:o,behavior:t}):(r.scrollTop=a,r.scrollLeft=o)}))}(ne(e,r),r.behavior)}}var oe=t.createContext(null),le=function(){var e=t.useContext(oe);if(!e)throw new Error("The `useSlateStatic` hook must be used inside the <Slate> component's context.");return e},ie=parseInt(a.default.version.split(".")[0],10),ue="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,se="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),ce="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent),fe="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),de="undefined"!=typeof navigator&&/AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent),pe="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])(?:\.)/i.test(navigator.userAgent),he="undefined"!=typeof navigator&&/Chrome/i.test(navigator.userAgent),ve="undefined"!=typeof navigator&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])(?:\.)/i.test(navigator.userAgent),ge=ce&&"undefined"!=typeof navigator&&/Chrome?\/(?:[0-5]?\d)(?:\.)/i.test(navigator.userAgent),me="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])(?:\.)).*/i.test(navigator.userAgent),be="undefined"!=typeof navigator&&/.*UCBrowser/.test(navigator.userAgent),ye="undefined"!=typeof navigator&&/.*Wechat/.test(navigator.userAgent),we=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),ke=(!ve||!ge)&&!pe&&"undefined"!=typeof globalThis&&globalThis.InputEvent&&"function"==typeof globalThis.InputEvent.prototype.getTargetRanges,Ee=new WeakMap,xe=new WeakMap,Se=new WeakMap,Ce=new WeakMap,Te=new WeakMap,_e=new WeakMap,Oe=new WeakMap,Pe=new WeakMap,De=new WeakMap,Ne=new WeakMap,Me=new WeakMap,Re=new WeakMap,Le=new WeakMap,Fe=new WeakMap,ze=new WeakMap,Be=new WeakMap,Ie=new WeakMap,Ae=new WeakMap,je=new WeakMap,We=new WeakMap,Ue=new WeakMap,Ve=Symbol("placeholder"),He=Symbol("mark-placeholder"),qe=i((function(e){e.exports=function(e){if(Array.isArray(e))return f(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));l(qe);var Qe=i((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));l(Qe);var Ke=i((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));l(Ke);var $e=l(i((function(e){e.exports=function(e){return qe(e)||Qe(e)||d(e)||Ke()},e.exports.default=e.exports,e.exports.__esModule=!0})));function Ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ge=globalThis.Text,Je=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||null},Ze=function(e){return et(e)&&1===e.nodeType},et=function(e){var t=Je(e);return!!t&&e instanceof t.Node},tt=function(e){var t=e&&e.anchorNode&&Je(e.anchorNode);return!!t&&e instanceof t.Selection},nt=function(e){return et(e)&&3===e.nodeType},rt=function(e,t,n){for(var r,a=e.childNodes,o=a[t],l=t,i=!1,u=!1;(et(r=o)&&8===r.nodeType||Ze(o)&&0===o.childNodes.length||Ze(o)&&"false"===o.getAttribute("contenteditable"))&&(!i||!u);)l>=a.length?(i=!0,l=t-1,n="backward"):l<0?(u=!0,l=t+1,n="forward"):(o=a[l],t=l,l+="forward"===n?1:-1);return[o,t]},at=function(e,t,n){var r=rt(e,t,n);return h(r,1)[0]},ot=function e(t){var n="";if(nt(t)&&t.nodeValue)return t.nodeValue;if(Ze(t)){for(var r=0,a=Array.from(t.childNodes);r<a.length;r++){n+=e(a[r])}var o=getComputedStyle(t).getPropertyValue("display");"block"!==o&&"list"!==o&&"BR"!==t.tagName||(n+="\n")}return n},lt=/data-slate-fragment="(.+?)"/m,it=function(e){var t=e.getData("text/html").match(lt)||[];return h(t,2)[1]},ut=function e(t,n,r){var a=n.target;if(Ze(a)&&a.matches('[contentEditable="false"]'))return!1;if(dt.getWindow(t).document.contains(a))return dt.hasDOMNode(t,a,{editable:!0});var o=r.find((function(e){var t,n=e.addedNodes,r=e.removedNodes,o=Ye(n);try{for(o.s();!(t=o.n()).done;){var l=t.value;if(l===a||l.contains(a))return!0}}catch(e){o.e(e)}finally{o.f()}var i,u=Ye(r);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s===a||s.contains(a))return!0}}catch(e){u.e(e)}finally{u.f()}}));return!(!o||o===n)&&e(t,o,r)},st=l(i((function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0}))),ct=0,ft=function e(){st(this,e),this.id="".concat(ct++)},dt={androidPendingDiffs:function(e){return Ae.get(e)},androidScheduleFlush:function(e){var t;null===(t=ze.get(e))||void 0===t||t()},blur:function(e){var t=dt.toDOMNode(e,e),n=dt.findDocumentOrShadowRoot(e);Me.set(e,!1),n.activeElement===t&&t.blur()},deselect:function(e){var t=e.selection,r=dt.findDocumentOrShadowRoot(e).getSelection();r&&r.rangeCount>0&&r.removeAllRanges(),t&&n.Transforms.deselect(e)},findDocumentOrShadowRoot:function(e){var t=dt.toDOMNode(e,e),n=t.getRootNode();return(n instanceof Document||n instanceof ShadowRoot)&&null!=n.getSelection?n:t.ownerDocument},findEventRange:function(e,t){"nativeEvent"in t&&(t=t.nativeEvent);var r=t,a=r.clientX,o=r.clientY,l=r.target;if(null==a||null==o)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));var i,u=dt.toSlateNode(e,t.target),s=dt.findPath(e,u);if(n.Element.isElement(u)&&n.Editor.isVoid(e,u)){var c=l.getBoundingClientRect(),f=e.isInline(u)?a-c.left<c.left+c.width-a:o-c.top<c.top+c.height-o,d=n.Editor.point(e,s,{edge:f?"start":"end"}),p=f?n.Editor.before(e,d):n.Editor.after(e,d);if(p)return n.Editor.range(e,p)}var h=dt.getWindow(e).document;if(h.caretRangeFromPoint)i=h.caretRangeFromPoint(a,o);else{var v=h.caretPositionFromPoint(a,o);v&&((i=h.createRange()).setStart(v.offsetNode,v.offset),i.setEnd(v.offsetNode,v.offset))}if(!i)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));return dt.toSlateRange(e,i,{exactMatch:!1,suppressThrow:!1})},findKey:function(e,t){var n=Pe.get(t);return n||(n=new ft,Pe.set(t,n)),n},findPath:function(e,t){for(var r=[],a=t;;){var o=xe.get(a);if(null==o){if(n.Editor.isEditor(a))return r;break}var l=Ee.get(a);if(null==l)break;r.unshift(l),a=o}throw new Error("Unable to find the path for Slate node: ".concat(n.Scrubber.stringify(t)))},focus:function(e){var t=dt.toDOMNode(e,e),n=dt.findDocumentOrShadowRoot(e);Me.set(e,!0),n.activeElement!==t&&t.focus({preventScroll:!0})},getWindow:function(e){var t=Se.get(e);if(!t)throw new Error("Unable to find a host window element for this editor");return t},hasDOMNode:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.editable,o=void 0!==a&&a,l=dt.toDOMNode(e,e);try{n=Ze(t)?t:t.parentElement}catch(e){if(!e.message.includes('Permission denied to access property "nodeType"'))throw e}return!!n&&!(n.closest("[data-slate-editor]")!==l||o&&!n.isContentEditable&&("boolean"!=typeof n.isContentEditable||n.closest('[contenteditable="false"]')!==l)&&!n.getAttribute("data-slate-zero-width"))},hasEditableTarget:function(e,t){return et(t)&&dt.hasDOMNode(e,t,{editable:!0})},hasRange:function(e,t){var r=t.anchor,a=t.focus;return n.Editor.hasPath(e,r.path)&&n.Editor.hasPath(e,a.path)},hasSelectableTarget:function(e,t){return dt.hasEditableTarget(e,t)||dt.isTargetInsideNonReadonlyVoid(e,t)},hasTarget:function(e,t){return et(t)&&dt.hasDOMNode(e,t)},insertData:function(e,t){e.insertData(t)},insertFragmentData:function(e,t){return e.insertFragmentData(t)},insertTextData:function(e,t){return e.insertTextData(t)},isComposing:function(e){return!!Re.get(e)},isFocused:function(e){return!!Me.get(e)},isReadOnly:function(e){return!!Ne.get(e)},isTargetInsideNonReadonlyVoid:function(e,t){if(Ne.get(e))return!1;var r=dt.hasTarget(e,t)&&dt.toSlateNode(e,t);return n.Element.isElement(r)&&n.Editor.isVoid(e,r)},setFragmentData:function(e,t,n){return e.setFragmentData(t,n)},toDOMNode:function(e,t){var r=De.get(e),a=n.Editor.isEditor(t)?Ce.get(e):null==r?void 0:r.get(dt.findKey(e,t));if(!a)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(n.Scrubber.stringify(t)));return a},toDOMPoint:function(e,t){var r,a=n.Editor.node(e,t.path),o=h(a,1)[0],l=dt.toDOMNode(e,o);n.Editor.void(e,{at:t})&&(t={path:t.path,offset:0});for(var i=Array.from(l.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),u=0,s=0;s<i.length;s++){var c=i[s],f=c.childNodes[0];if(null!=f&&null!=f.textContent){var d=f.textContent.length,p=c.getAttribute("data-slate-length"),v=u+(null==p?d:parseInt(p,10)),g=i[s+1];if(t.offset===v&&null!=g&&g.hasAttribute("data-slate-mark-placeholder")){var m,b=g.childNodes[0];r=[b instanceof Ge?b:g,null!==(m=g.textContent)&&void 0!==m&&m.startsWith("\ufeff")?1:0];break}if(t.offset<=v){r=[f,Math.min(d,Math.max(0,t.offset-u))];break}u=v}}if(!r)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(n.Scrubber.stringify(t)));return r},toDOMRange:function(e,t){var r=t.anchor,a=t.focus,o=n.Range.isBackward(t),l=dt.toDOMPoint(e,r),i=n.Range.isCollapsed(t)?l:dt.toDOMPoint(e,a),u=dt.getWindow(e).document.createRange(),s=h(o?i:l,2),c=s[0],f=s[1],d=h(o?l:i,2),p=d[0],v=d[1],g=!!(Ze(c)?c:c.parentElement).getAttribute("data-slate-zero-width"),m=!!(Ze(p)?p:p.parentElement).getAttribute("data-slate-zero-width");return u.setStart(c,g?1:f),u.setEnd(p,m?1:v),u},toSlateNode:function(e,t){var n=Ze(t)?t:t.parentElement;n&&!n.hasAttribute("data-slate-node")&&(n=n.closest("[data-slate-node]"));var r=n?_e.get(n):null;if(!r)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(n));return r},toSlatePoint:function(e,t,r){var a=r.exactMatch,o=r.suppressThrow,l=a?t:function(e){var t=h(e,2),n=t[0],r=t[1];if(Ze(n)&&n.childNodes.length){var a=r===n.childNodes.length,o=a?r-1:r,l=rt(n,o,a?"backward":"forward"),i=h(l,2);for(n=i[0],a=(o=i[1])<r;Ze(n)&&n.childNodes.length;){var u=a?n.childNodes.length-1:0;n=at(n,u,a?"backward":"forward")}r=a&&null!=n.textContent?n.textContent.length:0}return[n,r]}(t),i=h(l,2),u=i[0],s=i[1],c=u.parentNode,f=null,d=0;if(c){var p,v,g=dt.toDOMNode(e,e),m=c.closest('[data-slate-void="true"]'),b=m&&g.contains(m)?m:null,y=c.closest("[data-slate-leaf]"),w=null;if(y){if(f=y.closest('[data-slate-node="text"]')){var k=dt.getWindow(e).document.createRange();k.setStart(f,0),k.setEnd(u,s);var E=k.cloneContents();[].concat($e(Array.prototype.slice.call(E.querySelectorAll("[data-slate-zero-width]"))),$e(Array.prototype.slice.call(E.querySelectorAll("[contenteditable=false]")))).forEach((function(e){ce&&!a&&e.hasAttribute("data-slate-zero-width")&&e.textContent.length>0&&"\ufeff"!==e.textContext?e.textContent.startsWith("\ufeff")&&(e.textContent=e.textContent.slice(1)):e.parentNode.removeChild(e)})),d=E.textContent.length,w=f}}else if(b){for(var x=b.querySelectorAll("[data-slate-leaf]"),S=0;S<x.length;S++){var C=x[S];if(dt.hasDOMNode(e,C)){y=C;break}}y?(f=y.closest('[data-slate-node="text"]'),d=(w=y).textContent.length,w.querySelectorAll("[data-slate-zero-width]").forEach((function(e){d-=e.textContent.length}))):d=1}w&&d===w.textContent.length&&ce&&"z"===w.getAttribute("data-slate-zero-width")&&null!==(p=w.textContent)&&void 0!==p&&p.startsWith("\ufeff")&&(c.hasAttribute("data-slate-zero-width")||fe&&null!==(v=w.textContent)&&void 0!==v&&v.endsWith("\n\n"))&&d--}if(ce&&!f&&!a){var T=c.hasAttribute("data-slate-node")?c:c.closest("[data-slate-node]");if(T&&dt.hasDOMNode(e,T,{editable:!0})){var _=dt.toSlateNode(e,T),O=n.Editor.start(e,dt.findPath(e,_)),P=O.path,D=O.offset;return T.querySelector("[data-slate-leaf]")||(D=s),{path:P,offset:D}}}if(!f){if(o)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t))}var N=dt.toSlateNode(e,f);return{path:dt.findPath(e,N),offset:d}},toSlateRange:function(e,t,r){var a,o,l,i,u,s,c=r.exactMatch,f=r.suppressThrow;if(tt(t)?t.anchorNode:t.startContainer)if(tt(t)){if(fe&&t.rangeCount>1){l=t.focusNode;var d=t.getRangeAt(0),p=t.getRangeAt(t.rangeCount-1);d.startContainer===l?(a=p.endContainer,o=p.endOffset,i=d.startOffset):(a=d.startContainer,o=d.endOffset,i=p.startOffset)}else a=t.anchorNode,o=t.anchorOffset,l=t.focusNode,i=t.focusOffset;u=he&&function(e){for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1}(a)||fe?t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset:t.isCollapsed}else a=t.startContainer,o=t.startOffset,l=t.endContainer,i=t.endOffset,u=t.collapsed;if(null==a||null==l||null==o||null==i)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));"getAttribute"in l&&"false"===l.getAttribute("contenteditable")&&"true"!==l.getAttribute("data-slate-void")&&(l=a,i=(null===(s=a.textContent)||void 0===s?void 0:s.length)||0);var h=dt.toSlatePoint(e,[a,o],{exactMatch:c,suppressThrow:f});if(!h)return null;var v=u?h:dt.toSlatePoint(e,[l,i],{exactMatch:c,suppressThrow:f});if(!v)return null;var g={anchor:h,focus:v};return n.Range.isExpanded(g)&&n.Range.isForward(g)&&Ze(l)&&n.Editor.void(e,{at:g.focus,mode:"highest"})&&(g=n.Editor.unhangRange(e,g,{voids:!0})),g}};function pt(e,t){var r=t.path,a=t.diff;if(!n.Editor.hasPath(e,r))return!1;var o=n.Node.get(e,r);if(!n.Text.isText(o))return!1;if(a.start!==o.text.length||0===a.text.length)return o.text.slice(a.start,a.start+a.text.length)===a.text;var l=n.Path.next(r);if(!n.Editor.hasPath(e,l))return!1;var i=n.Node.get(e,l);return n.Text.isText(i)&&i.text.startsWith(a.text)}function ht(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return e.slice(0,t.start)+t.text+e.slice(t.end)}),e)}function vt(e,t){var n=t.start,r=t.end,a=t.text,o=e.slice(n,r),l=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++)if(e.charAt(r)!==t.charAt(r))return r;return n}(o,a),i=function(e,t,n){for(var r=Math.min(e.length,t.length,n),a=0;a<r;a++)if(e.charAt(e.length-a-1)!==t.charAt(t.length-a-1))return a;return r}(o,a,Math.min(o.length-l,a.length-l)),u={start:n+l,end:r-i,text:a.slice(l,a.length-i)};return u.start===u.end&&0===u.text.length?null:u}function gt(e){var t=e.path,n=e.diff;return{anchor:{path:t,offset:n.start},focus:{path:t,offset:n.end}}}function mt(e,t){var r=t.path,a=t.offset;if(!n.Editor.hasPath(e,r))return null;var o=n.Node.get(e,r);if(!n.Text.isText(o))return null;var l=n.Editor.above(e,{match:function(t){return n.Element.isElement(t)&&n.Editor.isBlock(e,t)},at:r});if(!l)return null;for(;a>o.text.length;){var i=n.Editor.next(e,{at:r,match:n.Text.isText});if(!i||!n.Path.isDescendant(i[1],l[1]))return null;a-=o.text.length,o=i[0],r=i[1]}return{path:r,offset:a}}function bt(e,t){var r=mt(e,t.anchor);if(!r)return null;if(n.Range.isCollapsed(t))return{anchor:r,focus:r};var a=mt(e,t.focus);return a?{anchor:r,focus:a}:null}function yt(e,t,r){var a=Ae.get(e),o=null==a?void 0:a.find((function(e){var r=e.path;return n.Path.equals(r,t.path)}));if(!o||t.offset<=o.diff.start)return n.Point.transform(t,r,{affinity:"backward"});var l=o.diff;if(t.offset<=l.start+l.text.length){var i={path:t.path,offset:l.start},u=n.Point.transform(i,r,{affinity:"backward"});return u?{path:u.path,offset:u.offset+t.offset-l.start}:null}var s={path:t.path,offset:t.offset-l.text.length+l.end-l.start},c=n.Point.transform(s,r,{affinity:"backward"});return c?"split_node"===r.type&&n.Path.equals(r.path,t.path)&&s.offset<r.position&&l.start<r.position?c:{path:c.path,offset:c.offset+l.text.length-l.end+l.start}:null}function wt(e,t,r){var a=yt(e,t.anchor,r);if(!a)return null;if(n.Range.isCollapsed(t))return{anchor:a,focus:a};var o=yt(e,t.focus,r);return o?{anchor:a,focus:o}:null}function kt(e,t){var r=e.path,a=e.diff,o=e.id;switch(t.type){case"insert_text":return!n.Path.equals(t.path,r)||t.offset>=a.end?e:t.offset<=a.start?{diff:{start:t.text.length+a.start,end:t.text.length+a.end,text:a.text},id:o,path:r}:{diff:{start:a.start,end:a.end+t.text.length,text:a.text},id:o,path:r};case"remove_text":return!n.Path.equals(t.path,r)||t.offset>=a.end?e:t.offset+t.text.length<=a.start?{diff:{start:a.start-t.text.length,end:a.end-t.text.length,text:a.text},id:o,path:r}:{diff:{start:a.start,end:a.end-t.text.length,text:a.text},id:o,path:r};case"split_node":return!n.Path.equals(t.path,r)||t.position>=a.end?{diff:a,id:o,path:n.Path.transform(r,t,{affinity:"backward"})}:t.position>a.start?{diff:{start:a.start,end:Math.min(t.position,a.end),text:a.text},id:o,path:r}:{diff:{start:a.start-t.position,end:a.end-t.position,text:a.text},id:o,path:n.Path.transform(r,t,{affinity:"forward"})};case"merge_node":return n.Path.equals(t.path,r)?{diff:{start:a.start+t.position,end:a.end+t.position,text:a.text},id:o,path:n.Path.transform(r,t)}:{diff:a,id:o,path:n.Path.transform(r,t)}}var l=n.Path.transform(r,t);return l?{diff:a,path:l,id:o}:null}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e){var t=e.editor,r=e.scheduleOnDOMSelectionChange,a=e.onDOMSelectionChange,o=!1,l=null,i=null,u=null,s=0,c=!1,f=function(){var e=We.get(t);if(We.delete(t),e){var r=t.selection,a=bt(t,e);!a||r&&n.Range.equals(a,r)||n.Transforms.select(t,a)}},d=function(){if(i&&(clearTimeout(i),i=null),u&&(clearTimeout(u),u=null),b()||m()){o||(o=!0,setTimeout((function(){return o=!1}))),m()&&(o="action");var e=t.selection&&n.Editor.rangeRef(t,t.selection,{affinity:"forward"});Ie.set(t,t.marks),je.get(t),Ae.get(t);for(var l,s=b();l=null===(d=Ae.get(t))||void 0===d?void 0:d[0];){var d,p,h=Be.get(t);void 0!==h&&(Be.delete(t),t.marks=h),h&&!1===c&&(c=null);var v=gt(l);t.selection&&n.Range.equals(t.selection,v)||n.Transforms.select(t,v),l.diff.text?n.Editor.insertText(t,l.diff.text):n.Editor.deleteFragment(t),Ae.set(t,null===(p=Ae.get(t))||void 0===p?void 0:p.filter((function(e){return e.id!==l.id}))),pt(t,l)||(s=!1,je.delete(t),Ie.delete(t),o="action",We.delete(t),r.cancel(),a.cancel(),null==e||e.unref())}var g=null==e?void 0:e.unref();if(!g||We.get(t)||t.selection&&n.Range.equals(g,t.selection)||n.Transforms.select(t,g),m())!function(){var e=je.get(t);if(je.delete(t),e){if(e.at){var r=n.Point.isPoint(e.at)?mt(t,e.at):bt(t,e.at);if(!r)return;var a=n.Editor.range(t,r);t.selection&&n.Range.equals(t.selection,a)||n.Transforms.select(t,r)}e.run()}}();else{s&&r(),r.flush(),a.flush(),f();var y=Ie.get(t);Ie.delete(t),void 0!==y&&(t.marks=y,t.onChange())}}else f()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Te.get(t);n&&(b()||e?n.style.display="none":n.style.removeProperty("display"))},v=function(e,r){var a,o=null!==(a=Ae.get(t))&&void 0!==a?a:[];Ae.set(t,o);var l=n.Node.leaf(t,e),i=o.findIndex((function(t){return n.Path.equals(t.path,e)}));if(i<0)return vt(l.text,r)&&o.push({path:e,diff:r,id:s++}),void p();var u=function(e,t,n){var r=Math.min(t.start,n.start),a=Math.max(0,Math.min(t.start+t.text.length,n.end)-n.start),o=ht(e,t,n),l=Math.max(n.start+n.text.length,t.start+t.text.length+(t.start+t.text.length>n.start?n.text.length:0)-a),i=o.slice(r,l);return vt(e,{start:r,end:Math.max(t.end,n.end-t.text.length+(t.end-t.start)),text:i})}(l.text,o[i].diff,r);if(!u)return o.splice(i,1),void p();o[i]=xt(xt({},o[i]),{},{diff:u})},g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.at;c=!1,We.delete(t),r.cancel(),a.cancel(),m()&&d(),je.set(t,{at:o,run:e}),u=setTimeout(d)},m=function(){return!!je.get(t)},b=function(){var e;return!(null===(e=Ae.get(t))||void 0===e||!e.length)},y=function(e){We.set(t,e),i&&(clearTimeout(i),i=null);var r=t.selection;if(e){var a=!r||!n.Path.equals(r.anchor.path,e.anchor.path),o=!r||!n.Path.equals(r.anchor.path.slice(0,-1),e.anchor.path.slice(0,-1));(a&&c||o)&&(c=!1),(a||b())&&(i=setTimeout(d,200))}},w=function(){m()||(u=setTimeout(d))};return{flush:d,scheduleFlush:w,hasPendingDiffs:b,hasPendingAction:m,hasPendingChanges:function(){return m()||b()},isFlushing:function(){return o},handleUserSelect:y,handleCompositionEnd:function(e){l&&clearTimeout(l),l=setTimeout((function(){Re.set(t,!1),d()}),25)},handleCompositionStart:function(e){Re.set(t,!0),l&&(clearTimeout(l),l=null)},handleDOMBeforeInput:function(e){var r;i&&(clearTimeout(i),i=null);var a=e.inputType,o=null,l=e.dataTransfer||e.data||void 0;!1!==c&&"insertText"!==a&&"insertCompositionText"!==a&&(c=!1);var u=e.getTargetRanges(),s=h(u,1)[0];s&&(o=dt.toSlateRange(t,s,{exactMatch:!1,suppressThrow:!0}));var f=dt.getWindow(t).getSelection();if(!o&&f&&(s=f,o=dt.toSlateRange(t,f,{exactMatch:!1,suppressThrow:!0})),o=null!==(r=o)&&void 0!==r?r:t.selection){var d,p=!0;if(a.startsWith("delete")){if(n.Range.isExpanded(o)){var m=n.Range.edges(o),b=h(m,2),k=b[0],E=b[1];if(n.Node.leaf(t,k.path).text.length===k.offset&&0===E.offset){var x=n.Editor.next(t,{at:k.path,match:n.Text.isText});x&&n.Path.equals(x[1],E.path)&&(o={anchor:E,focus:E})}}var S=a.endsWith("Backward")?"backward":"forward",C=n.Range.edges(o),T=h(C,2),_=T[0],O=T[1],P=n.Editor.leaf(t,_.path),D=h(P,2),N=D[0],M=D[1],R={text:"",start:_.offset,end:O.offset},L=Ae.get(t),F=null==L?void 0:L.find((function(e){return n.Path.equals(e.path,M)})),z=F?[F.diff,R]:[R];if(0===ht.apply(void 0,[N.text].concat(z)).length&&(p=!1),n.Range.isExpanded(o)){if(p&&n.Path.equals(o.anchor.path,o.focus.path)){var B={path:o.anchor.path,offset:_.offset},I=n.Editor.range(t,B,B);return y(I),v(o.anchor.path,{text:"",end:O.offset,start:_.offset})}return g((function(){return n.Editor.deleteFragment(t,{direction:S})}),{at:o})}}switch(a){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":return g((function(){return n.Editor.deleteFragment(t)}),{at:o});case"deleteContent":case"deleteContentForward":var A=o.anchor;if(p&&n.Range.isCollapsed(o)){var j=n.Node.leaf(t,A.path);if(A.offset<j.text.length)return v(A.path,{text:"",start:A.offset,end:A.offset+1})}return g((function(){return n.Editor.deleteForward(t)}),{at:o});case"deleteContentBackward":var W,U=o.anchor,V=tt(s)?s.isCollapsed:!(null===(W=s)||void 0===W||!W.collapsed);return p&&V&&n.Range.isCollapsed(o)&&U.offset>0?v(U.path,{text:"",start:U.offset-1,end:U.offset}):g((function(){return n.Editor.deleteBackward(t)}),{at:o});case"deleteEntireSoftLine":return g((function(){n.Editor.deleteBackward(t,{unit:"line"}),n.Editor.deleteForward(t,{unit:"line"})}),{at:o});case"deleteHardLineBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"block"})}),{at:o});case"deleteSoftLineBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"line"})}),{at:o});case"deleteHardLineForward":return g((function(){return n.Editor.deleteForward(t,{unit:"block"})}),{at:o});case"deleteSoftLineForward":return g((function(){return n.Editor.deleteForward(t,{unit:"line"})}),{at:o});case"deleteWordBackward":return g((function(){return n.Editor.deleteBackward(t,{unit:"word"})}),{at:o});case"deleteWordForward":return g((function(){return n.Editor.deleteForward(t,{unit:"word"})}),{at:o});case"insertLineBreak":return g((function(){return n.Editor.insertSoftBreak(t)}),{at:o});case"insertParagraph":return g((function(){return n.Editor.insertBreak(t)}),{at:o});case"insertCompositionText":case"deleteCompositionText":case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":if("DataTransfer"===(null==(d=l)?void 0:d.constructor.name))return g((function(){return dt.insertData(t,l)}),{at:o});var H=null!=l?l:"";if(Be.get(t)&&(H=H.replace("\ufeff","")),"insertText"===a&&/.*\n.*\n$/.test(H)&&(H=H.slice(0,-1)),H.includes("\n"))return g((function(){var e=H.split("\n");e.forEach((function(r,a){r&&n.Editor.insertText(t,r),a!==e.length-1&&n.Editor.insertSoftBreak(t)}))}),{at:o});if(n.Path.equals(o.anchor.path,o.focus.path)){var q=n.Range.edges(o),Q=h(q,2),K=Q[0],$=Q[1],Y={start:K.offset,end:$.offset,text:H};if(H&&c&&"insertCompositionText"===a){var X=c.start+c.text.search(/\S|$/);Y.start+Y.text.search(/\S|$/)===X+1&&Y.end===c.start+c.text.length?(Y.start-=1,c=null,w()):c=!1}else c="insertText"===a&&(null===c?Y:!(!c||!n.Range.isCollapsed(o)||c.end+c.text.length!==K.offset)&&xt(xt({},c),{},{text:c.text+H}));if(p)return void v(K.path,Y)}return g((function(){return n.Editor.insertText(t,H)}),{at:o})}}},handleKeyDown:function(e){b()||(p(!0),setTimeout(p))},handleDomMutations:function(e){var n;b()||m()||e.some((function(n){return ut(t,n,e)}))&&(null===(n=Ue.get(t))||void 0===n||n())},handleInput:function(){!m()&&b()||d()}}}var Ct=we?t.useLayoutEffect:t.useEffect;var Tt=["node"];function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ot,Pt={subtree:!0,childList:!0,characterData:!0},Dt=ce?function(e){var n=e.node,r=g(e,Tt);if(!ce)return null;var a,o=le(),l=(a=t.useRef(!1),t.useEffect((function(){return a.current=!0,function(){a.current=!1}}),[]),a.current),i=t.useState((function(){return St(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({editor:o},r))})),s=h(i,1)[0];return function(e,n,r){var a=t.useState((function(){return new MutationObserver(n)})),o=h(a,1)[0];Ct((function(){o.takeRecords()})),t.useEffect((function(){if(!e.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");return o.observe(e.current,r),function(){return o.disconnect()}}),[o,e,r])}(n,s.handleDomMutations,Pt),ze.set(o,s.scheduleFlush),l&&s.flush(),s}:function(){return null},Nt=["anchor","focus"],Mt=["anchor","focus"],Rt=function(e,t){e.anchor,e.focus;var n=g(e,Nt);t.anchor,t.focus;var r,a,o=g(t,Mt);return e[Ve]===t[Ve]&&(r=n,a=o,Object.keys(r).length===Object.keys(a).length&&Object.keys(r).every((function(e){return a.hasOwnProperty(e)&&r[e]===a[e]})))},Lt=[],Ft="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(Ot||(Ot={}));var zt,Bt=function(e){return Object.freeze(e)},It=function(e,t){this.inlineSize=e,this.blockSize=t,Bt(this)},At=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Bt(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),jt=function(e){return e instanceof SVGElement&&"getBBox"in e},Wt=function(e){if(jt(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var a=e,o=a.offsetWidth,l=a.offsetHeight;return!(o||l||e.getClientRects().length)},Ut=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},Vt="undefined"!=typeof window?window:{},Ht=new WeakMap,qt=/auto|scroll/,Qt=/^tb|vertical/,Kt=/msie|trident/i.test(Vt.navigator&&Vt.navigator.userAgent),$t=function(e){return parseFloat(e||"0")},Yt=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new It((n?t:e)||0,(n?e:t)||0)},Xt=Bt({devicePixelContentBoxSize:Yt(),borderBoxSize:Yt(),contentBoxSize:Yt(),contentRect:new At(0,0,0,0)}),Gt=function(e,t){if(void 0===t&&(t=!1),Ht.has(e)&&!t)return Ht.get(e);if(Wt(e))return Ht.set(e,Xt),Xt;var n=getComputedStyle(e),r=jt(e)&&e.ownerSVGElement&&e.getBBox(),a=!Kt&&"border-box"===n.boxSizing,o=Qt.test(n.writingMode||""),l=!r&&qt.test(n.overflowY||""),i=!r&&qt.test(n.overflowX||""),u=r?0:$t(n.paddingTop),s=r?0:$t(n.paddingRight),c=r?0:$t(n.paddingBottom),f=r?0:$t(n.paddingLeft),d=r?0:$t(n.borderTopWidth),p=r?0:$t(n.borderRightWidth),h=r?0:$t(n.borderBottomWidth),v=f+s,g=u+c,m=(r?0:$t(n.borderLeftWidth))+p,b=d+h,y=i?e.offsetHeight-b-e.clientHeight:0,w=l?e.offsetWidth-m-e.clientWidth:0,k=a?v+m:0,E=a?g+b:0,x=r?r.width:$t(n.width)-k-w,S=r?r.height:$t(n.height)-E-y,C=x+v+w+m,T=S+g+y+b,_=Bt({devicePixelContentBoxSize:Yt(Math.round(x*devicePixelRatio),Math.round(S*devicePixelRatio),o),borderBoxSize:Yt(C,T,o),contentBoxSize:Yt(x,S,o),contentRect:new At(f,u,x,S)});return Ht.set(e,_),_},Jt=function(e,t,n){var r=Gt(e,n),a=r.borderBoxSize,o=r.contentBoxSize,l=r.devicePixelContentBoxSize;switch(t){case Ot.DEVICE_PIXEL_CONTENT_BOX:return l;case Ot.BORDER_BOX:return a;default:return o}},Zt=function(e){var t=Gt(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Bt([t.borderBoxSize]),this.contentBoxSize=Bt([t.contentBoxSize]),this.devicePixelContentBoxSize=Bt([t.devicePixelContentBoxSize])},en=function(e){if(Wt(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},tn=function(){var e=1/0,t=[];Lt.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new Zt(t.target),a=en(t.target);r.push(n),t.lastReportedSize=Jt(t.target,t.observedBox),a<e&&(e=a)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,r=t;n<r.length;n++){(0,r[n])()}return e},nn=function(e){Lt.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(en(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},rn=function(){var e,t=0;for(nn(t);Lt.some((function(e){return e.activeTargets.length>0}));)t=tn(),nn(t);return Lt.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:Ft}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=Ft),window.dispatchEvent(e)),t>0},an=[],on=function(e){if(!zt){var t=0,n=document.createTextNode("");new MutationObserver((function(){return an.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),zt=function(){n.textContent="".concat(t?t--:t++)}}an.push(e),zt()},ln=0,un={attributes:!0,characterData:!0,childList:!0,subtree:!0},sn=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],cn=function(e){return void 0===e&&(e=0),Date.now()+e},fn=!1,dn=function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!fn){fn=!0;var n=cn(e);!function(e){on((function(){requestAnimationFrame(e)}))}((function(){var r=!1;try{r=rn()}finally{if(fn=!1,e=n-cn(),!ln)return;r?t.run(1e3):e>0?t.run(e):t.start()}}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,un)};document.body?t():Vt.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),sn.forEach((function(t){return Vt.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),sn.forEach((function(t){return Vt.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}(),pn=new dn,hn=function(e){!ln&&e>0&&pn.start(),!(ln+=e)&&pn.stop()},vn=function(){function e(e,t){this.target=e,this.observedBox=t||Ot.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=Jt(this.target,this.observedBox,!0);return e=this.target,jt(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),gn=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},mn=new WeakMap,bn=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},yn=function(){function e(){}return e.connect=function(e,t){var n=new gn(e,t);mn.set(e,n)},e.observe=function(e,t,n){var r=mn.get(e),a=0===r.observationTargets.length;bn(r.observationTargets,t)<0&&(a&&Lt.push(r),r.observationTargets.push(new vn(t,n&&n.box)),hn(1),pn.schedule())},e.unobserve=function(e,t){var n=mn.get(e),r=bn(n.observationTargets,t),a=1===n.observationTargets.length;r>=0&&(a&&Lt.splice(Lt.indexOf(n),1),n.observationTargets.splice(r,1),hn(-1))},e.disconnect=function(e){var t=this,n=mn.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),wn=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");yn.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ut(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");yn.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ut(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");yn.unobserve(this,e)},e.prototype.disconnect=function(){yn.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),kn=function(e){var t=e.isLast,r=e.leaf,o=e.parent,l=e.text,i=le(),u=dt.findPath(i,l),s=n.Path.parent(u),c=!0===r[He];return i.isVoid(o)?a.default.createElement(Sn,{length:n.Node.string(o).length}):""!==r.text||o.children[o.children.length-1]!==l||i.isInline(o)||""!==n.Editor.string(i,s)?""===r.text?a.default.createElement(Sn,{isMarkPlaceholder:c}):t&&"\n"===r.text.slice(-1)?a.default.createElement(En,{isTrailing:!0,text:r.text}):a.default.createElement(En,{text:r.text}):a.default.createElement(Sn,{isLineBreak:!0,isMarkPlaceholder:c})},En=function(e){var n=e.text,r=e.isTrailing,o=void 0!==r&&r,l=t.useRef(null),i=function(){return"".concat(null!=n?n:"").concat(o?"\n":"")},u=t.useState(i),s=h(u,1)[0];return Ct((function(){var e=i();l.current&&l.current.textContent!==e&&(l.current.textContent=e)})),a.default.createElement(xn,{ref:l},s)},xn=t.memo(t.forwardRef((function(e,t){return a.default.createElement("span",{"data-slate-string":!0,ref:t},e.children)}))),Sn=function(e){var t=e.length,n=void 0===t?0:t,r=e.isLineBreak,o=void 0!==r&&r,l=e.isMarkPlaceholder,i={"data-slate-zero-width":o?"n":"z","data-slate-length":n};return void 0!==l&&l&&(i["data-slate-mark-placeholder"]=!0),a.default.createElement("span",Object.assign({},i),ce&&o?null:"\ufeff",o?a.default.createElement("br",null):null)};function Cn(e){e.current&&(clearTimeout(e.current),e.current=null)}var Tn=function(e){var n=e.leaf,r=e.isLast,o=e.text,l=e.parent,i=e.renderPlaceholder,u=e.renderLeaf,s=void 0===u?function(e){return a.default.createElement(On,Object.assign({},e))}:u,c=le(),f=t.useRef(null),d=t.useRef(null),p=t.useState(!1),v=h(p,2),g=v[0],m=v[1],b=t.useRef(null),y=t.useCallback((function(e){if(function(e,t){e.current&&(e.current.disconnect(),t&&(e.current=null))}(f,null==e),null==e){var t;Te.delete(c),null===(t=n.onPlaceholderResize)||void 0===t||t.call(n,null)}else{if(Te.set(c,e),!f.current){var r=window.ResizeObserver||wn;f.current=new r((function(){var t;null===(t=n.onPlaceholderResize)||void 0===t||t.call(n,e)}))}f.current.observe(e),d.current=e}}),[d,n,c]),w=a.default.createElement(kn,{isLast:r,leaf:n,parent:l,text:o}),k=n[Ve];if(t.useEffect((function(){return k?b.current||(b.current=setTimeout((function(){m(!0),b.current=null}),300)):(Cn(b),m(!1)),function(){return Cn(b)}}),[k,m]),k&&g){var E={children:n.placeholder,attributes:{"data-slate-placeholder":!0,style:{position:"absolute",top:0,pointerEvents:"none",width:"100%",maxWidth:"100%",display:"block",opacity:"0.333",userSelect:"none",textDecoration:"none",WebkitUserModify:de?"inherit":void 0},contentEditable:!1,ref:y}};w=a.default.createElement(a.default.Fragment,null,i(E),w)}return s({attributes:{"data-slate-leaf":!0},children:w,leaf:n,text:o})},_n=a.default.memo(Tn,(function(e,t){return t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&n.Text.equals(t.leaf,e.leaf)&&t.leaf[Ve]===e.leaf[Ve]})),On=function(e){var t=e.attributes,n=e.children;return a.default.createElement("span",Object.assign({},t),n)},Pn=function(e){for(var r=e.decorations,o=e.isLast,l=e.parent,i=e.renderPlaceholder,u=e.renderLeaf,s=e.text,c=le(),f=t.useRef(null),d=n.Text.decorations(s,r),p=dt.findKey(c,s),h=[],v=0;v<d.length;v++){var g=d[v];h.push(a.default.createElement(_n,{isLast:o&&v===d.length-1,key:"".concat(p.id,"-").concat(v),renderPlaceholder:i,leaf:g,text:s,parent:l,renderLeaf:u}))}var m=t.useCallback((function(e){var t=De.get(c);e?(null==t||t.set(p,e),Oe.set(s,e),_e.set(e,s)):(null==t||t.delete(p),Oe.delete(s),f.current&&_e.delete(f.current)),f.current=e}),[f,c,p,s]);return a.default.createElement("span",{"data-slate-node":"text",ref:m},h)},Dn=a.default.memo(Pn,(function(e,t){return t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(r.anchor.offset!==a.anchor.offset||r.focus.offset!==a.focus.offset||!Rt(r,a))return!1}return!0}(t.decorations,e.decorations)})),Nn=function(e){var r=e.decorations,o=e.element,l=e.renderElement,i=void 0===l?function(e){return a.default.createElement(Rn,Object.assign({},e))}:l,u=e.renderPlaceholder,s=e.renderLeaf,c=e.selection,f=le(),d=jn(),p=f.isInline(o),v=dt.findKey(f,o),g=t.useCallback((function(e){var t=De.get(f);e?(null==t||t.set(v,e),Oe.set(o,e),_e.set(e,o)):(null==t||t.delete(v),Oe.delete(o))}),[f,v,o]),b=In({decorations:r,node:o,renderElement:i,renderPlaceholder:u,renderLeaf:s,selection:c}),y={"data-slate-node":"element",ref:g};if(p&&(y["data-slate-inline"]=!0),!p&&n.Editor.hasInlines(f,o)){var w=n.Node.string(o),k=m(w);"rtl"===k&&(y.dir=k)}if(n.Editor.isVoid(f,o)){y["data-slate-void"]=!0,!d&&p&&(y.contentEditable=!1);var E=p?"span":"div",x=n.Node.texts(o),S=h(x,1),C=h(S[0],1)[0];b=a.default.createElement(E,{"data-slate-spacer":!0,style:{height:"0",color:"transparent",outline:"none",position:"absolute"}},a.default.createElement(Dn,{renderPlaceholder:u,decorations:[],isLast:!1,parent:o,text:C})),Ee.set(C,0),xe.set(C,o)}return i({attributes:y,children:b,element:o})},Mn=a.default.memo(Nn,(function(e,t){return e.element===t.element&&e.renderElement===t.renderElement&&e.renderLeaf===t.renderLeaf&&e.renderPlaceholder===t.renderPlaceholder&&function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var a=e[r],o=t[r];if(!n.Range.equals(a,o)||!Rt(a,o))return!1}return!0}(e.decorations,t.decorations)&&(e.selection===t.selection||!!e.selection&&!!t.selection&&n.Range.equals(e.selection,t.selection))})),Rn=function(e){var t=e.attributes,n=e.children,r=e.element,o=le().isInline(r)?"span":"div";return a.default.createElement(o,Object.assign({},t,{style:{position:"relative"}}),n)},Ln=t.createContext((function(){return[]})),Fn=t.createContext(!1);function zn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var In=function(e){for(var r=e.decorations,o=e.node,l=e.renderElement,i=e.renderPlaceholder,u=e.renderLeaf,s=e.selection,c=t.useContext(Ln),f=le(),d=dt.findPath(f,o),p=[],h=n.Element.isElement(o)&&!f.isInline(o)&&n.Editor.hasInlines(f,o),v=0;v<o.children.length;v++){var g,m=d.concat(v),b=o.children[v],y=dt.findKey(f,b),w=n.Editor.range(f,m),k=s&&n.Range.intersection(w,s),E=c([b,m]),x=zn(r);try{for(x.s();!(g=x.n()).done;){var S=g.value,C=n.Range.intersection(S,w);C&&E.push(C)}}catch(e){x.e(e)}finally{x.f()}n.Element.isElement(b)?p.push(a.default.createElement(Fn.Provider,{key:"provider-".concat(y.id),value:!!k},a.default.createElement(Mn,{decorations:E,element:b,key:y.id,renderElement:l,renderPlaceholder:i,renderLeaf:u,selection:k}))):p.push(a.default.createElement(Dn,{decorations:E,key:y.id,isLast:h&&v===o.children.length-1,parent:o,renderPlaceholder:i,renderLeaf:u,text:b})),Ee.set(b,v),xe.set(b,o)}return p},An=t.createContext(!1),jn=function(){return t.useContext(An)},Wn=t.createContext(null),Un=function(){var e=t.useContext(Wn);if(!e)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");return e.editor};var Vn=i((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});for(var n="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),r={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},a={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:n?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},o={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},l=1;l<20;l++)o["f"+l]=111+l;function i(e,t,n){t&&!("byKey"in t)&&(n=t,t=null),Array.isArray(e)||(e=[e]);var r=e.map((function(e){return u(e,t)})),a=function(e){return r.some((function(t){return s(t,e)}))};return null==n?a:a(n)}function u(e,t){var n=t&&t.byKey,a={},o=(e=e.replace("++","+add")).split("+"),l=o.length;for(var i in r)a[r[i]]=!1;var u=!0,s=!1,d=void 0;try{for(var p,h=o[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var v=p.value,g=v.endsWith("?")&&v.length>1;g&&(v=v.slice(0,-1));var m=f(v),b=r[m];1!==l&&b||(n?a.key=m:a.which=c(v)),b&&(a[b]=!g||null)}}catch(e){s=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(s)throw d}}return a}function s(e,t){for(var n in e){var r=e[n],a=void 0;if(null!=r&&((null!=(a="key"===n&&null!=t.key?t.key.toLowerCase():"which"===n?91===r&&93===t.which?91:t.which:t[n])||!1!==r)&&a!==r))return!1}return!0}function c(e){return e=f(e),o[e]||e.toUpperCase().charCodeAt(0)}function f(e){return e=e.toLowerCase(),e=a[e]||e}t.default=i,t.isHotkey=i,t.isCodeHotkey=function(e,t){return i(e,t)},t.isKeyHotkey=function(e,t){return i(e,{byKey:!0},t)},t.parseHotkey=u,t.compareHotkey=s,t.toKeyCode=c,t.toKeyName=f}));l(Vn);var Hn=Vn.isHotkey;Vn.isCodeHotkey,Vn.isKeyHotkey,Vn.parseHotkey,Vn.compareHotkey,Vn.toKeyCode,Vn.toKeyName;var qn={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},Qn={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},Kn={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},$n=function(e){var t=qn[e],n=Qn[e],r=Kn[e],a=t&&Hn(t),o=n&&Hn(n),l=r&&Hn(r);return function(e){return!(!a||!a(e))||(!!(se&&o&&o(e))||!(se||!l||!l(e)))}},Yn={isBold:$n("bold"),isCompose:$n("compose"),isMoveBackward:$n("moveBackward"),isMoveForward:$n("moveForward"),isDeleteBackward:$n("deleteBackward"),isDeleteForward:$n("deleteForward"),isDeleteLineBackward:$n("deleteLineBackward"),isDeleteLineForward:$n("deleteLineForward"),isDeleteWordBackward:$n("deleteWordBackward"),isDeleteWordForward:$n("deleteWordForward"),isExtendBackward:$n("extendBackward"),isExtendForward:$n("extendForward"),isExtendLineBackward:$n("extendLineBackward"),isExtendLineForward:$n("extendLineForward"),isItalic:$n("italic"),isMoveLineBackward:$n("moveLineBackward"),isMoveLineForward:$n("moveLineForward"),isMoveWordBackward:$n("moveWordBackward"),isMoveWordForward:$n("moveWordForward"),isRedo:$n("redo"),isSoftBreak:$n("insertSoftBreak"),isSplitBlock:$n("splitBlock"),isTransposeCharacter:$n("transposeCharacter"),isUndo:$n("undo")},Xn=l(i((function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0}))),Gn=i((function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));l(Gn);var Jn=l(i((function(e){e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0}))),Zn=i((function(e){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));l(Zn);var er=i((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0}));l(er);var tr=l(i((function(e){var t=Zn.default;e.exports=function(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return er(e)},e.exports.default=e.exports,e.exports.__esModule=!0}))),nr=i((function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),rr=l(nr);function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rr(e);if(t){var a=rr(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return tr(this,n)}}var or={subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0},lr=function(e){Jn(n,e);var t=ar(n);function n(){var e;return st(this,n),(e=t.apply(this,arguments)).context=null,e.manager=null,e.mutationObserver=null,e}return Xn(n,[{key:"observe",value:function(){var e,t=this.props.node;if(!t.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");null===(e=this.mutationObserver)||void 0===e||e.observe(t.current,or)}},{key:"componentDidMount",value:function(){var e=this.props.receivedUserInput,t=this.context;this.manager=function(e,t){var n=[],r=function(){n=[]};return{registerMutations:function(r){var a;if(t.current){var o=r.filter((function(t){return ut(e,t,r)}));(a=n).push.apply(a,$e(o))}},restoreDOM:function(){n.length>0&&(n.reverse().forEach((function(e){"characterData"!==e.type&&(e.removedNodes.forEach((function(t){e.target.insertBefore(t,e.nextSibling)})),e.addedNodes.forEach((function(t){e.target.removeChild(t)})))})),r())},clear:r}}(t,e),this.mutationObserver=new MutationObserver(this.manager.registerMutations),this.observe()}},{key:"getSnapshotBeforeUpdate",value:function(){var e,t,n,r,a=null===(e=this.mutationObserver)||void 0===e?void 0:e.takeRecords();null!=a&&a.length&&(null===(r=this.manager)||void 0===r||r.registerMutations(a));return null===(t=this.mutationObserver)||void 0===t||t.disconnect(),null===(n=this.manager)||void 0===n||n.restoreDOM(),null}},{key:"componentDidUpdate",value:function(){var e;null===(e=this.manager)||void 0===e||e.clear(),this.observe()}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}},{key:"render",value:function(){return this.props.children}}]),n}(t.Component);lr.contextType=oe;var ir=ce?lr:function(e){var t=e.children;return a.default.createElement(a.default.Fragment,null,t)},ur=["autoFocus","decorate","onDOMBeforeInput","placeholder","readOnly","renderElement","renderLeaf","renderPlaceholder","scrollSelectionIntoView","style","as","disableDefaultStyles"],sr=["text"];function cr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var hr=function(e){return a.default.createElement(a.default.Fragment,null,In(e))},vr=function(e){var t=e.attributes,n=e.children;return a.default.createElement("span",Object.assign({},t),n,ce&&a.default.createElement("br",null))},gr=function(){return[]},mr=function(e,t){if(t.getBoundingClientRect&&(!e.selection||e.selection&&n.Range.isCollapsed(e.selection))){var r=t.startContainer.parentElement;r.getBoundingClientRect=t.getBoundingClientRect.bind(t),ae(r,{scrollMode:"if-needed"}),delete r.getBoundingClientRect}},br=function(e,t){if(!t)return!1;var n=t(e);return null!=n?n:e.isDefaultPrevented()||e.isPropagationStopped()},yr=function(e){return et(e.target)&&(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement)},wr=function(e,t){if(!t)return!1;var n=t(e);return null!=n?n:e.defaultPrevented},kr=t.createContext(!1);function Er(e){return e instanceof Error}var xr=t.createContext({}),Sr=function(e,t){return e===t};function Cr(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sr,r=t.useReducer((function(e){return e+1}),0),a=h(r,2),o=a[1],l=t.useContext(xr);if(!l)throw new Error("The `useSlateSelector` hook must be used inside the <Slate> component's context.");var i,u=l.getSlate,s=l.addEventListener,c=t.useRef(),f=t.useRef((function(){return null})),d=t.useRef(null);try{i=e!==f.current||c.current?e(u()):d.current}catch(e){throw c.current&&Er(e)&&(e.message+="\nThe error may be correlated with this previous error:\n".concat(c.current.stack,"\n\n")),e}return Ct((function(){f.current=e,d.current=i,c.current=void 0})),Ct((function(){function e(){try{var e=f.current(u());if(n(e,d.current))return;d.current=e}catch(e){c.current=e}o()}var t=s(e);return e(),function(){return t()}}),[s,u]),i}var Tr=["editor","children","onChange","initialValue"],_r=function(e,t){return!e&&!t||!(!e||!t)&&n.Range.equals(e,t)},Or=Object.getOwnPropertySymbols,Pr=Object.prototype.hasOwnProperty,Dr=Object.prototype.propertyIsEnumerable;function Nr(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var Mr=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==r.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,a=Nr(e),o=1;o<arguments.length;o++){for(var l in n=Object(arguments[o]))Pr.call(n,l)&&(a[l]=n[l]);if(Or){r=Or(n);for(var i=0;i<r.length;i++)Dr.call(n,r[i])&&(a[r[i]]=n[r[i]])}}return a},Rr=i((function(e,t){var n,r,a,o;if("object"==typeof performance&&"function"==typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,u=i.now();t.unstable_now=function(){return i.now()-u}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var s=null,c=null,f=function(){if(null!==s)try{var e=t.unstable_now();s(!0,e),s=null}catch(e){throw setTimeout(f,0),e}};n=function(e){null!==s?setTimeout(n,0,e):(s=e,setTimeout(f,0))},r=function(e,t){c=setTimeout(e,t)},a=function(){clearTimeout(c)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var h=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var v=!1,g=null,m=-1,b=5,y=0;t.unstable_shouldYield=function(){return t.unstable_now()>=y},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var w=new MessageChannel,k=w.port2;w.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();y=e+b;try{g(!0,e)?k.postMessage(null):(v=!1,g=null)}catch(e){throw k.postMessage(null),e}}else v=!1},n=function(e){g=e,v||(v=!0,k.postMessage(null))},r=function(e,n){m=d((function(){e(t.unstable_now())}),n)},a=function(){p(m),m=-1}}function E(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<C(a,t)))break e;e[r]=t,e[n]=a,n=r}}function x(e){return void 0===(e=e[0])?null:e}function S(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var o=2*(r+1)-1,l=e[o],i=o+1,u=e[i];if(void 0!==l&&0>C(l,n))void 0!==u&&0>C(u,l)?(e[r]=u,e[i]=n,r=i):(e[r]=l,e[o]=n,r=o);else{if(!(void 0!==u&&0>C(u,n)))break e;e[r]=u,e[i]=n,r=i}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var T=[],_=[],O=1,P=null,D=3,N=!1,M=!1,R=!1;function L(e){for(var t=x(_);null!==t;){if(null===t.callback)S(_);else{if(!(t.startTime<=e))break;S(_),t.sortIndex=t.expirationTime,E(T,t)}t=x(_)}}function F(e){if(R=!1,L(e),!M)if(null!==x(T))M=!0,n(z);else{var t=x(_);null!==t&&r(F,t.startTime-e)}}function z(e,n){M=!1,R&&(R=!1,a()),N=!0;var o=D;try{for(L(n),P=x(T);null!==P&&(!(P.expirationTime>n)||e&&!t.unstable_shouldYield());){var l=P.callback;if("function"==typeof l){P.callback=null,D=P.priorityLevel;var i=l(P.expirationTime<=n);n=t.unstable_now(),"function"==typeof i?P.callback=i:P===x(T)&&S(T),L(n)}else S(T);P=x(T)}if(null!==P)var u=!0;else{var s=x(_);null!==s&&r(F,s.startTime-n),u=!1}return u}finally{P=null,D=o,N=!1}}var B=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){M||N||(M=!0,n(z))},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return x(T)},t.unstable_next=function(e){switch(D){case 1:case 2:case 3:var t=3;break;default:t=D}var n=D;D=t;try{return e()}finally{D=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=B,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=D;D=e;try{return t()}finally{D=n}},t.unstable_scheduleCallback=function(e,o,l){var i=t.unstable_now();switch("object"==typeof l&&null!==l?l="number"==typeof(l=l.delay)&&0<l?i+l:i:l=i,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:O++,callback:o,priorityLevel:e,startTime:l,expirationTime:u=l+u,sortIndex:-1},l>i?(e.sortIndex=l,E(_,e),null===x(T)&&e===x(_)&&(R?a():R=!0,r(F,l-i))):(e.sortIndex=u,E(T,e),M||N||(M=!0,n(z))),e},t.unstable_wrapCallback=function(e){var t=D;return function(){var n=D;D=t;try{return e.apply(this,arguments)}finally{D=n}}}}));Rr.unstable_now,Rr.unstable_shouldYield,Rr.unstable_forceFrameRate,Rr.unstable_IdlePriority,Rr.unstable_ImmediatePriority,Rr.unstable_LowPriority,Rr.unstable_NormalPriority,Rr.unstable_Profiling,Rr.unstable_UserBlockingPriority,Rr.unstable_cancelCallback,Rr.unstable_continueExecution,Rr.unstable_getCurrentPriorityLevel,Rr.unstable_getFirstCallbackNode,Rr.unstable_next,Rr.unstable_pauseExecution,Rr.unstable_requestPaint,Rr.unstable_runWithPriority,Rr.unstable_scheduleCallback,Rr.unstable_wrapCallback;var Lr=i((function(e,t){}));Lr.unstable_now,Lr.unstable_shouldYield,Lr.unstable_forceFrameRate,Lr.unstable_IdlePriority,Lr.unstable_ImmediatePriority,Lr.unstable_LowPriority,Lr.unstable_NormalPriority,Lr.unstable_Profiling,Lr.unstable_UserBlockingPriority,Lr.unstable_cancelCallback,Lr.unstable_continueExecution,Lr.unstable_getCurrentPriorityLevel,Lr.unstable_getFirstCallbackNode,Lr.unstable_next,Lr.unstable_pauseExecution,Lr.unstable_requestPaint,Lr.unstable_runWithPriority,Lr.unstable_scheduleCallback,Lr.unstable_wrapCallback;var Fr=i((function(e){e.exports=Rr}));function zr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!a.default)throw Error(zr(227));var Br=new Set,Ir={};function Ar(e,t){jr(e,t),jr(e+"Capture",t)}function jr(e,t){for(Ir[e]=t,e=0;e<t.length;e++)Br.add(t[e])}var Wr=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ur=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vr=Object.prototype.hasOwnProperty,Hr={},qr={};function Qr(e,t,n,r,a,o,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var Kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){Kr[e]=new Qr(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];Kr[t]=new Qr(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){Kr[e]=new Qr(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){Kr[e]=new Qr(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){Kr[e]=new Qr(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){Kr[e]=new Qr(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){Kr[e]=new Qr(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){Kr[e]=new Qr(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){Kr[e]=new Qr(e,5,!1,e.toLowerCase(),null,!1,!1)}));var $r=/[\-:]([a-z])/g;function Yr(e){return e[1].toUpperCase()}function Xr(e,t,n,r){var a=Kr.hasOwnProperty(t)?Kr[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!Vr.call(qr,e)||!Vr.call(Hr,e)&&(Ur.test(e)?qr[e]=!0:(Hr[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace($r,Yr);Kr[t]=new Qr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){Kr[e]=new Qr(e,1,!1,e.toLowerCase(),null,!1,!1)})),Kr.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){Kr[e]=new Qr(e,1,!1,e.toLowerCase(),null,!0,!0)}));var Gr=a.default.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jr=60103,Zr=60106,ea=60107,ta=60108,na=60114,ra=60109,aa=60110,oa=60112,la=60113,ia=60120,ua=60115,sa=60116,ca=60121,fa=60128,da=60129,pa=60130,ha=60131;if("function"==typeof Symbol&&Symbol.for){var va=Symbol.for;Jr=va("react.element"),Zr=va("react.portal"),ea=va("react.fragment"),ta=va("react.strict_mode"),na=va("react.profiler"),ra=va("react.provider"),aa=va("react.context"),oa=va("react.forward_ref"),la=va("react.suspense"),ia=va("react.suspense_list"),ua=va("react.memo"),sa=va("react.lazy"),ca=va("react.block"),va("react.scope"),fa=va("react.opaque.id"),da=va("react.debug_trace_mode"),pa=va("react.offscreen"),ha=va("react.legacy_hidden")}var ga,ma="function"==typeof Symbol&&Symbol.iterator;function ba(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=ma&&e[ma]||e["@@iterator"])?e:null}function ya(e){if(void 0===ga)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);ga=t&&t[1]||""}return"\n"+ga+e}var wa=!1;function ka(e,t){if(!e||wa)return"";wa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var a=e.stack.split("\n"),o=r.stack.split("\n"),l=a.length-1,i=o.length-1;1<=l&&0<=i&&a[l]!==o[i];)i--;for(;1<=l&&0<=i;l--,i--)if(a[l]!==o[i]){if(1!==l||1!==i)do{if(l--,0>--i||a[l]!==o[i])return"\n"+a[l].replace(" at new "," at ")}while(1<=l&&0<=i);break}}}finally{wa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ya(e):""}function Ea(e){switch(e.tag){case 5:return ya(e.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return e=ka(e.type,!1);case 11:return e=ka(e.type.render,!1);case 22:return e=ka(e.type._render,!1);case 1:return e=ka(e.type,!0);default:return""}}function xa(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ea:return"Fragment";case Zr:return"Portal";case na:return"Profiler";case ta:return"StrictMode";case la:return"Suspense";case ia:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case aa:return(e.displayName||"Context")+".Consumer";case ra:return(e._context.displayName||"Context")+".Provider";case oa:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ua:return xa(e.type);case ca:return xa(e._render);case sa:t=e._payload,e=e._init;try{return xa(e(t))}catch(e){}}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Ca(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ta(e){e._valueTracker||(e._valueTracker=function(e){var t=Ca(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function _a(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ca(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Oa(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Pa(e,t){var n=t.checked;return Mr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Da(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Sa(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Na(e,t){null!=(t=t.checked)&&Xr(e,"checked",t,!1)}function Ma(e,t){Na(e,t);var n=Sa(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?La(e,t.type,n):t.hasOwnProperty("defaultValue")&&La(e,t.type,Sa(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ra(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function La(e,t,n){"number"===t&&Oa(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Fa(e,t){return e=Mr({children:void 0},t),(t=function(e){var t="";return a.default.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function za(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Sa(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Ba(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(zr(91));return Mr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ia(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(zr(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(zr(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Sa(n)}}function Aa(e,t){var n=Sa(t.value),r=Sa(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ja(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Wa="http://www.w3.org/1999/xhtml",Ua="http://www.w3.org/2000/svg";function Va(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ha(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Va(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var qa,Qa,Ka=(Qa=function(e,t){if(e.namespaceURI!==Ua||"innerHTML"in e)e.innerHTML=t;else{for((qa=qa||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Qa(e,t)}))}:Qa);function $a(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ya={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xa=["Webkit","ms","Moz","O"];function Ga(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Ya.hasOwnProperty(e)&&Ya[e]?(""+t).trim():t+"px"}function Ja(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=Ga(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(Ya).forEach((function(e){Xa.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ya[t]=Ya[e]}))}));var Za=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function eo(e,t){if(t){if(Za[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(zr(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(zr(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(zr(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(zr(62))}}function to(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function no(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ro=null,ao=null,oo=null;function lo(e){if(e=Ru(e)){if("function"!=typeof ro)throw Error(zr(280));var t=e.stateNode;t&&(t=Fu(t),ro(e.stateNode,e.type,t))}}function io(e){ao?oo?oo.push(e):oo=[e]:ao=e}function uo(){if(ao){var e=ao,t=oo;if(oo=ao=null,lo(e),t)for(e=0;e<t.length;e++)lo(t[e])}}function so(e,t){return e(t)}function co(e,t,n,r,a){return e(t,n,r,a)}function fo(){}var po=so,ho=!1,vo=!1;function go(){null===ao&&null===oo||(fo(),uo())}function mo(e,t){var n=e.stateNode;if(null===n)return null;var r=Fu(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(zr(231,t,typeof n));return n}var bo=!1;if(Wr)try{var yo={};Object.defineProperty(yo,"passive",{get:function(){bo=!0}}),window.addEventListener("test",yo,yo),window.removeEventListener("test",yo,yo)}catch(Qa){bo=!1}function wo(e,t,n,r,a,o,l,i,u){var s=Array.prototype.slice.call(arguments,3);try{t.apply(n,s)}catch(e){this.onError(e)}}var ko=!1,Eo=null,xo=!1,So=null,Co={onError:function(e){ko=!0,Eo=e}};function To(e,t,n,r,a,o,l,i,u){ko=!1,Eo=null,wo.apply(Co,arguments)}function _o(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Oo(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Po(e){if(_o(e)!==e)throw Error(zr(188))}function Do(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=_o(e)))throw Error(zr(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Po(a),e;if(o===r)return Po(a),t;o=o.sibling}throw Error(zr(188))}if(n.return!==r.return)n=a,r=o;else{for(var l=!1,i=a.child;i;){if(i===n){l=!0,n=a,r=o;break}if(i===r){l=!0,r=a,n=o;break}i=i.sibling}if(!l){for(i=o.child;i;){if(i===n){l=!0,n=o,r=a;break}if(i===r){l=!0,r=o,n=a;break}i=i.sibling}if(!l)throw Error(zr(189))}}if(n.alternate!==r)throw Error(zr(190))}if(3!==n.tag)throw Error(zr(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function No(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var Mo,Ro,Lo,Fo,zo=!1,Bo=[],Io=null,Ao=null,jo=null,Wo=new Map,Uo=new Map,Vo=[],Ho="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qo(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function Qo(e,t){switch(e){case"focusin":case"focusout":Io=null;break;case"dragenter":case"dragleave":Ao=null;break;case"mouseover":case"mouseout":jo=null;break;case"pointerover":case"pointerout":Wo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uo.delete(t.pointerId)}}function Ko(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e=qo(t,n,r,a,o),null!==t&&(null!==(t=Ru(t))&&Ro(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function $o(e){var t=Mu(e.target);if(null!==t){var n=_o(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Oo(n)))return e.blockedOn=t,void Fo(e.lanePriority,(function(){Fr.unstable_runWithPriority(e.priority,(function(){Lo(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Yo(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ru(n))&&Ro(t),e.blockedOn=n,!1;t.shift()}return!0}function Xo(e,t,n){Yo(e)&&n.delete(t)}function Go(){for(zo=!1;0<Bo.length;){var e=Bo[0];if(null!==e.blockedOn){null!==(e=Ru(e.blockedOn))&&Mo(e);break}for(var t=e.targetContainers;0<t.length;){var n=Dl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&Bo.shift()}null!==Io&&Yo(Io)&&(Io=null),null!==Ao&&Yo(Ao)&&(Ao=null),null!==jo&&Yo(jo)&&(jo=null),Wo.forEach(Xo),Uo.forEach(Xo)}function Jo(e,t){e.blockedOn===t&&(e.blockedOn=null,zo||(zo=!0,Fr.unstable_scheduleCallback(Fr.unstable_NormalPriority,Go)))}function Zo(e){function t(t){return Jo(t,e)}if(0<Bo.length){Jo(Bo[0],e);for(var n=1;n<Bo.length;n++){var r=Bo[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Io&&Jo(Io,e),null!==Ao&&Jo(Ao,e),null!==jo&&Jo(jo,e),Wo.forEach(t),Uo.forEach(t),n=0;n<Vo.length;n++)(r=Vo[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Vo.length&&null===(n=Vo[0]).blockedOn;)$o(n),null===n.blockedOn&&Vo.shift()}function el(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tl={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},nl={},rl={};function al(e){if(nl[e])return nl[e];if(!tl[e])return e;var t,n=tl[e];for(t in n)if(n.hasOwnProperty(t)&&t in rl)return nl[e]=n[t];return e}Wr&&(rl=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);var ol=al("animationend"),ll=al("animationiteration"),il=al("animationstart"),ul=al("transitionend"),sl=new Map,cl=new Map,fl=["abort","abort",ol,"animationEnd",ll,"animationIteration",il,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ul,"transitionEnd","waiting","waiting"];function dl(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),cl.set(r,t),sl.set(r,a),Ar(a,[r])}}(0,Fr.unstable_now)();var pl=8;function hl(e){if(0!=(1&e))return pl=15,1;if(0!=(2&e))return pl=14,2;if(0!=(4&e))return pl=13,4;var t=24&e;return 0!==t?(pl=12,t):0!=(32&e)?(pl=11,32):0!==(t=192&e)?(pl=10,t):0!=(256&e)?(pl=9,256):0!==(t=3584&e)?(pl=8,t):0!=(4096&e)?(pl=7,4096):0!==(t=4186112&e)?(pl=6,t):0!==(t=62914560&e)?(pl=5,t):67108864&e?(pl=4,67108864):0!=(134217728&e)?(pl=3,134217728):0!==(t=805306368&e)?(pl=2,t):0!=(1073741824&e)?(pl=1,1073741824):(pl=8,e)}function vl(e,t){var n=e.pendingLanes;if(0===n)return pl=0;var r=0,a=0,o=e.expiredLanes,l=e.suspendedLanes,i=e.pingedLanes;if(0!==o)r=o,a=pl=15;else if(0!==(o=134217727&n)){var u=o&~l;0!==u?(r=hl(u),a=pl):0!==(i&=o)&&(r=hl(i),a=pl)}else 0!==(o=n&~l)?(r=hl(o),a=pl):0!==i&&(r=hl(i),a=pl);if(0===r)return 0;if(r=n&((0>(r=31-kl(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0==(t&l)){if(hl(t),a<=pl)return t;pl=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-kl(t)),r|=e[n],t&=~a;return r}function gl(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ml(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=bl(24&~t))?ml(10,t):e;case 10:return 0===(e=bl(192&~t))?ml(8,t):e;case 8:return 0===(e=bl(3584&~t))&&(0===(e=bl(4186112&~t))&&(e=512)),e;case 2:return 0===(t=bl(805306368&~t))&&(t=268435456),t}throw Error(zr(358,e))}function bl(e){return e&-e}function yl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wl(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-kl(t)]=n}var kl=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(El(e)/xl|0)|0},El=Math.log,xl=Math.LN2;var Sl=Fr.unstable_UserBlockingPriority,Cl=Fr.unstable_runWithPriority,Tl=!0;function _l(e,t,n,r){ho||fo();var a=Pl,o=ho;ho=!0;try{co(a,e,t,n,r)}finally{(ho=o)||go()}}function Ol(e,t,n,r){Cl(Sl,Pl.bind(null,e,t,n,r))}function Pl(e,t,n,r){var a;if(Tl)if((a=0==(4&t))&&0<Bo.length&&-1<Ho.indexOf(e))e=qo(null,e,t,n,r),Bo.push(e);else{var o=Dl(e,t,n,r);if(null===o)a&&Qo(e,r);else{if(a){if(-1<Ho.indexOf(e))return e=qo(o,e,t,n,r),void Bo.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return Io=Ko(Io,e,t,n,r,a),!0;case"dragenter":return Ao=Ko(Ao,e,t,n,r,a),!0;case"mouseover":return jo=Ko(jo,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return Wo.set(o,Ko(Wo.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Uo.set(o,Ko(Uo.get(o)||null,e,t,n,r,a)),!0}return!1}(o,e,t,n,r))return;Qo(e,r)}fu(e,t,r,null,n)}}}function Dl(e,t,n,r){var a=no(r);if(null!==(a=Mu(a))){var o=_o(a);if(null===o)a=null;else{var l=o.tag;if(13===l){if(null!==(a=Oo(o)))return a;a=null}else if(3===l){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return fu(e,t,r,a,n),null}var Nl=null,Ml=null,Rl=null;function Ll(){if(Rl)return Rl;var e,t,n=Ml,r=n.length,a="value"in Nl?Nl.value:Nl.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var l=r-e;for(t=1;t<=l&&n[r-t]===a[o-t];t++);return Rl=a.slice(e,1<t?1-t:void 0)}function Fl(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function zl(){return!0}function Bl(){return!1}function Il(e){function t(t,n,r,a,o){for(var l in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(a):a[l]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?zl:Bl,this.isPropagationStopped=Bl,this}return Mr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),t}var Al,jl,Wl,Ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vl=Il(Ul),Hl=Mr({},Ul,{view:0,detail:0}),ql=Il(Hl),Ql=Mr({},Hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ai,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Wl&&(Wl&&"mousemove"===e.type?(Al=e.screenX-Wl.screenX,jl=e.screenY-Wl.screenY):jl=Al=0,Wl=e),Al)},movementY:function(e){return"movementY"in e?e.movementY:jl}}),Kl=Il(Ql),$l=Il(Mr({},Ql,{dataTransfer:0})),Yl=Il(Mr({},Hl,{relatedTarget:0})),Xl=Il(Mr({},Ul,{animationName:0,elapsedTime:0,pseudoElement:0})),Gl=Mr({},Ul,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jl=Il(Gl),Zl=Il(Mr({},Ul,{data:0})),ei={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ti={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ni={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ri(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ni[e])&&!!t[e]}function ai(){return ri}var oi=Mr({},Hl,{key:function(e){if(e.key){var t=ei[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Fl(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ti[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ai,charCode:function(e){return"keypress"===e.type?Fl(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Fl(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),li=Il(oi),ii=Il(Mr({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ui=Il(Mr({},Hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ai})),si=Il(Mr({},Ul,{propertyName:0,elapsedTime:0,pseudoElement:0})),ci=Mr({},Ql,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fi=Il(ci),di=[9,13,27,32],pi=Wr&&"CompositionEvent"in window,hi=null;Wr&&"documentMode"in document&&(hi=document.documentMode);var vi=Wr&&"TextEvent"in window&&!hi,gi=Wr&&(!pi||hi&&8<hi&&11>=hi),mi=String.fromCharCode(32),bi=!1;function yi(e,t){switch(e){case"keyup":return-1!==di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wi(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var ki=!1;var Ei={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ei[e.type]:"textarea"===t}function Si(e,t,n,r){io(r),0<(t=pu(t,"onChange")).length&&(n=new Vl("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ci=null,Ti=null;function _i(e){ou(e,0)}function Oi(e){if(_a(Lu(e)))return e}function Pi(e,t){if("change"===e)return t}var Di=!1;if(Wr){var Ni;if(Wr){var Mi="oninput"in document;if(!Mi){var Ri=document.createElement("div");Ri.setAttribute("oninput","return;"),Mi="function"==typeof Ri.oninput}Ni=Mi}else Ni=!1;Di=Ni&&(!document.documentMode||9<document.documentMode)}function Li(){Ci&&(Ci.detachEvent("onpropertychange",Fi),Ti=Ci=null)}function Fi(e){if("value"===e.propertyName&&Oi(Ti)){var t=[];if(Si(t,Ti,e,no(e)),e=_i,ho)e(t);else{ho=!0;try{so(e,t)}finally{ho=!1,go()}}}}function zi(e,t,n){"focusin"===e?(Li(),Ti=n,(Ci=t).attachEvent("onpropertychange",Fi)):"focusout"===e&&Li()}function Bi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Oi(Ti)}function Ii(e,t){if("click"===e)return Oi(t)}function Ai(e,t){if("input"===e||"change"===e)return Oi(t)}var ji="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Wi=Object.prototype.hasOwnProperty;function Ui(e,t){if(ji(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Wi.call(t,n[r])||!ji(e[n[r]],t[n[r]]))return!1;return!0}function Vi(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hi(e,t){var n,r=Vi(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Vi(r)}}function qi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?qi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Qi(){for(var e=window,t=Oa();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Oa((e=t.contentWindow).document)}return t}function Ki(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var $i=Wr&&"documentMode"in document&&11>=document.documentMode,Yi=null,Xi=null,Gi=null,Ji=!1;function Zi(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Ji||null==Yi||Yi!==Oa(r)||("selectionStart"in(r=Yi)&&Ki(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Gi&&Ui(Gi,r)||(Gi=r,0<(r=pu(Xi,"onSelect")).length&&(t=new Vl("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Yi)))}dl("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),dl("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),dl(fl,2);for(var eu="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),tu=0;tu<eu.length;tu++)cl.set(eu[tu],0);jr("onMouseEnter",["mouseout","mouseover"]),jr("onMouseLeave",["mouseout","mouseover"]),jr("onPointerEnter",["pointerout","pointerover"]),jr("onPointerLeave",["pointerout","pointerover"]),Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ru=new Set("cancel close invalid load scroll toggle".split(" ").concat(nu));function au(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,l,i,u){if(To.apply(this,arguments),ko){if(!ko)throw Error(zr(198));var s=Eo;ko=!1,Eo=null,xo||(xo=!0,So=s)}}(r,t,void 0,e),e.currentTarget=null}function ou(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var i=r[l],u=i.instance,s=i.currentTarget;if(i=i.listener,u!==o&&a.isPropagationStopped())break e;au(a,i,s),o=u}else for(l=0;l<r.length;l++){if(u=(i=r[l]).instance,s=i.currentTarget,i=i.listener,u!==o&&a.isPropagationStopped())break e;au(a,i,s),o=u}}}if(xo)throw e=So,xo=!1,So=null,e}function lu(e,t){var n=zu(t),r=e+"__bubble";n.has(r)||(cu(t,e,2,!1),n.add(r))}var iu="_reactListening"+Math.random().toString(36).slice(2);function uu(e){e[iu]||(e[iu]=!0,Br.forEach((function(t){ru.has(t)||su(t,!1,e,null),su(t,!0,e,null)})))}function su(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&ru.has(e)){if("scroll"!==e)return;a|=2,o=r}var l=zu(o),i=e+"__"+(t?"capture":"bubble");l.has(i)||(t&&(a|=4),cu(o,e,a,t),l.add(i))}function cu(e,t,n,r){var a=cl.get(t);switch(void 0===a?2:a){case 0:a=_l;break;case 1:a=Ol;break;default:a=Pl}n=a.bind(null,t,n,e),a=void 0,!bo||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function fu(e,t,n,r,a){var o=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var l=r.tag;if(3===l||4===l){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===l)for(l=r.return;null!==l;){var u=l.tag;if((3===u||4===u)&&((u=l.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;l=l.return}for(;null!==i;){if(null===(l=Mu(i)))return;if(5===(u=l.tag)||6===u){r=o=l;continue e}i=i.parentNode}}r=r.return}!function(e,t,n){if(vo)return e(t,n);vo=!0;try{po(e,t,n)}finally{vo=!1,go()}}((function(){var r=o,a=no(n),l=[];e:{var i=sl.get(e);if(void 0!==i){var u=Vl,s=e;switch(e){case"keypress":if(0===Fl(n))break e;case"keydown":case"keyup":u=li;break;case"focusin":s="focus",u=Yl;break;case"focusout":s="blur",u=Yl;break;case"beforeblur":case"afterblur":u=Yl;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=$l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=ui;break;case ol:case ll:case il:u=Xl;break;case ul:u=si;break;case"scroll":u=ql;break;case"wheel":u=fi;break;case"copy":case"cut":case"paste":u=Jl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=ii}var c=0!=(4&t),f=!c&&"scroll"===e,d=c?null!==i?i+"Capture":null:i;c=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==d&&(null!=(v=mo(h,d))&&c.push(du(h,v,p)))),f)break;h=h.return}0<c.length&&(i=new u(i,s,null,n,a),l.push({event:i,listeners:c}))}}if(0==(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||0!=(16&t)||!(s=n.relatedTarget||n.fromElement)||!Mu(s)&&!s[Du])&&(u||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,u?(u=r,null!==(s=(s=n.relatedTarget||n.toElement)?Mu(s):null)&&(s!==(f=_o(s))||5!==s.tag&&6!==s.tag)&&(s=null)):(u=null,s=r),u!==s)){if(c=Kl,v="onMouseLeave",d="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(c=ii,v="onPointerLeave",d="onPointerEnter",h="pointer"),f=null==u?i:Lu(u),p=null==s?i:Lu(s),(i=new c(v,h+"leave",u,n,a)).target=f,i.relatedTarget=p,v=null,Mu(a)===r&&((c=new c(d,h+"enter",s,n,a)).target=p,c.relatedTarget=f,v=c),f=v,u&&s)e:{for(d=s,h=0,p=c=u;p;p=hu(p))h++;for(p=0,v=d;v;v=hu(v))p++;for(;0<h-p;)c=hu(c),h--;for(;0<p-h;)d=hu(d),p--;for(;h--;){if(c===d||null!==d&&c===d.alternate)break e;c=hu(c),d=hu(d)}c=null}else c=null;null!==u&&vu(l,i,u,c,!1),null!==s&&null!==f&&vu(l,f,s,c,!0)}if("select"===(u=(i=r?Lu(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===u&&"file"===i.type)var g=Pi;else if(xi(i))if(Di)g=Ai;else{g=Bi;var m=zi}else(u=i.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=Ii);switch(g&&(g=g(e,r))?Si(l,g,n,a):(m&&m(e,i,r),"focusout"===e&&(m=i._wrapperState)&&m.controlled&&"number"===i.type&&La(i,"number",i.value)),m=r?Lu(r):window,e){case"focusin":(xi(m)||"true"===m.contentEditable)&&(Yi=m,Xi=r,Gi=null);break;case"focusout":Gi=Xi=Yi=null;break;case"mousedown":Ji=!0;break;case"contextmenu":case"mouseup":case"dragend":Ji=!1,Zi(l,n,a);break;case"selectionchange":if($i)break;case"keydown":case"keyup":Zi(l,n,a)}var b;if(pi)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ki?yi(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(gi&&"ko"!==n.locale&&(ki||"onCompositionStart"!==y?"onCompositionEnd"===y&&ki&&(b=Ll()):(Ml="value"in(Nl=a)?Nl.value:Nl.textContent,ki=!0)),0<(m=pu(r,y)).length&&(y=new Zl(y,e,null,n,a),l.push({event:y,listeners:m}),b?y.data=b:null!==(b=wi(n))&&(y.data=b))),(b=vi?function(e,t){switch(e){case"compositionend":return wi(t);case"keypress":return 32!==t.which?null:(bi=!0,mi);case"textInput":return(e=t.data)===mi&&bi?null:e;default:return null}}(e,n):function(e,t){if(ki)return"compositionend"===e||!pi&&yi(e,t)?(e=Ll(),Rl=Ml=Nl=null,ki=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return gi&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=pu(r,"onBeforeInput")).length&&(a=new Zl("onBeforeInput","beforeinput",null,n,a),l.push({event:a,listeners:r}),a.data=b))}ou(l,t)}))}function du(e,t,n){return{instance:e,listener:t,currentTarget:n}}function pu(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=mo(e,n))&&r.unshift(du(e,o,a)),null!=(o=mo(e,t))&&r.push(du(e,o,a))),e=e.return}return r}function hu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function vu(e,t,n,r,a){for(var o=t._reactName,l=[];null!==n&&n!==r;){var i=n,u=i.alternate,s=i.stateNode;if(null!==u&&u===r)break;5===i.tag&&null!==s&&(i=s,a?null!=(u=mo(n,o))&&l.unshift(du(n,u,i)):a||null!=(u=mo(n,o))&&l.push(du(n,u,i))),n=n.return}0!==l.length&&e.push({event:t,listeners:l})}function gu(){}var mu=null,bu=null;function yu(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function wu(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ku="function"==typeof setTimeout?setTimeout:void 0,Eu="function"==typeof clearTimeout?clearTimeout:void 0;function xu(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Su(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Cu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Tu=0;var _u=Math.random().toString(36).slice(2),Ou="__reactFiber$"+_u,Pu="__reactProps$"+_u,Du="__reactContainer$"+_u,Nu="__reactEvents$"+_u;function Mu(e){var t=e[Ou];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Du]||n[Ou]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Cu(e);null!==e;){if(n=e[Ou])return n;e=Cu(e)}return t}n=(e=n).parentNode}return null}function Ru(e){return!(e=e[Ou]||e[Du])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Lu(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(zr(33))}function Fu(e){return e[Pu]||null}function zu(e){var t=e[Nu];return void 0===t&&(t=e[Nu]=new Set),t}var Bu=[],Iu=-1;function Au(e){return{current:e}}function ju(e){0>Iu||(e.current=Bu[Iu],Bu[Iu]=null,Iu--)}function Wu(e,t){Iu++,Bu[Iu]=e.current,e.current=t}var Uu={},Vu=Au(Uu),Hu=Au(!1),qu=Uu;function Qu(e,t){var n=e.type.contextTypes;if(!n)return Uu;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ku(e){return null!=(e=e.childContextTypes)}function $u(){ju(Hu),ju(Vu)}function Yu(e,t,n){if(Vu.current!==Uu)throw Error(zr(168));Wu(Vu,t),Wu(Hu,n)}function Xu(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(zr(108,xa(t)||"Unknown",a));return Mr({},n,r)}function Gu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uu,qu=Vu.current,Wu(Vu,e),Wu(Hu,Hu.current),!0}function Ju(e,t,n){var r=e.stateNode;if(!r)throw Error(zr(169));n?(e=Xu(e,t,qu),r.__reactInternalMemoizedMergedChildContext=e,ju(Hu),ju(Vu),Wu(Vu,e)):ju(Hu),Wu(Hu,n)}var Zu=null,es=null,ts=Fr.unstable_runWithPriority,ns=Fr.unstable_scheduleCallback,rs=Fr.unstable_cancelCallback,as=Fr.unstable_shouldYield,os=Fr.unstable_requestPaint,ls=Fr.unstable_now,is=Fr.unstable_getCurrentPriorityLevel,us=Fr.unstable_ImmediatePriority,ss=Fr.unstable_UserBlockingPriority,cs=Fr.unstable_NormalPriority,fs=Fr.unstable_LowPriority,ds=Fr.unstable_IdlePriority,ps={},hs=void 0!==os?os:function(){},vs=null,gs=null,ms=!1,bs=ls(),ys=1e4>bs?ls:function(){return ls()-bs};function ws(){switch(is()){case us:return 99;case ss:return 98;case cs:return 97;case fs:return 96;case ds:return 95;default:throw Error(zr(332))}}function ks(e){switch(e){case 99:return us;case 98:return ss;case 97:return cs;case 96:return fs;case 95:return ds;default:throw Error(zr(332))}}function Es(e,t){return e=ks(e),ts(e,t)}function xs(e,t,n){return e=ks(e),ns(e,t,n)}function Ss(){if(null!==gs){var e=gs;gs=null,rs(e)}Cs()}function Cs(){if(!ms&&null!==vs){ms=!0;var e=0;try{var t=vs;Es(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),vs=null}catch(t){throw null!==vs&&(vs=vs.slice(e+1)),ns(us,Ss),t}finally{ms=!1}}}var Ts=Gr.ReactCurrentBatchConfig;function _s(e,t){if(e&&e.defaultProps){for(var n in t=Mr({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Os=Au(null),Ps=null,Ds=null,Ns=null;function Ms(){Ns=Ds=Ps=null}function Rs(e){var t=Os.current;ju(Os),e.type._context._currentValue=t}function Ls(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function Fs(e,t){Ps=e,Ns=Ds=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(pf=!0),e.firstContext=null)}function zs(e,t){if(Ns!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Ns=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ds){if(null===Ps)throw Error(zr(308));Ds=t,Ps.dependencies={lanes:0,firstContext:t,responders:null}}else Ds=Ds.next=t;return e._currentValue}var Bs=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function js(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ws(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function Us(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=l:o=o.next=l,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,r){var a=e.updateQueue;Bs=!1;var o=a.firstBaseUpdate,l=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var u=i,s=u.next;u.next=null,null===l?o=s:l.next=s,l=u;var c=e.alternate;if(null!==c){var f=(c=c.updateQueue).lastBaseUpdate;f!==l&&(null===f?c.firstBaseUpdate=s:f.next=s,c.lastBaseUpdate=u)}}if(null!==o){for(f=a.baseState,l=0,c=s=u=null;;){i=o.lane;var d=o.eventTime;if((r&i)===i){null!==c&&(c=c.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,h=o;switch(i=t,d=n,h.tag){case 1:if("function"==typeof(p=h.payload)){f=p.call(d,f,i);break e}f=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null==(i="function"==typeof(p=h.payload)?p.call(d,f,i):p))break e;f=Mr({},f,i);break e;case 2:Bs=!0}}null!==o.callback&&(e.flags|=32,null===(i=a.effects)?a.effects=[o]:i.push(o))}else d={eventTime:d,lane:i,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(s=c=d,u=f):c=c.next=d,l|=i;if(null===(o=o.next)){if(null===(i=a.shared.pending))break;o=i.next,i.next=null,a.lastBaseUpdate=i,a.shared.pending=null}}null===c&&(u=f),a.baseState=u,a.firstBaseUpdate=s,a.lastBaseUpdate=c,md|=l,e.lanes=l,e.memoizedState=f}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!=typeof a)throw Error(zr(191,a));a.call(r)}}}var qs=(new a.default.Component).refs;function Qs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:Mr({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ks={isMounted:function(e){return!!(e=e._reactInternals)&&_o(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ud(),a=Vd(e),o=js(r,a);o.payload=t,null!=n&&(o.callback=n),Ws(e,o),Hd(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ud(),a=Vd(e),o=js(r,a);o.tag=1,o.payload=t,null!=n&&(o.callback=n),Ws(e,o),Hd(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ud(),r=Vd(e),a=js(n,r);a.tag=2,null!=t&&(a.callback=t),Ws(e,a),Hd(e,r,n)}};function $s(e,t,n,r,a,o,l){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,l):!t.prototype||!t.prototype.isPureReactComponent||(!Ui(n,r)||!Ui(a,o))}function Ys(e,t,n){var r=!1,a=Uu,o=t.contextType;return"object"==typeof o&&null!==o?o=zs(o):(a=Ku(t)?qu:Vu.current,o=(r=null!=(r=t.contextTypes))?Qu(e,a):Uu),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ks,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function Xs(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ks.enqueueReplaceState(t,t.state,null)}function Gs(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=qs,Is(e);var o=t.contextType;"object"==typeof o&&null!==o?a.context=zs(o):(o=Ku(t)?qu:Vu.current,a.context=Qu(e,o)),Vs(e,n,a,r),a.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(Qs(e,t,o,n),a.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(t=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Ks.enqueueReplaceState(a,a.state,null),Vs(e,n,a,r),a.state=e.memoizedState),"function"==typeof a.componentDidMount&&(e.flags|=4)}var Js=Array.isArray;function Zs(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(zr(309));var r=n.stateNode}if(!r)throw Error(zr(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===qs&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(zr(284));if(!n._owner)throw Error(zr(290,e))}return e}function ec(e,t){if("textarea"!==e.type)throw Error(zr(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function tc(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ep(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function l(t){return e&&null===t.alternate&&(t.flags=2),t}function i(e,t,n,r){return null===t||6!==t.tag?((t=Tp(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Zs(e,t,n),r.return=e,r):((r=xp(n.type,n.key,n.props,null,e.mode,r)).ref=Zs(e,t,n),r.return=e,r)}function s(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=_p(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function c(e,t,n,r,o){return null===t||7!==t.tag?((t=Sp(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Tp(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Jr:return(n=xp(t.type,t.key,t.props,null,e.mode,n)).ref=Zs(e,null,t),n.return=e,n;case Zr:return(t=_p(t,e.mode,n)).return=e,t}if(Js(t)||ba(t))return(t=Sp(t,e.mode,n,null)).return=e,t;ec(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==a?null:i(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Jr:return n.key===a?n.type===ea?c(e,t,n.props.children,r,a):u(e,t,n,r):null;case Zr:return n.key===a?s(e,t,n,r):null}if(Js(n)||ba(n))return null!==a?null:c(e,t,n,r,null);ec(e,n)}return null}function p(e,t,n,r,a){if("string"==typeof r||"number"==typeof r)return i(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Jr:return e=e.get(null===r.key?n:r.key)||null,r.type===ea?c(t,e,r.props.children,a,r.key):u(t,e,r,a);case Zr:return s(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(Js(r)||ba(r))return c(t,e=e.get(n)||null,r,a,null);ec(t,r)}return null}function h(a,l,i,u){for(var s=null,c=null,h=l,v=l=0,g=null;null!==h&&v<i.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var m=d(a,h,i[v],u);if(null===m){null===h&&(h=g);break}e&&h&&null===m.alternate&&t(a,h),l=o(m,l,v),null===c?s=m:c.sibling=m,c=m,h=g}if(v===i.length)return n(a,h),s;if(null===h){for(;v<i.length;v++)null!==(h=f(a,i[v],u))&&(l=o(h,l,v),null===c?s=h:c.sibling=h,c=h);return s}for(h=r(a,h);v<i.length;v++)null!==(g=p(h,a,v,i[v],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?v:g.key),l=o(g,l,v),null===c?s=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(a,e)})),s}function v(a,l,i,u){var s=ba(i);if("function"!=typeof s)throw Error(zr(150));if(null==(i=s.call(i)))throw Error(zr(151));for(var c=s=null,h=l,v=l=0,g=null,m=i.next();null!==h&&!m.done;v++,m=i.next()){h.index>v?(g=h,h=null):g=h.sibling;var b=d(a,h,m.value,u);if(null===b){null===h&&(h=g);break}e&&h&&null===b.alternate&&t(a,h),l=o(b,l,v),null===c?s=b:c.sibling=b,c=b,h=g}if(m.done)return n(a,h),s;if(null===h){for(;!m.done;v++,m=i.next())null!==(m=f(a,m.value,u))&&(l=o(m,l,v),null===c?s=m:c.sibling=m,c=m);return s}for(h=r(a,h);!m.done;v++,m=i.next())null!==(m=p(h,a,v,m.value,u))&&(e&&null!==m.alternate&&h.delete(null===m.key?v:m.key),l=o(m,l,v),null===c?s=m:c.sibling=m,c=m);return e&&h.forEach((function(e){return t(a,e)})),s}return function(e,r,o,i){var u="object"==typeof o&&null!==o&&o.type===ea&&null===o.key;u&&(o=o.props.children);var s="object"==typeof o&&null!==o;if(s)switch(o.$$typeof){case Jr:e:{for(s=o.key,u=r;null!==u;){if(u.key===s){if(7===u.tag){if(o.type===ea){n(e,u.sibling),(r=a(u,o.props.children)).return=e,e=r;break e}}else if(u.elementType===o.type){n(e,u.sibling),(r=a(u,o.props)).ref=Zs(e,u,o),r.return=e,e=r;break e}n(e,u);break}t(e,u),u=u.sibling}o.type===ea?((r=Sp(o.props.children,e.mode,i,o.key)).return=e,e=r):((i=xp(o.type,o.key,o.props,null,e.mode,i)).ref=Zs(e,r,o),i.return=e,e=i)}return l(e);case Zr:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=a(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=_p(o,e.mode,i)).return=e,e=r}return l(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,o)).return=e,e=r):(n(e,r),(r=Tp(o,e.mode,i)).return=e,e=r),l(e);if(Js(o))return h(e,r,o,i);if(ba(o))return v(e,r,o,i);if(s&&ec(e,o),void 0===o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(zr(152,xa(e.type)||"Component"))}return n(e,r)}}var nc=tc(!0),rc=tc(!1),ac={},oc=Au(ac),lc=Au(ac),ic=Au(ac);function uc(e){if(e===ac)throw Error(zr(174));return e}function sc(e,t){switch(Wu(ic,t),Wu(lc,e),Wu(oc,ac),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ha(null,"");break;default:t=Ha(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ju(oc),Wu(oc,t)}function cc(){ju(oc),ju(lc),ju(ic)}function fc(e){uc(ic.current);var t=uc(oc.current),n=Ha(t,e.type);t!==n&&(Wu(lc,e),Wu(oc,n))}function dc(e){lc.current===e&&(ju(oc),ju(lc))}var pc=Au(0);function hc(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vc=null,gc=null,mc=!1;function bc(e,t){var n=wp(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function yc(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function wc(e){if(mc){var t=gc;if(t){var n=t;if(!yc(e,t)){if(!(t=Su(n.nextSibling))||!yc(e,t))return e.flags=-1025&e.flags|2,mc=!1,void(vc=e);bc(vc,n)}vc=e,gc=Su(t.firstChild)}else e.flags=-1025&e.flags|2,mc=!1,vc=e}}function kc(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;vc=e}function Ec(e){if(e!==vc)return!1;if(!mc)return kc(e),mc=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!wu(t,e.memoizedProps))for(t=gc;t;)bc(e,t),t=Su(t.nextSibling);if(kc(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(zr(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){gc=Su(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}gc=null}}else gc=vc?Su(e.stateNode.nextSibling):null;return!0}function xc(){gc=vc=null,mc=!1}var Sc=[];function Cc(){for(var e=0;e<Sc.length;e++)Sc[e]._workInProgressVersionPrimary=null;Sc.length=0}var Tc=Gr.ReactCurrentDispatcher,_c=Gr.ReactCurrentBatchConfig,Oc=0,Pc=null,Dc=null,Nc=null,Mc=!1,Rc=!1;function Lc(){throw Error(zr(321))}function Fc(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ji(e[n],t[n]))return!1;return!0}function zc(e,t,n,r,a,o){if(Oc=o,Pc=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Tc.current=null===e||null===e.memoizedState?sf:cf,e=n(r,a),Rc){o=0;do{if(Rc=!1,!(25>o))throw Error(zr(301));o+=1,Nc=Dc=null,t.updateQueue=null,Tc.current=ff,e=n(r,a)}while(Rc)}if(Tc.current=uf,t=null!==Dc&&null!==Dc.next,Oc=0,Nc=Dc=Pc=null,Mc=!1,t)throw Error(zr(300));return e}function Bc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Nc?Pc.memoizedState=Nc=e:Nc=Nc.next=e,Nc}function Ic(){if(null===Dc){var e=Pc.alternate;e=null!==e?e.memoizedState:null}else e=Dc.next;var t=null===Nc?Pc.memoizedState:Nc.next;if(null!==t)Nc=t,Dc=e;else{if(null===e)throw Error(zr(310));e={memoizedState:(Dc=e).memoizedState,baseState:Dc.baseState,baseQueue:Dc.baseQueue,queue:Dc.queue,next:null},null===Nc?Pc.memoizedState=Nc=e:Nc=Nc.next=e}return Nc}function Ac(e,t){return"function"==typeof t?t(e):t}function jc(e){var t=Ic(),n=t.queue;if(null===n)throw Error(zr(311));n.lastRenderedReducer=e;var r=Dc,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var l=a.next;a.next=o.next,o.next=l}r.baseQueue=a=o,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var i=l=o=null,u=a;do{var s=u.lane;if((Oc&s)===s)null!==i&&(i=i.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var c={lane:s,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===i?(l=i=c,o=r):i=i.next=c,Pc.lanes|=s,md|=s}u=u.next}while(null!==u&&u!==a);null===i?o=r:i.next=l,ji(r,t.memoizedState)||(pf=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=i,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Wc(e){var t=Ic(),n=t.queue;if(null===n)throw Error(zr(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var l=a=a.next;do{o=e(o,l.action),l=l.next}while(l!==a);ji(o,t.memoizedState)||(pf=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Uc(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Oc&e)===e)&&(t._workInProgressVersionPrimary=r,Sc.push(t))),e)return n(t._source);throw Sc.push(t),Error(zr(350))}function Vc(e,t,n,r){var a=sd;if(null===a)throw Error(zr(349));var o=t._getVersion,l=o(t._source),i=Tc.current,u=i.useState((function(){return Uc(a,t,n)})),s=u[1],c=u[0];u=Nc;var f=e.memoizedState,d=f.refs,p=d.getSnapshot,h=f.source;f=f.subscribe;var v=Pc;return e.memoizedState={refs:d,source:t,subscribe:r},i.useEffect((function(){d.getSnapshot=n,d.setSnapshot=s;var e=o(t._source);if(!ji(l,e)){e=n(t._source),ji(c,e)||(s(e),e=Vd(v),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,i=e;0<i;){var u=31-kl(i),f=1<<u;r[u]|=e,i&=~f}}}),[n,t,r]),i.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=Vd(v);a.mutableReadLanes|=r&a.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),ji(p,n)&&ji(h,t)&&ji(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:c}).dispatch=s=lf.bind(null,Pc,e),u.queue=e,u.baseQueue=null,c=Uc(a,t,n),u.memoizedState=u.baseState=c),c}function Hc(e,t,n){return Vc(Ic(),e,t,n)}function qc(e){var t=Bc();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:e}).dispatch=lf.bind(null,Pc,e),[t.memoizedState,e]}function Qc(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Pc.updateQueue)?(t={lastEffect:null},Pc.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Kc(e){return e={current:e},Bc().memoizedState=e}function $c(){return Ic().memoizedState}function Yc(e,t,n,r){var a=Bc();Pc.flags|=e,a.memoizedState=Qc(1|t,n,void 0,void 0===r?null:r)}function Xc(e,t,n,r){var a=Ic();r=void 0===r?null:r;var o=void 0;if(null!==Dc){var l=Dc.memoizedState;if(o=l.destroy,null!==r&&Fc(r,l.deps))return void Qc(t,n,o,r)}Pc.flags|=e,a.memoizedState=Qc(1|t,n,o,r)}function Gc(e,t){return Yc(516,4,e,t)}function Jc(e,t){return Xc(516,4,e,t)}function Zc(e,t){return Xc(4,2,e,t)}function ef(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tf(e,t,n){return n=null!=n?n.concat([e]):null,Xc(4,2,ef.bind(null,t,e),n)}function nf(){}function rf(e,t){var n=Ic();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Fc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function af(e,t){var n=Ic();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Fc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function of(e,t){var n=ws();Es(98>n?98:n,(function(){e(!0)})),Es(97<n?97:n,(function(){var n=_c.transition;_c.transition=1;try{e(!1),t()}finally{_c.transition=n}}))}function lf(e,t,n){var r=Ud(),a=Vd(e),o={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},l=t.pending;if(null===l?o.next=o:(o.next=l.next,l.next=o),t.pending=o,l=e.alternate,e===Pc||null!==l&&l===Pc)Rc=Mc=!0;else{if(0===e.lanes&&(null===l||0===l.lanes)&&null!==(l=t.lastRenderedReducer))try{var i=t.lastRenderedState,u=l(i,n);if(o.eagerReducer=l,o.eagerState=u,ji(u,i))return}catch(e){}Hd(e,a,r)}}var uf={readContext:zs,useCallback:Lc,useContext:Lc,useEffect:Lc,useImperativeHandle:Lc,useLayoutEffect:Lc,useMemo:Lc,useReducer:Lc,useRef:Lc,useState:Lc,useDebugValue:Lc,useDeferredValue:Lc,useTransition:Lc,useMutableSource:Lc,useOpaqueIdentifier:Lc,unstable_isNewReconciler:!1},sf={readContext:zs,useCallback:function(e,t){return Bc().memoizedState=[e,void 0===t?null:t],e},useContext:zs,useEffect:Gc,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Yc(4,2,ef.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yc(4,2,e,t)},useMemo:function(e,t){var n=Bc();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Bc();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=lf.bind(null,Pc,e),[r.memoizedState,e]},useRef:Kc,useState:qc,useDebugValue:nf,useDeferredValue:function(e){var t=qc(e),n=t[0],r=t[1];return Gc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=qc(!1),t=e[0];return Kc(e=of.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=Bc();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},Vc(r,e,t,n)},useOpaqueIdentifier:function(){if(mc){var e=!1,t=function(e){return{$$typeof:fa,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Tu++).toString(36))),Error(zr(355))})),n=qc(t)[1];return 0==(2&Pc.mode)&&(Pc.flags|=516,Qc(5,(function(){n("r:"+(Tu++).toString(36))}),void 0,null)),t}return qc(t="r:"+(Tu++).toString(36)),t},unstable_isNewReconciler:!1},cf={readContext:zs,useCallback:rf,useContext:zs,useEffect:Jc,useImperativeHandle:tf,useLayoutEffect:Zc,useMemo:af,useReducer:jc,useRef:$c,useState:function(){return jc(Ac)},useDebugValue:nf,useDeferredValue:function(e){var t=jc(Ac),n=t[0],r=t[1];return Jc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=jc(Ac)[0];return[$c().current,e]},useMutableSource:Hc,useOpaqueIdentifier:function(){return jc(Ac)[0]},unstable_isNewReconciler:!1},ff={readContext:zs,useCallback:rf,useContext:zs,useEffect:Jc,useImperativeHandle:tf,useLayoutEffect:Zc,useMemo:af,useReducer:Wc,useRef:$c,useState:function(){return Wc(Ac)},useDebugValue:nf,useDeferredValue:function(e){var t=Wc(Ac),n=t[0],r=t[1];return Jc((function(){var t=_c.transition;_c.transition=1;try{r(e)}finally{_c.transition=t}}),[e]),n},useTransition:function(){var e=Wc(Ac)[0];return[$c().current,e]},useMutableSource:Hc,useOpaqueIdentifier:function(){return Wc(Ac)[0]},unstable_isNewReconciler:!1},df=Gr.ReactCurrentOwner,pf=!1;function hf(e,t,n,r){t.child=null===e?rc(t,null,n,r):nc(t,e.child,n,r)}function vf(e,t,n,r,a){n=n.render;var o=t.ref;return Fs(t,a),r=zc(e,t,n,r,o,a),null===e||pf?(t.flags|=1,hf(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,Ff(e,t,a))}function gf(e,t,n,r,a,o){if(null===e){var l=n.type;return"function"!=typeof l||kp(l)||void 0!==l.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=xp(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=l,mf(e,t,l,r,a,o))}return l=e.child,0==(a&o)&&(a=l.memoizedProps,(n=null!==(n=n.compare)?n:Ui)(a,r)&&e.ref===t.ref)?Ff(e,t,o):(t.flags|=1,(e=Ep(l,r)).ref=t.ref,e.return=t,t.child=e)}function mf(e,t,n,r,a,o){if(null!==e&&Ui(e.memoizedProps,r)&&e.ref===t.ref){if(pf=!1,0==(o&a))return t.lanes=e.lanes,Ff(e,t,o);0!=(16384&e.flags)&&(pf=!0)}return wf(e,t,n,r,o)}function bf(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},Jd(t,n);else{if(0==(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Jd(t,e),null;t.memoizedState={baseLanes:0},Jd(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Jd(t,r);return hf(e,t,a,n),t.child}function yf(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function wf(e,t,n,r,a){var o=Ku(n)?qu:Vu.current;return o=Qu(t,o),Fs(t,a),n=zc(e,t,n,r,o,a),null===e||pf?(t.flags|=1,hf(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,Ff(e,t,a))}function kf(e,t,n,r,a){if(Ku(n)){var o=!0;Gu(t)}else o=!1;if(Fs(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Ys(t,n,r),Gs(t,n,r,a),r=!0;else if(null===e){var l=t.stateNode,i=t.memoizedProps;l.props=i;var u=l.context,s=n.contextType;"object"==typeof s&&null!==s?s=zs(s):s=Qu(t,s=Ku(n)?qu:Vu.current);var c=n.getDerivedStateFromProps,f="function"==typeof c||"function"==typeof l.getSnapshotBeforeUpdate;f||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(i!==r||u!==s)&&Xs(t,l,r,s),Bs=!1;var d=t.memoizedState;l.state=d,Vs(t,r,l,a),u=t.memoizedState,i!==r||d!==u||Hu.current||Bs?("function"==typeof c&&(Qs(t,n,c,r),u=t.memoizedState),(i=Bs||$s(t,n,i,r,d,u,s))?(f||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||("function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"==typeof l.componentDidMount&&(t.flags|=4)):("function"==typeof l.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=s,r=i):("function"==typeof l.componentDidMount&&(t.flags|=4),r=!1)}else{l=t.stateNode,As(e,t),i=t.memoizedProps,s=t.type===t.elementType?i:_s(t.type,i),l.props=s,f=t.pendingProps,d=l.context,"object"==typeof(u=n.contextType)&&null!==u?u=zs(u):u=Qu(t,u=Ku(n)?qu:Vu.current);var p=n.getDerivedStateFromProps;(c="function"==typeof p||"function"==typeof l.getSnapshotBeforeUpdate)||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(i!==f||d!==u)&&Xs(t,l,r,u),Bs=!1,d=t.memoizedState,l.state=d,Vs(t,r,l,a);var h=t.memoizedState;i!==f||d!==h||Hu.current||Bs?("function"==typeof p&&(Qs(t,n,p,r),h=t.memoizedState),(s=Bs||$s(t,n,s,r,d,h,u))?(c||"function"!=typeof l.UNSAFE_componentWillUpdate&&"function"!=typeof l.componentWillUpdate||("function"==typeof l.componentWillUpdate&&l.componentWillUpdate(r,h,u),"function"==typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(r,h,u)),"function"==typeof l.componentDidUpdate&&(t.flags|=4),"function"==typeof l.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof l.componentDidUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),l.props=r,l.state=h,l.context=u,r=s):("function"!=typeof l.componentDidUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Ef(e,t,n,r,o,a)}function Ef(e,t,n,r,a,o){yf(e,t);var l=0!=(64&t.flags);if(!r&&!l)return a&&Ju(t,n,!1),Ff(e,t,o);r=t.stateNode,df.current=t;var i=l&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&l?(t.child=nc(t,e.child,null,o),t.child=nc(t,null,i,o)):hf(e,t,i,o),t.memoizedState=r.state,a&&Ju(t,n,!0),t.child}function xf(e){var t=e.stateNode;t.pendingContext?Yu(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Yu(0,t.context,!1),sc(e,t.containerInfo)}var Sf,Cf,Tf,_f={dehydrated:null,retryLane:0};function Of(e,t,n){var r,a=t.pendingProps,o=pc.current,l=!1;return(r=0!=(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!=(2&o)),r?(l=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),Wu(pc,1&o),null===e?(void 0!==a.fallback&&wc(t),e=a.children,o=a.fallback,l?(e=Pf(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=_f,e):"number"==typeof a.unstable_expectedLoadTime?(e=Pf(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=_f,t.lanes=33554432,e):((n=Cp({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,l?(a=Nf(e,t,a.children,a.fallback,n),l=t.child,o=e.child.memoizedState,l.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},l.childLanes=e.childLanes&~n,t.memoizedState=_f,a):(n=Df(e,t,a.children,n),t.memoizedState=null,n))}function Pf(e,t,n,r){var a=e.mode,o=e.child;return t={mode:"hidden",children:t},0==(2&a)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Cp(t,a,0,null),n=Sp(n,a,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Df(e,t,n,r){var a=e.child;return e=a.sibling,n=Ep(a,{mode:"visible",children:n}),0==(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Nf(e,t,n,r,a){var o=t.mode,l=e.child;e=l.sibling;var i={mode:"hidden",children:n};return 0==(2&o)&&t.child!==l?((n=t.child).childLanes=0,n.pendingProps=i,null!==(l=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=l,l.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Ep(l,i),null!==e?r=Ep(e,r):(r=Sp(r,o,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Mf(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ls(e.return,t)}function Rf(e,t,n,r,a,o){var l=e.memoizedState;null===l?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:o}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a,l.lastEffect=o)}function Lf(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(hf(e,t,r.children,n),0!=(2&(r=pc.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Mf(e,n);else if(19===e.tag)Mf(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Wu(pc,r),0==(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===hc(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Rf(t,!1,a,n,o,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===hc(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Rf(t,!0,n,null,o,t.lastEffect);break;case"together":Rf(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ff(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),md|=t.lanes,0!=(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(zr(153));if(null!==t.child){for(n=Ep(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ep(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function zf(e,t){if(!mc)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Bf(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return Ku(t.type)&&$u(),null;case 3:return cc(),ju(Hu),ju(Vu),Cc(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Ec(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:dc(t);var a=uc(ic.current);if(n=t.type,null!==e&&null!=t.stateNode)Cf(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(zr(166));return null}if(e=uc(oc.current),Ec(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Ou]=t,r[Pu]=o,n){case"dialog":lu("cancel",r),lu("close",r);break;case"iframe":case"object":case"embed":lu("load",r);break;case"video":case"audio":for(e=0;e<nu.length;e++)lu(nu[e],r);break;case"source":lu("error",r);break;case"img":case"image":case"link":lu("error",r),lu("load",r);break;case"details":lu("toggle",r);break;case"input":Da(r,o),lu("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},lu("invalid",r);break;case"textarea":Ia(r,o),lu("invalid",r)}for(var l in eo(n,o),e=null,o)o.hasOwnProperty(l)&&(a=o[l],"children"===l?"string"==typeof a?r.textContent!==a&&(e=["children",a]):"number"==typeof a&&r.textContent!==""+a&&(e=["children",""+a]):Ir.hasOwnProperty(l)&&null!=a&&"onScroll"===l&&lu("scroll",r));switch(n){case"input":Ta(r),Ra(r,o,!0);break;case"textarea":Ta(r),ja(r);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(r.onclick=gu)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(l=9===a.nodeType?a:a.ownerDocument,e===Wa&&(e=Va(n)),e===Wa?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Ou]=t,e[Pu]=r,Sf(e,t),t.stateNode=e,l=to(n,r),n){case"dialog":lu("cancel",e),lu("close",e),a=r;break;case"iframe":case"object":case"embed":lu("load",e),a=r;break;case"video":case"audio":for(a=0;a<nu.length;a++)lu(nu[a],e);a=r;break;case"source":lu("error",e),a=r;break;case"img":case"image":case"link":lu("error",e),lu("load",e),a=r;break;case"details":lu("toggle",e),a=r;break;case"input":Da(e,r),a=Pa(e,r),lu("invalid",e);break;case"option":a=Fa(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Mr({},r,{value:void 0}),lu("invalid",e);break;case"textarea":Ia(e,r),a=Ba(e,r),lu("invalid",e);break;default:a=r}eo(n,a);var i=a;for(o in i)if(i.hasOwnProperty(o)){var u=i[o];"style"===o?Ja(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&Ka(e,u):"children"===o?"string"==typeof u?("textarea"!==n||""!==u)&&$a(e,u):"number"==typeof u&&$a(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(Ir.hasOwnProperty(o)?null!=u&&"onScroll"===o&&lu("scroll",e):null!=u&&Xr(e,o,u,l))}switch(n){case"input":Ta(e),Ra(e,r,!1);break;case"textarea":Ta(e),ja(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Sa(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?za(e,!!r.multiple,o,!1):null!=r.defaultValue&&za(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=gu)}yu(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Tf(0,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(zr(166));n=uc(ic.current),uc(oc.current),Ec(t)?(r=t.stateNode,n=t.memoizedProps,r[Ou]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ou]=t,t.stateNode=r)}return null;case 13:return ju(pc),r=t.memoizedState,0!=(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Ec(t):n=null!==e.memoizedState,r&&!n&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&pc.current)?0===hd&&(hd=3):(0!==hd&&3!==hd||(hd=4),null===sd||0==(134217727&md)&&0==(134217727&bd)||$d(sd,fd))),(r||n)&&(t.flags|=4),null);case 4:return cc(),null===e&&uu(t.stateNode.containerInfo),null;case 10:return Rs(t),null;case 19:if(ju(pc),null===(r=t.memoizedState))return null;if(o=0!=(64&t.flags),null===(l=r.rendering))if(o)zf(r,!1);else{if(0!==hd||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(l=hc(e))){for(t.flags|=64,zf(r,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Wu(pc,1&pc.current|2),t.child}e=e.sibling}null!==r.tail&&ys()>Ed&&(t.flags|=64,o=!0,zf(r,!1),t.lanes=33554432)}else{if(!o)if(null!==(e=hc(l))){if(t.flags|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),zf(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!mc)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*ys()-r.renderingStartTime>Ed&&1073741824!==n&&(t.flags|=64,o=!0,zf(r,!1),t.lanes=33554432);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=ys(),n.sibling=null,t=pc.current,Wu(pc,o?1&t|2:1&t),n):null;case 23:case 24:return Zd(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(zr(156,t.tag))}function If(e){switch(e.tag){case 1:Ku(e.type)&&$u();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(cc(),ju(Hu),ju(Vu),Cc(),0!=(64&(t=e.flags)))throw Error(zr(285));return e.flags=-4097&t|64,e;case 5:return dc(e),null;case 13:return ju(pc),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ju(pc),null;case 4:return cc(),null;case 10:return Rs(e),null;case 23:case 24:return Zd(),null;default:return null}}function Af(e,t){try{var n="",r=t;do{n+=Ea(r),r=r.return}while(r);var a=n}catch(e){a="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:a}}function jf(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Sf=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Cf=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,uc(oc.current);var o,l=null;switch(n){case"input":a=Pa(e,a),r=Pa(e,r),l=[];break;case"option":a=Fa(e,a),r=Fa(e,r),l=[];break;case"select":a=Mr({},a,{value:void 0}),r=Mr({},r,{value:void 0}),l=[];break;case"textarea":a=Ba(e,a),r=Ba(e,r),l=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(e.onclick=gu)}for(s in eo(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s){var i=a[s];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(Ir.hasOwnProperty(s)?l||(l=[]):(l=l||[]).push(s,null));for(s in r){var u=r[s];if(i=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&u!==i&&(null!=u||null!=i))if("style"===s)if(i){for(o in i)!i.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&i[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(l||(l=[]),l.push(s,n)),n=u;else"dangerouslySetInnerHTML"===s?(u=u?u.__html:void 0,i=i?i.__html:void 0,null!=u&&i!==u&&(l=l||[]).push(s,u)):"children"===s?"string"!=typeof u&&"number"!=typeof u||(l=l||[]).push(s,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(Ir.hasOwnProperty(s)?(null!=u&&"onScroll"===s&&lu("scroll",e),l||i===u||(l=[])):"object"==typeof u&&null!==u&&u.$$typeof===fa?u.toString():(l=l||[]).push(s,u))}n&&(l=l||[]).push("style",n);var s=l;(t.updateQueue=s)&&(t.flags|=4)}},Tf=function(e,t,n,r){n!==r&&(t.flags|=4)};var Wf="function"==typeof WeakMap?WeakMap:Map;function Uf(e,t,n){(n=js(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Td||(Td=!0,_d=r),jf(0,t)},n}function Vf(e,t,n){(n=js(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var a=t.value;n.payload=function(){return jf(0,t),r(a)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Od?Od=new Set([this]):Od.add(this),jf(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var Hf="function"==typeof WeakSet?WeakSet:Set;function qf(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){gp(e,t)}else t.current=null}function Qf(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:_s(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&xu(t.stateNode.containerInfo))}throw Error(zr(163))}function Kf(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3==(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!=(4&(a=a.tag))&&0!=(1&a)&&(pp(n,e),dp(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:_s(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&Hs(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}Hs(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&yu(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Zo(n)))))}throw Error(zr(163))}function $f(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=null!=a&&a.hasOwnProperty("display")?a.display:null,r.style.display=Ga("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Yf(e,t){if(es&&"function"==typeof es.onCommitFiberUnmount)try{es.onCommitFiberUnmount(Zu,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!=(4&r))pp(t,n);else{r=t;try{a()}catch(e){gp(r,e)}}n=n.next}while(n!==e)}break;case 1:if(qf(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){gp(t,e)}break;case 5:qf(t);break;case 4:td(e,t)}}function Xf(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Gf(e){return 5===e.tag||3===e.tag||4===e.tag}function Jf(e){e:{for(var t=e.return;null!==t;){if(Gf(t))break e;t=t.return}throw Error(zr(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(zr(161))}16&n.flags&&($a(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Gf(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Zf(e,n,t):ed(e,n,t)}function Zf(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=gu));else if(4!==r&&null!==(e=e.child))for(Zf(e,t,n),e=e.sibling;null!==e;)Zf(e,t,n),e=e.sibling}function ed(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ed(e,t,n),e=e.sibling;null!==e;)ed(e,t,n),e=e.sibling}function td(e,t){for(var n,r,a=t,o=!1;;){if(!o){o=a.return;e:for(;;){if(null===o)throw Error(zr(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===a.tag||6===a.tag){e:for(var l=e,i=a,u=i;;)if(Yf(l,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===i)break e;for(;null===u.sibling;){if(null===u.return||u.return===i)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(l=n,i=a.stateNode,8===l.nodeType?l.parentNode.removeChild(i):l.removeChild(i)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(Yf(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function nd(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3==(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Pu]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Na(n,r),to(e,a),t=to(e,r),a=0;a<o.length;a+=2){var l=o[a],i=o[a+1];"style"===l?Ja(n,i):"dangerouslySetInnerHTML"===l?Ka(n,i):"children"===l?$a(n,i):Xr(n,l,i,t)}switch(e){case"input":Ma(n,r);break;case"textarea":Aa(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?za(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?za(n,!!r.multiple,r.defaultValue,!0):za(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(zr(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,Zo(n.containerInfo)));case 13:return null!==t.memoizedState&&(kd=ys(),$f(t.child,!0)),void rd(t);case 19:return void rd(t);case 23:case 24:return void $f(t,null!==t.memoizedState)}throw Error(zr(163))}function rd(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Hf),t.forEach((function(t){var r=bp.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ad(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var od=Math.ceil,ld=Gr.ReactCurrentDispatcher,id=Gr.ReactCurrentOwner,ud=0,sd=null,cd=null,fd=0,dd=0,pd=Au(0),hd=0,vd=null,gd=0,md=0,bd=0,yd=0,wd=null,kd=0,Ed=1/0;function xd(){Ed=ys()+500}var Sd,Cd=null,Td=!1,_d=null,Od=null,Pd=!1,Dd=null,Nd=90,Md=[],Rd=[],Ld=null,Fd=0,zd=null,Bd=-1,Id=0,Ad=0,jd=null,Wd=!1;function Ud(){return 0!=(48&ud)?ys():-1!==Bd?Bd:Bd=ys()}function Vd(e){if(0==(2&(e=e.mode)))return 1;if(0==(4&e))return 99===ws()?1:2;if(0===Id&&(Id=gd),0!==Ts.transition){0!==Ad&&(Ad=null!==wd?wd.pendingLanes:0),e=Id;var t=4186112&~Ad;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=ws(),0!=(4&ud)&&98===e?e=ml(12,Id):e=ml(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Id),e}function Hd(e,t,n){if(50<Fd)throw Fd=0,zd=null,Error(zr(185));if(null===(e=qd(e,t)))return null;wl(e,t,n),e===sd&&(bd|=t,4===hd&&$d(e,fd));var r=ws();1===t?0!=(8&ud)&&0==(48&ud)?Yd(e):(Qd(e,n),0===ud&&(xd(),Ss())):(0==(4&ud)||98!==r&&99!==r||(null===Ld?Ld=new Set([e]):Ld.add(e)),Qd(e,n)),wd=e}function qd(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Qd(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-kl(l),u=1<<i,s=o[i];if(-1===s){if(0==(u&r)||0!=(u&a)){s=t,hl(u);var c=pl;o[i]=10<=c?s+250:6<=c?s+5e3:-1}}else s<=t&&(e.expiredLanes|=u);l&=~u}if(r=vl(e,e===sd?fd:0),t=pl,0===r)null!==n&&(n!==ps&&rs(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==ps&&rs(n)}15===t?(n=Yd.bind(null,e),null===vs?(vs=[n],gs=ns(us,Cs)):vs.push(n),n=ps):14===t?n=xs(99,Yd.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(zr(358,e))}}(t),n=xs(n,Kd.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function Kd(e){if(Bd=-1,Ad=Id=0,0!=(48&ud))throw Error(zr(327));var t=e.callbackNode;if(fp()&&e.callbackNode!==t)return null;var n=vl(e,e===sd?fd:0);if(0===n)return null;var r=n,a=ud;ud|=16;var o=np();for(sd===e&&fd===r||(xd(),ep(e,r));;)try{op();break}catch(t){tp(e,t)}if(Ms(),ld.current=o,ud=a,null!==cd?r=0:(sd=null,fd=0,r=hd),0!=(gd&bd))ep(e,0);else if(0!==r){if(2===r&&(ud|=64,e.hydrate&&(e.hydrate=!1,xu(e.containerInfo)),0!==(n=gl(e))&&(r=rp(e,n))),1===r)throw t=vd,ep(e,0),$d(e,n),Qd(e,ys()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(zr(345));case 2:case 5:up(e);break;case 3:if($d(e,n),(62914560&n)===n&&10<(r=kd+500-ys())){if(0!==vl(e,0))break;if(((a=e.suspendedLanes)&n)!==n){Ud(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ku(up.bind(null,e),r);break}up(e);break;case 4:if($d(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var l=31-kl(n);o=1<<l,(l=r[l])>a&&(a=l),n&=~o}if(n=a,10<(n=(120>(n=ys()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*od(n/1960))-n)){e.timeoutHandle=ku(up.bind(null,e),n);break}up(e);break;default:throw Error(zr(329))}}return Qd(e,ys()),e.callbackNode===t?Kd.bind(null,e):null}function $d(e,t){for(t&=~yd,t&=~bd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-kl(t),r=1<<n;e[n]=-1,t&=~r}}function Yd(e){if(0!=(48&ud))throw Error(zr(327));if(fp(),e===sd&&0!=(e.expiredLanes&fd)){var t=fd,n=rp(e,t);0!=(gd&bd)&&(n=rp(e,t=vl(e,t)))}else n=rp(e,t=vl(e,0));if(0!==e.tag&&2===n&&(ud|=64,e.hydrate&&(e.hydrate=!1,xu(e.containerInfo)),0!==(t=gl(e))&&(n=rp(e,t))),1===n)throw n=vd,ep(e,0),$d(e,t),Qd(e,ys()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,up(e),Qd(e,ys()),null}function Xd(e,t){var n=ud;ud|=1;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}}function Gd(e,t){var n=ud;ud&=-2,ud|=8;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}}function Jd(e,t){Wu(pd,dd),dd|=t,gd|=t}function Zd(){dd=pd.current,ju(pd)}function ep(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Eu(n)),null!==cd)for(n=cd.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&$u();break;case 3:cc(),ju(Hu),ju(Vu),Cc();break;case 5:dc(r);break;case 4:cc();break;case 13:case 19:ju(pc);break;case 10:Rs(r);break;case 23:case 24:Zd()}n=n.return}sd=e,cd=Ep(e.current,null),fd=dd=gd=t,hd=0,vd=null,yd=bd=md=0}function tp(e,t){for(;;){var n=cd;try{if(Ms(),Tc.current=uf,Mc){for(var r=Pc.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}Mc=!1}if(Oc=0,Nc=Dc=Pc=null,Rc=!1,id.current=null,null===n||null===n.return){hd=1,vd=t,cd=null;break}e:{var o=e,l=n.return,i=n,u=t;if(t=fd,i.flags|=2048,i.firstEffect=i.lastEffect=null,null!==u&&"object"==typeof u&&"function"==typeof u.then){var s=u;if(0==(2&i.mode)){var c=i.alternate;c?(i.updateQueue=c.updateQueue,i.memoizedState=c.memoizedState,i.lanes=c.lanes):(i.updateQueue=null,i.memoizedState=null)}var f=0!=(1&pc.current),d=l;do{var p;if(p=13===d.tag){var h=d.memoizedState;if(null!==h)p=null!==h.dehydrated;else{var v=d.memoizedProps;p=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(p){var g=d.updateQueue;if(null===g){var m=new Set;m.add(s),d.updateQueue=m}else g.add(s);if(0==(2&d.mode)){if(d.flags|=64,i.flags|=16384,i.flags&=-2981,1===i.tag)if(null===i.alternate)i.tag=17;else{var b=js(-1,1);b.tag=2,Ws(i,b)}i.lanes|=1;break e}u=void 0,i=t;var y=o.pingCache;if(null===y?(y=o.pingCache=new Wf,u=new Set,y.set(s,u)):void 0===(u=y.get(s))&&(u=new Set,y.set(s,u)),!u.has(i)){u.add(i);var w=mp.bind(null,o,s,i);s.then(w,w)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((xa(i.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==hd&&(hd=2),u=Af(u,i),d=l;do{switch(d.tag){case 3:o=u,d.flags|=4096,t&=-t,d.lanes|=t,Us(d,Uf(0,o,t));break e;case 1:o=u;var k=d.type,E=d.stateNode;if(0==(64&d.flags)&&("function"==typeof k.getDerivedStateFromError||null!==E&&"function"==typeof E.componentDidCatch&&(null===Od||!Od.has(E)))){d.flags|=4096,t&=-t,d.lanes|=t,Us(d,Vf(d,o,t));break e}}d=d.return}while(null!==d)}ip(n)}catch(e){t=e,cd===n&&null!==n&&(cd=n=n.return);continue}break}}function np(){var e=ld.current;return ld.current=uf,null===e?uf:e}function rp(e,t){var n=ud;ud|=16;var r=np();for(sd===e&&fd===t||ep(e,t);;)try{ap();break}catch(t){tp(e,t)}if(Ms(),ud=n,ld.current=r,null!==cd)throw Error(zr(261));return sd=null,fd=0,hd}function ap(){for(;null!==cd;)lp(cd)}function op(){for(;null!==cd&&!as();)lp(cd)}function lp(e){var t=Sd(e.alternate,e,dd);e.memoizedProps=e.pendingProps,null===t?ip(e):cd=t,id.current=null}function ip(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(n=Bf(n,t,dd)))return void(cd=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!=(1073741824&dd)||0==(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=If(t)))return n.flags&=2047,void(cd=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(cd=t);cd=t=e}while(null!==t);0===hd&&(hd=5)}function up(e){var t=ws();return Es(99,sp.bind(null,e,t)),null}function sp(e,t){do{fp()}while(null!==Dd);if(0!=(48&ud))throw Error(zr(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(zr(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,o=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var l=e.eventTimes,i=e.expirationTimes;0<o;){var u=31-kl(o),s=1<<u;a[u]=0,l[u]=-1,i[u]=-1,o&=~s}if(null!==Ld&&0==(24&r)&&Ld.has(e)&&Ld.delete(e),e===sd&&(cd=sd=null,fd=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=ud,ud|=32,id.current=null,mu=Tl,Ki(l=Qi())){if("selectionStart"in l)i={start:l.selectionStart,end:l.selectionEnd};else e:if(i=(i=l.ownerDocument)&&i.defaultView||window,(s=i.getSelection&&i.getSelection())&&0!==s.rangeCount){i=s.anchorNode,o=s.anchorOffset,u=s.focusNode,s=s.focusOffset;try{i.nodeType,u.nodeType}catch(e){i=null;break e}var c=0,f=-1,d=-1,p=0,h=0,v=l,g=null;t:for(;;){for(var m;v!==i||0!==o&&3!==v.nodeType||(f=c+o),v!==u||0!==s&&3!==v.nodeType||(d=c+s),3===v.nodeType&&(c+=v.nodeValue.length),null!==(m=v.firstChild);)g=v,v=m;for(;;){if(v===l)break t;if(g===i&&++p===o&&(f=c),g===u&&++h===s&&(d=c),null!==(m=v.nextSibling))break;g=(v=g).parentNode}v=m}i=-1===f||-1===d?null:{start:f,end:d}}else i=null;i=i||{start:0,end:0}}else i=null;bu={focusedElem:l,selectionRange:i},Tl=!1,jd=null,Wd=!1,Cd=r;do{try{cp()}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);jd=null,Cd=r;do{try{for(l=e;null!==Cd;){var b=Cd.flags;if(16&b&&$a(Cd.stateNode,""),128&b){var y=Cd.alternate;if(null!==y){var w=y.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&b){case 2:Jf(Cd),Cd.flags&=-3;break;case 6:Jf(Cd),Cd.flags&=-3,nd(Cd.alternate,Cd);break;case 1024:Cd.flags&=-1025;break;case 1028:Cd.flags&=-1025,nd(Cd.alternate,Cd);break;case 4:nd(Cd.alternate,Cd);break;case 8:td(l,i=Cd);var k=i.alternate;Xf(i),null!==k&&Xf(k)}Cd=Cd.nextEffect}}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);if(w=bu,y=Qi(),b=w.focusedElem,l=w.selectionRange,y!==b&&b&&b.ownerDocument&&qi(b.ownerDocument.documentElement,b)){null!==l&&Ki(b)&&(y=l.start,void 0===(w=l.end)&&(w=y),"selectionStart"in b?(b.selectionStart=y,b.selectionEnd=Math.min(w,b.value.length)):(w=(y=b.ownerDocument||document)&&y.defaultView||window).getSelection&&(w=w.getSelection(),i=b.textContent.length,k=Math.min(l.start,i),l=void 0===l.end?k:Math.min(l.end,i),!w.extend&&k>l&&(i=l,l=k,k=i),i=Hi(b,k),o=Hi(b,l),i&&o&&(1!==w.rangeCount||w.anchorNode!==i.node||w.anchorOffset!==i.offset||w.focusNode!==o.node||w.focusOffset!==o.offset)&&((y=y.createRange()).setStart(i.node,i.offset),w.removeAllRanges(),k>l?(w.addRange(y),w.extend(o.node,o.offset)):(y.setEnd(o.node,o.offset),w.addRange(y))))),y=[];for(w=b;w=w.parentNode;)1===w.nodeType&&y.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof b.focus&&b.focus(),b=0;b<y.length;b++)(w=y[b]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Tl=!!mu,bu=mu=null,e.current=n,Cd=r;do{try{for(b=e;null!==Cd;){var E=Cd.flags;if(36&E&&Kf(b,Cd.alternate,Cd),128&E){y=void 0;var x=Cd.ref;if(null!==x){var S=Cd.stateNode;Cd.tag,y=S,"function"==typeof x?x(y):x.current=y}}Cd=Cd.nextEffect}}catch(e){if(null===Cd)throw Error(zr(330));gp(Cd,e),Cd=Cd.nextEffect}}while(null!==Cd);Cd=null,hs(),ud=a}else e.current=n;if(Pd)Pd=!1,Dd=e,Nd=t;else for(Cd=r;null!==Cd;)t=Cd.nextEffect,Cd.nextEffect=null,8&Cd.flags&&((E=Cd).sibling=null,E.stateNode=null),Cd=t;if(0===(r=e.pendingLanes)&&(Od=null),1===r?e===zd?Fd++:(Fd=0,zd=e):Fd=0,n=n.stateNode,es&&"function"==typeof es.onCommitFiberRoot)try{es.onCommitFiberRoot(Zu,n,void 0,64==(64&n.current.flags))}catch(e){}if(Qd(e,ys()),Td)throw Td=!1,e=_d,_d=null,e;return 0!=(8&ud)||Ss(),null}function cp(){for(;null!==Cd;){var e=Cd.alternate;Wd||null===jd||(0!=(8&Cd.flags)?No(Cd,jd)&&(Wd=!0):13===Cd.tag&&ad(e,Cd)&&No(Cd,jd)&&(Wd=!0));var t=Cd.flags;0!=(256&t)&&Qf(e,Cd),0==(512&t)||Pd||(Pd=!0,xs(97,(function(){return fp(),null}))),Cd=Cd.nextEffect}}function fp(){if(90!==Nd){var e=97<Nd?97:Nd;return Nd=90,Es(e,hp)}return!1}function dp(e,t){Md.push(t,e),Pd||(Pd=!0,xs(97,(function(){return fp(),null})))}function pp(e,t){Rd.push(t,e),Pd||(Pd=!0,xs(97,(function(){return fp(),null})))}function hp(){if(null===Dd)return!1;var e=Dd;if(Dd=null,0!=(48&ud))throw Error(zr(331));var t=ud;ud|=32;var n=Rd;Rd=[];for(var r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],l=a.destroy;if(a.destroy=void 0,"function"==typeof l)try{l()}catch(e){if(null===o)throw Error(zr(330));gp(o,e)}}for(n=Md,Md=[],r=0;r<n.length;r+=2){a=n[r],o=n[r+1];try{var i=a.create;a.destroy=i()}catch(e){if(null===o)throw Error(zr(330));gp(o,e)}}for(i=e.current.firstEffect;null!==i;)e=i.nextEffect,i.nextEffect=null,8&i.flags&&(i.sibling=null,i.stateNode=null),i=e;return ud=t,Ss(),!0}function vp(e,t,n){Ws(e,t=Uf(0,t=Af(n,t),1)),t=Ud(),null!==(e=qd(e,1))&&(wl(e,1,t),Qd(e,t))}function gp(e,t){if(3===e.tag)vp(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){vp(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Od||!Od.has(r))){var a=Vf(n,e=Af(t,e),1);if(Ws(n,a),a=Ud(),null!==(n=qd(n,1)))wl(n,1,a),Qd(n,a);else if("function"==typeof r.componentDidCatch&&(null===Od||!Od.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function mp(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ud(),e.pingedLanes|=e.suspendedLanes&n,sd===e&&(fd&n)===n&&(4===hd||3===hd&&(62914560&fd)===fd&&500>ys()-kd?ep(e,0):yd|=n),Qd(e,t)}function bp(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===ws()?1:2:(0===Id&&(Id=gd),0===(t=bl(62914560&~Id))&&(t=4194304))),n=Ud(),null!==(e=qd(e,t))&&(wl(e,t,n),Qd(e,n))}function yp(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function wp(e,t,n,r){return new yp(e,t,n,r)}function kp(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ep(e,t){var n=e.alternate;return null===n?((n=wp(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xp(e,t,n,r,a,o){var l=2;if(r=e,"function"==typeof e)kp(e)&&(l=1);else if("string"==typeof e)l=5;else e:switch(e){case ea:return Sp(n.children,a,o,t);case da:l=8,a|=16;break;case ta:l=8,a|=1;break;case na:return(e=wp(12,n,t,8|a)).elementType=na,e.type=na,e.lanes=o,e;case la:return(e=wp(13,n,t,a)).type=la,e.elementType=la,e.lanes=o,e;case ia:return(e=wp(19,n,t,a)).elementType=ia,e.lanes=o,e;case pa:return Cp(n,a,o,t);case ha:return(e=wp(24,n,t,a)).elementType=ha,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case ra:l=10;break e;case aa:l=9;break e;case oa:l=11;break e;case ua:l=14;break e;case sa:l=16,r=null;break e;case ca:l=22;break e}throw Error(zr(130,null==e?e:typeof e,""))}return(t=wp(l,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Sp(e,t,n,r){return(e=wp(7,e,r,t)).lanes=n,e}function Cp(e,t,n,r){return(e=wp(23,e,r,t)).elementType=pa,e.lanes=n,e}function Tp(e,t,n){return(e=wp(6,e,null,t)).lanes=n,e}function _p(e,t,n){return(t=wp(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Op(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=yl(0),this.expirationTimes=yl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.mutableSourceEagerHydrationData=null}function Pp(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Zr,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Dp(e,t,n,r){var a=t.current,o=Ud(),l=Vd(a);e:if(n){t:{if(_o(n=n._reactInternals)!==n||1!==n.tag)throw Error(zr(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Ku(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(null!==i);throw Error(zr(171))}if(1===n.tag){var u=n.type;if(Ku(u)){n=Xu(n,u,i);break e}}n=i}else n=Uu;return null===t.context?t.context=n:t.pendingContext=n,(t=js(o,l)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),Ws(a,t),Hd(a,l,o),l}function Np(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Mp(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Rp(e,t){Mp(e,t),(e=e.alternate)&&Mp(e,t)}function Lp(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Op(e,t,null!=n&&!0===n.hydrate),t=wp(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,Is(t),e[Du]=n.current,uu(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function Fp(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function zp(e,t,n,r,a){var o=n._reactRootContainer;if(o){var l=o._internalRoot;if("function"==typeof a){var i=a;a=function(){var e=Np(l);i.call(e)}}Dp(t,l,e,a)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Lp(e,0,t?{hydrate:!0}:void 0)}(n,r),l=o._internalRoot,"function"==typeof a){var u=a;a=function(){var e=Np(l);u.call(e)}}Gd((function(){Dp(t,l,e,a)}))}return Np(l)}function Bp(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Fp(t))throw Error(zr(200));return Pp(e,t,null,n)}Sd=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||Hu.current)pf=!0;else{if(0==(n&r)){switch(pf=!1,t.tag){case 3:xf(t),xc();break;case 5:fc(t);break;case 1:Ku(t.type)&&Gu(t);break;case 4:sc(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;Wu(Os,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!=(n&t.child.childLanes)?Of(e,t,n):(Wu(pc,1&pc.current),null!==(t=Ff(e,t,n))?t.sibling:null);Wu(pc,1&pc.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(64&e.flags)){if(r)return Lf(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Wu(pc,pc.current),r)break;return null;case 23:case 24:return t.lanes=0,bf(e,t,n)}return Ff(e,t,n)}pf=0!=(16384&e.flags)}else pf=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=Qu(t,Vu.current),Fs(t,n),a=zc(null,t,r,e,a,n),t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ku(r)){var o=!0;Gu(t)}else o=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Is(t);var l=r.getDerivedStateFromProps;"function"==typeof l&&Qs(t,r,l,e),a.updater=Ks,t.stateNode=a,a._reactInternals=t,Gs(t,r,e,n),t=Ef(null,t,r,!0,o,n)}else t.tag=0,hf(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(o=a._init)(a._payload),t.type=a,o=t.tag=function(e){if("function"==typeof e)return kp(e)?1:0;if(null!=e){if((e=e.$$typeof)===oa)return 11;if(e===ua)return 14}return 2}(a),e=_s(a,e),o){case 0:t=wf(null,t,a,e,n);break e;case 1:t=kf(null,t,a,e,n);break e;case 11:t=vf(null,t,a,e,n);break e;case 14:t=gf(null,t,a,_s(a.type,e),r,n);break e}throw Error(zr(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,wf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 1:return r=t.type,a=t.pendingProps,kf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 3:if(xf(t),r=t.updateQueue,null===e||null===r)throw Error(zr(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,As(e,t),Vs(t,r,null,n),(r=t.memoizedState.element)===a)xc(),t=Ff(e,t,n);else{if((o=(a=t.stateNode).hydrate)&&(gc=Su(t.stateNode.containerInfo.firstChild),vc=t,o=mc=!0),o){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(o=e[a])._workInProgressVersionPrimary=e[a+1],Sc.push(o);for(n=rc(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else hf(e,t,r,n),xc();t=t.child}return t;case 5:return fc(t),null===e&&wc(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,l=a.children,wu(r,a)?l=null:null!==o&&wu(r,o)&&(t.flags|=16),yf(e,t),hf(e,t,l,n),t.child;case 6:return null===e&&wc(t),null;case 13:return Of(e,t,n);case 4:return sc(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=nc(t,null,r,n):hf(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,vf(e,t,r,a=t.elementType===r?a:_s(r,a),n);case 7:return hf(e,t,t.pendingProps,n),t.child;case 8:case 12:return hf(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value;var i=t.type._context;if(Wu(Os,i._currentValue),i._currentValue=o,null!==l)if(i=l.value,0===(o=ji(i,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(i,o):1073741823))){if(l.children===a.children&&!Hu.current){t=Ff(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var u=i.dependencies;if(null!==u){l=i.child;for(var s=u.firstContext;null!==s;){if(s.context===r&&0!=(s.observedBits&o)){1===i.tag&&((s=js(-1,n&-n)).tag=2,Ws(i,s)),i.lanes|=n,null!==(s=i.alternate)&&(s.lanes|=n),Ls(i.return,n),u.lanes|=n;break}s=s.next}}else l=10===i.tag&&i.type===t.type?null:i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===t){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}hf(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(o=t.pendingProps).children,Fs(t,n),r=r(a=zs(a,o.unstable_observedBits)),t.flags|=1,hf(e,t,r,n),t.child;case 14:return o=_s(a=t.type,t.pendingProps),gf(e,t,a,o=_s(a.type,o),r,n);case 15:return mf(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:_s(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Ku(r)?(e=!0,Gu(t)):e=!1,Fs(t,n),Ys(t,r,a),Gs(t,r,a,n),Ef(null,t,r,!0,e,n);case 19:return Lf(e,t,n);case 23:case 24:return bf(e,t,n)}throw Error(zr(156,t.tag))},Lp.prototype.render=function(e){Dp(e,this._internalRoot,null,null)},Lp.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Dp(null,e,null,(function(){t[Du]=null}))},Mo=function(e){13===e.tag&&(Hd(e,4,Ud()),Rp(e,4))},Ro=function(e){13===e.tag&&(Hd(e,67108864,Ud()),Rp(e,67108864))},Lo=function(e){if(13===e.tag){var t=Ud(),n=Vd(e);Hd(e,n,t),Rp(e,n)}},Fo=function(e,t){return t()},ro=function(e,t,n){switch(t){case"input":if(Ma(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Fu(r);if(!a)throw Error(zr(90));_a(r),Ma(r,a)}}}break;case"textarea":Aa(e,n);break;case"select":null!=(t=n.value)&&za(e,!!n.multiple,t,!1)}},so=Xd,co=function(e,t,n,r,a){var o=ud;ud|=4;try{return Es(98,e.bind(null,t,n,r,a))}finally{0===(ud=o)&&(xd(),Ss())}},fo=function(){0==(49&ud)&&(function(){if(null!==Ld){var e=Ld;Ld=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Qd(e,ys())}))}Ss()}(),fp())},po=function(e,t){var n=ud;ud|=2;try{return e(t)}finally{0===(ud=n)&&(xd(),Ss())}};var Ip={Events:[Ru,Lu,Fu,io,uo,fp,{current:!1}]},Ap={findFiberByHostInstance:Mu,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},jp={bundleType:Ap.bundleType,version:Ap.version,rendererPackageName:Ap.rendererPackageName,rendererConfig:Ap.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Do(e))?null:e.stateNode},findFiberByHostInstance:Ap.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{Zu=Wp.inject(jp),es=Wp}catch(Qa){}}var Up={__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Ip,createPortal:Bp,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(zr(188));throw Error(zr(268,Object.keys(e)))}return e=null===(e=Do(t))?null:e.stateNode},flushSync:function(e,t){var n=ud;if(0!=(48&n))return e(t);ud|=1;try{if(e)return Es(99,e.bind(null,t))}finally{ud=n,Ss()}},hydrate:function(e,t,n){if(!Fp(t))throw Error(zr(200));return zp(null,e,t,!0,n)},render:function(e,t,n){if(!Fp(t))throw Error(zr(200));return zp(null,e,t,!1,n)},unmountComponentAtNode:function(e){if(!Fp(e))throw Error(zr(40));return!!e._reactRootContainer&&(Gd((function(){zp(null,null,e,!1,(function(){e._reactRootContainer=null,e[Du]=null}))})),!0)},unstable_batchedUpdates:Xd,unstable_createPortal:function(e,t){return Bp(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){if(!Fp(n))throw Error(zr(200));if(null==e||void 0===e._reactInternals)throw Error(zr(38));return zp(e,t,n,!1,r)},version:"17.0.2"},Vp=0,Hp={__interactionsRef:null,__subscriberRef:null,unstable_clear:function(e){return e()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Vp},unstable_subscribe:function(){},unstable_trace:function(e,t,n){return n()},unstable_unsubscribe:function(){},unstable_wrap:function(e){return e}},qp=i((function(e,t){}));qp.__interactionsRef,qp.__subscriberRef,qp.unstable_clear,qp.unstable_getCurrent,qp.unstable_getThreadID,qp.unstable_subscribe,qp.unstable_trace,qp.unstable_unsubscribe,qp.unstable_wrap,i((function(e){e.exports=Hp}));var Qp=i((function(e,t){}));Qp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qp.createPortal,Qp.findDOMNode,Qp.flushSync,Qp.hydrate,Qp.render,Qp.unmountComponentAtNode,Qp.unstable_batchedUpdates,Qp.unstable_createPortal,Qp.unstable_renderSubtreeIntoContainer,Qp.version;var Kp=i((function(e){!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=Up})),$p=function(e,t){var n=(t.top+t.bottom)/2;return e.top<=n&&e.bottom>=n},Yp=function(e,t,n){var r=dt.toDOMRange(e,t).getBoundingClientRect(),a=dt.toDOMRange(e,n).getBoundingClientRect();return $p(r,a)&&$p(a,r)},Xp=function(e,t){var r=n.Editor.range(e,n.Range.end(t)),a=Array.from(n.Editor.positions(e,{at:t})),o=0,l=a.length,i=Math.floor(l/2);if(Yp(e,n.Editor.range(e,a[o]),r))return n.Editor.range(e,a[o],r);if(a.length<2)return n.Editor.range(e,a[a.length-1],r);for(;i!==a.length&&i!==o;)Yp(e,n.Editor.range(e,a[i]),r)?l=i:o=i,i=Math.floor((o+l)/2);return n.Editor.range(e,a[l],r)};function Gp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Jp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Jp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zp(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var th=function(e,t){var r,a=[],o=Gp(n.Editor.levels(e,{at:t}));try{for(o.s();!(r=o.n()).done;){var l=h(r.value,2),i=l[0],u=l[1],s=dt.findKey(e,i);a.push([u,s])}}catch(e){o.e(e)}finally{o.f()}return a};e.DefaultElement=Rn,e.DefaultLeaf=On,e.DefaultPlaceholder=vr,e.Editable=function(e){var r=t.useCallback((function(e){return a.default.createElement(vr,Object.assign({},e))}),[]),o=e.autoFocus,l=e.decorate,i=void 0===l?gr:l,s=e.onDOMBeforeInput,c=e.placeholder,f=e.readOnly,d=void 0!==f&&f,p=e.renderElement,v=e.renderLeaf,b=e.renderPlaceholder,y=void 0===b?r:b,w=e.scrollSelectionIntoView,k=void 0===w?mr:w,E=e.style,x=void 0===E?{}:E,S=e.as,C=void 0===S?"div":S,T=e.disableDefaultStyles,_=void 0!==T&&T,O=g(e,ur),P=Un(),D=t.useState(!1),N=h(D,2),M=N[0],R=N[1],L=t.useRef(null),F=t.useRef([]),z=t.useState(),B=h(z,2),I=B[0],A=B[1],j=function(){var e=le(),n=t.useRef(!1),r=t.useRef(0),a=t.useCallback((function(){if(!n.current){n.current=!0;var t=dt.getWindow(e);t.cancelAnimationFrame(r.current),r.current=t.requestAnimationFrame((function(){n.current=!1}))}}),[e]);return t.useEffect((function(){return function(){return cancelAnimationFrame(r.current)}}),[]),{receivedUserInput:n,onUserInput:a}}(),W=j.onUserInput,U=j.receivedUserInput,V=t.useReducer((function(e){return e+1}),0),H=h(V,2)[1];Ue.set(P,H),Ne.set(P,d);var q=t.useMemo((function(){return{isDraggingInternally:!1,isUpdatingSelection:!1,latestElement:null,hasMarkPlaceholder:!1}}),[]);t.useEffect((function(){L.current&&o&&L.current.focus()}),[o]);var Q=t.useRef(),K=t.useMemo((function(){return G((function(){var e=Q.current;if((ce||!dt.isComposing(P))&&(!q.isUpdatingSelection||null!=e&&e.isFlushing())&&!q.isDraggingInternally){var t=dt.findDocumentOrShadowRoot(P),r=t.activeElement,a=dt.toDOMNode(P,P),o=t.getSelection();if(r===a?(q.latestElement=r,Me.set(P,!0)):Me.delete(P),!o)return n.Transforms.deselect(P);var l=o.anchorNode,i=o.focusNode,u=dt.hasEditableTarget(P,l)||dt.isTargetInsideNonReadonlyVoid(P,l),s=dt.hasEditableTarget(P,i)||dt.isTargetInsideNonReadonlyVoid(P,i);if(u&&s){var c=dt.toSlateRange(P,o,{exactMatch:!1,suppressThrow:!0});c&&(dt.isComposing(P)||null!=e&&e.hasPendingChanges()||null!=e&&e.isFlushing()?null==e||e.handleUserSelect(c):n.Transforms.select(P,c))}!d||u&&s||n.Transforms.deselect(P)}}),100)}),[P,d,q]),$=t.useMemo((function(){return X(K,0)}),[K]);Q.current=Dt({node:L,onDOMSelectionChange:K,scheduleOnDOMSelectionChange:$}),Ct((function(){var e,t,r;L.current&&(r=Je(L.current))?(Se.set(P,r),Ce.set(P,L.current),Oe.set(P,L.current),_e.set(L.current,P)):Oe.delete(P);var a=P.selection,o=dt.findDocumentOrShadowRoot(P).getSelection();if(o&&dt.isFocused(P)&&(null===(e=Q.current)||void 0===e||!e.hasPendingAction())){var l="action"===(null===(t=Q.current)||void 0===t?void 0:t.isFlushing());if(ce&&l){var i=null,u=requestAnimationFrame((function(){if(l){var e=function(e){try{dt.toDOMNode(P,P).focus(),function(e){var t="None"!==o.type;if(a||t){var r,l=o.focusNode;if(fe&&o.rangeCount>1){var i=o.getRangeAt(0),u=o.getRangeAt(o.rangeCount-1);r=i.startContainer===l?u.endContainer:i.startContainer}else r=o.anchorNode;var s=Ce.get(P),c=!1;if(s.contains(r)&&s.contains(l)&&(c=!0),t&&c&&a&&!e){var f=dt.toSlateRange(P,o,{exactMatch:!0,suppressThrow:!0});if(f&&n.Range.equals(f,a)){var d,p;if(!q.hasMarkPlaceholder)return;if(null!==(d=r)&&void 0!==d&&null!==(p=d.parentElement)&&void 0!==p&&p.hasAttribute("data-slate-mark-placeholder"))return}}if(!a||dt.hasRange(P,a)){q.isUpdatingSelection=!0;var h=a&&dt.toDOMRange(P,a);return h?(dt.isComposing(P)&&!ce?o.collapseToEnd():n.Range.isBackward(a)?o.setBaseAndExtent(h.endContainer,h.endOffset,h.startContainer,h.startOffset):o.setBaseAndExtent(h.startContainer,h.startOffset,h.endContainer,h.endOffset),k(P,h)):o.removeAllRanges(),h}P.selection=dt.toSlateRange(P,o,{exactMatch:!1,suppressThrow:!0})}}(e)}catch(e){}};e(),i=setTimeout((function(){e(!0),q.isUpdatingSelection=!1}))}}));return function(){cancelAnimationFrame(u),i&&clearTimeout(i)}}setTimeout((function(){q.isUpdatingSelection=!1}))}}));var Y=t.useCallback((function(e){if(W(),!d&&dt.hasEditableTarget(P,e.target)&&!wr(e,s)){var t;if(Q.current)return Q.current.handleDOMBeforeInput(e);$.flush(),K.flush();var r=P.selection,a=e.inputType,o=e.dataTransfer||e.data||void 0,l="insertCompositionText"===a||"deleteCompositionText"===a;if(l&&dt.isComposing(P))return;var i=!1;if("insertText"===a&&r&&n.Range.isCollapsed(r)&&e.data&&1===e.data.length&&/[a-z ]/i.test(e.data)&&0!==r.anchor.offset){var u,c;i=!0,P.marks&&(i=!1);var f=r.anchor,p=dt.toDOMPoint(P,f),v=h(p,2),g=v[0],m=v[1],b=null===(u=g.parentElement)||void 0===u?void 0:u.closest("a"),y=dt.getWindow(P);if(i&&b&&dt.hasDOMNode(P,b)){var w,k=null==y?void 0:y.document.createTreeWalker(b,NodeFilter.SHOW_TEXT).lastChild();k===g&&(null===(w=k.textContent)||void 0===w?void 0:w.length)===m&&(i=!1)}if(i&&g.parentElement&&"pre"===(null==y||null===(c=y.getComputedStyle(g.parentElement))||void 0===c?void 0:c.whiteSpace)){var E=n.Editor.above(P,{at:f.path,match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(P,e)}});E&&n.Node.string(E[0]).includes("\t")&&(i=!1)}}if(!a.startsWith("delete")||a.startsWith("deleteBy")){var x=e.getTargetRanges(),S=h(x,1)[0];if(S){var C=dt.toSlateRange(P,S,{exactMatch:!1,suppressThrow:!1});if(!r||!n.Range.equals(r,C)){i=!1;var T=!l&&P.selection&&n.Editor.rangeRef(P,P.selection);n.Transforms.select(P,C),T&&Le.set(P,T)}}}if(l)return;if(i||e.preventDefault(),r&&n.Range.isExpanded(r)&&a.startsWith("delete")){var _=a.endsWith("Backward")?"backward":"forward";return void n.Editor.deleteFragment(P,{direction:_})}switch(a){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":n.Editor.deleteFragment(P);break;case"deleteContent":case"deleteContentForward":n.Editor.deleteForward(P);break;case"deleteContentBackward":n.Editor.deleteBackward(P);break;case"deleteEntireSoftLine":n.Editor.deleteBackward(P,{unit:"line"}),n.Editor.deleteForward(P,{unit:"line"});break;case"deleteHardLineBackward":n.Editor.deleteBackward(P,{unit:"block"});break;case"deleteSoftLineBackward":n.Editor.deleteBackward(P,{unit:"line"});break;case"deleteHardLineForward":n.Editor.deleteForward(P,{unit:"block"});break;case"deleteSoftLineForward":n.Editor.deleteForward(P,{unit:"line"});break;case"deleteWordBackward":n.Editor.deleteBackward(P,{unit:"word"});break;case"deleteWordForward":n.Editor.deleteForward(P,{unit:"word"});break;case"insertLineBreak":n.Editor.insertSoftBreak(P);break;case"insertParagraph":n.Editor.insertBreak(P);break;case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":"insertFromComposition"===a&&dt.isComposing(P)&&(R(!1),Re.set(P,!1)),"DataTransfer"===(null==o?void 0:o.constructor.name)?dt.insertData(P,o):"string"==typeof o&&(i?F.current.push((function(){return n.Editor.insertText(P,o)})):n.Editor.insertText(P,o))}var O=null===(t=Le.get(P))||void 0===t?void 0:t.unref();Le.delete(P),!O||P.selection&&n.Range.equals(P.selection,O)||n.Transforms.select(P,O)}}),[P,K,W,s,d,$]),J=t.useCallback((function(e){null==e?(K.cancel(),$.cancel(),Ce.delete(P),Oe.delete(P),L.current&&ke&&L.current.removeEventListener("beforeinput",Y)):ke&&e.addEventListener("beforeinput",Y),L.current=e}),[K,$,P,Y]);Ct((function(){var e=dt.getWindow(P);return e.document.addEventListener("selectionchange",$),function(){e.document.removeEventListener("selectionchange",$)}}),[$]);var Z=i([P,[]]),ee=c&&1===P.children.length&&1===Array.from(n.Node.texts(P)).length&&""===n.Node.string(P)&&!M,te=t.useCallback((function(e){var t;e&&ee?A(null===(t=e.getBoundingClientRect())||void 0===t?void 0:t.height):A(void 0)}),[ee]);if(ee){var ne,re=n.Editor.start(P,[]);Z.push((u(ne={},Ve,!0),u(ne,"placeholder",c),u(ne,"onPlaceholderResize",te),u(ne,"anchor",re),u(ne,"focus",re),ne))}var ae=P.marks;if(q.hasMarkPlaceholder=!1,P.selection&&n.Range.isCollapsed(P.selection)&&ae){var oe=P.selection.anchor,ie=n.Node.leaf(P,oe.path);ie.text;var se=g(ie,sr);if(!n.Text.equals(ie,ae,{loose:!0})){q.hasMarkPlaceholder=!0;var pe=Object.fromEntries(Object.keys(se).map((function(e){return[e,null]})));Z.push(pr(pr(pr(u({},He,!0),pe),ae),{},{anchor:oe,focus:oe}))}}return t.useEffect((function(){setTimeout((function(){var e=P.selection;if(e){var t=e.anchor,r=n.Node.leaf(P,t.path);if(ae&&!n.Text.equals(r,ae,{loose:!0}))return void Be.set(P,ae)}Be.delete(P)}))})),a.default.createElement(An.Provider,{value:d},a.default.createElement(Ln.Provider,{value:i},a.default.createElement(ir,{node:L,receivedUserInput:U},a.default.createElement(C,Object.assign({role:d?void 0:"textbox","aria-multiline":!d||void 0},O,{spellCheck:!(!ke&&we)&&O.spellCheck,autoCorrect:ke||!we?O.autoCorrect:"false",autoCapitalize:ke||!we?O.autoCapitalize:"false","data-slate-editor":!0,"data-slate-node":"value",contentEditable:!d,zindex:-1,suppressContentEditableWarning:!0,ref:J,style:pr(pr({},_?{}:pr({position:"relative",whiteSpace:"pre-wrap",wordWrap:"break-word"},I?{minHeight:I}:{})),x),onBeforeInput:t.useCallback((function(e){if(!ke&&!d&&!br(e,O.onBeforeInput)&&dt.hasSelectableTarget(P,e.target)&&(e.preventDefault(),!dt.isComposing(P))){var t=e.data;n.Editor.insertText(P,t)}}),[O.onBeforeInput,P,d]),onInput:t.useCallback((function(e){if(!br(e,O.onInput))if(Q.current)Q.current.handleInput();else{var t,n=cr(F.current);try{for(n.s();!(t=n.n()).done;){(0,t.value)()}}catch(e){n.e(e)}finally{n.f()}F.current=[]}}),[O.onInput]),onBlur:t.useCallback((function(e){if(!d&&!q.isUpdatingSelection&&dt.hasSelectableTarget(P,e.target)&&!br(e,O.onBlur)){var t=dt.findDocumentOrShadowRoot(P);if(q.latestElement!==t.activeElement){var r=e.relatedTarget;if(!(r===dt.toDOMNode(P,P)||Ze(r)&&r.hasAttribute("data-slate-spacer"))){if(null!=r&&et(r)&&dt.hasDOMNode(P,r)){var a=dt.toSlateNode(P,r);if(n.Element.isElement(a)&&!P.isVoid(a))return}if(de){var o=t.getSelection();null==o||o.removeAllRanges()}Me.delete(P)}}}}),[d,q.isUpdatingSelection,q.latestElement,P,O.onBlur]),onClick:t.useCallback((function(e){if(dt.hasTarget(P,e.target)&&!br(e,O.onClick)&&et(e.target)){var t=dt.toSlateNode(P,e.target),r=dt.findPath(P,t);if(!n.Editor.hasPath(P,r)||n.Node.get(P,r)!==t)return;if(3===e.detail&&r.length>=1){var a=r;if(!n.Element.isElement(t)||!n.Editor.isBlock(P,t)){var o,l=n.Editor.above(P,{match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(P,e)},at:r});a=null!==(o=null==l?void 0:l[1])&&void 0!==o?o:r.slice(0,1)}var i=n.Editor.range(P,a);return void n.Transforms.select(P,i)}if(d)return;var u=n.Editor.start(P,r),s=n.Editor.end(P,r),c=n.Editor.void(P,{at:u}),f=n.Editor.void(P,{at:s});if(c&&f&&n.Path.equals(c[1],f[1])){var p=n.Editor.range(P,u);n.Transforms.select(P,p)}}}),[P,O.onClick,d]),onCompositionEnd:t.useCallback((function(e){if(dt.hasSelectableTarget(P,e.target)){var t;if(dt.isComposing(P)&&(R(!1),Re.set(P,!1)),null===(t=Q.current)||void 0===t||t.handleCompositionEnd(e),br(e,O.onCompositionEnd)||ce)return;if(!de&&!me&&!ue&&!ye&&!be&&e.data){var r=Be.get(P);Be.delete(P),void 0!==r&&(Ie.set(P,P.marks),P.marks=r),n.Editor.insertText(P,e.data);var a=Ie.get(P);Ie.delete(P),void 0!==a&&(P.marks=a)}}}),[O.onCompositionEnd,P]),onCompositionUpdate:t.useCallback((function(e){dt.hasSelectableTarget(P,e.target)&&!br(e,O.onCompositionUpdate)&&(dt.isComposing(P)||(R(!0),Re.set(P,!0)))}),[O.onCompositionUpdate,P]),onCompositionStart:t.useCallback((function(e){if(dt.hasSelectableTarget(P,e.target)){var t;if(null===(t=Q.current)||void 0===t||t.handleCompositionStart(e),br(e,O.onCompositionStart)||ce)return;R(!0);var r=P.selection;if(r){if(n.Range.isExpanded(r))return void n.Editor.deleteFragment(P);var a=n.Editor.above(P,{match:function(e){return n.Element.isElement(e)&&n.Editor.isInline(P,e)},mode:"highest"});if(a){var o=h(a,2)[1];if(n.Editor.isEnd(P,r.anchor,o)){var l=n.Editor.after(P,o);n.Transforms.setSelection(P,{anchor:l,focus:l})}}}}}),[O.onCompositionStart,P]),onCopy:t.useCallback((function(e){!dt.hasSelectableTarget(P,e.target)||br(e,O.onCopy)||yr(e)||(e.preventDefault(),dt.setFragmentData(P,e.clipboardData,"copy"))}),[O.onCopy,P]),onCut:t.useCallback((function(e){if(!d&&dt.hasSelectableTarget(P,e.target)&&!br(e,O.onCut)&&!yr(e)){e.preventDefault(),dt.setFragmentData(P,e.clipboardData,"cut");var t=P.selection;if(t)if(n.Range.isExpanded(t))n.Editor.deleteFragment(P);else{var r=n.Node.parent(P,t.anchor.path);n.Editor.isVoid(P,r)&&n.Transforms.delete(P)}}}),[d,P,O.onCut]),onDragOver:t.useCallback((function(e){if(dt.hasTarget(P,e.target)&&!br(e,O.onDragOver)){var t=dt.toSlateNode(P,e.target);n.Element.isElement(t)&&n.Editor.isVoid(P,t)&&e.preventDefault()}}),[O.onDragOver,P]),onDragStart:t.useCallback((function(e){if(!d&&dt.hasTarget(P,e.target)&&!br(e,O.onDragStart)){var t=dt.toSlateNode(P,e.target),r=dt.findPath(P,t);if(n.Element.isElement(t)&&n.Editor.isVoid(P,t)||n.Editor.void(P,{at:r,voids:!0})){var a=n.Editor.range(P,r);n.Transforms.select(P,a)}q.isDraggingInternally=!0,dt.setFragmentData(P,e.dataTransfer,"drag")}}),[d,P,O.onDragStart,q]),onDrop:t.useCallback((function(e){if(!d&&dt.hasTarget(P,e.target)&&!br(e,O.onDrop)){e.preventDefault();var t=P.selection,r=dt.findEventRange(P,e),a=e.dataTransfer;n.Transforms.select(P,r),q.isDraggingInternally&&(!t||n.Range.equals(t,r)||n.Editor.void(P,{at:r,voids:!0})||n.Transforms.delete(P,{at:t})),dt.insertData(P,a),dt.isFocused(P)||dt.focus(P)}q.isDraggingInternally=!1}),[d,P,O.onDrop,q]),onDragEnd:t.useCallback((function(e){!d&&q.isDraggingInternally&&O.onDragEnd&&dt.hasTarget(P,e.target)&&O.onDragEnd(e),q.isDraggingInternally=!1}),[d,q,O,P]),onFocus:t.useCallback((function(e){if(!d&&!q.isUpdatingSelection&&dt.hasEditableTarget(P,e.target)&&!br(e,O.onFocus)){var t=dt.toDOMNode(P,P),n=dt.findDocumentOrShadowRoot(P);if(q.latestElement=n.activeElement,fe&&e.target!==t)return void t.focus();Me.set(P,!0)}}),[d,q,P,O.onFocus]),onKeyDown:t.useCallback((function(e){if(!d&&dt.hasEditableTarget(P,e.target)){var t;null===(t=Q.current)||void 0===t||t.handleKeyDown(e);var r=e.nativeEvent;if(dt.isComposing(P)&&!1===r.isComposing&&(Re.set(P,!1),R(!1)),br(e,O.onKeyDown)||dt.isComposing(P))return;var a=P.selection,o=P.children[null!==a?a.focus.path[0]:0],l="rtl"===m(n.Node.string(o));if(Yn.isRedo(r)){e.preventDefault();var i=P;return void("function"==typeof i.redo&&i.redo())}if(Yn.isUndo(r)){e.preventDefault();var u=P;return void("function"==typeof u.undo&&u.undo())}if(Yn.isMoveLineBackward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",reverse:!0});if(Yn.isMoveLineForward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line"});if(Yn.isExtendLineBackward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",edge:"focus",reverse:!0});if(Yn.isExtendLineForward(r))return e.preventDefault(),void n.Transforms.move(P,{unit:"line",edge:"focus"});if(Yn.isMoveBackward(r))return e.preventDefault(),void(a&&n.Range.isCollapsed(a)?n.Transforms.move(P,{reverse:!l}):n.Transforms.collapse(P,{edge:"start"}));if(Yn.isMoveForward(r))return e.preventDefault(),void(a&&n.Range.isCollapsed(a)?n.Transforms.move(P,{reverse:l}):n.Transforms.collapse(P,{edge:"end"}));if(Yn.isMoveWordBackward(r))return e.preventDefault(),a&&n.Range.isExpanded(a)&&n.Transforms.collapse(P,{edge:"focus"}),void n.Transforms.move(P,{unit:"word",reverse:!l});if(Yn.isMoveWordForward(r))return e.preventDefault(),a&&n.Range.isExpanded(a)&&n.Transforms.collapse(P,{edge:"focus"}),void n.Transforms.move(P,{unit:"word",reverse:l});if(ke){if((he||de)&&a&&(Yn.isDeleteBackward(r)||Yn.isDeleteForward(r))&&n.Range.isCollapsed(a)){var s=n.Node.parent(P,a.anchor.path);if(n.Element.isElement(s)&&n.Editor.isVoid(P,s)&&(n.Editor.isInline(P,s)||n.Editor.isBlock(P,s)))return e.preventDefault(),void n.Editor.deleteBackward(P,{unit:"block"})}}else{if(Yn.isBold(r)||Yn.isItalic(r)||Yn.isTransposeCharacter(r))return void e.preventDefault();if(Yn.isSoftBreak(r))return e.preventDefault(),void n.Editor.insertSoftBreak(P);if(Yn.isSplitBlock(r))return e.preventDefault(),void n.Editor.insertBreak(P);if(Yn.isDeleteBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P));if(Yn.isDeleteForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P));if(Yn.isDeleteLineBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P,{unit:"line"}));if(Yn.isDeleteLineForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P,{unit:"line"}));if(Yn.isDeleteWordBackward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"backward"}):n.Editor.deleteBackward(P,{unit:"word"}));if(Yn.isDeleteWordForward(r))return e.preventDefault(),void(a&&n.Range.isExpanded(a)?n.Editor.deleteFragment(P,{direction:"forward"}):n.Editor.deleteForward(P,{unit:"word"}))}}}),[d,P,O.onKeyDown]),onPaste:t.useCallback((function(e){d||!dt.hasEditableTarget(P,e.target)||br(e,O.onPaste)||(!ke||function(e){return e.clipboardData&&""!==e.clipboardData.getData("text/plain")&&1===e.clipboardData.types.length}(e.nativeEvent)||de)&&(e.preventDefault(),dt.insertData(P,e.clipboardData))}),[d,P,O.onPaste])}),a.default.createElement(hr,{decorations:Z,node:P,renderElement:p,renderPlaceholder:y,renderLeaf:v,selection:P.selection})))))},e.ReactEditor=dt,e.Slate=function(e){var r=e.editor,o=e.children,l=e.onChange,i=e.initialValue,u=g(e,Tr),s=t.useRef(!1),c=a.default.useState((function(){if(!n.Node.isNodeList(i))throw new Error("[Slate] initialValue is invalid! Expected a list of elements but got: ".concat(n.Scrubber.stringify(i)));if(!n.Editor.isEditor(r))throw new Error("[Slate] editor is invalid! You passed: ".concat(n.Scrubber.stringify(r)));return r.children=i,Object.assign(r,u),{v:0,editor:r}})),f=h(c,2),d=f[0],p=f[1],v=function(e){var n=t.useRef([]).current,r=t.useRef({editor:e}).current,a=t.useCallback((function(e){r.editor=e,n.forEach((function(t){return t(e)}))}),[n,r]);return{selectorContext:t.useMemo((function(){return{getSlate:function(){return r.editor},addEventListener:function(e){return n.push(e),function(){n.splice(n.indexOf(e),1)}}}}),[n,r]),onChange:a}}(r),m=v.selectorContext,b=v.onChange,y=t.useCallback((function(){l&&l(r.children),p((function(e){return{v:e.v+1,editor:r}})),b(r)}),[r,b,l]);t.useEffect((function(){return Fe.set(r,y),function(){Fe.set(r,(function(){})),s.current=!0}}),[r,y]);var w=t.useState(dt.isFocused(r)),k=h(w,2),E=k[0],x=k[1];return t.useEffect((function(){x(dt.isFocused(r))}),[r]),Ct((function(){var e=function(){return x(dt.isFocused(r))};return ie>=17?(document.addEventListener("focusin",e),document.addEventListener("focusout",e),function(){document.removeEventListener("focusin",e),document.removeEventListener("focusout",e)}):(document.addEventListener("focus",e,!0),document.addEventListener("blur",e,!0),function(){document.removeEventListener("focus",e,!0),document.removeEventListener("blur",e,!0)})}),[]),a.default.createElement(xr.Provider,{value:m},a.default.createElement(Wn.Provider,{value:d},a.default.createElement(oe.Provider,{value:d.editor},a.default.createElement(kr.Provider,{value:E},o))))},e.useEditor=function(){var e=t.useContext(oe);if(!e)throw new Error("The `useEditor` hook must be used inside the <Slate> component's context.");return e},e.useFocused=function(){return t.useContext(kr)},e.useReadOnly=jn,e.useSelected=function(){return t.useContext(Fn)},e.useSlate=Un,e.useSlateSelection=function(){return Cr((function(e){return e.selection}),_r)},e.useSlateSelector=Cr,e.useSlateStatic=le,e.useSlateWithV=function(){var e=t.useContext(Wn);if(!e)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");return e},e.withReact=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x-slate-fragment",r=e,a=r.apply,o=r.onChange,l=r.deleteBackward,i=r.addMark,u=r.removeMark;return De.set(r,new WeakMap),r.addMark=function(e,t){var n,a;null===(n=ze.get(r))||void 0===n||n(),!Be.get(r)&&null!==(a=Ae.get(r))&&void 0!==a&&a.length&&Be.set(r,null),Ie.delete(r),i(e,t)},r.removeMark=function(e){var t;!Be.get(r)&&null!==(t=Ae.get(r))&&void 0!==t&&t.length&&Be.set(r,null),Ie.delete(r),u(e)},r.deleteBackward=function(e){if("line"!==e)return l(e);if(r.selection&&n.Range.isCollapsed(r.selection)){var t=n.Editor.above(r,{match:function(e){return n.Element.isElement(e)&&n.Editor.isBlock(r,e)},at:r.selection});if(t){var a=h(t,2)[1],o=n.Editor.range(r,a,r.selection.anchor),i=Xp(r,o);n.Range.isCollapsed(i)||n.Transforms.delete(r,{at:i})}}},r.apply=function(e){var t=[],o=Ae.get(r);if(null!=o&&o.length){var l=o.map((function(t){return kt(t,e)})).filter(Boolean);Ae.set(r,l)}var i=We.get(r);i&&We.set(r,wt(r,i,e));var u=je.get(r);if(null!=u&&u.at){var s=n.Point.isPoint(null==u?void 0:u.at)?yt(r,u.at,e):wt(r,u.at,e);je.set(r,s?eh(eh({},u),{},{at:s}):null)}switch(e.type){case"insert_text":case"remove_text":case"set_node":case"split_node":t.push.apply(t,$e(th(r,e.path)));break;case"set_selection":var c;null===(c=Le.get(r))||void 0===c||c.unref(),Le.delete(r);break;case"insert_node":case"remove_node":t.push.apply(t,$e(th(r,n.Path.parent(e.path))));break;case"merge_node":var f=n.Path.previous(e.path);t.push.apply(t,$e(th(r,f)));break;case"move_node":var d=n.Path.common(n.Path.parent(e.path),n.Path.parent(e.newPath));t.push.apply(t,$e(th(r,d)))}a(e);for(var p=0,v=t;p<v.length;p++){var g=h(v[p],2),m=g[0],b=g[1],y=n.Editor.node(r,m),w=h(y,1)[0];Pe.set(w,b)}},r.setFragmentData=function(e){var a=r.selection;if(a){var o=n.Range.edges(a),l=h(o,2),i=l[0],u=l[1],s=n.Editor.void(r,{at:i.path}),c=n.Editor.void(r,{at:u.path});if(!n.Range.isCollapsed(a)||s){var f=dt.toDOMRange(r,a),d=f.cloneContents(),p=d.childNodes[0];if(d.childNodes.forEach((function(e){e.textContent&&""!==e.textContent.trim()&&(p=e)})),c){var v=h(c,1)[0],g=f.cloneRange(),m=dt.toDOMNode(r,v);g.setEndAfter(m),d=g.cloneContents()}if(s&&(p=d.querySelector("[data-slate-spacer]")),Array.from(d.querySelectorAll("[data-slate-zero-width]")).forEach((function(e){var t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""})),nt(p)){var b=p.ownerDocument.createElement("span");b.style.whiteSpace="pre",b.appendChild(p),d.appendChild(b),p=b}var y=r.getFragment(),w=JSON.stringify(y),k=window.btoa(encodeURIComponent(w));p.setAttribute("data-slate-fragment",k),e.setData("application/".concat(t),k);var E=d.ownerDocument.createElement("div");return E.appendChild(d),E.setAttribute("hidden","true"),d.ownerDocument.body.appendChild(E),e.setData("text/html",E.innerHTML),e.setData("text/plain",ot(E)),d.ownerDocument.body.removeChild(E),e}}},r.insertData=function(e){r.insertFragmentData(e)||r.insertTextData(e)},r.insertFragmentData=function(e){var n=e.getData("application/".concat(t))||it(e);if(n){var a=decodeURIComponent(window.atob(n)),o=JSON.parse(a);return r.insertFragment(o),!0}return!1},r.insertTextData=function(e){var t=e.getData("text/plain");if(t){var a,o=!1,l=Gp(t.split(/\r\n|\r|\n/));try{for(l.s();!(a=l.n()).done;){var i=a.value;o&&n.Transforms.splitNodes(r,{always:!0}),r.insertText(i),o=!0}}catch(e){l.e(e)}finally{l.f()}return!0}return!1},r.onChange=function(e){(ie<18?Kp.unstable_batchedUpdates:function(e){return e()})((function(){var t=Fe.get(r);t&&t(),o(e)}))},r},Object.defineProperty(e,"__esModule",{value:!0})}));
